<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>bro: /home/jasonlu/bro/src/analyzer/protocol/tcp/TCP.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">bro
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5b988f0c4d1fda8dce2b23100e7167dd.html">bro</a></li><li class="navelem"><a class="el" href="dir_1ae927ab70ca550cfc88d2a3fb3c22b4.html">src</a></li><li class="navelem"><a class="el" href="dir_7586a856c60941b3cc462ee37566c769.html">analyzer</a></li><li class="navelem"><a class="el" href="dir_03030804dde665b61f655ec69ac6e841.html">protocol</a></li><li class="navelem"><a class="el" href="dir_dd48db9b997925238105e6f723e03c15.html">tcp</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">TCP.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;algorithm&gt;</code><br />
<code>#include &quot;<a class="el" href="NetVar_8h_source.html">NetVar.h</a>&quot;</code><br />
<code>#include &quot;File.h&quot;</code><br />
<code>#include &quot;<a class="el" href="OSFinger_8h_source.html">OSFinger.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Event_8h_source.html">Event.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="PIA_8h_source.html">analyzer/protocol/pia/PIA.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="TCP_8h_source.html">analyzer/protocol/tcp/TCP.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="TCP__Reassembler_8h_source.html">analyzer/protocol/tcp/TCP_Reassembler.h</a>&quot;</code><br />
<code>#include &quot;events.bif.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for TCP.cc:</div>
<div class="dyncontent">
<div class="center"><img src="TCP_8cc__incl.png" border="0" usemap="#_2home_2jasonlu_2bro_2src_2analyzer_2protocol_2tcp_2TCP_8cc" alt=""/></div>
<map name="_2home_2jasonlu_2bro_2src_2analyzer_2protocol_2tcp_2TCP_8cc" id="_2home_2jasonlu_2bro_2src_2analyzer_2protocol_2tcp_2TCP_8cc">
<area shape="rect" id="node3" href="NetVar_8h.html" title="NetVar.h" alt="" coords="597,363,672,389"/>
<area shape="rect" id="node36" href="OSFinger_8h.html" title="OSFinger.h" alt="" coords="985,363,1073,389"/>
<area shape="rect" id="node38" href="Event_8h.html" title="Event.h" alt="" coords="2077,288,2144,315"/>
<area shape="rect" id="node42" href="PIA_8h.html" title="analyzer/protocol/pia\l/PIA.h" alt="" coords="1879,109,2022,151"/>
<area shape="rect" id="node43" href="TCP_8h.html" title="analyzer/protocol/tcp\l/TCP.h" alt="" coords="1661,199,1803,240"/>
<area shape="rect" id="node48" href="TCP__Reassembler_8h.html" title="analyzer/protocol/tcp\l/TCP_Reassembler.h" alt="" coords="1458,199,1606,240"/>
<area shape="rect" id="node4" href="Val_8h.html" title="Val.h" alt="" coords="1851,437,1903,464"/>
<area shape="rect" id="node24" href="Func_8h.html" title="Func.h" alt="" coords="726,512,789,539"/>
<area shape="rect" id="node27" href="EventRegistry_8h.html" title="EventRegistry.h" alt="" coords="723,437,839,464"/>
<area shape="rect" id="node29" href="Stats_8h.html" title="Stats.h" alt="" coords="1203,437,1267,464"/>
<area shape="rect" id="node8" href="net__util_8h.html" title="net_util.h" alt="" coords="1789,587,1864,613"/>
<area shape="rect" id="node11" href="Type_8h.html" title="Type.h" alt="" coords="1550,587,1613,613"/>
<area shape="rect" id="node13" href="Attr_8h.html" title="Attr.h" alt="" coords="1622,661,1677,688"/>
<area shape="rect" id="node16" href="Dict_8h.html" title="Dict.h" alt="" coords="1218,661,1275,688"/>
<area shape="rect" id="node17" href="CompHash_8h.html" title="CompHash.h" alt="" coords="1611,512,1709,539"/>
<area shape="rect" id="node18" href="BroString_8h.html" title="BroString.h" alt="" coords="1889,587,1975,613"/>
<area shape="rect" id="node19" href="Timer_8h.html" title="Timer.h" alt="" coords="2387,512,2453,539"/>
<area shape="rect" id="node20" href="ID_8h.html" title="ID.h" alt="" coords="2011,512,2058,539"/>
<area shape="rect" id="node21" href="StateAccess_8h.html" title="StateAccess.h" alt="" coords="2051,587,2159,613"/>
<area shape="rect" id="node22" href="Scope_8h.html" title="Scope.h" alt="" coords="1353,587,1423,613"/>
<area shape="rect" id="node23" href="IPAddr_8h.html" title="IPAddr.h" alt="" coords="1411,512,1485,539"/>
<area shape="rect" id="node10" href="util_8h.html" title="util.h" alt="" coords="1552,811,1603,837"/>
<area shape="rect" id="node12" href="Obj_8h.html" title="Obj.h" alt="" coords="1531,736,1584,763"/>
<area shape="rect" id="node14" href="BroList_8h.html" title="BroList.h" alt="" coords="1300,661,1375,688"/>
<area shape="rect" id="node15" href="List_8h.html" title="List.h" alt="" coords="1161,736,1215,763"/>
<area shape="rect" id="node26" href="Debug_8h.html" title="Debug.h" alt="" coords="690,587,761,613"/>
<area shape="rect" id="node28" href="EventHandler_8h.html" title="EventHandler.h" alt="" coords="965,512,1077,539"/>
<area shape="rect" id="node37" href="Reporter_8h.html" title="Reporter.h" alt="" coords="988,437,1071,464"/>
<area shape="rect" id="node39" href="Serializer_8h.html" title="Serializer.h" alt="" coords="2029,363,2115,389"/>
<area shape="rect" id="node40" href="analyzer_2Tag_8h.html" title="analyzer/Tag.h" alt="" coords="2630,437,2738,464"/>
<area shape="rect" id="node41" href="analyzer_2Analyzer_8h.html" title="analyzer/Analyzer.h" alt="" coords="2473,363,2610,389"/>
<area shape="rect" id="node44" href="PacketDumper_8h.html" title="PacketDumper.h" alt="" coords="1933,288,2053,315"/>
<area shape="rect" id="node45" href="TCP__Endpoint_8h.html" title="TCP_Endpoint.h" alt="" coords="1606,288,1725,315"/>
<area shape="rect" id="node46" href="TCP__Flags_8h.html" title="TCP_Flags.h" alt="" coords="1483,288,1581,315"/>
<area shape="rect" id="node47" href="Conn_8h.html" title="Conn.h" alt="" coords="1845,288,1909,315"/>
<area shape="rect" id="node49" href="Reassem_8h.html" title="Reassem.h" alt="" coords="1401,437,1490,464"/>
</map>
</div>
</div>
<p><a href="TCP_8cc_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:acb3203940d8aab3eef7dd8ec1e0112db"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="TCP_8cc.html#acb3203940d8aab3eef7dd8ec1e0112db">TH_ECE</a>&#160;&#160;&#160;0x40</td></tr>
<tr class="separator:acb3203940d8aab3eef7dd8ec1e0112db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a427da5535811ecaae82a11869ea9e1d9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="TCP_8cc.html#a427da5535811ecaae82a11869ea9e1d9">TH_CWR</a>&#160;&#160;&#160;0x80</td></tr>
<tr class="separator:a427da5535811ecaae82a11869ea9e1d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7cbae7c65518e45bf3bb43e30bdde35"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="TCP_8cc.html#af7cbae7c65518e45bf3bb43e30bdde35">TOO_LARGE_SEQ_DELTA</a>&#160;&#160;&#160;1048576</td></tr>
<tr class="separator:af7cbae7c65518e45bf3bb43e30bdde35"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a94780f7aa08732a0cb9f424723ac52b9"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classRecordVal.html">RecordVal</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="TCP_8cc.html#a94780f7aa08732a0cb9f424723ac52b9">build_syn_packet_val</a> (int is_orig, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip, const struct tcphdr *tcp)</td></tr>
<tr class="separator:a94780f7aa08732a0cb9f424723ac52b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3029ea1fb2cc0043d0800c5b866a675a"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classRecordVal.html">RecordVal</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="TCP_8cc.html#a3029ea1fb2cc0043d0800c5b866a675a">build_os_val</a> (int is_orig, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip, const struct tcphdr *tcp, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> tcp_hdr_len)</td></tr>
<tr class="separator:a3029ea1fb2cc0043d0800c5b866a675a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a430bc1e427ce2a7f556c498743ac4cec"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="TCP_8cc.html#a430bc1e427ce2a7f556c498743ac4cec">passive_fingerprint</a> (<a class="el" href="classanalyzer_1_1tcp_1_1TCP__Analyzer.html">TCP_Analyzer</a> *tcp, bool is_orig, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip, const struct tcphdr *tp, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> tcp_hdr_len)</td></tr>
<tr class="separator:a430bc1e427ce2a7f556c498743ac4cec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a760ebc103e668d434b07cd75a98d8a18"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="TCP_8cc.html#a760ebc103e668d434b07cd75a98d8a18">update_history</a> (<a class="el" href="classanalyzer_1_1tcp_1_1TCP__Flags.html">TCP_Flags</a> flags, <a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *<a class="el" href="NetVar_8h.html#a3262e86c23b12b9eeec15cbc3e5eb99b">endpoint</a>, <a class="el" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> rel_seq, int len)</td></tr>
<tr class="separator:a760ebc103e668d434b07cd75a98d8a18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa134f71de6d0c1398ccc141d3bb39f74"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="TCP_8cc.html#aa134f71de6d0c1398ccc141d3bb39f74">init_window</a> (<a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *<a class="el" href="NetVar_8h.html#a3262e86c23b12b9eeec15cbc3e5eb99b">endpoint</a>, <a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *<a class="el" href="NetVar_8h.html#a2260e28f6230cdd21c6d230fdced24b1">peer</a>, <a class="el" href="classanalyzer_1_1tcp_1_1TCP__Flags.html">TCP_Flags</a> flags, <a class="el" href="util_8h.html#a24311c511e9860ae0891def00cc0592d">bro_int_t</a> scale, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> base_seq, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> ack_seq)</td></tr>
<tr class="separator:aa134f71de6d0c1398ccc141d3bb39f74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a521d5f8ccac25db071681b896f74fcef"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="TCP_8cc.html#a521d5f8ccac25db071681b896f74fcef">update_window</a> (<a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *<a class="el" href="NetVar_8h.html#a3262e86c23b12b9eeec15cbc3e5eb99b">endpoint</a>, unsigned int window, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> base_seq, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> ack_seq, <a class="el" href="classanalyzer_1_1tcp_1_1TCP__Flags.html">TCP_Flags</a> flags)</td></tr>
<tr class="separator:a521d5f8ccac25db071681b896f74fcef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b8b7f14cbccaa203aa43bd14a4b328e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="TCP_8cc.html#a0b8b7f14cbccaa203aa43bd14a4b328e">syn_weirds</a> (<a class="el" href="classanalyzer_1_1tcp_1_1TCP__Flags.html">TCP_Flags</a> flags, <a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *<a class="el" href="NetVar_8h.html#a3262e86c23b12b9eeec15cbc3e5eb99b">endpoint</a>, int data_len)</td></tr>
<tr class="separator:a0b8b7f14cbccaa203aa43bd14a4b328e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a799e0170d2a82b0ebffd3444c59bd26d"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="TCP_8cc.html#a799e0170d2a82b0ebffd3444c59bd26d">get_relative_seq</a> (const <a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *<a class="el" href="NetVar_8h.html#a3262e86c23b12b9eeec15cbc3e5eb99b">endpoint</a>, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> cur_base, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> last, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> wraps, bool *underflow=0)</td></tr>
<tr class="separator:a799e0170d2a82b0ebffd3444c59bd26d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4242da7c43cc41ccd53b5a5a9e2bd7b8"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="TCP_8cc.html#a4242da7c43cc41ccd53b5a5a9e2bd7b8">get_segment_len</a> (int payload_len, <a class="el" href="classanalyzer_1_1tcp_1_1TCP__Flags.html">TCP_Flags</a> flags)</td></tr>
<tr class="separator:a4242da7c43cc41ccd53b5a5a9e2bd7b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abebe4e4649deb2ec2786baded575df38"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="TCP_8cc.html#abebe4e4649deb2ec2786baded575df38">init_endpoint</a> (<a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *<a class="el" href="NetVar_8h.html#a3262e86c23b12b9eeec15cbc3e5eb99b">endpoint</a>, <a class="el" href="classanalyzer_1_1tcp_1_1TCP__Flags.html">TCP_Flags</a> flags, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> first_seg_seq, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> last_seq, double t)</td></tr>
<tr class="separator:abebe4e4649deb2ec2786baded575df38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f8d0b6ab9f353a5448eb6adda3b29d1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="TCP_8cc.html#a2f8d0b6ab9f353a5448eb6adda3b29d1">init_peer</a> (<a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *<a class="el" href="NetVar_8h.html#a2260e28f6230cdd21c6d230fdced24b1">peer</a>, <a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *<a class="el" href="NetVar_8h.html#a3262e86c23b12b9eeec15cbc3e5eb99b">endpoint</a>, <a class="el" href="classanalyzer_1_1tcp_1_1TCP__Flags.html">TCP_Flags</a> flags, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> ack_seq)</td></tr>
<tr class="separator:a2f8d0b6ab9f353a5448eb6adda3b29d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4761586c66bd342eae540f772c344e44"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="TCP_8cc.html#a4761586c66bd342eae540f772c344e44">update_ack_seq</a> (<a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *<a class="el" href="NetVar_8h.html#a3262e86c23b12b9eeec15cbc3e5eb99b">endpoint</a>, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> ack_seq)</td></tr>
<tr class="separator:a4761586c66bd342eae540f772c344e44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67a2d7d6580da138b52bac3710d2dd4b"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="util_8h.html#ab7903878916593daecbeb95b98115ab0">int32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="TCP_8cc.html#a67a2d7d6580da138b52bac3710d2dd4b">update_last_seq</a> (<a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *<a class="el" href="NetVar_8h.html#a3262e86c23b12b9eeec15cbc3e5eb99b">endpoint</a>, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> last_seq, <a class="el" href="classanalyzer_1_1tcp_1_1TCP__Flags.html">TCP_Flags</a> flags, int len)</td></tr>
<tr class="separator:a67a2d7d6580da138b52bac3710d2dd4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b7150db31f548075c43bd0f3f0b42a8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="TCP_8cc.html#a8b7150db31f548075c43bd0f3f0b42a8">endian_flip</a> (int n)</td></tr>
<tr class="separator:a8b7150db31f548075c43bd0f3f0b42a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a78de38cc503164b5b63f18e951d73574"><td class="memItemLeft" align="right" valign="top">static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="TCP_8cc.html#a78de38cc503164b5b63f18e951d73574">ORIG</a> = 1</td></tr>
<tr class="separator:a78de38cc503164b5b63f18e951d73574"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5a2ceca6571928bb008b306fde9628e"><td class="memItemLeft" align="right" valign="top">static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="TCP_8cc.html#ac5a2ceca6571928bb008b306fde9628e">RESP</a> = 2</td></tr>
<tr class="separator:ac5a2ceca6571928bb008b306fde9628e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a427da5535811ecaae82a11869ea9e1d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TH_CWR&#160;&#160;&#160;0x80</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="TCP_8cc_source.html#l00030">30</a> of file <a class="el" href="TCP_8cc_source.html">TCP.cc</a>.</p>

</div>
</div>
<a class="anchor" id="acb3203940d8aab3eef7dd8ec1e0112db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TH_ECE&#160;&#160;&#160;0x40</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="TCP_8cc_source.html#l00026">26</a> of file <a class="el" href="TCP_8cc_source.html">TCP.cc</a>.</p>

</div>
</div>
<a class="anchor" id="af7cbae7c65518e45bf3bb43e30bdde35"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TOO_LARGE_SEQ_DELTA&#160;&#160;&#160;1048576</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="TCP_8cc_source.html#l00034">34</a> of file <a class="el" href="TCP_8cc_source.html">TCP.cc</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a3029ea1fb2cc0043d0800c5b866a675a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classRecordVal.html">RecordVal</a>* build_os_val </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_orig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct tcphdr *&#160;</td>
          <td class="paramname"><em>tcp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&#160;</td>
          <td class="paramname"><em>tcp_hdr_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="TCP_8cc_source.html#l00118">118</a> of file <a class="el" href="TCP_8cc_source.html">TCP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">if</span> ( ! is_orig )</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="comment">// Later we might use SYN-ACK fingerprinting here.</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// Passive OS fingerprinting wants to know a lot about IP and TCP</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// options: how many options there are, and in which order.</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordtype">int</span> winscale = 0;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordtype">int</span> MSS = 0;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordtype">int</span> optcount = 0;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> quirks = 0;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> tstamp = 0;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> op[<a class="code" href="OSFinger_8h.html#aecb43ca9e05881053b36a9f8e6f39350">MAXOPT</a>];</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span> ( ip-&gt;<a class="code" href="classIP__Hdr.html#a86ccf5d09d6e00dc0229b065ffda3ed6">HdrLen</a>() &gt; 20 )</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        quirks |= <a class="code" href="OSFinger_8h.html#ad66e76c4b49da5f0b0909f3154865bf3">QUIRK_IPOPT</a>;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">if</span> ( ip-&gt;<a class="code" href="classIP__Hdr.html#a9ddce824b8b97f1b4b8fac9c861d5ab1">ID</a>() == 0 )</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        quirks |= <a class="code" href="OSFinger_8h.html#a8e5994ed1775c179f662b8940824de84">QUIRK_ZEROID</a>;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">if</span> ( tcp-&gt;th_seq == 0 )</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        quirks |= <a class="code" href="OSFinger_8h.html#a6a0006ba80263c4b31876032cb137f99">QUIRK_SEQ0</a>;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">if</span> ( tcp-&gt;th_seq == tcp-&gt;th_ack )</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        quirks |= <a class="code" href="OSFinger_8h.html#a9ae08c0a82e3abf0185cfc3d33f60bbb">QUIRK_SEQEQ</a>;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> ( tcp-&gt;th_flags &amp; ~(TH_SYN|TH_ACK|TH_RST|<a class="code" href="TCP_8cc.html#acb3203940d8aab3eef7dd8ec1e0112db">TH_ECE</a>|<a class="code" href="TCP_8cc.html#a427da5535811ecaae82a11869ea9e1d9">TH_CWR</a>) )</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        quirks |= <a class="code" href="OSFinger_8h.html#a063b284cec078748a039a9a3674aa9c4">QUIRK_FLAGS</a>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">if</span> ( ip-&gt;<a class="code" href="classIP__Hdr.html#a564d7f86b1bb3b27e7f432c52d67d6db">TotalLen</a>() - ip-&gt;<a class="code" href="classIP__Hdr.html#a86ccf5d09d6e00dc0229b065ffda3ed6">HdrLen</a>() - tcp_hdr_len &gt; 0 )</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        quirks |= <a class="code" href="OSFinger_8h.html#a2d7ff99c6f15f66b985e10e24b0b403b">QUIRK_DATA</a>;   <span class="comment">// SYN with data</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">if</span> ( tcp-&gt;th_ack )</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        quirks |= <a class="code" href="OSFinger_8h.html#affba9678119b6a996961ff76682314d0">QUIRK_ACK</a>;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">if</span> ( tcp-&gt;th_urp )</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        quirks |= <a class="code" href="OSFinger_8h.html#a49bacf78a2424baa57acffd42c605d39">QUIRK_URG</a>;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">if</span> ( tcp-&gt;th_x2 )</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        quirks |= <a class="code" href="OSFinger_8h.html#ac18fe7b0ab0065363c7da0e203128356">QUIRK_X2</a>;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">// Parse TCP options.</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    u_char* options = (u_char*) tcp + <span class="keyword">sizeof</span>(<span class="keyword">struct</span> tcphdr);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    u_char* opt_end = (u_char*) tcp + tcp_hdr_len;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">while</span> ( options &lt; opt_end )</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> opt = options[0];</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">if</span> ( opt == TCPOPT_EOL )</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            {</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            op[optcount++] = TCPOPT_EOL;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">if</span> ( ++options &lt; opt_end )</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                quirks |= <a class="code" href="OSFinger_8h.html#a0f7176792c744449713ad5cbc4a9777f">QUIRK_PAST</a>;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="comment">// All done - could flag if more junk left over ....</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">if</span> ( opt == TCPOPT_NOP )</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            op[optcount++] = TCPOPT_NOP;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            ++options;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">if</span> ( options + 1 &gt;= opt_end )</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="comment">// We&#39;ve run off the end, no room for the length.</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            quirks |= <a class="code" href="OSFinger_8h.html#a8dbc3bff1c5646e7abbbb6f71e846a77">QUIRK_BROKEN</a>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> opt_len = options[1];</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">if</span> ( options + opt_len &gt; opt_end )</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="comment">// No room for rest of the options.</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            quirks |= <a class="code" href="OSFinger_8h.html#a8dbc3bff1c5646e7abbbb6f71e846a77">QUIRK_BROKEN</a>;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordflow">if</span> ( opt_len == 0 )</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="comment">// Trashed length field.</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordflow">switch</span> ( opt ) {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">case</span> TCPOPT_SACK_PERMITTED:</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <span class="comment">// SACKOK LEN</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            op[optcount] = TCPOPT_SACK_PERMITTED;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordflow">case</span> TCPOPT_MAXSEG:</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <span class="comment">// MSS LEN D0 D1</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="keywordflow">if</span> ( opt_len &lt; 4 )</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                <span class="keywordflow">break</span>;  <span class="comment">// bad length</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            op[optcount] = TCPOPT_MAXSEG;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            MSS = (options[2] &lt;&lt; 8) | options[3];</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">case</span> TCPOPT_WINDOW:</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="comment">// WSCALE LEN D0</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="keywordflow">if</span> ( opt_len &lt; 3 )</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                <span class="keywordflow">break</span>;  <span class="comment">// bad length</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            op[optcount] = TCPOPT_WINDOW;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            winscale = options[2];</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keywordflow">case</span> TCPOPT_TIMESTAMP:</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="comment">// TSTAMP LEN T0 T1 T2 T3 A0 A1 A2 A3</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="keywordflow">if</span> ( opt_len &lt; 10 )</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                <span class="keywordflow">break</span>;  <span class="comment">// bad length</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            op[optcount] = TCPOPT_TIMESTAMP;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            tstamp = ntohl(<a class="code" href="net__util_8cc.html#a7b6cc45fea24717707d09c4dfc939efc">extract_uint32</a>(options + 2));</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="net__util_8cc.html#a7b6cc45fea24717707d09c4dfc939efc">extract_uint32</a>(options + 6) )</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                quirks |= <a class="code" href="OSFinger_8h.html#a91a5b17dab627cf53867e38b3c71f1e6">QUIRK_T2</a>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">default</span>:    <span class="comment">// just skip over</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            op[optcount]=opt;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">if</span> ( optcount &lt; <a class="code" href="OSFinger_8h.html#aecb43ca9e05881053b36a9f8e6f39350">MAXOPT</a> - 1 )</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            ++optcount;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            quirks |= <a class="code" href="OSFinger_8h.html#a8dbc3bff1c5646e7abbbb6f71e846a77">QUIRK_BROKEN</a>;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        options += opt_len;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keyword">struct </span><a class="code" href="structos__type.html">os_type</a> os_from_print;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code" href="Sessions_8cc.html#a122fc34dddb8900b5416f73094dafade">sessions</a>-&gt;<a class="code" href="classNetSessions.html#adbc01be5dd34c7627b0c907be2f007e8">Get_OS_From_SYN</a>(&amp;os_from_print,</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <a class="code" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a>(ip-&gt;<a class="code" href="classIP__Hdr.html#a564d7f86b1bb3b27e7f432c52d67d6db">TotalLen</a>()),</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <a class="code" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a>(ip-&gt;<a class="code" href="classIP__Hdr.html#ad6414f085f7f1d3f703a75acfd9a546b">DF</a>()), <a class="code" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a>(ip-&gt;<a class="code" href="classIP__Hdr.html#a387fd92f715e230e9db5553ebc3f6374">TTL</a>()),</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <a class="code" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a>(ntohs(tcp-&gt;th_win)),</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <a class="code" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a>(optcount), op,</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <a class="code" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a>(MSS), <a class="code" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a>(winscale),</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            tstamp, quirks,</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <a class="code" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a>(tcp-&gt;th_flags &amp; (<a class="code" href="TCP_8cc.html#acb3203940d8aab3eef7dd8ec1e0112db">TH_ECE</a>|<a class="code" href="TCP_8cc.html#a427da5535811ecaae82a11869ea9e1d9">TH_CWR</a>)));</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="Sessions_8cc.html#a122fc34dddb8900b5416f73094dafade">sessions</a>-&gt;<a class="code" href="classNetSessions.html#a9fb012b26d018200b1c81b197a528a1b">CompareWithPreviousOSMatch</a>(ip-&gt;<a class="code" href="classIP__Hdr.html#a8256bb033063a8e8034beb36bc3bff5c">SrcAddr</a>(), id) )</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        {</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <a class="code" href="classRecordVal.html">RecordVal</a>* <a class="code" href="structos__type.html#a6b18916c23f7f7735fd00095403c09ce">os</a> = <span class="keyword">new</span> <a class="code" href="classRecordVal.html">RecordVal</a>(<a class="code" href="NetVar_8cc.html#a9f21136cb76239516189a072d02788b4">OS_version</a>);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        os-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(0, <span class="keyword">new</span> <a class="code" href="classStringVal.html">StringVal</a>(os_from_print.os));</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">if</span> ( os_from_print.desc )</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            os-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(1, <span class="keyword">new</span> <a class="code" href="classStringVal.html">StringVal</a>(os_from_print.desc));</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            os-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(1, <span class="keyword">new</span> <a class="code" href="classStringVal.html">StringVal</a>(<span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        os-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(2, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(os_from_print.dist, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        os-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(3, <span class="keyword">new</span> <a class="code" href="classEnumVal.html">EnumVal</a>(os_from_print.match, <a class="code" href="NetVar_8cc.html#aad882af2774e8d3b5d2735f0092e22ad">OS_version_inference</a>));</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structos__type.html#a6b18916c23f7f7735fd00095403c09ce">os</a>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    }</div><div class="ttc" id="classIP__Hdr_html_a8256bb033063a8e8034beb36bc3bff5c"><div class="ttname"><a href="classIP__Hdr.html#a8256bb033063a8e8034beb36bc3bff5c">IP_Hdr::SrcAddr</a></div><div class="ttdeci">IPAddr SrcAddr() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00418">IP.h:418</a></div></div>
<div class="ttc" id="OSFinger_8h_html_a91a5b17dab627cf53867e38b3c71f1e6"><div class="ttname"><a href="OSFinger_8h.html#a91a5b17dab627cf53867e38b3c71f1e6">QUIRK_T2</a></div><div class="ttdeci">#define QUIRK_T2</div><div class="ttdef"><b>Definition:</b> <a href="OSFinger_8h_source.html#l00144">OSFinger.h:144</a></div></div>
<div class="ttc" id="classVal_html"><div class="ttname"><a href="classVal.html">Val</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00078">Val.h:78</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a564d7f86b1bb3b27e7f432c52d67d6db"><div class="ttname"><a href="classIP__Hdr.html#a564d7f86b1bb3b27e7f432c52d67d6db">IP_Hdr::TotalLen</a></div><div class="ttdeci">uint32 TotalLen() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00473">IP.h:473</a></div></div>
<div class="ttc" id="classStringVal_html"><div class="ttname"><a href="classStringVal.html">StringVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00623">Val.h:623</a></div></div>
<div class="ttc" id="OSFinger_8h_html_a9ae08c0a82e3abf0185cfc3d33f60bbb"><div class="ttname"><a href="OSFinger_8h.html#a9ae08c0a82e3abf0185cfc3d33f60bbb">QUIRK_SEQEQ</a></div><div class="ttdeci">#define QUIRK_SEQEQ</div><div class="ttdef"><b>Definition:</b> <a href="OSFinger_8h_source.html#l00149">OSFinger.h:149</a></div></div>
<div class="ttc" id="structos__type_html"><div class="ttname"><a href="structos__type.html">os_type</a></div><div class="ttdef"><b>Definition:</b> <a href="OSFinger_8h_source.html#l00041">OSFinger.h:41</a></div></div>
<div class="ttc" id="Sessions_8cc_html_a122fc34dddb8900b5416f73094dafade"><div class="ttname"><a href="Sessions_8cc.html#a122fc34dddb8900b5416f73094dafade">sessions</a></div><div class="ttdeci">NetSessions * sessions</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l00045">Sessions.cc:45</a></div></div>
<div class="ttc" id="OSFinger_8h_html_a0f7176792c744449713ad5cbc4a9777f"><div class="ttname"><a href="OSFinger_8h.html#a0f7176792c744449713ad5cbc4a9777f">QUIRK_PAST</a></div><div class="ttdeci">#define QUIRK_PAST</div><div class="ttdef"><b>Definition:</b> <a href="OSFinger_8h_source.html#l00138">OSFinger.h:138</a></div></div>
<div class="ttc" id="OSFinger_8h_html_a6a0006ba80263c4b31876032cb137f99"><div class="ttname"><a href="OSFinger_8h.html#a6a0006ba80263c4b31876032cb137f99">QUIRK_SEQ0</a></div><div class="ttdeci">#define QUIRK_SEQ0</div><div class="ttdef"><b>Definition:</b> <a href="OSFinger_8h_source.html#l00150">OSFinger.h:150</a></div></div>
<div class="ttc" id="classNetSessions_html_a9fb012b26d018200b1c81b197a528a1b"><div class="ttname"><a href="classNetSessions.html#a9fb012b26d018200b1c81b197a528a1b">NetSessions::CompareWithPreviousOSMatch</a></div><div class="ttdeci">bool CompareWithPreviousOSMatch(const IPAddr &amp;addr, int id) const </div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l00960">Sessions.cc:960</a></div></div>
<div class="ttc" id="classRecordVal_html"><div class="ttname"><a href="classRecordVal.html">RecordVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00937">Val.h:937</a></div></div>
<div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00022">Type.h:22</a></div></div>
<div class="ttc" id="util_8h_html_ac2a9e79eb120216f855626495b7bd18a"><div class="ttname"><a href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a></div><div class="ttdeci">uint16_t uint16</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00065">util.h:65</a></div></div>
<div class="ttc" id="OSFinger_8h_html_affba9678119b6a996961ff76682314d0"><div class="ttname"><a href="OSFinger_8h.html#affba9678119b6a996961ff76682314d0">QUIRK_ACK</a></div><div class="ttdeci">#define QUIRK_ACK</div><div class="ttdef"><b>Definition:</b> <a href="OSFinger_8h_source.html#l00143">OSFinger.h:143</a></div></div>
<div class="ttc" id="NetVar_8cc_html_a9f21136cb76239516189a072d02788b4"><div class="ttname"><a href="NetVar_8cc.html#a9f21136cb76239516189a072d02788b4">OS_version</a></div><div class="ttdeci">RecordType * OS_version</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00143">NetVar.cc:143</a></div></div>
<div class="ttc" id="OSFinger_8h_html_aecb43ca9e05881053b36a9f8e6f39350"><div class="ttname"><a href="OSFinger_8h.html#aecb43ca9e05881053b36a9f8e6f39350">MAXOPT</a></div><div class="ttdeci">#define MAXOPT</div><div class="ttdef"><b>Definition:</b> <a href="OSFinger_8h_source.html#l00037">OSFinger.h:37</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a9ddce824b8b97f1b4b8fac9c861d5ab1"><div class="ttname"><a href="classIP__Hdr.html#a9ddce824b8b97f1b4b8fac9c861d5ab1">IP_Hdr::ID</a></div><div class="ttdeci">uint32 ID() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00538">IP.h:538</a></div></div>
<div class="ttc" id="classRecordVal_html_a5c6a817fc30e555ddb9708a83ffbdfaf"><div class="ttname"><a href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">RecordVal::Assign</a></div><div class="ttdeci">void Assign(int field, Val *new_val, Opcode op=OP_ASSIGN)</div><div class="ttdef"><b>Definition:</b> <a href="Val_8cc_source.html#l02873">Val.cc:2873</a></div></div>
<div class="ttc" id="net__util_8cc_html_a7b6cc45fea24717707d09c4dfc939efc"><div class="ttname"><a href="net__util_8cc.html#a7b6cc45fea24717707d09c4dfc939efc">extract_uint32</a></div><div class="ttdeci">uint32 extract_uint32(const u_char *data)</div><div class="ttdef"><b>Definition:</b> <a href="net__util_8cc_source.html#l00174">net_util.cc:174</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a387fd92f715e230e9db5553ebc3f6374"><div class="ttname"><a href="classIP__Hdr.html#a387fd92f715e230e9db5553ebc3f6374">IP_Hdr::TTL</a></div><div class="ttdeci">unsigned char TTL() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00517">IP.h:517</a></div></div>
<div class="ttc" id="classNetSessions_html_adbc01be5dd34c7627b0c907be2f007e8"><div class="ttname"><a href="classNetSessions.html#adbc01be5dd34c7627b0c907be2f007e8">NetSessions::Get_OS_From_SYN</a></div><div class="ttdeci">int Get_OS_From_SYN(struct os_type *retval, uint16 tot, uint8 DF_flag, uint8 TTL, uint16 WSS, uint8 ocnt, uint8 *op, uint16 MSS, uint8 win_scale, uint32 tstamp, uint32 quirks, uint8 ECN) const </div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l00948">Sessions.cc:948</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a86ccf5d09d6e00dc0229b065ffda3ed6"><div class="ttname"><a href="classIP__Hdr.html#a86ccf5d09d6e00dc0229b065ffda3ed6">IP_Hdr::HdrLen</a></div><div class="ttdeci">uint16 HdrLen() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00479">IP.h:479</a></div></div>
<div class="ttc" id="classEnumVal_html"><div class="ttname"><a href="classEnumVal.html">EnumVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l01004">Val.h:1004</a></div></div>
<div class="ttc" id="OSFinger_8h_html_a8e5994ed1775c179f662b8940824de84"><div class="ttname"><a href="OSFinger_8h.html#a8e5994ed1775c179f662b8940824de84">QUIRK_ZEROID</a></div><div class="ttdeci">#define QUIRK_ZEROID</div><div class="ttdef"><b>Definition:</b> <a href="OSFinger_8h_source.html#l00139">OSFinger.h:139</a></div></div>
<div class="ttc" id="OSFinger_8h_html_ac18fe7b0ab0065363c7da0e203128356"><div class="ttname"><a href="OSFinger_8h.html#ac18fe7b0ab0065363c7da0e203128356">QUIRK_X2</a></div><div class="ttdeci">#define QUIRK_X2</div><div class="ttdef"><b>Definition:</b> <a href="OSFinger_8h_source.html#l00142">OSFinger.h:142</a></div></div>
<div class="ttc" id="OSFinger_8h_html_a49bacf78a2424baa57acffd42c605d39"><div class="ttname"><a href="OSFinger_8h.html#a49bacf78a2424baa57acffd42c605d39">QUIRK_URG</a></div><div class="ttdeci">#define QUIRK_URG</div><div class="ttdef"><b>Definition:</b> <a href="OSFinger_8h_source.html#l00141">OSFinger.h:141</a></div></div>
<div class="ttc" id="OSFinger_8h_html_a063b284cec078748a039a9a3674aa9c4"><div class="ttname"><a href="OSFinger_8h.html#a063b284cec078748a039a9a3674aa9c4">QUIRK_FLAGS</a></div><div class="ttdeci">#define QUIRK_FLAGS</div><div class="ttdef"><b>Definition:</b> <a href="OSFinger_8h_source.html#l00145">OSFinger.h:145</a></div></div>
<div class="ttc" id="OSFinger_8h_html_ad66e76c4b49da5f0b0909f3154865bf3"><div class="ttname"><a href="OSFinger_8h.html#ad66e76c4b49da5f0b0909f3154865bf3">QUIRK_IPOPT</a></div><div class="ttdeci">#define QUIRK_IPOPT</div><div class="ttdef"><b>Definition:</b> <a href="OSFinger_8h_source.html#l00140">OSFinger.h:140</a></div></div>
<div class="ttc" id="OSFinger_8h_html_a8dbc3bff1c5646e7abbbb6f71e846a77"><div class="ttname"><a href="OSFinger_8h.html#a8dbc3bff1c5646e7abbbb6f71e846a77">QUIRK_BROKEN</a></div><div class="ttdeci">#define QUIRK_BROKEN</div><div class="ttdef"><b>Definition:</b> <a href="OSFinger_8h_source.html#l00147">OSFinger.h:147</a></div></div>
<div class="ttc" id="TCP_8cc_html_acb3203940d8aab3eef7dd8ec1e0112db"><div class="ttname"><a href="TCP_8cc.html#acb3203940d8aab3eef7dd8ec1e0112db">TH_ECE</a></div><div class="ttdeci">#define TH_ECE</div><div class="ttdef"><b>Definition:</b> <a href="TCP_8cc_source.html#l00026">TCP.cc:26</a></div></div>
<div class="ttc" id="util_8h_html_acbd4acd0d29e2d6c43104827f77d9cd2"><div class="ttname"><a href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00064">util.h:64</a></div></div>
<div class="ttc" id="structos__type_html_a6b18916c23f7f7735fd00095403c09ce"><div class="ttname"><a href="structos__type.html#a6b18916c23f7f7735fd00095403c09ce">os_type::os</a></div><div class="ttdeci">const char * os</div><div class="ttdef"><b>Definition:</b> <a href="OSFinger_8h_source.html#l00042">OSFinger.h:42</a></div></div>
<div class="ttc" id="OSFinger_8h_html_a2d7ff99c6f15f66b985e10e24b0b403b"><div class="ttname"><a href="OSFinger_8h.html#a2d7ff99c6f15f66b985e10e24b0b403b">QUIRK_DATA</a></div><div class="ttdeci">#define QUIRK_DATA</div><div class="ttdef"><b>Definition:</b> <a href="OSFinger_8h_source.html#l00146">OSFinger.h:146</a></div></div>
<div class="ttc" id="NetVar_8cc_html_aad882af2774e8d3b5d2735f0092e22ad"><div class="ttname"><a href="NetVar_8cc.html#aad882af2774e8d3b5d2735f0092e22ad">OS_version_inference</a></div><div class="ttdeci">EnumType * OS_version_inference</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00144">NetVar.cc:144</a></div></div>
<div class="ttc" id="TCP_8cc_html_a427da5535811ecaae82a11869ea9e1d9"><div class="ttname"><a href="TCP_8cc.html#a427da5535811ecaae82a11869ea9e1d9">TH_CWR</a></div><div class="ttdeci">#define TH_CWR</div><div class="ttdef"><b>Definition:</b> <a href="TCP_8cc_source.html#l00030">TCP.cc:30</a></div></div>
<div class="ttc" id="classIP__Hdr_html_ad6414f085f7f1d3f703a75acfd9a546b"><div class="ttname"><a href="classIP__Hdr.html#ad6414f085f7f1d3f703a75acfd9a546b">IP_Hdr::DF</a></div><div class="ttdeci">int DF() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00551">IP.h:551</a></div></div>
<div class="ttc" id="util_8h_html_a33a5e996e7a90acefb8b1c0bea47e365"><div class="ttname"><a href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a></div><div class="ttdeci">uint8_t uint8</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00066">util.h:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a94780f7aa08732a0cb9f424723ac52b9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classRecordVal.html">RecordVal</a>* build_syn_packet_val </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_orig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct tcphdr *&#160;</td>
          <td class="paramname"><em>tcp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="TCP_8cc_source.html#l00039">39</a> of file <a class="el" href="TCP_8cc_source.html">TCP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    {</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordtype">int</span> winscale = -1;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordtype">int</span> MSS = 0;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordtype">int</span> SACK = 0;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// Parse TCP options.</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    u_char* options = (u_char*) tcp + <span class="keyword">sizeof</span>(<span class="keyword">struct</span> tcphdr);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    u_char* opt_end = (u_char*) tcp + tcp-&gt;th_off * 4;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    while ( options &lt; opt_end )</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        {</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> opt = options[0];</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">if</span> ( opt == TCPOPT_EOL )</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            <span class="comment">// All done - could flag if more junk left over ....</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordflow">if</span> ( opt == TCPOPT_NOP )</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            ++options;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordflow">if</span> ( options + 1 &gt;= opt_end )</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <span class="comment">// We&#39;ve run off the end, no room for the length.</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> opt_len = options[1];</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">if</span> ( options + opt_len &gt; opt_end )</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="comment">// No room for rest of option.</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">if</span> ( opt_len == 0 )</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <span class="comment">// Trashed length field.</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">switch</span> ( opt ) {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordflow">case</span> TCPOPT_SACK_PERMITTED:</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            SACK = 1;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordflow">case</span> TCPOPT_MAXSEG:</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            <span class="keywordflow">if</span> ( opt_len &lt; 4 )</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                <span class="keywordflow">break</span>;  <span class="comment">// bad length</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            MSS = (options[2] &lt;&lt; 8) | options[3];</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordflow">case</span> 3: <span class="comment">// TCPOPT_WSCALE</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <span class="keywordflow">if</span> ( opt_len &lt; 3 )</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                <span class="keywordflow">break</span>;  <span class="comment">// bad length</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            winscale = options[2];</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">default</span>:    <span class="comment">// just skip over</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        options += opt_len;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="classRecordVal.html">RecordVal</a>* v = <span class="keyword">new</span> <a class="code" href="classRecordVal.html">RecordVal</a>(<a class="code" href="NetVar_8cc.html#a32c17a626c1a702364e3b09d55d1c1da">SYN_packet</a>);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    v-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(0, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(is_orig, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>));</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    v-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(1, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(<span class="keywordtype">int</span>(ip-&gt;<a class="code" href="classIP__Hdr.html#ad6414f085f7f1d3f703a75acfd9a546b">DF</a>()), <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>));</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    v-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(2, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>((ip-&gt;<a class="code" href="classIP__Hdr.html#a387fd92f715e230e9db5553ebc3f6374">TTL</a>()), <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    v-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(3, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>((ip-&gt;<a class="code" href="classIP__Hdr.html#a564d7f86b1bb3b27e7f432c52d67d6db">TotalLen</a>()), <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    v-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(4, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(ntohs(tcp-&gt;th_win), <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    v-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(5, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(winscale, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a4fcd4421533bb21c827865bdbac4fef9">TYPE_INT</a>));</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    v-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(6, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(MSS, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    v-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(7, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(SACK, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>));</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">return</span> v;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div><div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00020">Type.h:20</a></div></div>
<div class="ttc" id="classVal_html"><div class="ttname"><a href="classVal.html">Val</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00078">Val.h:78</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a564d7f86b1bb3b27e7f432c52d67d6db"><div class="ttname"><a href="classIP__Hdr.html#a564d7f86b1bb3b27e7f432c52d67d6db">IP_Hdr::TotalLen</a></div><div class="ttdeci">uint32 TotalLen() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00473">IP.h:473</a></div></div>
<div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76a4fcd4421533bb21c827865bdbac4fef9"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a4fcd4421533bb21c827865bdbac4fef9">TYPE_INT</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00021">Type.h:21</a></div></div>
<div class="ttc" id="classRecordVal_html"><div class="ttname"><a href="classRecordVal.html">RecordVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00937">Val.h:937</a></div></div>
<div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00022">Type.h:22</a></div></div>
<div class="ttc" id="classRecordVal_html_a5c6a817fc30e555ddb9708a83ffbdfaf"><div class="ttname"><a href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">RecordVal::Assign</a></div><div class="ttdeci">void Assign(int field, Val *new_val, Opcode op=OP_ASSIGN)</div><div class="ttdef"><b>Definition:</b> <a href="Val_8cc_source.html#l02873">Val.cc:2873</a></div></div>
<div class="ttc" id="NetVar_8cc_html_a32c17a626c1a702364e3b09d55d1c1da"><div class="ttname"><a href="NetVar_8cc.html#a32c17a626c1a702364e3b09d55d1c1da">SYN_packet</a></div><div class="ttdeci">RecordType * SYN_packet</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00016">NetVar.cc:16</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a387fd92f715e230e9db5553ebc3f6374"><div class="ttname"><a href="classIP__Hdr.html#a387fd92f715e230e9db5553ebc3f6374">IP_Hdr::TTL</a></div><div class="ttdeci">unsigned char TTL() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00517">IP.h:517</a></div></div>
<div class="ttc" id="classIP__Hdr_html_ad6414f085f7f1d3f703a75acfd9a546b"><div class="ttname"><a href="classIP__Hdr.html#ad6414f085f7f1d3f703a75acfd9a546b">IP_Hdr::DF</a></div><div class="ttdeci">int DF() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00551">IP.h:551</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8b7150db31f548075c43bd0f3f0b42a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int endian_flip </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="TCP_8cc_source.html#l02026">2026</a> of file <a class="el" href="TCP_8cc_source.html">TCP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    {</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    <span class="keywordflow">return</span> ((n &amp; 0xff) &lt;&lt; 8) | ((n &amp; 0xff00) &gt;&gt; 8);</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a799e0170d2a82b0ebffd3444c59bd26d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> get_relative_seq </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&#160;</td>
          <td class="paramname"><em>cur_base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&#160;</td>
          <td class="paramname"><em>last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&#160;</td>
          <td class="paramname"><em>wraps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>underflow</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="TCP_8cc_source.html#l01022">1022</a> of file <a class="el" href="TCP_8cc_source.html">TCP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    {</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <a class="code" href="util_8h.html#ab7903878916593daecbeb95b98115ab0">int32</a> delta = <a class="code" href="net__util_8h.html#a8911c5f5081a5f1d8d893950329f9bfb">seq_delta</a>(cur_base, last);</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keywordflow">if</span> ( delta &lt; 0 )</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        {</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="keywordflow">if</span> ( wraps &amp;&amp; cur_base &gt; last )</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            <span class="comment">// Seems to be a part of a previous 32-bit sequence space.</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            --wraps;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        }</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( delta &gt; 0 )</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        {</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        <span class="keywordflow">if</span> ( cur_base &lt; last )</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            <span class="comment">// The sequence space wrapped around.</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;            ++wraps;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        }</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keywordflow">if</span> ( wraps == 0 )</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        {</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        delta = <a class="code" href="net__util_8h.html#a8911c5f5081a5f1d8d893950329f9bfb">seq_delta</a>(cur_base, endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a90b1b435a7d354567a36829afacee337">StartSeq</a>());</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="keywordflow">if</span> ( underflow &amp;&amp; delta &lt; 0 )</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            *underflow = <span class="keyword">true</span>;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <span class="keywordflow">return</span> delta;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        }</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="keywordflow">return</span> endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a1ca173956a6f4212595f0ce834d1b695">ToRelativeSeqSpace</a>(cur_base, wraps);</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a1ca173956a6f4212595f0ce834d1b695"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a1ca173956a6f4212595f0ce834d1b695">analyzer::tcp::TCP_Endpoint::ToRelativeSeqSpace</a></div><div class="ttdeci">uint64 ToRelativeSeqSpace(uint32 tcp_seq_num, uint32 wraparounds) const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00107">TCP_Endpoint.h:107</a></div></div>
<div class="ttc" id="util_8h_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="util_8h.html#ab7903878916593daecbeb95b98115ab0">int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00069">util.h:69</a></div></div>
<div class="ttc" id="net__util_8h_html_a8911c5f5081a5f1d8d893950329f9bfb"><div class="ttname"><a href="net__util_8h.html#a8911c5f5081a5f1d8d893950329f9bfb">seq_delta</a></div><div class="ttdeci">int32 seq_delta(uint32 a, uint32 b)</div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00131">net_util.h:131</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a90b1b435a7d354567a36829afacee337"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a90b1b435a7d354567a36829afacee337">analyzer::tcp::TCP_Endpoint::StartSeq</a></div><div class="ttdeci">uint32 StartSeq() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00051">TCP_Endpoint.h:51</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4242da7c43cc41ccd53b5a5a9e2bd7b8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int get_segment_len </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>payload_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classanalyzer_1_1tcp_1_1TCP__Flags.html">TCP_Flags</a>&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="TCP_8cc_source.html#l01055">1055</a> of file <a class="el" href="TCP_8cc_source.html">TCP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    {</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="keywordtype">int</span> seg_len = payload_len;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="keywordflow">if</span> ( flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#add5426934cf883530fb54d4ecb158b92">SYN</a>() )</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <span class="comment">// SYN consumes a byte of sequence space.</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        ++seg_len;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="keywordflow">if</span> ( flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a61d44dfe8d1f8e18efe5456972bb7087">FIN</a>() )</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        <span class="comment">// FIN consumes a bytes of sequence space.</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        ++seg_len;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keywordflow">if</span> ( flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a069448a9292c9f790067e4988a545e41">RST</a>() )</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <span class="comment">// Don&#39;t include the data in the computation of</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        <span class="comment">// the sequence space for this connection, as</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="comment">// it&#39;s not in fact part of the TCP stream.</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        seg_len -= payload_len;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="keywordflow">return</span> seg_len;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Flags_html_add5426934cf883530fb54d4ecb158b92"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Flags.html#add5426934cf883530fb54d4ecb158b92">analyzer::tcp::TCP_Flags::SYN</a></div><div class="ttdeci">bool SYN() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Flags_8h_source.html#l00011">TCP_Flags.h:11</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Flags_html_a069448a9292c9f790067e4988a545e41"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a069448a9292c9f790067e4988a545e41">analyzer::tcp::TCP_Flags::RST</a></div><div class="ttdeci">bool RST() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Flags_8h_source.html#l00013">TCP_Flags.h:13</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Flags_html_a61d44dfe8d1f8e18efe5456972bb7087"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a61d44dfe8d1f8e18efe5456972bb7087">analyzer::tcp::TCP_Flags::FIN</a></div><div class="ttdeci">bool FIN() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Flags_8h_source.html#l00012">TCP_Flags.h:12</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abebe4e4649deb2ec2786baded575df38"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void init_endpoint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classanalyzer_1_1tcp_1_1TCP__Flags.html">TCP_Flags</a>&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&#160;</td>
          <td class="paramname"><em>first_seg_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&#160;</td>
          <td class="paramname"><em>last_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="TCP_8cc_source.html#l01076">1076</a> of file <a class="el" href="TCP_8cc_source.html">TCP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    {</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordflow">switch</span> ( endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#ae0ecc95ab857e4af3fe472f63a8e3337">state</a> ) {</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8a868c0f2d2db041d3d9c49f8c2fa4e59d">TCP_ENDPOINT_INACTIVE</a>:</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <span class="keywordflow">if</span> ( flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#add5426934cf883530fb54d4ecb158b92">SYN</a>() )</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            {</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#adf48d90e195fe487f4692e13a01dd9c9">InitAckSeq</a>(first_seg_seq);</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a1270a221933a1349d07ccc58bd53c90d">InitStartSeq</a>(first_seg_seq);</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            }</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            {</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;            <span class="comment">// This is a partial connection - set up the initial sequence</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            <span class="comment">// numbers as though we saw a SYN, to keep the relative byte</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;            <span class="comment">// numbering consistent.</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#adf48d90e195fe487f4692e13a01dd9c9">InitAckSeq</a>(first_seg_seq - 1);</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a1270a221933a1349d07ccc58bd53c90d">InitStartSeq</a>(first_seg_seq - 1);</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;            }</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a8cdcd099d1925fa918a5b84acef3a796">InitLastSeq</a>(last_seq);</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#acd915e42c982a4344251bc3e249cfaf3">start_time</a> = t;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8a1f83aa699d7bcc89a09bd473288bf241">TCP_ENDPOINT_SYN_SENT</a>:</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8ab4930b3df03c5eee9d919cd88fb0cb3a">TCP_ENDPOINT_SYN_ACK_SENT</a>:</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        <span class="keywordflow">if</span> ( flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#add5426934cf883530fb54d4ecb158b92">SYN</a>() &amp;&amp; first_seg_seq != endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a90b1b435a7d354567a36829afacee337">StartSeq</a>() )</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            {</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6ad5d71529533cbf88c2d241e56956f1">Conn</a>()-&gt;<a class="code" href="classConnection.html#ab32090383d2647bbfb14ffad1b3755a2">Weird</a>(<span class="stringliteral">&quot;SYN_seq_jump&quot;</span>);</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a1270a221933a1349d07ccc58bd53c90d">InitStartSeq</a>(first_seg_seq);</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#adf48d90e195fe487f4692e13a01dd9c9">InitAckSeq</a>(first_seg_seq);</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a8cdcd099d1925fa918a5b84acef3a796">InitLastSeq</a>(last_seq);</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            }</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8a1ffeb387e5cdca0b0909d070060e83f2">TCP_ENDPOINT_ESTABLISHED</a>:</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8ae1e548fd5170e52d14a6bf37bafe367e">TCP_ENDPOINT_PARTIAL</a>:</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        <span class="keywordflow">if</span> ( flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#add5426934cf883530fb54d4ecb158b92">SYN</a>() )</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            {</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;            <span class="keywordflow">if</span> ( endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a740bf83d2d8dad25ffbf4ba7d38e1af2">Size</a>() &gt; 0 )</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6ad5d71529533cbf88c2d241e56956f1">Conn</a>()-&gt;<a class="code" href="classConnection.html#ab32090383d2647bbfb14ffad1b3755a2">Weird</a>(<span class="stringliteral">&quot;SYN_inside_connection&quot;</span>);</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            <span class="keywordflow">if</span> ( first_seg_seq != endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a90b1b435a7d354567a36829afacee337">StartSeq</a>() )</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6ad5d71529533cbf88c2d241e56956f1">Conn</a>()-&gt;<a class="code" href="classConnection.html#ab32090383d2647bbfb14ffad1b3755a2">Weird</a>(<span class="stringliteral">&quot;SYN_seq_jump&quot;</span>);</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            <span class="comment">// Make a guess that somehow the connection didn&#39;t get established,</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            <span class="comment">// and this SYN will be the one that actually sets it up.</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a1270a221933a1349d07ccc58bd53c90d">InitStartSeq</a>(first_seg_seq);</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#adf48d90e195fe487f4692e13a01dd9c9">InitAckSeq</a>(first_seg_seq);</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a8cdcd099d1925fa918a5b84acef3a796">InitLastSeq</a>(last_seq);</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            }</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8a979e64e901631e3419683627aa0e136b">TCP_ENDPOINT_RESET</a>:</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <span class="keywordflow">if</span> ( flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#add5426934cf883530fb54d4ecb158b92">SYN</a>() )</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            {</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            <span class="keywordflow">if</span> ( endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a9bede8d1bd82e75ec68e8718b229131e">prev_state</a> == <a class="code" href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8a868c0f2d2db041d3d9c49f8c2fa4e59d">TCP_ENDPOINT_INACTIVE</a> )</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                {</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                <span class="comment">// Seq. numbers were initialized by a RST packet from this</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                <span class="comment">// endpoint, but now that a SYN is seen from it, that could mean</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                <span class="comment">// the earlier RST was spoofed/injected, so re-initialize.  This</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                <span class="comment">// mostly just helps prevent misrepresentations of payload sizes</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                <span class="comment">// that are based on bad initial sequence values.</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a1270a221933a1349d07ccc58bd53c90d">InitStartSeq</a>(first_seg_seq);</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#adf48d90e195fe487f4692e13a01dd9c9">InitAckSeq</a>(first_seg_seq);</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a8cdcd099d1925fa918a5b84acef3a796">InitLastSeq</a>(last_seq);</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                }</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            }</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    }</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a1270a221933a1349d07ccc58bd53c90d"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a1270a221933a1349d07ccc58bd53c90d">analyzer::tcp::TCP_Endpoint::InitStartSeq</a></div><div class="ttdeci">void InitStartSeq(int64 seq)</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00112">TCP_Endpoint.h:112</a></div></div>
<div class="ttc" id="namespaceanalyzer_1_1tcp_html_a8cfae039001606e60b0b9beb5c451ef8a979e64e901631e3419683627aa0e136b"><div class="ttname"><a href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8a979e64e901631e3419683627aa0e136b">analyzer::tcp::TCP_ENDPOINT_RESET</a></div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00024">TCP_Endpoint.h:24</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Flags_html_add5426934cf883530fb54d4ecb158b92"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Flags.html#add5426934cf883530fb54d4ecb158b92">analyzer::tcp::TCP_Flags::SYN</a></div><div class="ttdeci">bool SYN() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Flags_8h_source.html#l00011">TCP_Flags.h:11</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_adf48d90e195fe487f4692e13a01dd9c9"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#adf48d90e195fe487f4692e13a01dd9c9">analyzer::tcp::TCP_Endpoint::InitAckSeq</a></div><div class="ttdeci">void InitAckSeq(uint32 seq)</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00114">TCP_Endpoint.h:114</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a6ad5d71529533cbf88c2d241e56956f1"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6ad5d71529533cbf88c2d241e56956f1">analyzer::tcp::TCP_Endpoint::Conn</a></div><div class="ttdeci">Connection * Conn() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8cc_source.html#l00058">TCP_Endpoint.cc:58</a></div></div>
<div class="ttc" id="namespaceanalyzer_1_1tcp_html_a8cfae039001606e60b0b9beb5c451ef8a868c0f2d2db041d3d9c49f8c2fa4e59d"><div class="ttname"><a href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8a868c0f2d2db041d3d9c49f8c2fa4e59d">analyzer::tcp::TCP_ENDPOINT_INACTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00017">TCP_Endpoint.h:17</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a740bf83d2d8dad25ffbf4ba7d38e1af2"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a740bf83d2d8dad25ffbf4ba7d38e1af2">analyzer::tcp::TCP_Endpoint::Size</a></div><div class="ttdeci">uint64 Size() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8cc_source.html#l00166">TCP_Endpoint.cc:166</a></div></div>
<div class="ttc" id="namespaceanalyzer_1_1tcp_html_a8cfae039001606e60b0b9beb5c451ef8a1ffeb387e5cdca0b0909d070060e83f2"><div class="ttname"><a href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8a1ffeb387e5cdca0b0909d070060e83f2">analyzer::tcp::TCP_ENDPOINT_ESTABLISHED</a></div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00021">TCP_Endpoint.h:21</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a8cdcd099d1925fa918a5b84acef3a796"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a8cdcd099d1925fa918a5b84acef3a796">analyzer::tcp::TCP_Endpoint::InitLastSeq</a></div><div class="ttdeci">void InitLastSeq(uint32 seq)</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00113">TCP_Endpoint.h:113</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a9bede8d1bd82e75ec68e8718b229131e"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a9bede8d1bd82e75ec68e8718b229131e">analyzer::tcp::TCP_Endpoint::prev_state</a></div><div class="ttdeci">EndpointState prev_state</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00205">TCP_Endpoint.h:205</a></div></div>
<div class="ttc" id="namespaceanalyzer_1_1tcp_html_a8cfae039001606e60b0b9beb5c451ef8ab4930b3df03c5eee9d919cd88fb0cb3a"><div class="ttname"><a href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8ab4930b3df03c5eee9d919cd88fb0cb3a">analyzer::tcp::TCP_ENDPOINT_SYN_ACK_SENT</a></div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00019">TCP_Endpoint.h:19</a></div></div>
<div class="ttc" id="namespaceanalyzer_1_1tcp_html_a8cfae039001606e60b0b9beb5c451ef8ae1e548fd5170e52d14a6bf37bafe367e"><div class="ttname"><a href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8ae1e548fd5170e52d14a6bf37bafe367e">analyzer::tcp::TCP_ENDPOINT_PARTIAL</a></div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00020">TCP_Endpoint.h:20</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_acd915e42c982a4344251bc3e249cfaf3"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#acd915e42c982a4344251bc3e249cfaf3">analyzer::tcp::TCP_Endpoint::start_time</a></div><div class="ttdeci">double start_time</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00212">TCP_Endpoint.h:212</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a90b1b435a7d354567a36829afacee337"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a90b1b435a7d354567a36829afacee337">analyzer::tcp::TCP_Endpoint::StartSeq</a></div><div class="ttdeci">uint32 StartSeq() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00051">TCP_Endpoint.h:51</a></div></div>
<div class="ttc" id="namespaceanalyzer_1_1tcp_html_a8cfae039001606e60b0b9beb5c451ef8a1f83aa699d7bcc89a09bd473288bf241"><div class="ttname"><a href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8a1f83aa699d7bcc89a09bd473288bf241">analyzer::tcp::TCP_ENDPOINT_SYN_SENT</a></div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00018">TCP_Endpoint.h:18</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_ae0ecc95ab857e4af3fe472f63a8e3337"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#ae0ecc95ab857e4af3fe472f63a8e3337">analyzer::tcp::TCP_Endpoint::state</a></div><div class="ttdeci">EndpointState state</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00205">TCP_Endpoint.h:205</a></div></div>
<div class="ttc" id="classConnection_html_ab32090383d2647bbfb14ffad1b3755a2"><div class="ttname"><a href="classConnection.html#ab32090383d2647bbfb14ffad1b3755a2">Connection::Weird</a></div><div class="ttdeci">void Weird(const char *name, const char *addl=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00731">Conn.cc:731</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2f8d0b6ab9f353a5448eb6adda3b29d1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void init_peer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *&#160;</td>
          <td class="paramname"><em>peer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classanalyzer_1_1tcp_1_1TCP__Flags.html">TCP_Flags</a>&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&#160;</td>
          <td class="paramname"><em>ack_seq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="TCP_8cc_source.html#l01150">1150</a> of file <a class="el" href="TCP_8cc_source.html">TCP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    {</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="keywordflow">if</span> ( ! flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#add5426934cf883530fb54d4ecb158b92">SYN</a>() &amp;&amp; ! flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a61d44dfe8d1f8e18efe5456972bb7087">FIN</a>() &amp;&amp; ! flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a069448a9292c9f790067e4988a545e41">RST</a>() )</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        {</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        <span class="keywordflow">if</span> ( endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#ae0ecc95ab857e4af3fe472f63a8e3337">state</a> == <a class="code" href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8a1f83aa699d7bcc89a09bd473288bf241">TCP_ENDPOINT_SYN_SENT</a> ||</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;             endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#ae0ecc95ab857e4af3fe472f63a8e3337">state</a> == <a class="code" href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8ab4930b3df03c5eee9d919cd88fb0cb3a">TCP_ENDPOINT_SYN_ACK_SENT</a> ||</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;             endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#ae0ecc95ab857e4af3fe472f63a8e3337">state</a> == <a class="code" href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8a1ffeb387e5cdca0b0909d070060e83f2">TCP_ENDPOINT_ESTABLISHED</a> )</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            {</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            <span class="comment">// We&#39;ve already sent a SYN, but that</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            <span class="comment">// hasn&#39;t roused the other end, yet we&#39;re</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            <span class="comment">// ack&#39;ing their data.</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            <span class="keywordflow">if</span> ( ! endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6ad5d71529533cbf88c2d241e56956f1">Conn</a>()-&gt;<a class="code" href="classConnection.html#a28f61fd8e0e956aa94df456e5c3e61b0">DidWeird</a>() )</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6ad5d71529533cbf88c2d241e56956f1">Conn</a>()-&gt;<a class="code" href="classConnection.html#ab32090383d2647bbfb14ffad1b3755a2">Weird</a>(<span class="stringliteral">&quot;possible_split_routing&quot;</span>);</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            }</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        }</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="comment">// Start the sequence numbering as if there was an initial</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="comment">// SYN, so the relative numbering of subsequent data packets</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="comment">// stays consistent.</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    peer-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a1270a221933a1349d07ccc58bd53c90d">InitStartSeq</a>(ack_seq - 1);</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    peer-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#adf48d90e195fe487f4692e13a01dd9c9">InitAckSeq</a>(ack_seq - 1);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    peer-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a8cdcd099d1925fa918a5b84acef3a796">InitLastSeq</a>(ack_seq - 1);</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a1270a221933a1349d07ccc58bd53c90d"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a1270a221933a1349d07ccc58bd53c90d">analyzer::tcp::TCP_Endpoint::InitStartSeq</a></div><div class="ttdeci">void InitStartSeq(int64 seq)</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00112">TCP_Endpoint.h:112</a></div></div>
<div class="ttc" id="classConnection_html_a28f61fd8e0e956aa94df456e5c3e61b0"><div class="ttname"><a href="classConnection.html#a28f61fd8e0e956aa94df456e5c3e61b0">Connection::DidWeird</a></div><div class="ttdeci">bool DidWeird() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00182">Conn.h:182</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Flags_html_add5426934cf883530fb54d4ecb158b92"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Flags.html#add5426934cf883530fb54d4ecb158b92">analyzer::tcp::TCP_Flags::SYN</a></div><div class="ttdeci">bool SYN() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Flags_8h_source.html#l00011">TCP_Flags.h:11</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_adf48d90e195fe487f4692e13a01dd9c9"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#adf48d90e195fe487f4692e13a01dd9c9">analyzer::tcp::TCP_Endpoint::InitAckSeq</a></div><div class="ttdeci">void InitAckSeq(uint32 seq)</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00114">TCP_Endpoint.h:114</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a6ad5d71529533cbf88c2d241e56956f1"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6ad5d71529533cbf88c2d241e56956f1">analyzer::tcp::TCP_Endpoint::Conn</a></div><div class="ttdeci">Connection * Conn() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8cc_source.html#l00058">TCP_Endpoint.cc:58</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Flags_html_a069448a9292c9f790067e4988a545e41"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a069448a9292c9f790067e4988a545e41">analyzer::tcp::TCP_Flags::RST</a></div><div class="ttdeci">bool RST() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Flags_8h_source.html#l00013">TCP_Flags.h:13</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Flags_html_a61d44dfe8d1f8e18efe5456972bb7087"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a61d44dfe8d1f8e18efe5456972bb7087">analyzer::tcp::TCP_Flags::FIN</a></div><div class="ttdeci">bool FIN() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Flags_8h_source.html#l00012">TCP_Flags.h:12</a></div></div>
<div class="ttc" id="namespaceanalyzer_1_1tcp_html_a8cfae039001606e60b0b9beb5c451ef8a1ffeb387e5cdca0b0909d070060e83f2"><div class="ttname"><a href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8a1ffeb387e5cdca0b0909d070060e83f2">analyzer::tcp::TCP_ENDPOINT_ESTABLISHED</a></div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00021">TCP_Endpoint.h:21</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a8cdcd099d1925fa918a5b84acef3a796"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a8cdcd099d1925fa918a5b84acef3a796">analyzer::tcp::TCP_Endpoint::InitLastSeq</a></div><div class="ttdeci">void InitLastSeq(uint32 seq)</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00113">TCP_Endpoint.h:113</a></div></div>
<div class="ttc" id="namespaceanalyzer_1_1tcp_html_a8cfae039001606e60b0b9beb5c451ef8ab4930b3df03c5eee9d919cd88fb0cb3a"><div class="ttname"><a href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8ab4930b3df03c5eee9d919cd88fb0cb3a">analyzer::tcp::TCP_ENDPOINT_SYN_ACK_SENT</a></div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00019">TCP_Endpoint.h:19</a></div></div>
<div class="ttc" id="namespaceanalyzer_1_1tcp_html_a8cfae039001606e60b0b9beb5c451ef8a1f83aa699d7bcc89a09bd473288bf241"><div class="ttname"><a href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8a1f83aa699d7bcc89a09bd473288bf241">analyzer::tcp::TCP_ENDPOINT_SYN_SENT</a></div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00018">TCP_Endpoint.h:18</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_ae0ecc95ab857e4af3fe472f63a8e3337"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#ae0ecc95ab857e4af3fe472f63a8e3337">analyzer::tcp::TCP_Endpoint::state</a></div><div class="ttdeci">EndpointState state</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00205">TCP_Endpoint.h:205</a></div></div>
<div class="ttc" id="classConnection_html_ab32090383d2647bbfb14ffad1b3755a2"><div class="ttname"><a href="classConnection.html#ab32090383d2647bbfb14ffad1b3755a2">Connection::Weird</a></div><div class="ttdeci">void Weird(const char *name, const char *addl=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00731">Conn.cc:731</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa134f71de6d0c1398ccc141d3bb39f74"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void init_window </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *&#160;</td>
          <td class="paramname"><em>peer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classanalyzer_1_1tcp_1_1TCP__Flags.html">TCP_Flags</a>&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#a24311c511e9860ae0891def00cc0592d">bro_int_t</a>&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&#160;</td>
          <td class="paramname"><em>base_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&#160;</td>
          <td class="paramname"><em>ack_seq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="TCP_8cc_source.html#l00541">541</a> of file <a class="el" href="TCP_8cc_source.html">TCP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">// ### In the following, we could be fooled by an</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">// inconsistent SYN retransmission.  Where&#39;s a normalizer</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">// when you need one?</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordflow">if</span> ( scale &lt; 0 )</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        { <span class="comment">// no window scaling option</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="keywordflow">if</span> ( flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a989fdbffe41191f21a822ea46a14c045">ACK</a>() )</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            { <span class="comment">// window scaling not negotiated</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a425d390e39f4f2e2c704f18c1831b641">window_scale</a> = 0;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            peer-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a425d390e39f4f2e2c704f18c1831b641">window_scale</a> = 0;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            }</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            <span class="comment">// We&#39;re not offering window scaling.</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            <span class="comment">// Ideally, we&#39;d remember this fact so that</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            <span class="comment">// if the SYN/ACK *does* include window</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            <span class="comment">// scaling, we know it won&#39;t be negotiated.</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            <span class="comment">// But it&#39;s a pain to track that, and hard</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            <span class="comment">// to see how an adversarial responder could</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            <span class="comment">// use it to evade.  Also, if we *do* want</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            <span class="comment">// to track it, we could do so using</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            <span class="comment">// connection_SYN_packet.</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a425d390e39f4f2e2c704f18c1831b641">window_scale</a> = 0;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        }</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        {</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a425d390e39f4f2e2c704f18c1831b641">window_scale</a> = scale;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a128587f67e0939e552f3d3aa2b838ee7">window_seq</a> = base_seq;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6f7758c5cfe9c4d60483649d281ad0ad">window_ack_seq</a> = ack_seq;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        peer-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a128587f67e0939e552f3d3aa2b838ee7">window_seq</a> = ack_seq;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        peer-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6f7758c5cfe9c4d60483649d281ad0ad">window_ack_seq</a> = base_seq;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        }</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a128587f67e0939e552f3d3aa2b838ee7"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a128587f67e0939e552f3d3aa2b838ee7">analyzer::tcp::TCP_Endpoint::window_seq</a></div><div class="ttdeci">uint32 window_seq</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00218">TCP_Endpoint.h:218</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a6f7758c5cfe9c4d60483649d281ad0ad"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6f7758c5cfe9c4d60483649d281ad0ad">analyzer::tcp::TCP_Endpoint::window_ack_seq</a></div><div class="ttdeci">uint32 window_ack_seq</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00217">TCP_Endpoint.h:217</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a425d390e39f4f2e2c704f18c1831b641"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a425d390e39f4f2e2c704f18c1831b641">analyzer::tcp::TCP_Endpoint::window_scale</a></div><div class="ttdeci">int window_scale</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00216">TCP_Endpoint.h:216</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Flags_html_a989fdbffe41191f21a822ea46a14c045"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a989fdbffe41191f21a822ea46a14c045">analyzer::tcp::TCP_Flags::ACK</a></div><div class="ttdeci">bool ACK() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Flags_8h_source.html#l00014">TCP_Flags.h:14</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a430bc1e427ce2a7f556c498743ac4cec"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void passive_fingerprint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classanalyzer_1_1tcp_1_1TCP__Analyzer.html">TCP_Analyzer</a> *&#160;</td>
          <td class="paramname"><em>tcp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>is_orig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct tcphdr *&#160;</td>
          <td class="paramname"><em>tp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&#160;</td>
          <td class="paramname"><em>tcp_hdr_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="TCP_8cc_source.html#l00285">285</a> of file <a class="el" href="TCP_8cc_source.html">TCP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// is_orig will be removed once we can do SYN-ACK fingerprinting</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">if</span> ( OS_version_found &amp;&amp; is_orig )</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keyword">const</span> <a class="code" href="classIPAddr.html">IPAddr</a>&amp; orig_addr = tcp-&gt;<a class="code" href="classanalyzer_1_1Analyzer.html#a5aee2807c8bbdc99f863e27523cf785f">Conn</a>()-&gt;<a class="code" href="classConnection.html#a2807492e6d4a7e525082873aa3a06ba1">OrigAddr</a>();</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <a class="code" href="classAddrVal.html">AddrVal</a>* src_addr_val = <span class="keyword">new</span> <a class="code" href="classAddrVal.html">AddrVal</a>(orig_addr);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="NetVar_8cc.html#ac2737fd5702ef0096ee8196ab0546578">generate_OS_version_event</a>-&gt;<a class="code" href="classTableVal.html#a72f36aaccf3c79a8a41c910c6fad5321">Size</a>() == 0 ||</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;             <a class="code" href="NetVar_8cc.html#ac2737fd5702ef0096ee8196ab0546578">generate_OS_version_event</a>-&gt;<a class="code" href="classTableVal.html#a6f1d3203902271c07016a80c9f545ec6">Lookup</a>(src_addr_val) )</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <a class="code" href="classRecordVal.html">RecordVal</a>* OS_val = <a class="code" href="TCP_8cc.html#a3029ea1fb2cc0043d0800c5b866a675a">build_os_val</a>(is_orig, ip, tp, tcp_hdr_len);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="keywordflow">if</span> ( OS_val )</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                { <span class="comment">// found new OS version</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                val_list* vl = <span class="keyword">new</span> val_list;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                vl-&gt;append(tcp-&gt;<a class="code" href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">BuildConnVal</a>());</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                vl-&gt;append(src_addr_val-&gt;<a class="code" href="classVal.html#a20bda9245d8259a400c7b7cba4168a50">Ref</a>());</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                vl-&gt;append(OS_val);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                tcp-&gt;<a class="code" href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">ConnectionEvent</a>(OS_version_found, vl);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                }</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <a class="code" href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a>(src_addr_val);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1Analyzer_html_a33fbd3099c09106bff5e5900091ec69e"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">analyzer::Analyzer::ConnectionEvent</a></div><div class="ttdeci">void ConnectionEvent(EventHandlerPtr f, val_list *vl)</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00780">Analyzer.cc:780</a></div></div>
<div class="ttc" id="classVal_html_a20bda9245d8259a400c7b7cba4168a50"><div class="ttname"><a href="classVal.html#a20bda9245d8259a400c7b7cba4168a50">Val::Ref</a></div><div class="ttdeci">Val * Ref()</div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00159">Val.h:159</a></div></div>
<div class="ttc" id="TCP_8cc_html_a3029ea1fb2cc0043d0800c5b866a675a"><div class="ttname"><a href="TCP_8cc.html#a3029ea1fb2cc0043d0800c5b866a675a">build_os_val</a></div><div class="ttdeci">static RecordVal * build_os_val(int is_orig, const IP_Hdr *ip, const struct tcphdr *tcp, uint32 tcp_hdr_len)</div><div class="ttdef"><b>Definition:</b> <a href="TCP_8cc_source.html#l00118">TCP.cc:118</a></div></div>
<div class="ttc" id="classTableVal_html_a6f1d3203902271c07016a80c9f545ec6"><div class="ttname"><a href="classTableVal.html#a6f1d3203902271c07016a80c9f545ec6">TableVal::Lookup</a></div><div class="ttdeci">Val * Lookup(Val *index, bool use_default_val=true)</div><div class="ttdef"><b>Definition:</b> <a href="Val_8cc_source.html#l01931">Val.cc:1931</a></div></div>
<div class="ttc" id="classIPAddr_html"><div class="ttname"><a href="classIPAddr.html">IPAddr</a></div><div class="ttdef"><b>Definition:</b> <a href="IPAddr_8h_source.html#l00024">IPAddr.h:24</a></div></div>
<div class="ttc" id="NetVar_8cc_html_ac2737fd5702ef0096ee8196ab0546578"><div class="ttname"><a href="NetVar_8cc.html#ac2737fd5702ef0096ee8196ab0546578">generate_OS_version_event</a></div><div class="ttdeci">TableVal * generate_OS_version_event</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00145">NetVar.cc:145</a></div></div>
<div class="ttc" id="classConnection_html_a2807492e6d4a7e525082873aa3a06ba1"><div class="ttname"><a href="classConnection.html#a2807492e6d4a7e525082873aa3a06ba1">Connection::OrigAddr</a></div><div class="ttdeci">const IPAddr &amp; OrigAddr() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00102">Conn.h:102</a></div></div>
<div class="ttc" id="classRecordVal_html"><div class="ttname"><a href="classRecordVal.html">RecordVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00937">Val.h:937</a></div></div>
<div class="ttc" id="classTableVal_html_a72f36aaccf3c79a8a41c910c6fad5321"><div class="ttname"><a href="classTableVal.html#a72f36aaccf3c79a8a41c910c6fad5321">TableVal::Size</a></div><div class="ttdeci">int Size() const </div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00868">Val.h:868</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a5aee2807c8bbdc99f863e27523cf785f"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a5aee2807c8bbdc99f863e27523cf785f">analyzer::Analyzer::Conn</a></div><div class="ttdeci">Connection * Conn() const </div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8h_source.html#l00273">Analyzer.h:273</a></div></div>
<div class="ttc" id="classAddrVal_html"><div class="ttname"><a href="classAddrVal.html">AddrVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00570">Val.h:570</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a4c95b7a2821ab00dbf331534d4accc89"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">analyzer::Analyzer::BuildConnVal</a></div><div class="ttdeci">RecordVal * BuildConnVal()</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00765">Analyzer.cc:765</a></div></div>
<div class="ttc" id="Obj_8h_html_a3bc2efaea5f7739dc79d7f733f6ee6fe"><div class="ttname"><a href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a></div><div class="ttdeci">void Unref(BroObj *o)</div><div class="ttdef"><b>Definition:</b> <a href="Obj_8h_source.html#l00216">Obj.h:216</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0b8b7f14cbccaa203aa43bd14a4b328e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void syn_weirds </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classanalyzer_1_1tcp_1_1TCP__Flags.html">TCP_Flags</a>&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>data_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="TCP_8cc_source.html#l00642">642</a> of file <a class="el" href="TCP_8cc_source.html">TCP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordflow">if</span> ( flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a069448a9292c9f790067e4988a545e41">RST</a>() )</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6ad5d71529533cbf88c2d241e56956f1">Conn</a>()-&gt;<a class="code" href="classConnection.html#ab32090383d2647bbfb14ffad1b3755a2">Weird</a>(<span class="stringliteral">&quot;TCP_christmas&quot;</span>);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordflow">if</span> ( flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a4fe276ce940f0d96469bd65eecfc267f">URG</a>() )</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6ad5d71529533cbf88c2d241e56956f1">Conn</a>()-&gt;<a class="code" href="classConnection.html#ab32090383d2647bbfb14ffad1b3755a2">Weird</a>(<span class="stringliteral">&quot;baroque_SYN&quot;</span>);</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordflow">if</span> ( data_len &gt; 0 )</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <span class="comment">// Not technically wrong according to RFC 793, but the other side</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <span class="comment">// would be forced to buffer data until the handshake succeeds, and</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="comment">// that could be bad in some cases, e.g. SYN floods.</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="comment">// T/TCP definitely complicates this.</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6ad5d71529533cbf88c2d241e56956f1">Conn</a>()-&gt;<a class="code" href="classConnection.html#ab32090383d2647bbfb14ffad1b3755a2">Weird</a>(<span class="stringliteral">&quot;SYN_with_data&quot;</span>);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a6ad5d71529533cbf88c2d241e56956f1"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6ad5d71529533cbf88c2d241e56956f1">analyzer::tcp::TCP_Endpoint::Conn</a></div><div class="ttdeci">Connection * Conn() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8cc_source.html#l00058">TCP_Endpoint.cc:58</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Flags_html_a069448a9292c9f790067e4988a545e41"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a069448a9292c9f790067e4988a545e41">analyzer::tcp::TCP_Flags::RST</a></div><div class="ttdeci">bool RST() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Flags_8h_source.html#l00013">TCP_Flags.h:13</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Flags_html_a4fe276ce940f0d96469bd65eecfc267f"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a4fe276ce940f0d96469bd65eecfc267f">analyzer::tcp::TCP_Flags::URG</a></div><div class="ttdeci">bool URG() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Flags_8h_source.html#l00015">TCP_Flags.h:15</a></div></div>
<div class="ttc" id="classConnection_html_ab32090383d2647bbfb14ffad1b3755a2"><div class="ttname"><a href="classConnection.html#ab32090383d2647bbfb14ffad1b3755a2">Connection::Weird</a></div><div class="ttdeci">void Weird(const char *name, const char *addl=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00731">Conn.cc:731</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4761586c66bd342eae540f772c344e44"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void update_ack_seq </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&#160;</td>
          <td class="paramname"><em>ack_seq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="TCP_8cc_source.html#l01176">1176</a> of file <a class="el" href="TCP_8cc_source.html">TCP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    {</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <a class="code" href="util_8h.html#ab7903878916593daecbeb95b98115ab0">int32</a> delta_ack = <a class="code" href="net__util_8h.html#a8911c5f5081a5f1d8d893950329f9bfb">seq_delta</a>(ack_seq, endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a5291aef3e3b463c00bcd7aed47a46887">AckSeq</a>());</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="keywordflow">if</span> ( ack_seq == 0 &amp;&amp; delta_ack &gt; <a class="code" href="TCP_8cc.html#af7cbae7c65518e45bf3bb43e30bdde35">TOO_LARGE_SEQ_DELTA</a> )</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        <span class="comment">// More likely that this is a broken ack than a</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        <span class="comment">// large connection that happens to land on 0 in the</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        <span class="comment">// sequence space.</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        ;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( delta_ack &gt; 0 )</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a4a7075e279f7595c0d66cd8d21674e16">UpdateAckSeq</a>(ack_seq);</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    }</div><div class="ttc" id="TCP_8cc_html_af7cbae7c65518e45bf3bb43e30bdde35"><div class="ttname"><a href="TCP_8cc.html#af7cbae7c65518e45bf3bb43e30bdde35">TOO_LARGE_SEQ_DELTA</a></div><div class="ttdeci">#define TOO_LARGE_SEQ_DELTA</div><div class="ttdef"><b>Definition:</b> <a href="TCP_8cc_source.html#l00034">TCP.cc:34</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a4a7075e279f7595c0d66cd8d21674e16"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a4a7075e279f7595c0d66cd8d21674e16">analyzer::tcp::TCP_Endpoint::UpdateAckSeq</a></div><div class="ttdeci">void UpdateAckSeq(uint32 seq)</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00124">TCP_Endpoint.h:124</a></div></div>
<div class="ttc" id="util_8h_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="util_8h.html#ab7903878916593daecbeb95b98115ab0">int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00069">util.h:69</a></div></div>
<div class="ttc" id="net__util_8h_html_a8911c5f5081a5f1d8d893950329f9bfb"><div class="ttname"><a href="net__util_8h.html#a8911c5f5081a5f1d8d893950329f9bfb">seq_delta</a></div><div class="ttdeci">int32 seq_delta(uint32 a, uint32 b)</div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00131">net_util.h:131</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a5291aef3e3b463c00bcd7aed47a46887"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a5291aef3e3b463c00bcd7aed47a46887">analyzer::tcp::TCP_Endpoint::AckSeq</a></div><div class="ttdeci">uint32 AckSeq() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00069">TCP_Endpoint.h:69</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a760ebc103e668d434b07cd75a98d8a18"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void update_history </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classanalyzer_1_1tcp_1_1TCP__Flags.html">TCP_Flags</a>&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a>&#160;</td>
          <td class="paramname"><em>rel_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="TCP_8cc_source.html#l00483">483</a> of file <a class="el" href="TCP_8cc_source.html">TCP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    {</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordtype">int</span> bits_set = (flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#add5426934cf883530fb54d4ecb158b92">SYN</a>() ? 1 : 0) + (flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a61d44dfe8d1f8e18efe5456972bb7087">FIN</a>() ? 1 : 0) +</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            (flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a069448a9292c9f790067e4988a545e41">RST</a>() ? 1 : 0);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">if</span> ( bits_set &gt; 1 )</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordflow">if</span> ( flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a61d44dfe8d1f8e18efe5456972bb7087">FIN</a>() &amp;&amp; flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a069448a9292c9f790067e4988a545e41">RST</a>() )</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#aed2cd5923e48027bae17f7bb9ffd92ee">CheckHistory</a>(<a class="code" href="TCP__Endpoint_8h.html#a533d73df82ad191de90c5d425166739b">HIST_FIN_RST_PKT</a>, <span class="charliteral">&#39;I&#39;</span>);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#aed2cd5923e48027bae17f7bb9ffd92ee">CheckHistory</a>(<a class="code" href="TCP__Endpoint_8h.html#a579324265145fb15d2a2034553108f1d">HIST_MULTI_FLAG_PKT</a>, <span class="charliteral">&#39;Q&#39;</span>);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        }</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bits_set == 1 )</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        {</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keywordflow">if</span> ( flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#add5426934cf883530fb54d4ecb158b92">SYN</a>() )</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            {</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <span class="keywordtype">char</span> code = flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a989fdbffe41191f21a822ea46a14c045">ACK</a>() ? <span class="charliteral">&#39;H&#39;</span> : <span class="charliteral">&#39;S&#39;</span>;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="keywordflow">if</span> ( endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#aed2cd5923e48027bae17f7bb9ffd92ee">CheckHistory</a>(<a class="code" href="TCP__Endpoint_8h.html#ad08f3f160a3388125fb6d2aa5423c04b">HIST_SYN_PKT</a>, code) &amp;&amp;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                 rel_seq != endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#ad3a33230ac976c04d0665c0e3a574aba">hist_last_SYN</a> )</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a794aaf4a80f516be36db186fc5f35708">AddHistory</a>(code);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#ad3a33230ac976c04d0665c0e3a574aba">hist_last_SYN</a> = rel_seq;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            }</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keywordflow">if</span> ( flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a61d44dfe8d1f8e18efe5456972bb7087">FIN</a>() )</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            {</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <span class="comment">// For FIN&#39;s, the sequence number comes at the</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            <span class="comment">// end of (any data in) the packet, not the</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            <span class="comment">// beginning as for SYNs and RSTs.</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            <span class="keywordflow">if</span> ( endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#aed2cd5923e48027bae17f7bb9ffd92ee">CheckHistory</a>(<a class="code" href="TCP__Endpoint_8h.html#aa97a33e0cd1abc4101f038a05e7c5039">HIST_FIN_PKT</a>, <span class="charliteral">&#39;F&#39;</span>) &amp;&amp;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                 rel_seq + len != endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6d4faca09046f752f1a4943e9ebe40e3">hist_last_FIN</a> )</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a794aaf4a80f516be36db186fc5f35708">AddHistory</a>(<span class="charliteral">&#39;F&#39;</span>);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6d4faca09046f752f1a4943e9ebe40e3">hist_last_FIN</a> = rel_seq + len;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            }</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keywordflow">if</span> ( flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a069448a9292c9f790067e4988a545e41">RST</a>() )</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            {</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="keywordflow">if</span> ( endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#aed2cd5923e48027bae17f7bb9ffd92ee">CheckHistory</a>(<a class="code" href="TCP__Endpoint_8h.html#a1491f6ae7a80a6331333289e5b6bf6f1">HIST_RST_PKT</a>, <span class="charliteral">&#39;R&#39;</span>) &amp;&amp;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                 rel_seq != endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a3f02742a7a4d59b63ddc82b0c5455cf4">hist_last_RST</a> )</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a794aaf4a80f516be36db186fc5f35708">AddHistory</a>(<span class="charliteral">&#39;R&#39;</span>);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a3f02742a7a4d59b63ddc82b0c5455cf4">hist_last_RST</a> = rel_seq;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            }</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        }</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        { <span class="comment">// bits_set == 0</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="keywordflow">if</span> ( len )</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#aed2cd5923e48027bae17f7bb9ffd92ee">CheckHistory</a>(<a class="code" href="TCP__Endpoint_8h.html#ad7a24bd625abbc58bd98c10bc5268282">HIST_DATA_PKT</a>, <span class="charliteral">&#39;D&#39;</span>);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a989fdbffe41191f21a822ea46a14c045">ACK</a>() )</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#aed2cd5923e48027bae17f7bb9ffd92ee">CheckHistory</a>(<a class="code" href="TCP__Endpoint_8h.html#a68409243168d3d01051d4c95bf988e22">HIST_ACK_PKT</a>, <span class="charliteral">&#39;A&#39;</span>);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        }</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    }</div><div class="ttc" id="TCP__Endpoint_8h_html_a1491f6ae7a80a6331333289e5b6bf6f1"><div class="ttname"><a href="TCP__Endpoint_8h.html#a1491f6ae7a80a6331333289e5b6bf6f1">HIST_RST_PKT</a></div><div class="ttdeci">#define HIST_RST_PKT</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00193">TCP_Endpoint.h:193</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Flags_html_add5426934cf883530fb54d4ecb158b92"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Flags.html#add5426934cf883530fb54d4ecb158b92">analyzer::tcp::TCP_Flags::SYN</a></div><div class="ttdeci">bool SYN() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Flags_8h_source.html#l00011">TCP_Flags.h:11</a></div></div>
<div class="ttc" id="TCP__Endpoint_8h_html_a579324265145fb15d2a2034553108f1d"><div class="ttname"><a href="TCP__Endpoint_8h.html#a579324265145fb15d2a2034553108f1d">HIST_MULTI_FLAG_PKT</a></div><div class="ttdeci">#define HIST_MULTI_FLAG_PKT</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00197">TCP_Endpoint.h:197</a></div></div>
<div class="ttc" id="TCP__Endpoint_8h_html_aa97a33e0cd1abc4101f038a05e7c5039"><div class="ttname"><a href="TCP__Endpoint_8h.html#aa97a33e0cd1abc4101f038a05e7c5039">HIST_FIN_PKT</a></div><div class="ttdeci">#define HIST_FIN_PKT</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00192">TCP_Endpoint.h:192</a></div></div>
<div class="ttc" id="TCP__Endpoint_8h_html_ad08f3f160a3388125fb6d2aa5423c04b"><div class="ttname"><a href="TCP__Endpoint_8h.html#ad08f3f160a3388125fb6d2aa5423c04b">HIST_SYN_PKT</a></div><div class="ttdeci">#define HIST_SYN_PKT</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00191">TCP_Endpoint.h:191</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_aed2cd5923e48027bae17f7bb9ffd92ee"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#aed2cd5923e48027bae17f7bb9ffd92ee">analyzer::tcp::TCP_Endpoint::CheckHistory</a></div><div class="ttdeci">int CheckHistory(uint32 mask, char code)</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8cc_source.html#l00271">TCP_Endpoint.cc:271</a></div></div>
<div class="ttc" id="TCP__Endpoint_8h_html_ad7a24bd625abbc58bd98c10bc5268282"><div class="ttname"><a href="TCP__Endpoint_8h.html#ad7a24bd625abbc58bd98c10bc5268282">HIST_DATA_PKT</a></div><div class="ttdeci">#define HIST_DATA_PKT</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00195">TCP_Endpoint.h:195</a></div></div>
<div class="ttc" id="TCP__Endpoint_8h_html_a533d73df82ad191de90c5d425166739b"><div class="ttname"><a href="TCP__Endpoint_8h.html#a533d73df82ad191de90c5d425166739b">HIST_FIN_RST_PKT</a></div><div class="ttdeci">#define HIST_FIN_RST_PKT</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00194">TCP_Endpoint.h:194</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a6d4faca09046f752f1a4943e9ebe40e3"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6d4faca09046f752f1a4943e9ebe40e3">analyzer::tcp::TCP_Endpoint::hist_last_FIN</a></div><div class="ttdeci">uint64 hist_last_FIN</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00228">TCP_Endpoint.h:228</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Flags_html_a069448a9292c9f790067e4988a545e41"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a069448a9292c9f790067e4988a545e41">analyzer::tcp::TCP_Flags::RST</a></div><div class="ttdeci">bool RST() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Flags_8h_source.html#l00013">TCP_Flags.h:13</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Flags_html_a61d44dfe8d1f8e18efe5456972bb7087"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a61d44dfe8d1f8e18efe5456972bb7087">analyzer::tcp::TCP_Flags::FIN</a></div><div class="ttdeci">bool FIN() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Flags_8h_source.html#l00012">TCP_Flags.h:12</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Flags_html_a989fdbffe41191f21a822ea46a14c045"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a989fdbffe41191f21a822ea46a14c045">analyzer::tcp::TCP_Flags::ACK</a></div><div class="ttdeci">bool ACK() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Flags_8h_source.html#l00014">TCP_Flags.h:14</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_ad3a33230ac976c04d0665c0e3a574aba"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#ad3a33230ac976c04d0665c0e3a574aba">analyzer::tcp::TCP_Endpoint::hist_last_SYN</a></div><div class="ttdeci">uint64 hist_last_SYN</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00228">TCP_Endpoint.h:228</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a794aaf4a80f516be36db186fc5f35708"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a794aaf4a80f516be36db186fc5f35708">analyzer::tcp::TCP_Endpoint::AddHistory</a></div><div class="ttdeci">void AddHistory(char code)</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8cc_source.html#l00282">TCP_Endpoint.cc:282</a></div></div>
<div class="ttc" id="TCP__Endpoint_8h_html_a68409243168d3d01051d4c95bf988e22"><div class="ttname"><a href="TCP__Endpoint_8h.html#a68409243168d3d01051d4c95bf988e22">HIST_ACK_PKT</a></div><div class="ttdeci">#define HIST_ACK_PKT</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00196">TCP_Endpoint.h:196</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a3f02742a7a4d59b63ddc82b0c5455cf4"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a3f02742a7a4d59b63ddc82b0c5455cf4">analyzer::tcp::TCP_Endpoint::hist_last_RST</a></div><div class="ttdeci">uint64 hist_last_RST</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00228">TCP_Endpoint.h:228</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a67a2d7d6580da138b52bac3710d2dd4b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="util_8h.html#ab7903878916593daecbeb95b98115ab0">int32</a> update_last_seq </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&#160;</td>
          <td class="paramname"><em>last_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classanalyzer_1_1tcp_1_1TCP__Flags.html">TCP_Flags</a>&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="TCP_8cc_source.html#l01191">1191</a> of file <a class="el" href="TCP_8cc_source.html">TCP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    {</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <a class="code" href="util_8h.html#ab7903878916593daecbeb95b98115ab0">int32</a> delta_last = <a class="code" href="net__util_8h.html#a8911c5f5081a5f1d8d893950329f9bfb">seq_delta</a>(last_seq, endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#aa032a944075d2818cb7ca66b55dfa6c4">LastSeq</a>());</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="keywordflow">if</span> ( (flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#add5426934cf883530fb54d4ecb158b92">SYN</a>() || flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a069448a9292c9f790067e4988a545e41">RST</a>()) &amp;&amp;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;         (delta_last &gt; <a class="code" href="TCP_8cc.html#af7cbae7c65518e45bf3bb43e30bdde35">TOO_LARGE_SEQ_DELTA</a> ||</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;         delta_last &lt; -<a class="code" href="TCP_8cc.html#af7cbae7c65518e45bf3bb43e30bdde35">TOO_LARGE_SEQ_DELTA</a>) )</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        <span class="comment">// ### perhaps trust RST seq #&#39;s if initial and not too</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <span class="comment">// outlandish, but not if they&#39;re coming after the other</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        <span class="comment">// side has sent a FIN - trust the FIN ack instead</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        ;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a61d44dfe8d1f8e18efe5456972bb7087">FIN</a>() &amp;&amp;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;          endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#aa032a944075d2818cb7ca66b55dfa6c4">LastSeq</a>() == endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a90b1b435a7d354567a36829afacee337">StartSeq</a>() + 1 )</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        <span class="comment">// Update last_seq based on the FIN even if delta_last &lt; 0.</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        <span class="comment">// This is to accommodate &gt; 2 GB connections for which</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <span class="comment">// we&#39;ve only seen the SYN and the FIN (hence the check</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <span class="comment">// for last_seq == start_seq + 1).</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a70e7b4fa2afb5f8852d7f6e64dd84999">UpdateLastSeq</a>(last_seq);</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#ae0ecc95ab857e4af3fe472f63a8e3337">state</a> == <a class="code" href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8a979e64e901631e3419683627aa0e136b">TCP_ENDPOINT_RESET</a> )</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        <span class="comment">// don&#39;t trust any subsequent sequence numbers</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        ;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( delta_last &gt; 0 )</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        <span class="comment">// ### check for large jumps here.</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        <span class="comment">// ## endpoint-&gt;last_seq = last_seq;</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a70e7b4fa2afb5f8852d7f6e64dd84999">UpdateLastSeq</a>(last_seq);</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( delta_last &lt; 0 &amp;&amp; len &gt; 0 )</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#aa82e4da1b45e6a65c44204dc95341baf">DidRxmit</a>();</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">return</span> delta_last;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    }</div><div class="ttc" id="namespaceanalyzer_1_1tcp_html_a8cfae039001606e60b0b9beb5c451ef8a979e64e901631e3419683627aa0e136b"><div class="ttname"><a href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8a979e64e901631e3419683627aa0e136b">analyzer::tcp::TCP_ENDPOINT_RESET</a></div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00024">TCP_Endpoint.h:24</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_aa82e4da1b45e6a65c44204dc95341baf"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#aa82e4da1b45e6a65c44204dc95341baf">analyzer::tcp::TCP_Endpoint::DidRxmit</a></div><div class="ttdeci">void DidRxmit()</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8cc_source.html#l00299">TCP_Endpoint.cc:299</a></div></div>
<div class="ttc" id="TCP_8cc_html_af7cbae7c65518e45bf3bb43e30bdde35"><div class="ttname"><a href="TCP_8cc.html#af7cbae7c65518e45bf3bb43e30bdde35">TOO_LARGE_SEQ_DELTA</a></div><div class="ttdeci">#define TOO_LARGE_SEQ_DELTA</div><div class="ttdef"><b>Definition:</b> <a href="TCP_8cc_source.html#l00034">TCP.cc:34</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a70e7b4fa2afb5f8852d7f6e64dd84999"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a70e7b4fa2afb5f8852d7f6e64dd84999">analyzer::tcp::TCP_Endpoint::UpdateLastSeq</a></div><div class="ttdeci">void UpdateLastSeq(uint32 seq)</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00116">TCP_Endpoint.h:116</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Flags_html_add5426934cf883530fb54d4ecb158b92"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Flags.html#add5426934cf883530fb54d4ecb158b92">analyzer::tcp::TCP_Flags::SYN</a></div><div class="ttdeci">bool SYN() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Flags_8h_source.html#l00011">TCP_Flags.h:11</a></div></div>
<div class="ttc" id="util_8h_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="util_8h.html#ab7903878916593daecbeb95b98115ab0">int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00069">util.h:69</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Flags_html_a069448a9292c9f790067e4988a545e41"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a069448a9292c9f790067e4988a545e41">analyzer::tcp::TCP_Flags::RST</a></div><div class="ttdeci">bool RST() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Flags_8h_source.html#l00013">TCP_Flags.h:13</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Flags_html_a61d44dfe8d1f8e18efe5456972bb7087"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a61d44dfe8d1f8e18efe5456972bb7087">analyzer::tcp::TCP_Flags::FIN</a></div><div class="ttdeci">bool FIN() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Flags_8h_source.html#l00012">TCP_Flags.h:12</a></div></div>
<div class="ttc" id="net__util_8h_html_a8911c5f5081a5f1d8d893950329f9bfb"><div class="ttname"><a href="net__util_8h.html#a8911c5f5081a5f1d8d893950329f9bfb">seq_delta</a></div><div class="ttdeci">int32 seq_delta(uint32 a, uint32 b)</div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00131">net_util.h:131</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a90b1b435a7d354567a36829afacee337"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a90b1b435a7d354567a36829afacee337">analyzer::tcp::TCP_Endpoint::StartSeq</a></div><div class="ttdeci">uint32 StartSeq() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00051">TCP_Endpoint.h:51</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_aa032a944075d2818cb7ca66b55dfa6c4"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#aa032a944075d2818cb7ca66b55dfa6c4">analyzer::tcp::TCP_Endpoint::LastSeq</a></div><div class="ttdeci">uint32 LastSeq() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00064">TCP_Endpoint.h:64</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_ae0ecc95ab857e4af3fe472f63a8e3337"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#ae0ecc95ab857e4af3fe472f63a8e3337">analyzer::tcp::TCP_Endpoint::state</a></div><div class="ttdeci">EndpointState state</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00205">TCP_Endpoint.h:205</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a521d5f8ccac25db071681b896f74fcef"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void update_window </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">TCP_Endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&#160;</td>
          <td class="paramname"><em>base_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&#160;</td>
          <td class="paramname"><em>ack_seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classanalyzer_1_1tcp_1_1TCP__Flags.html">TCP_Flags</a>&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="TCP_8cc_source.html#l00579">579</a> of file <a class="el" href="TCP_8cc_source.html">TCP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    {</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">// Note, applying scaling here would be incorrect for an initial SYN,</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="comment">// whose window value is always unscaled.  However, we don&#39;t</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="comment">// check the window&#39;s value for recision in that case anyway, so</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">// no-harm-no-foul.</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordtype">int</span> scale = endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a425d390e39f4f2e2c704f18c1831b641">window_scale</a>;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    window = window &lt;&lt; scale;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="comment">// Zero windows are boring if either (1) they come with a RST packet</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="comment">// or after a RST packet, or (2) they come after the peer has sent</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="comment">// a FIN (because there&#39;s no relevant window at that point anyway).</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="comment">// (They&#39;re also boring if they come after the peer has sent a RST,</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="comment">// but *nothing* should be sent in response to a RST, so we ignore</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">// that case.)</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">// However, they *are* potentially interesting if sent by an</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="comment">// endpoint that&#39;s already sent a FIN, since that FIN meant &quot;I&#39;m</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="comment">// not going to send any more&quot;, but doesn&#39;t mean &quot;I won&#39;t receive</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="comment">// any more&quot;.</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">if</span> ( window == 0 &amp;&amp; ! flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a069448a9292c9f790067e4988a545e41">RST</a>() &amp;&amp;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;         endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#aa3e7aa2d5737da26f2153a8f817e702e">peer</a>-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#ae0ecc95ab857e4af3fe472f63a8e3337">state</a> != <a class="code" href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8aef923ba70ac0bbfda47d49b9a5c6aaaf">TCP_ENDPOINT_CLOSED</a> &amp;&amp;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;         endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#ae0ecc95ab857e4af3fe472f63a8e3337">state</a> != <a class="code" href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8a979e64e901631e3419683627aa0e136b">TCP_ENDPOINT_RESET</a> )</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a3f78b5c49cfc4fad2ebff73ff4906e99">ZeroWindow</a>();</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="comment">// Don&#39;t analyze window values off of SYNs, they&#39;re sometimes</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="comment">// immediately rescinded.  Also don&#39;t do so for FINs or RSTs,</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="comment">// or if the connection has already been partially closed, since</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="comment">// such recisions occur frequently in practice, probably as the</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="comment">// receiver loses buffer memory due to its process going away.</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">if</span> ( ! flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#add5426934cf883530fb54d4ecb158b92">SYN</a>() &amp;&amp; ! flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a61d44dfe8d1f8e18efe5456972bb7087">FIN</a>() &amp;&amp; ! flags.<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a069448a9292c9f790067e4988a545e41">RST</a>() &amp;&amp;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;         endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#ae0ecc95ab857e4af3fe472f63a8e3337">state</a> != <a class="code" href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8aef923ba70ac0bbfda47d49b9a5c6aaaf">TCP_ENDPOINT_CLOSED</a> &amp;&amp;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;         endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#ae0ecc95ab857e4af3fe472f63a8e3337">state</a> != <a class="code" href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8a979e64e901631e3419683627aa0e136b">TCP_ENDPOINT_RESET</a> )</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        {</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="comment">// ### Decide whether to accept new window based on Active</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="comment">// Mapping policy.</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="net__util_8h.html#a8911c5f5081a5f1d8d893950329f9bfb">seq_delta</a>(base_seq, endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a128587f67e0939e552f3d3aa2b838ee7">window_seq</a>) &gt;= 0 &amp;&amp;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;             <a class="code" href="net__util_8h.html#a8911c5f5081a5f1d8d893950329f9bfb">seq_delta</a>(ack_seq, endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6f7758c5cfe9c4d60483649d281ad0ad">window_ack_seq</a>) &gt;= 0 )</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            {</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> new_edge = ack_seq + window;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> old_edge = endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6f7758c5cfe9c4d60483649d281ad0ad">window_ack_seq</a> + endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a47c61ca4225089cbaec384cd3fb4e896">window</a>;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <a class="code" href="util_8h.html#ab7903878916593daecbeb95b98115ab0">int32</a> advance = <a class="code" href="net__util_8h.html#a8911c5f5081a5f1d8d893950329f9bfb">seq_delta</a>(new_edge, old_edge);</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <span class="keywordflow">if</span> ( advance &lt; 0 )</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                {</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                <span class="comment">// An apparent window recision.  Allow a</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                <span class="comment">// bit of slop for window scaling.  This is</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                <span class="comment">// because sometimes there will be an</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                <span class="comment">// apparent recision due to the granularity</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                <span class="comment">// of the scaling.</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                <span class="keywordflow">if</span> ( (-advance) &gt;= (1 &lt;&lt; scale) )</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                    endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6ad5d71529533cbf88c2d241e56956f1">Conn</a>()-&gt;<a class="code" href="classConnection.html#ab32090383d2647bbfb14ffad1b3755a2">Weird</a>(<span class="stringliteral">&quot;window_recision&quot;</span>);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                }</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a47c61ca4225089cbaec384cd3fb4e896">window</a> = window;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6f7758c5cfe9c4d60483649d281ad0ad">window_ack_seq</a> = ack_seq;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            endpoint-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a128587f67e0939e552f3d3aa2b838ee7">window_seq</a> = base_seq;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            }</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        }</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a128587f67e0939e552f3d3aa2b838ee7"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a128587f67e0939e552f3d3aa2b838ee7">analyzer::tcp::TCP_Endpoint::window_seq</a></div><div class="ttdeci">uint32 window_seq</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00218">TCP_Endpoint.h:218</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_aa3e7aa2d5737da26f2153a8f817e702e"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#aa3e7aa2d5737da26f2153a8f817e702e">analyzer::tcp::TCP_Endpoint::peer</a></div><div class="ttdeci">TCP_Endpoint * peer</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00206">TCP_Endpoint.h:206</a></div></div>
<div class="ttc" id="namespaceanalyzer_1_1tcp_html_a8cfae039001606e60b0b9beb5c451ef8a979e64e901631e3419683627aa0e136b"><div class="ttname"><a href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8a979e64e901631e3419683627aa0e136b">analyzer::tcp::TCP_ENDPOINT_RESET</a></div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00024">TCP_Endpoint.h:24</a></div></div>
<div class="ttc" id="namespaceanalyzer_1_1tcp_html_a8cfae039001606e60b0b9beb5c451ef8aef923ba70ac0bbfda47d49b9a5c6aaaf"><div class="ttname"><a href="namespaceanalyzer_1_1tcp.html#a8cfae039001606e60b0b9beb5c451ef8aef923ba70ac0bbfda47d49b9a5c6aaaf">analyzer::tcp::TCP_ENDPOINT_CLOSED</a></div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00023">TCP_Endpoint.h:23</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a47c61ca4225089cbaec384cd3fb4e896"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a47c61ca4225089cbaec384cd3fb4e896">analyzer::tcp::TCP_Endpoint::window</a></div><div class="ttdeci">uint32 window</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00215">TCP_Endpoint.h:215</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Flags_html_add5426934cf883530fb54d4ecb158b92"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Flags.html#add5426934cf883530fb54d4ecb158b92">analyzer::tcp::TCP_Flags::SYN</a></div><div class="ttdeci">bool SYN() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Flags_8h_source.html#l00011">TCP_Flags.h:11</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a3f78b5c49cfc4fad2ebff73ff4906e99"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a3f78b5c49cfc4fad2ebff73ff4906e99">analyzer::tcp::TCP_Endpoint::ZeroWindow</a></div><div class="ttdeci">void ZeroWindow()</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8cc_source.html#l00308">TCP_Endpoint.cc:308</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a6f7758c5cfe9c4d60483649d281ad0ad"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6f7758c5cfe9c4d60483649d281ad0ad">analyzer::tcp::TCP_Endpoint::window_ack_seq</a></div><div class="ttdeci">uint32 window_ack_seq</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00217">TCP_Endpoint.h:217</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a6ad5d71529533cbf88c2d241e56956f1"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a6ad5d71529533cbf88c2d241e56956f1">analyzer::tcp::TCP_Endpoint::Conn</a></div><div class="ttdeci">Connection * Conn() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8cc_source.html#l00058">TCP_Endpoint.cc:58</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_a425d390e39f4f2e2c704f18c1831b641"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#a425d390e39f4f2e2c704f18c1831b641">analyzer::tcp::TCP_Endpoint::window_scale</a></div><div class="ttdeci">int window_scale</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00216">TCP_Endpoint.h:216</a></div></div>
<div class="ttc" id="util_8h_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="util_8h.html#ab7903878916593daecbeb95b98115ab0">int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00069">util.h:69</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Flags_html_a069448a9292c9f790067e4988a545e41"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a069448a9292c9f790067e4988a545e41">analyzer::tcp::TCP_Flags::RST</a></div><div class="ttdeci">bool RST() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Flags_8h_source.html#l00013">TCP_Flags.h:13</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Flags_html_a61d44dfe8d1f8e18efe5456972bb7087"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Flags.html#a61d44dfe8d1f8e18efe5456972bb7087">analyzer::tcp::TCP_Flags::FIN</a></div><div class="ttdeci">bool FIN() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP__Flags_8h_source.html#l00012">TCP_Flags.h:12</a></div></div>
<div class="ttc" id="net__util_8h_html_a8911c5f5081a5f1d8d893950329f9bfb"><div class="ttname"><a href="net__util_8h.html#a8911c5f5081a5f1d8d893950329f9bfb">seq_delta</a></div><div class="ttdeci">int32 seq_delta(uint32 a, uint32 b)</div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00131">net_util.h:131</a></div></div>
<div class="ttc" id="util_8h_html_acbd4acd0d29e2d6c43104827f77d9cd2"><div class="ttname"><a href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00064">util.h:64</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_ae0ecc95ab857e4af3fe472f63a8e3337"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#ae0ecc95ab857e4af3fe472f63a8e3337">analyzer::tcp::TCP_Endpoint::state</a></div><div class="ttdeci">EndpointState state</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00205">TCP_Endpoint.h:205</a></div></div>
<div class="ttc" id="classConnection_html_ab32090383d2647bbfb14ffad1b3755a2"><div class="ttname"><a href="classConnection.html#ab32090383d2647bbfb14ffad1b3755a2">Connection::Weird</a></div><div class="ttdeci">void Weird(const char *name, const char *addl=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00731">Conn.cc:731</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a78de38cc503164b5b63f18e951d73574"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int ORIG = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="TCP_8cc_source.html#l00036">36</a> of file <a class="el" href="TCP_8cc_source.html">TCP.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ac5a2ceca6571928bb008b306fde9628e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int RESP = 2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="TCP_8cc_source.html#l00037">37</a> of file <a class="el" href="TCP_8cc_source.html">TCP.cc</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
