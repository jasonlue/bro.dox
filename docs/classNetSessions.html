<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>bro: NetSessions Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">bro
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-types">Protected Types</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classNetSessions-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">NetSessions Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="Sessions_8h_source.html">Sessions.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for NetSessions:</div>
<div class="dyncontent">
<div class="center"><img src="classNetSessions__coll__graph.png" border="0" usemap="#NetSessions_coll__map" alt="Collaboration graph"/></div>
<map name="NetSessions_coll__map" id="NetSessions_coll__map">
<area shape="rect" id="node2" href="classCompositeHash.html" title="CompositeHash" alt="" coords="1431,763,1547,789"/>
<area shape="rect" id="node3" href="classTypeList.html" title="TypeList" alt="" coords="1367,575,1439,601"/>
<area shape="rect" id="node4" href="classBroType.html" title="BroType" alt="" coords="1133,477,1203,503"/>
<area shape="rect" id="node11" href="classFunc.html" title="Func" alt="" coords="723,575,773,601"/>
<area shape="rect" id="node12" href="classScope.html" title="Scope" alt="" coords="295,1097,353,1124"/>
<area shape="rect" id="node13" href="classID.html" title="ID" alt="" coords="694,1008,733,1035"/>
<area shape="rect" id="node14" href="classVal.html" title="Val" alt="" coords="693,919,734,945"/>
<area shape="rect" id="node17" href="classBroFile.html" title="BroFile" alt="" coords="1291,709,1354,736"/>
<area shape="rect" id="node20" href="classAttributes.html" title="Attributes" alt="" coords="1263,575,1342,601"/>
<area shape="rect" id="node5" href="classBroObj.html" title="BroObj" alt="" coords="755,171,818,197"/>
<area shape="rect" id="node25" href="classDFA__Machine.html" title="DFA_Machine" alt="" coords="635,477,741,503"/>
<area shape="rect" id="node27" href="classDFA__State.html" title="DFA_State" alt="" coords="393,377,479,404"/>
<area shape="rect" id="node30" href="classNFA__Machine.html" title="NFA_Machine" alt="" coords="567,377,673,404"/>
<area shape="rect" id="node31" href="classNFA__State.html" title="NFA_State" alt="" coords="457,260,543,287"/>
<area shape="rect" id="node35" href="classanalyzer_1_1arp_1_1ARP__Analyzer.html" title="analyzer::arp::ARP\l_Analyzer" alt="" coords="1496,311,1629,352"/>
<area shape="rect" id="node6" href="classSerialObj.html" title="SerialObj" alt="" coords="767,5,841,32"/>
<area shape="rect" id="node7" href="classLocation.html" title="Location" alt="" coords="714,81,785,108"/>
<area shape="rect" id="node18" href="classTimer.html" title="Timer" alt="" coords="1263,81,1318,108"/>
<area shape="rect" id="node21" href="classRE__Matcher.html" title="RE_Matcher" alt="" coords="227,709,322,736"/>
<area shape="rect" id="node9" href="classanalyzer_1_1tcp_1_1TCPStateStats.html" title="analyzer::tcp::TCPStateStats" alt="" coords="1501,822,1696,849"/>
<area shape="rect" id="node10" href="classDiscarder.html" title="Discarder" alt="" coords="987,763,1066,789"/>
<area shape="rect" id="node15" href="unionBroValUnion.html" title="BroValUnion" alt="" coords="666,822,761,849"/>
<area shape="rect" id="node16" href="classIPAddr.html" title="IPAddr" alt="" coords="798,575,861,601"/>
<area shape="rect" id="node33" href="classIPPrefix.html" title="IPPrefix" alt="" coords="640,709,709,736"/>
<area shape="rect" id="node34" href="classPacketProfiler.html" title="PacketProfiler" alt="" coords="1307,822,1411,849"/>
<area shape="rect" id="node19" href="classPQ__Element.html" title="PQ_Element" alt="" coords="1243,5,1339,32"/>
<area shape="rect" id="node22" href="classSpecific__RE__Matcher.html" title="Specific_RE_Matcher" alt="" coords="436,575,585,601"/>
<area shape="rect" id="node23" href="classEquivClass.html" title="EquivClass" alt="" coords="694,260,783,287"/>
<area shape="rect" id="node24" href="classCCL.html" title="CCL" alt="" coords="101,171,150,197"/>
<area shape="rect" id="node26" href="classDFA__State__Cache.html" title="DFA_State_Cache" alt="" coords="765,377,897,404"/>
<area shape="rect" id="node28" href="structCacheEntry.html" title="CacheEntry" alt="" coords="349,477,440,503"/>
<area shape="rect" id="node29" href="classHashKey.html" title="HashKey" alt="" coords="293,377,369,404"/>
<area shape="rect" id="node32" href="classBroString.html" title="BroString" alt="" coords="835,709,911,736"/>
<area shape="rect" id="node36" href="classOSFingerprint.html" title="OSFingerprint" alt="" coords="1949,822,2051,849"/>
<area shape="rect" id="node37" href="structfp__entry.html" title="fp_entry" alt="" coords="1929,709,1999,736"/>
<area shape="rect" id="node38" href="classPacketFilter.html" title="PacketFilter" alt="" coords="2165,822,2257,849"/>
<area shape="rect" id="node39" href="classPrefixTable.html" title="PrefixTable" alt="" coords="2195,709,2283,736"/>
<area shape="rect" id="node40" href="struct__patricia__tree__t.html" title="_patricia_tree_t" alt="" coords="2193,575,2303,601"/>
<area shape="rect" id="node41" href="struct__patricia__node__t.html" title="_patricia_node_t" alt="" coords="2189,477,2307,503"/>
<area shape="rect" id="node42" href="struct__prefix__t.html" title="_prefix_t" alt="" coords="2212,377,2284,404"/>
<area shape="rect" id="node43" href="classanalyzer_1_1stepping__stone_1_1SteppingStoneManager.html" title="analyzer::stepping\l_stone::SteppingStoneManager" alt="" coords="1721,815,1925,856"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7e25c01f7583aa59e656be2865acafee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a7e25c01f7583aa59e656be2865acafee">NetSessions</a> ()</td></tr>
<tr class="separator:a7e25c01f7583aa59e656be2865acafee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee3bc9f44909ca3ea335c1d78334a114"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#aee3bc9f44909ca3ea335c1d78334a114">~NetSessions</a> ()</td></tr>
<tr class="separator:aee3bc9f44909ca3ea335c1d78334a114"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa52dd9eb1caa1b54c66c3d4846fa16ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#aa52dd9eb1caa1b54c66c3d4846fa16ad">NextPacket</a> (double t, const <a class="el" href="classPacket.html">Packet</a> *pkt)</td></tr>
<tr class="separator:aa52dd9eb1caa1b54c66c3d4846fa16ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad64904c56e977fd13613138cf55e6b64"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#ad64904c56e977fd13613138cf55e6b64">Done</a> ()</td></tr>
<tr class="separator:ad64904c56e977fd13613138cf55e6b64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83c4d484f576c82038cea5cd91f7f552"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFragReassembler.html">FragReassembler</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a83c4d484f576c82038cea5cd91f7f552">NextFragment</a> (double t, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip, const u_char *pkt)</td></tr>
<tr class="separator:a83c4d484f576c82038cea5cd91f7f552"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbc01be5dd34c7627b0c907be2f007e8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#adbc01be5dd34c7627b0c907be2f007e8">Get_OS_From_SYN</a> (struct <a class="el" href="structos__type.html">os_type</a> *retval, <a class="el" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a> tot, <a class="el" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> DF_flag, <a class="el" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> TTL, <a class="el" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a> WSS, <a class="el" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> ocnt, <a class="el" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> *op, <a class="el" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a> MSS, <a class="el" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> win_scale, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> tstamp, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> quirks, <a class="el" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> ECN) const </td></tr>
<tr class="separator:adbc01be5dd34c7627b0c907be2f007e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fb012b26d018200b1c81b197a528a1b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a9fb012b26d018200b1c81b197a528a1b">CompareWithPreviousOSMatch</a> (const <a class="el" href="classIPAddr.html">IPAddr</a> &amp;addr, int id) const </td></tr>
<tr class="separator:a9fb012b26d018200b1c81b197a528a1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeaf4c86e37fbf50b6e7a6c33f8c33aa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classConnection.html">Connection</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#afeaf4c86e37fbf50b6e7a6c33f8c33aa">FindConnection</a> (<a class="el" href="classVal.html">Val</a> *v)</td></tr>
<tr class="separator:afeaf4c86e37fbf50b6e7a6c33f8c33aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c8b3c4f33f8932e3ba6914b9cec52c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a1c8b3c4f33f8932e3ba6914b9cec52c3">Remove</a> (<a class="el" href="classConnection.html">Connection</a> *c)</td></tr>
<tr class="separator:a1c8b3c4f33f8932e3ba6914b9cec52c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa757979936bea61cce0fdd371f04b82b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#aa757979936bea61cce0fdd371f04b82b">Remove</a> (<a class="el" href="classFragReassembler.html">FragReassembler</a> *f)</td></tr>
<tr class="separator:aa757979936bea61cce0fdd371f04b82b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d3aec7911aed6175f95e45c3cfbcd6d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a0d3aec7911aed6175f95e45c3cfbcd6d">Insert</a> (<a class="el" href="classConnection.html">Connection</a> *c)</td></tr>
<tr class="separator:a0d3aec7911aed6175f95e45c3cfbcd6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9df7541b681ef6ec0d690db4b0c40edb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a9df7541b681ef6ec0d690db4b0c40edb">Drain</a> ()</td></tr>
<tr class="separator:a9df7541b681ef6ec0d690db4b0c40edb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada15fb2d4acef2840b25ad722a31b8a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#ada15fb2d4acef2840b25ad722a31b8a2">GetStats</a> (<a class="el" href="structSessionStats.html">SessionStats</a> &amp;s) const </td></tr>
<tr class="separator:ada15fb2d4acef2840b25ad722a31b8a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac693cf1ddd40bc732b9e988d11ed25f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a> (const char *name, const <a class="el" href="classPacket.html">Packet</a> *pkt, const <a class="el" href="classEncapsulationStack.html">EncapsulationStack</a> *encap=0)</td></tr>
<tr class="separator:ac693cf1ddd40bc732b9e988d11ed25f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88bcdb35bdaa1a74294719166024ff44"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a88bcdb35bdaa1a74294719166024ff44">Weird</a> (const char *name, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip, const <a class="el" href="classEncapsulationStack.html">EncapsulationStack</a> *encap=0)</td></tr>
<tr class="separator:a88bcdb35bdaa1a74294719166024ff44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a1d583d93f2c06d79c6f2e797b74a56"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPacketFilter.html">PacketFilter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a5a1d583d93f2c06d79c6f2e797b74a56">GetPacketFilter</a> ()</td></tr>
<tr class="separator:a5a1d583d93f2c06d79c6f2e797b74a56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2649c0e26761e93a7ed4b49e39004f2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTimerMgr.html">TimerMgr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#af2649c0e26761e93a7ed4b49e39004f2">LookupTimerMgr</a> (const <a class="el" href="classTimerMgr.html#a8d797fd4f0dc6dcf1e81026f0265c5f6">TimerMgr::Tag</a> *tag, bool create=<a class="el" href="ConvertUTF_8c.html#a41f9c5fb8b08eb5dc3edce4dcb37fee7">true</a>)</td></tr>
<tr class="separator:af2649c0e26761e93a7ed4b49e39004f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac93a4cf63254c310f216c317157df02c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#ac93a4cf63254c310f216c317157df02c">ExpireTimerMgrs</a> ()</td></tr>
<tr class="separator:ac93a4cf63254c310f216c317157df02c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1187590287d147c8da07fa3dade1b689"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classanalyzer_1_1stepping__stone_1_1SteppingStoneManager.html">analyzer::stepping_stone::SteppingStoneManager</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a1187590287d147c8da07fa3dade1b689">GetSTPManager</a> ()</td></tr>
<tr class="separator:a1187590287d147c8da07fa3dade1b689"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dcf5a33a113d4952c735572817f3bed"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a5dcf5a33a113d4952c735572817f3bed">CurrentConnections</a> ()</td></tr>
<tr class="separator:a5dcf5a33a113d4952c735572817f3bed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9e7d4c9ca9f04b797f8090bc88f37cc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#aa9e7d4c9ca9f04b797f8090bc88f37cc">DoNextPacket</a> (double t, const <a class="el" href="classPacket.html">Packet</a> *pkt, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip_hdr, const <a class="el" href="classEncapsulationStack.html">EncapsulationStack</a> *encapsulation)</td></tr>
<tr class="separator:aa9e7d4c9ca9f04b797f8090bc88f37cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f3161c112a2c9fdd0dd5a2b418926e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a3f3161c112a2c9fdd0dd5a2b418926e0">DoNextInnerPacket</a> (double t, const <a class="el" href="classPacket.html">Packet</a> *pkt, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *inner, const <a class="el" href="classEncapsulationStack.html">EncapsulationStack</a> *prev, const <a class="el" href="classEncapsulatingConn.html">EncapsulatingConn</a> &amp;ec)</td></tr>
<tr class="separator:a3f3161c112a2c9fdd0dd5a2b418926e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8566b0fbe1879eb0508039f2e3edb5bd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a8566b0fbe1879eb0508039f2e3edb5bd">ParseIPPacket</a> (int caplen, const u_char *const pkt, int proto, <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&amp;inner)</td></tr>
<tr class="separator:a8566b0fbe1879eb0508039f2e3edb5bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2523153a05c3bd6bf119923fe3b2d4b"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#ad2523153a05c3bd6bf119923fe3b2d4b">ConnectionMemoryUsage</a> ()</td></tr>
<tr class="separator:ad2523153a05c3bd6bf119923fe3b2d4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b9cd86f6aff95bff20d35bc9c6371f8"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a4b9cd86f6aff95bff20d35bc9c6371f8">ConnectionMemoryUsageConnVals</a> ()</td></tr>
<tr class="separator:a4b9cd86f6aff95bff20d35bc9c6371f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c389409036bfe683b2abb144e6cae7e"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a0c389409036bfe683b2abb144e6cae7e">MemoryAllocation</a> ()</td></tr>
<tr class="separator:a0c389409036bfe683b2abb144e6cae7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a45d7e6f22fb6ad866723e64530c915a3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classanalyzer_1_1tcp_1_1TCPStateStats.html">analyzer::tcp::TCPStateStats</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a45d7e6f22fb6ad866723e64530c915a3">tcp_stats</a></td></tr>
<tr class="separator:a45d7e6f22fb6ad866723e64530c915a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-types"></a>
Protected Types</h2></td></tr>
<tr class="memitem:ab7675fcc36494512228d1c3a282d22ce"><td class="memItemLeft" align="right" valign="top">typedef pair&lt; <a class="el" href="classIPAddr.html">IPAddr</a>, <a class="el" href="classIPAddr.html">IPAddr</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#ab7675fcc36494512228d1c3a282d22ce">IPPair</a></td></tr>
<tr class="separator:ab7675fcc36494512228d1c3a282d22ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14cbb326c4dc8196cced2706925cf0f9"><td class="memItemLeft" align="right" valign="top">typedef pair&lt; <a class="el" href="classEncapsulatingConn.html">EncapsulatingConn</a>, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a14cbb326c4dc8196cced2706925cf0f9">TunnelActivity</a></td></tr>
<tr class="separator:a14cbb326c4dc8196cced2706925cf0f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16e080f164d73987f1673f6e888b44b2"><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; <a class="el" href="classNetSessions.html#ab7675fcc36494512228d1c3a282d22ce">IPPair</a>, <a class="el" href="classNetSessions.html#a14cbb326c4dc8196cced2706925cf0f9">TunnelActivity</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a16e080f164d73987f1673f6e888b44b2">IPTunnelMap</a></td></tr>
<tr class="separator:a16e080f164d73987f1673f6e888b44b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a588c15a15bb6f54d196e37b7baf2e445"><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; <a class="el" href="classTimerMgr.html#a8d797fd4f0dc6dcf1e81026f0265c5f6">TimerMgr::Tag</a>, <a class="el" href="classTimerMgr.html">TimerMgr</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a588c15a15bb6f54d196e37b7baf2e445">TimerMgrMap</a></td></tr>
<tr class="separator:a588c15a15bb6f54d196e37b7baf2e445"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ad3965a2f68ea9c8cdd2b7c729af33720"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classConnection.html">Connection</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#ad3965a2f68ea9c8cdd2b7c729af33720">NewConn</a> (<a class="el" href="classHashKey.html">HashKey</a> *k, double t, const <a class="el" href="structConnID.html">ConnID</a> *id, const u_char *data, int proto, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> flow_label, const <a class="el" href="classPacket.html">Packet</a> *pkt, const <a class="el" href="classEncapsulationStack.html">EncapsulationStack</a> *encapsulation)</td></tr>
<tr class="separator:ad3965a2f68ea9c8cdd2b7c729af33720"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e1b9845ff7597ff1e44c67d6139173a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a8e1b9845ff7597ff1e44c67d6139173a">CheckConnectionTag</a> (<a class="el" href="classConnection.html">Connection</a> *conn)</td></tr>
<tr class="separator:a8e1b9845ff7597ff1e44c67d6139173a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad613585ffce6da5ccaf4069628c463fb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#ad613585ffce6da5ccaf4069628c463fb">IsLikelyServerPort</a> (<a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> port, <a class="el" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7b">TransportProto</a> <a class="el" href="NetVar_8h.html#a3a02cc4f8fe1642ffabc4ad51ce42dab">transport_proto</a>) const </td></tr>
<tr class="separator:ad613585ffce6da5ccaf4069628c463fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4be660e05101732d5eea8e6911eff62"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#af4be660e05101732d5eea8e6911eff62">WantConnection</a> (<a class="el" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a> src_port, <a class="el" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a> dest_port, <a class="el" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7b">TransportProto</a> <a class="el" href="NetVar_8h.html#a3a02cc4f8fe1642ffabc4ad51ce42dab">transport_proto</a>, <a class="el" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> tcp_flags, bool &amp;flip_roles)</td></tr>
<tr class="separator:af4be660e05101732d5eea8e6911eff62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8a81976f7c6230a5d8f0e50d6cda708"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#ab8a81976f7c6230a5d8f0e50d6cda708">DumpPacket</a> (const <a class="el" href="classPacket.html">Packet</a> *pkt, int len=0)</td></tr>
<tr class="separator:ab8a81976f7c6230a5d8f0e50d6cda708"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acad75ee2d3507036e5ef35d1374de67d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#acad75ee2d3507036e5ef35d1374de67d">CheckHeaderTrunc</a> (int proto, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> len, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> caplen, const <a class="el" href="classPacket.html">Packet</a> *pkt, const <a class="el" href="classEncapsulationStack.html">EncapsulationStack</a> *encap)</td></tr>
<tr class="separator:acad75ee2d3507036e5ef35d1374de67d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81c169d53b4107c0d6ff059b181a9c72"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a81c169d53b4107c0d6ff059b181a9c72">PDict</a> (<a class="el" href="classConnection.html">Connection</a>) tcp_conns</td></tr>
<tr class="separator:a81c169d53b4107c0d6ff059b181a9c72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accedbe7d4d4893a2f42d794e849a33d4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#accedbe7d4d4893a2f42d794e849a33d4">PDict</a> (<a class="el" href="classConnection.html">Connection</a>) udp_conns</td></tr>
<tr class="separator:accedbe7d4d4893a2f42d794e849a33d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae67e50e6366e3d19858f78ba378afa2b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#ae67e50e6366e3d19858f78ba378afa2b">PDict</a> (<a class="el" href="classConnection.html">Connection</a>) icmp_conns</td></tr>
<tr class="separator:ae67e50e6366e3d19858f78ba378afa2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ffd6b6d37347df70e12defbcd068ab9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a4ffd6b6d37347df70e12defbcd068ab9">PDict</a> (<a class="el" href="classFragReassembler.html">FragReassembler</a>) fragments</td></tr>
<tr class="separator:a4ffd6b6d37347df70e12defbcd068ab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a7fb2cf6c9b3cdfeb9921f0eef2889fe4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCompositeHash.html">CompositeHash</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a7fb2cf6c9b3cdfeb9921f0eef2889fe4">ch</a></td></tr>
<tr class="separator:a7fb2cf6c9b3cdfeb9921f0eef2889fe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2d46a6940ab5c04945729f85c5aa6fa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classNetSessions.html#a16e080f164d73987f1673f6e888b44b2">IPTunnelMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#ae2d46a6940ab5c04945729f85c5aa6fa">ip_tunnels</a></td></tr>
<tr class="separator:ae2d46a6940ab5c04945729f85c5aa6fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae746b070666b44da520738283037b24b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classanalyzer_1_1arp_1_1ARP__Analyzer.html">analyzer::arp::ARP_Analyzer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#ae746b070666b44da520738283037b24b">arp_analyzer</a></td></tr>
<tr class="separator:ae746b070666b44da520738283037b24b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4845dfcb5ecc5319f682387c0208809b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classanalyzer_1_1stepping__stone_1_1SteppingStoneManager.html">analyzer::stepping_stone::SteppingStoneManager</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a4845dfcb5ecc5319f682387c0208809b">stp_manager</a></td></tr>
<tr class="separator:a4845dfcb5ecc5319f682387c0208809b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8249bf085beaed0edf1d054a929d7ae9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDiscarder.html">Discarder</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a8249bf085beaed0edf1d054a929d7ae9">discarder</a></td></tr>
<tr class="separator:a8249bf085beaed0edf1d054a929d7ae9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1e4a540b075b3fc41bc2d74faf14373"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPacketFilter.html">PacketFilter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#af1e4a540b075b3fc41bc2d74faf14373">packet_filter</a></td></tr>
<tr class="separator:af1e4a540b075b3fc41bc2d74faf14373"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62bf64617bf9ecfb22b8e8894a168a12"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classOSFingerprint.html">OSFingerprint</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a62bf64617bf9ecfb22b8e8894a168a12">SYN_OS_Fingerprinter</a></td></tr>
<tr class="separator:a62bf64617bf9ecfb22b8e8894a168a12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc4ddb2a9c75fa2f960f8bf1745badd3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#adc4ddb2a9c75fa2f960f8bf1745badd3">build_backdoor_analyzer</a></td></tr>
<tr class="separator:adc4ddb2a9c75fa2f960f8bf1745badd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb38b95e4eae2b4ecb38e1bb481e2522"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#abb38b95e4eae2b4ecb38e1bb481e2522">dump_this_packet</a></td></tr>
<tr class="separator:abb38b95e4eae2b4ecb38e1bb481e2522"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26490773024adcd5527bdc17d98957f9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a26490773024adcd5527bdc17d98957f9">num_packets_processed</a></td></tr>
<tr class="separator:a26490773024adcd5527bdc17d98957f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafee75c822a3c0c0f5468c0e75789229"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPacketProfiler.html">PacketProfiler</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#aafee75c822a3c0c0f5468c0e75789229">pkt_profiler</a></td></tr>
<tr class="separator:aafee75c822a3c0c0f5468c0e75789229"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5118a8f46d752cfe03b7dbebc4fc3fc1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classNetSessions.html#a588c15a15bb6f54d196e37b7baf2e445">TimerMgrMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a5118a8f46d752cfe03b7dbebc4fc3fc1">timer_mgrs</a></td></tr>
<tr class="separator:a5118a8f46d752cfe03b7dbebc4fc3fc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:af1ff7f1837b4faee8509df88c2edbcf0"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#af1ff7f1837b4faee8509df88c2edbcf0">RemoteSerializer</a></td></tr>
<tr class="separator:af1ff7f1837b4faee8509df88c2edbcf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad14666fbd39879a687c9406615f8f1fa"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#ad14666fbd39879a687c9406615f8f1fa">ConnCompressor</a></td></tr>
<tr class="separator:ad14666fbd39879a687c9406615f8f1fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a633c39d095c642e834eb81c60c14eef7"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a633c39d095c642e834eb81c60c14eef7">TimerMgrExpireTimer</a></td></tr>
<tr class="separator:a633c39d095c642e834eb81c60c14eef7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46461efab16220523fa26f185e7daadb"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNetSessions.html#a46461efab16220523fa26f185e7daadb">IPTunnelTimer</a></td></tr>
<tr class="separator:a46461efab16220523fa26f185e7daadb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00065">65</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="ab7675fcc36494512228d1c3a282d22ce"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef pair&lt;<a class="el" href="classIPAddr.html">IPAddr</a>, <a class="el" href="classIPAddr.html">IPAddr</a>&gt; <a class="el" href="classNetSessions.html#ab7675fcc36494512228d1c3a282d22ce">NetSessions::IPPair</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00234">234</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a16e080f164d73987f1673f6e888b44b2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;<a class="el" href="classNetSessions.html#ab7675fcc36494512228d1c3a282d22ce">IPPair</a>, <a class="el" href="classNetSessions.html#a14cbb326c4dc8196cced2706925cf0f9">TunnelActivity</a>&gt; <a class="el" href="classNetSessions.html#a16e080f164d73987f1673f6e888b44b2">NetSessions::IPTunnelMap</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00236">236</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a588c15a15bb6f54d196e37b7baf2e445"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;<a class="el" href="classTimerMgr.html#a8d797fd4f0dc6dcf1e81026f0265c5f6">TimerMgr::Tag</a>, <a class="el" href="classTimerMgr.html">TimerMgr</a>*&gt; <a class="el" href="classNetSessions.html#a588c15a15bb6f54d196e37b7baf2e445">NetSessions::TimerMgrMap</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00252">252</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a14cbb326c4dc8196cced2706925cf0f9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef pair&lt;<a class="el" href="classEncapsulatingConn.html">EncapsulatingConn</a>, double&gt; <a class="el" href="classNetSessions.html#a14cbb326c4dc8196cced2706925cf0f9">NetSessions::TunnelActivity</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00235">235</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a7e25c01f7583aa59e656be2865acafee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NetSessions::NetSessions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l00093">93</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="classTypeList.html">TypeList</a>* t = <span class="keyword">new</span> <a class="code" href="classTypeList.html">TypeList</a>();</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    t-&gt;<a class="code" href="classTypeList.html#a87374d3b6bdc12c3d0886bf0afcc2dae">Append</a>(<a class="code" href="Type_8h.html#a5299a670221fc4d503c4e0cbf329fdcd">base_type</a>(<a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76ab6e01bc9c82ae356e556539430f0218e">TYPE_ADDR</a>));    <span class="comment">// source IP address</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    t-&gt;<a class="code" href="classTypeList.html#a87374d3b6bdc12c3d0886bf0afcc2dae">Append</a>(<a class="code" href="Type_8h.html#a5299a670221fc4d503c4e0cbf329fdcd">base_type</a>(<a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76ab6e01bc9c82ae356e556539430f0218e">TYPE_ADDR</a>));    <span class="comment">// dest IP address</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    t-&gt;<a class="code" href="classTypeList.html#a87374d3b6bdc12c3d0886bf0afcc2dae">Append</a>(<a class="code" href="Type_8h.html#a5299a670221fc4d503c4e0cbf329fdcd">base_type</a>(<a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));   <span class="comment">// source and dest ports</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="classNetSessions.html#a7fb2cf6c9b3cdfeb9921f0eef2889fe4">ch</a> = <span class="keyword">new</span> <a class="code" href="classCompositeHash.html">CompositeHash</a>(t);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a>(t);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    tcp_conns.SetDeleteFunc(<a class="code" href="Obj_8cc.html#a4c2e71ea7b0a165d0a99e4bf46332baf">bro_obj_delete_func</a>);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    udp_conns.SetDeleteFunc(<a class="code" href="Obj_8cc.html#a4c2e71ea7b0a165d0a99e4bf46332baf">bro_obj_delete_func</a>);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    icmp_conns.SetDeleteFunc(<a class="code" href="Obj_8cc.html#a4c2e71ea7b0a165d0a99e4bf46332baf">bro_obj_delete_func</a>);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    fragments.SetDeleteFunc(<a class="code" href="Obj_8cc.html#a4c2e71ea7b0a165d0a99e4bf46332baf">bro_obj_delete_func</a>);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">if</span> ( stp_correlate_pair )</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <a class="code" href="classNetSessions.html#a4845dfcb5ecc5319f682387c0208809b">stp_manager</a> = <span class="keyword">new</span> <a class="code" href="classanalyzer_1_1stepping__stone_1_1SteppingStoneManager.html">analyzer::stepping_stone::SteppingStoneManager</a>();</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <a class="code" href="classNetSessions.html#a4845dfcb5ecc5319f682387c0208809b">stp_manager</a> = 0;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="classNetSessions.html#a8249bf085beaed0edf1d054a929d7ae9">discarder</a> = <span class="keyword">new</span> <a class="code" href="classDiscarder.html">Discarder</a>();</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">if</span> ( ! <a class="code" href="classNetSessions.html#a8249bf085beaed0edf1d054a929d7ae9">discarder</a>-&gt;<a class="code" href="classDiscarder.html#a85b50d6d5c293f775a327d8375ad905b">IsActive</a>() )</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        {</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keyword">delete</span> <a class="code" href="classNetSessions.html#a8249bf085beaed0edf1d054a929d7ae9">discarder</a>;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <a class="code" href="classNetSessions.html#a8249bf085beaed0edf1d054a929d7ae9">discarder</a> = 0;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="classNetSessions.html#af1e4a540b075b3fc41bc2d74faf14373">packet_filter</a> = 0;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="classNetSessions.html#adc4ddb2a9c75fa2f960f8bf1745badd3">build_backdoor_analyzer</a> =</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        backdoor_stats || rlogin_signature_found ||</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        telnet_signature_found || ssh_signature_found ||</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        root_backdoor_signature_found || ftp_signature_found ||</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        napster_signature_found || kazaa_signature_found ||</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        http_signature_found || http_proxy_signature_found;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="classNetSessions.html#abb38b95e4eae2b4ecb38e1bb481e2522">dump_this_packet</a> = 0;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="classNetSessions.html#a26490773024adcd5527bdc17d98957f9">num_packets_processed</a> = 0;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">if</span> ( OS_version_found )</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <a class="code" href="classNetSessions.html#a62bf64617bf9ecfb22b8e8894a168a12">SYN_OS_Fingerprinter</a> = <span class="keyword">new</span> <a class="code" href="classOSFingerprint.html">OSFingerprint</a>(<a class="code" href="OSFinger_8h.html#a2e4c1480f259500bb7be56f72cd1792ea6ba1175428f54be89b18cfe7faf31a81">SYN_FINGERPRINT_MODE</a>);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="classNetSessions.html#a62bf64617bf9ecfb22b8e8894a168a12">SYN_OS_Fingerprinter</a>-&gt;<a class="code" href="classOSFingerprint.html#ac9ed26f91c06cea71a0f6cda6e15e79c">Error</a>() )</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            exit(1);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <a class="code" href="classNetSessions.html#a62bf64617bf9ecfb22b8e8894a168a12">SYN_OS_Fingerprinter</a> = 0;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="NetVar_8cc.html#a29012b92910f54058da7089ad14c20db">pkt_profile_mode</a> &amp;&amp; <a class="code" href="NetVar_8cc.html#a0d9421a9659f75eedbf1977ae1c20019">pkt_profile_freq</a> &gt; 0 &amp;&amp; <a class="code" href="NetVar_8cc.html#aaf837a4b5bbe660c8b603259bc165b4d">pkt_profile_file</a> )</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <a class="code" href="classNetSessions.html#aafee75c822a3c0c0f5468c0e75789229">pkt_profiler</a> = <span class="keyword">new</span> <a class="code" href="classPacketProfiler.html">PacketProfiler</a>(<a class="code" href="NetVar_8cc.html#a29012b92910f54058da7089ad14c20db">pkt_profile_mode</a>,</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                <a class="code" href="NetVar_8cc.html#a0d9421a9659f75eedbf1977ae1c20019">pkt_profile_freq</a>, <a class="code" href="NetVar_8cc.html#aaf837a4b5bbe660c8b603259bc165b4d">pkt_profile_file</a>-&gt;AsFile());</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <a class="code" href="classNetSessions.html#aafee75c822a3c0c0f5468c0e75789229">pkt_profiler</a> = 0;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">if</span> ( arp_request || arp_reply || bad_arp )</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <a class="code" href="classNetSessions.html#ae746b070666b44da520738283037b24b">arp_analyzer</a> = <span class="keyword">new</span> <a class="code" href="classanalyzer_1_1arp_1_1ARP__Analyzer.html">analyzer::arp::ARP_Analyzer</a>();</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <a class="code" href="classNetSessions.html#ae746b070666b44da520738283037b24b">arp_analyzer</a> = 0;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    }</div><div class="ttc" id="classNetSessions_html_af1e4a540b075b3fc41bc2d74faf14373"><div class="ttname"><a href="classNetSessions.html#af1e4a540b075b3fc41bc2d74faf14373">NetSessions::packet_filter</a></div><div class="ttdeci">PacketFilter * packet_filter</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00243">Sessions.h:243</a></div></div>
<div class="ttc" id="classNetSessions_html_adc4ddb2a9c75fa2f960f8bf1745badd3"><div class="ttname"><a href="classNetSessions.html#adc4ddb2a9c75fa2f960f8bf1745badd3">NetSessions::build_backdoor_analyzer</a></div><div class="ttdeci">int build_backdoor_analyzer</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00245">Sessions.h:245</a></div></div>
<div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76ab6e01bc9c82ae356e556539430f0218e"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76ab6e01bc9c82ae356e556539430f0218e">TYPE_ADDR</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00032">Type.h:32</a></div></div>
<div class="ttc" id="OSFinger_8h_html_a2e4c1480f259500bb7be56f72cd1792ea6ba1175428f54be89b18cfe7faf31a81"><div class="ttname"><a href="OSFinger_8h.html#a2e4c1480f259500bb7be56f72cd1792ea6ba1175428f54be89b18cfe7faf31a81">SYN_FINGERPRINT_MODE</a></div><div class="ttdef"><b>Definition:</b> <a href="OSFinger_8h_source.html#l00079">OSFinger.h:79</a></div></div>
<div class="ttc" id="Type_8h_html_a5299a670221fc4d503c4e0cbf329fdcd"><div class="ttname"><a href="Type_8h.html#a5299a670221fc4d503c4e0cbf329fdcd">base_type</a></div><div class="ttdeci">BroType * base_type(TypeTag tag)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00639">Type.h:639</a></div></div>
<div class="ttc" id="classanalyzer_1_1arp_1_1ARP__Analyzer_html"><div class="ttname"><a href="classanalyzer_1_1arp_1_1ARP__Analyzer.html">analyzer::arp::ARP_Analyzer</a></div><div class="ttdef"><b>Definition:</b> <a href="ARP_8h_source.html#l00036">ARP.h:36</a></div></div>
<div class="ttc" id="classDiscarder_html"><div class="ttname"><a href="classDiscarder.html">Discarder</a></div><div class="ttdef"><b>Definition:</b> <a href="Discard_8h_source.html#l00018">Discard.h:18</a></div></div>
<div class="ttc" id="classanalyzer_1_1stepping__stone_1_1SteppingStoneManager_html"><div class="ttname"><a href="classanalyzer_1_1stepping__stone_1_1SteppingStoneManager.html">analyzer::stepping_stone::SteppingStoneManager</a></div><div class="ttdef"><b>Definition:</b> <a href="SteppingStone_8h_source.html#l00075">SteppingStone.h:75</a></div></div>
<div class="ttc" id="classPacketProfiler_html"><div class="ttname"><a href="classPacketProfiler.html">PacketProfiler</a></div><div class="ttdef"><b>Definition:</b> <a href="Stats_8h_source.html#l00113">Stats.h:113</a></div></div>
<div class="ttc" id="classTypeList_html"><div class="ttname"><a href="classTypeList.html">TypeList</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00288">Type.h:288</a></div></div>
<div class="ttc" id="classNetSessions_html_a62bf64617bf9ecfb22b8e8894a168a12"><div class="ttname"><a href="classNetSessions.html#a62bf64617bf9ecfb22b8e8894a168a12">NetSessions::SYN_OS_Fingerprinter</a></div><div class="ttdeci">OSFingerprint * SYN_OS_Fingerprinter</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00244">Sessions.h:244</a></div></div>
<div class="ttc" id="NetVar_8cc_html_a0d9421a9659f75eedbf1977ae1c20019"><div class="ttname"><a href="NetVar_8cc.html#a0d9421a9659f75eedbf1977ae1c20019">pkt_profile_freq</a></div><div class="ttdeci">double pkt_profile_freq</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00187">NetVar.cc:187</a></div></div>
<div class="ttc" id="Obj_8cc_html_a4c2e71ea7b0a165d0a99e4bf46332baf"><div class="ttname"><a href="Obj_8cc.html#a4c2e71ea7b0a165d0a99e4bf46332baf">bro_obj_delete_func</a></div><div class="ttdeci">void bro_obj_delete_func(void *v)</div><div class="ttdef"><b>Definition:</b> <a href="Obj_8cc_source.html#l00268">Obj.cc:268</a></div></div>
<div class="ttc" id="classNetSessions_html_a7fb2cf6c9b3cdfeb9921f0eef2889fe4"><div class="ttname"><a href="classNetSessions.html#a7fb2cf6c9b3cdfeb9921f0eef2889fe4">NetSessions::ch</a></div><div class="ttdeci">CompositeHash * ch</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00228">Sessions.h:228</a></div></div>
<div class="ttc" id="classNetSessions_html_a4845dfcb5ecc5319f682387c0208809b"><div class="ttname"><a href="classNetSessions.html#a4845dfcb5ecc5319f682387c0208809b">NetSessions::stp_manager</a></div><div class="ttdeci">analyzer::stepping_stone::SteppingStoneManager * stp_manager</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00241">Sessions.h:241</a></div></div>
<div class="ttc" id="classDiscarder_html_a85b50d6d5c293f775a327d8375ad905b"><div class="ttname"><a href="classDiscarder.html#a85b50d6d5c293f775a327d8375ad905b">Discarder::IsActive</a></div><div class="ttdeci">int IsActive()</div><div class="ttdef"><b>Definition:</b> <a href="Discard_8cc_source.html#l00025">Discard.cc:25</a></div></div>
<div class="ttc" id="classNetSessions_html_ae746b070666b44da520738283037b24b"><div class="ttname"><a href="classNetSessions.html#ae746b070666b44da520738283037b24b">NetSessions::arp_analyzer</a></div><div class="ttdeci">analyzer::arp::ARP_Analyzer * arp_analyzer</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00239">Sessions.h:239</a></div></div>
<div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00022">Type.h:22</a></div></div>
<div class="ttc" id="classNetSessions_html_aafee75c822a3c0c0f5468c0e75789229"><div class="ttname"><a href="classNetSessions.html#aafee75c822a3c0c0f5468c0e75789229">NetSessions::pkt_profiler</a></div><div class="ttdeci">PacketProfiler * pkt_profiler</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00248">Sessions.h:248</a></div></div>
<div class="ttc" id="classOSFingerprint_html"><div class="ttname"><a href="classOSFingerprint.html">OSFingerprint</a></div><div class="ttdef"><b>Definition:</b> <a href="OSFinger_8h_source.html#l00082">OSFinger.h:82</a></div></div>
<div class="ttc" id="NetVar_8cc_html_aaf837a4b5bbe660c8b603259bc165b4d"><div class="ttname"><a href="NetVar_8cc.html#aaf837a4b5bbe660c8b603259bc165b4d">pkt_profile_file</a></div><div class="ttdeci">Val * pkt_profile_file</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00188">NetVar.cc:188</a></div></div>
<div class="ttc" id="classNetSessions_html_a8249bf085beaed0edf1d054a929d7ae9"><div class="ttname"><a href="classNetSessions.html#a8249bf085beaed0edf1d054a929d7ae9">NetSessions::discarder</a></div><div class="ttdeci">Discarder * discarder</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00242">Sessions.h:242</a></div></div>
<div class="ttc" id="classNetSessions_html_a26490773024adcd5527bdc17d98957f9"><div class="ttname"><a href="classNetSessions.html#a26490773024adcd5527bdc17d98957f9">NetSessions::num_packets_processed</a></div><div class="ttdeci">uint64 num_packets_processed</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00247">Sessions.h:247</a></div></div>
<div class="ttc" id="classOSFingerprint_html_ac9ed26f91c06cea71a0f6cda6e15e79c"><div class="ttname"><a href="classOSFingerprint.html#ac9ed26f91c06cea71a0f6cda6e15e79c">OSFingerprint::Error</a></div><div class="ttdeci">bool Error() const </div><div class="ttdef"><b>Definition:</b> <a href="OSFinger_8h_source.html#l00087">OSFinger.h:87</a></div></div>
<div class="ttc" id="classCompositeHash_html"><div class="ttname"><a href="classCompositeHash.html">CompositeHash</a></div><div class="ttdef"><b>Definition:</b> <a href="CompHash_8h_source.html#l00011">CompHash.h:11</a></div></div>
<div class="ttc" id="classNetSessions_html_abb38b95e4eae2b4ecb38e1bb481e2522"><div class="ttname"><a href="classNetSessions.html#abb38b95e4eae2b4ecb38e1bb481e2522">NetSessions::dump_this_packet</a></div><div class="ttdeci">int dump_this_packet</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00246">Sessions.h:246</a></div></div>
<div class="ttc" id="classTypeList_html_a87374d3b6bdc12c3d0886bf0afcc2dae"><div class="ttname"><a href="classTypeList.html#a87374d3b6bdc12c3d0886bf0afcc2dae">TypeList::Append</a></div><div class="ttdeci">void Append(BroType *t)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cc_source.html#l00340">Type.cc:340</a></div></div>
<div class="ttc" id="NetVar_8cc_html_a29012b92910f54058da7089ad14c20db"><div class="ttname"><a href="NetVar_8cc.html#a29012b92910f54058da7089ad14c20db">pkt_profile_mode</a></div><div class="ttdeci">int pkt_profile_mode</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00186">NetVar.cc:186</a></div></div>
<div class="ttc" id="Obj_8h_html_a3bc2efaea5f7739dc79d7f733f6ee6fe"><div class="ttname"><a href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a></div><div class="ttdeci">void Unref(BroObj *o)</div><div class="ttdef"><b>Definition:</b> <a href="Obj_8h_source.html#l00216">Obj.h:216</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aee3bc9f44909ca3ea335c1d78334a114"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NetSessions::~NetSessions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l00154">154</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classNetSessions.html#a7fb2cf6c9b3cdfeb9921f0eef2889fe4">ch</a>;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classNetSessions.html#af1e4a540b075b3fc41bc2d74faf14373">packet_filter</a>;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classNetSessions.html#a62bf64617bf9ecfb22b8e8894a168a12">SYN_OS_Fingerprinter</a>;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classNetSessions.html#aafee75c822a3c0c0f5468c0e75789229">pkt_profiler</a>;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a>(<a class="code" href="classNetSessions.html#ae746b070666b44da520738283037b24b">arp_analyzer</a>);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classNetSessions.html#a8249bf085beaed0edf1d054a929d7ae9">discarder</a>;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classNetSessions.html#a4845dfcb5ecc5319f682387c0208809b">stp_manager</a>;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div><div class="ttc" id="classNetSessions_html_af1e4a540b075b3fc41bc2d74faf14373"><div class="ttname"><a href="classNetSessions.html#af1e4a540b075b3fc41bc2d74faf14373">NetSessions::packet_filter</a></div><div class="ttdeci">PacketFilter * packet_filter</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00243">Sessions.h:243</a></div></div>
<div class="ttc" id="classNetSessions_html_a62bf64617bf9ecfb22b8e8894a168a12"><div class="ttname"><a href="classNetSessions.html#a62bf64617bf9ecfb22b8e8894a168a12">NetSessions::SYN_OS_Fingerprinter</a></div><div class="ttdeci">OSFingerprint * SYN_OS_Fingerprinter</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00244">Sessions.h:244</a></div></div>
<div class="ttc" id="classNetSessions_html_a7fb2cf6c9b3cdfeb9921f0eef2889fe4"><div class="ttname"><a href="classNetSessions.html#a7fb2cf6c9b3cdfeb9921f0eef2889fe4">NetSessions::ch</a></div><div class="ttdeci">CompositeHash * ch</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00228">Sessions.h:228</a></div></div>
<div class="ttc" id="classNetSessions_html_a4845dfcb5ecc5319f682387c0208809b"><div class="ttname"><a href="classNetSessions.html#a4845dfcb5ecc5319f682387c0208809b">NetSessions::stp_manager</a></div><div class="ttdeci">analyzer::stepping_stone::SteppingStoneManager * stp_manager</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00241">Sessions.h:241</a></div></div>
<div class="ttc" id="classNetSessions_html_ae746b070666b44da520738283037b24b"><div class="ttname"><a href="classNetSessions.html#ae746b070666b44da520738283037b24b">NetSessions::arp_analyzer</a></div><div class="ttdeci">analyzer::arp::ARP_Analyzer * arp_analyzer</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00239">Sessions.h:239</a></div></div>
<div class="ttc" id="classNetSessions_html_aafee75c822a3c0c0f5468c0e75789229"><div class="ttname"><a href="classNetSessions.html#aafee75c822a3c0c0f5468c0e75789229">NetSessions::pkt_profiler</a></div><div class="ttdeci">PacketProfiler * pkt_profiler</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00248">Sessions.h:248</a></div></div>
<div class="ttc" id="classNetSessions_html_a8249bf085beaed0edf1d054a929d7ae9"><div class="ttname"><a href="classNetSessions.html#a8249bf085beaed0edf1d054a929d7ae9">NetSessions::discarder</a></div><div class="ttdeci">Discarder * discarder</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00242">Sessions.h:242</a></div></div>
<div class="ttc" id="Obj_8h_html_a3bc2efaea5f7739dc79d7f733f6ee6fe"><div class="ttname"><a href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a></div><div class="ttdeci">void Unref(BroObj *o)</div><div class="ttdef"><b>Definition:</b> <a href="Obj_8h_source.html#l00216">Obj.h:216</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a8e1b9845ff7597ff1e44c67d6139173a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int NetSessions::CheckConnectionTag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classConnection.html">Connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l00240">240</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="Net_8cc.html#a7fb74d671853ca0d21f70e726235403f">current_iosrc</a>-&gt;<a class="code" href="classiosource_1_1IOSource.html#ad066cffba7266c6feaad2387c725dac0">GetCurrentTag</a>() )</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        {</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="comment">// Packet is tagged.</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">if</span> ( conn-&gt;<a class="code" href="classConnection.html#ab9824df8fee17aefafef0053973f1c97">GetTimerMgr</a>() == <a class="code" href="main_8cc.html#a36d412e0f4c6a9403bf08b697828e16b">timer_mgr</a> )</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="comment">// Connection uses global timer queue.  But the</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <span class="comment">// packet has a tag that means we got it externally,</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="comment">// probably from the Time Machine.</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <a class="code" href="DebugLogger_8h.html#a6ae561b796b2ef9273683b54d8b6937e">DBG_LOG</a>(DBG_TM, <span class="stringliteral">&quot;got packet with tag %s for already&quot;</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                    <span class="stringliteral">&quot;known connection, reinstantiating&quot;</span>,</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                    <a class="code" href="Net_8cc.html#a7fb74d671853ca0d21f70e726235403f">current_iosrc</a>-&gt;<a class="code" href="classiosource_1_1IOSource.html#ad066cffba7266c6feaad2387c725dac0">GetCurrentTag</a>()-&gt;c_str());</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="comment">// Connection uses local timer queue.</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            TimerMgrMap::iterator i =</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                <a class="code" href="classNetSessions.html#a5118a8f46d752cfe03b7dbebc4fc3fc1">timer_mgrs</a>.find(*<a class="code" href="Net_8cc.html#a7fb74d671853ca0d21f70e726235403f">current_iosrc</a>-&gt;<a class="code" href="classiosource_1_1IOSource.html#ad066cffba7266c6feaad2387c725dac0">GetCurrentTag</a>());</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <span class="keywordflow">if</span> ( i != <a class="code" href="classNetSessions.html#a5118a8f46d752cfe03b7dbebc4fc3fc1">timer_mgrs</a>.end() &amp;&amp;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                 conn-&gt;<a class="code" href="classConnection.html#ab9824df8fee17aefafef0053973f1c97">GetTimerMgr</a>() != i-&gt;second )</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                {</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <span class="comment">// Connection uses different local queue</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                <span class="comment">// than the tag for the current packet</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                <span class="comment">// indicates.</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                <span class="comment">//</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                <span class="comment">// This can happen due to:</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                <span class="comment">//     (1) getting same packets with</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                <span class="comment">//      different tags</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                <span class="comment">//     (2) timer mgr having already expired</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                <a class="code" href="DebugLogger_8h.html#a6ae561b796b2ef9273683b54d8b6937e">DBG_LOG</a>(DBG_TM, <span class="stringliteral">&quot;packet ignored due old/inconsistent tag&quot;</span>);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                }</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">// Packet is not tagged.</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">if</span> ( conn-&gt;<a class="code" href="classConnection.html#ab9824df8fee17aefafef0053973f1c97">GetTimerMgr</a>() != <a class="code" href="main_8cc.html#a36d412e0f4c6a9403bf08b697828e16b">timer_mgr</a> )</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="comment">// Connection does not use the global timer queue.  That</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="comment">// means that this is a live packet belonging to a</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="comment">// connection for which we have already switched to</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="comment">// processing external input.</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <a class="code" href="DebugLogger_8h.html#a6ae561b796b2ef9273683b54d8b6937e">DBG_LOG</a>(DBG_TM, <span class="stringliteral">&quot;packet ignored due to processing it in external data&quot;</span>);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div><div class="ttc" id="Net_8cc_html_a7fb74d671853ca0d21f70e726235403f"><div class="ttname"><a href="Net_8cc.html#a7fb74d671853ca0d21f70e726235403f">current_iosrc</a></div><div class="ttdeci">iosource::IOSource * current_iosrc</div><div class="ttdef"><b>Definition:</b> <a href="Net_8cc_source.html#l00067">Net.cc:67</a></div></div>
<div class="ttc" id="classNetSessions_html_a5118a8f46d752cfe03b7dbebc4fc3fc1"><div class="ttname"><a href="classNetSessions.html#a5118a8f46d752cfe03b7dbebc4fc3fc1">NetSessions::timer_mgrs</a></div><div class="ttdeci">TimerMgrMap timer_mgrs</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00253">Sessions.h:253</a></div></div>
<div class="ttc" id="main_8cc_html_a36d412e0f4c6a9403bf08b697828e16b"><div class="ttname"><a href="main_8cc.html#a36d412e0f4c6a9403bf08b697828e16b">timer_mgr</a></div><div class="ttdeci">TimerMgr * timer_mgr</div><div class="ttdef"><b>Definition:</b> <a href="main_8cc_source.html#l00085">main.cc:85</a></div></div>
<div class="ttc" id="DebugLogger_8h_html_a6ae561b796b2ef9273683b54d8b6937e"><div class="ttname"><a href="DebugLogger_8h.html#a6ae561b796b2ef9273683b54d8b6937e">DBG_LOG</a></div><div class="ttdeci">#define DBG_LOG(args...)</div><div class="ttdef"><b>Definition:</b> <a href="DebugLogger_8h_source.html#l00104">DebugLogger.h:104</a></div></div>
<div class="ttc" id="classiosource_1_1IOSource_html_ad066cffba7266c6feaad2387c725dac0"><div class="ttname"><a href="classiosource_1_1IOSource.html#ad066cffba7266c6feaad2387c725dac0">iosource::IOSource::GetCurrentTag</a></div><div class="ttdeci">virtual TimerMgr::Tag * GetCurrentTag()</div><div class="ttdef"><b>Definition:</b> <a href="IOSource_8h_source.html#l00106">IOSource.h:106</a></div></div>
<div class="ttc" id="classConnection_html_ab9824df8fee17aefafef0053973f1c97"><div class="ttname"><a href="classConnection.html#ab9824df8fee17aefafef0053973f1c97">Connection::GetTimerMgr</a></div><div class="ttdeci">TimerMgr * GetTimerMgr() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00776">Conn.cc:776</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acad75ee2d3507036e5ef35d1374de67d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool NetSessions::CheckHeaderTrunc </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>proto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&#160;</td>
          <td class="paramname"><em>caplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classPacket.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classEncapsulationStack.html">EncapsulationStack</a> *&#160;</td>
          <td class="paramname"><em>encap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l00872">872</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    {</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> min_hdr_len = 0;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordflow">switch</span> ( proto ) {</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordflow">case</span> IPPROTO_TCP:</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        min_hdr_len = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>tcphdr);</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordflow">case</span> IPPROTO_UDP:</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        min_hdr_len = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>udphdr);</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keywordflow">case</span> IPPROTO_IPV4:</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        min_hdr_len = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>ip);</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">case</span> IPPROTO_IPV6:</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        min_hdr_len = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structip6__hdr.html">ip6_hdr</a>);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="keywordflow">case</span> IPPROTO_NONE:</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        min_hdr_len = 0;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="keywordflow">case</span> IPPROTO_GRE:</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        min_hdr_len = 4;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordflow">case</span> IPPROTO_ICMP:</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">case</span> IPPROTO_ICMPV6:</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <span class="comment">// Use for all other packets.</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        min_hdr_len = ICMP_MINLEN;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    }</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keywordflow">if</span> ( len &lt; min_hdr_len )</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        {</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;truncated_header&quot;</span>, p, encap);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        }</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">if</span> ( caplen &lt; min_hdr_len )</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        {</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;internally_truncated_header&quot;</span>, p, encap);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        }</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    }</div><div class="ttc" id="util_8h_html_acbd4acd0d29e2d6c43104827f77d9cd2"><div class="ttname"><a href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00064">util.h:64</a></div></div>
<div class="ttc" id="classNetSessions_html_ac693cf1ddd40bc732b9e988d11ed25f1"><div class="ttname"><a href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">NetSessions::Weird</a></div><div class="ttdeci">void Weird(const char *name, const Packet *pkt, const EncapsulationStack *encap=0)</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l01417">Sessions.cc:1417</a></div></div>
<div class="ttc" id="structip6__hdr_html"><div class="ttname"><a href="structip6__hdr.html">ip6_hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00051">net_util.h:51</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9fb012b26d018200b1c81b197a528a1b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool NetSessions::CompareWithPreviousOSMatch </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classIPAddr.html">IPAddr</a> &amp;&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l00960">960</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    {</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classNetSessions.html#a62bf64617bf9ecfb22b8e8894a168a12">SYN_OS_Fingerprinter</a> ?</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <a class="code" href="classNetSessions.html#a62bf64617bf9ecfb22b8e8894a168a12">SYN_OS_Fingerprinter</a>-&gt;<a class="code" href="classOSFingerprint.html#af8ba3effaab842a81db0a3688b153d53">CacheMatch</a>(addr, <span class="keywordtype">id</span>) : 0;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    }</div><div class="ttc" id="classNetSessions_html_a62bf64617bf9ecfb22b8e8894a168a12"><div class="ttname"><a href="classNetSessions.html#a62bf64617bf9ecfb22b8e8894a168a12">NetSessions::SYN_OS_Fingerprinter</a></div><div class="ttdeci">OSFingerprint * SYN_OS_Fingerprinter</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00244">Sessions.h:244</a></div></div>
<div class="ttc" id="classOSFingerprint_html_af8ba3effaab842a81db0a3688b153d53"><div class="ttname"><a href="classOSFingerprint.html#af8ba3effaab842a81db0a3688b153d53">OSFingerprint::CacheMatch</a></div><div class="ttdeci">bool CacheMatch(const IPAddr &amp;addr, int id)</div><div class="ttdef"><b>Definition:</b> <a href="OSFinger_8cc_source.html#l00066">OSFinger.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad2523153a05c3bd6bf119923fe3b2d4b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int NetSessions::ConnectionMemoryUsage </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l01439">1439</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    {</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mem = 0;</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="Net_8cc.html#ad34ddf7f16a2b8ba8547e4f464148077">terminating</a> )</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        <span class="comment">// Connections have been flushed already.</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <a class="code" href="classIterCookie.html">IterCookie</a>* cookie = tcp_conns.InitForIteration();</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <a class="code" href="classConnection.html">Connection</a>* tc;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="keywordflow">while</span> ( (tc = tcp_conns.NextEntry(cookie)) )</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;        mem += tc-&gt;<a class="code" href="classConnection.html#a31be534ed27124863580257d4eb7066d">MemoryAllocation</a>();</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    cookie = udp_conns.InitForIteration();</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <a class="code" href="classConnection.html">Connection</a>* uc;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <span class="keywordflow">while</span> ( (uc = udp_conns.NextEntry(cookie)) )</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        mem += uc-&gt;<a class="code" href="classConnection.html#a31be534ed27124863580257d4eb7066d">MemoryAllocation</a>();</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    cookie = icmp_conns.InitForIteration();</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <a class="code" href="classConnection.html">Connection</a>* ic;</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="keywordflow">while</span> ( (ic = icmp_conns.NextEntry(cookie)) )</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        mem += ic-&gt;<a class="code" href="classConnection.html#a31be534ed27124863580257d4eb7066d">MemoryAllocation</a>();</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <span class="keywordflow">return</span> mem;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    }</div><div class="ttc" id="Net_8cc_html_ad34ddf7f16a2b8ba8547e4f464148077"><div class="ttname"><a href="Net_8cc.html#ad34ddf7f16a2b8ba8547e4f464148077">terminating</a></div><div class="ttdeci">bool terminating</div><div class="ttdef"><b>Definition:</b> <a href="Net_8cc_source.html#l00060">Net.cc:60</a></div></div>
<div class="ttc" id="classConnection_html_a31be534ed27124863580257d4eb7066d"><div class="ttname"><a href="classConnection.html#a31be534ed27124863580257d4eb7066d">Connection::MemoryAllocation</a></div><div class="ttdeci">unsigned int MemoryAllocation() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00824">Conn.cc:824</a></div></div>
<div class="ttc" id="classIterCookie_html"><div class="ttname"><a href="classIterCookie.html">IterCookie</a></div><div class="ttdef"><b>Definition:</b> <a href="Dict_8cc_source.html#l00038">Dict.cc:38</a></div></div>
<div class="ttc" id="classConnection_html"><div class="ttname"><a href="classConnection.html">Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00059">Conn.h:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4b9cd86f6aff95bff20d35bc9c6371f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int NetSessions::ConnectionMemoryUsageConnVals </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l01468">1468</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    {</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mem = 0;</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="Net_8cc.html#ad34ddf7f16a2b8ba8547e4f464148077">terminating</a> )</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        <span class="comment">// Connections have been flushed already.</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <a class="code" href="classIterCookie.html">IterCookie</a>* cookie = tcp_conns.InitForIteration();</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <a class="code" href="classConnection.html">Connection</a>* tc;</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <span class="keywordflow">while</span> ( (tc = tcp_conns.NextEntry(cookie)) )</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;        mem += tc-&gt;<a class="code" href="classConnection.html#aad71fb2527db126a89f88cfae4d028d1">MemoryAllocationConnVal</a>();</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    cookie = udp_conns.InitForIteration();</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <a class="code" href="classConnection.html">Connection</a>* uc;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="keywordflow">while</span> ( (uc = udp_conns.NextEntry(cookie)) )</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        mem += uc-&gt;<a class="code" href="classConnection.html#aad71fb2527db126a89f88cfae4d028d1">MemoryAllocationConnVal</a>();</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    cookie = icmp_conns.InitForIteration();</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <a class="code" href="classConnection.html">Connection</a>* ic;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="keywordflow">while</span> ( (ic = icmp_conns.NextEntry(cookie)) )</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;        mem += ic-&gt;<a class="code" href="classConnection.html#aad71fb2527db126a89f88cfae4d028d1">MemoryAllocationConnVal</a>();</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <span class="keywordflow">return</span> mem;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    }</div><div class="ttc" id="Net_8cc_html_ad34ddf7f16a2b8ba8547e4f464148077"><div class="ttname"><a href="Net_8cc.html#ad34ddf7f16a2b8ba8547e4f464148077">terminating</a></div><div class="ttdeci">bool terminating</div><div class="ttdef"><b>Definition:</b> <a href="Net_8cc_source.html#l00060">Net.cc:60</a></div></div>
<div class="ttc" id="classConnection_html_aad71fb2527db126a89f88cfae4d028d1"><div class="ttname"><a href="classConnection.html#aad71fb2527db126a89f88cfae4d028d1">Connection::MemoryAllocationConnVal</a></div><div class="ttdeci">unsigned int MemoryAllocationConnVal() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00836">Conn.cc:836</a></div></div>
<div class="ttc" id="classIterCookie_html"><div class="ttname"><a href="classIterCookie.html">IterCookie</a></div><div class="ttdef"><b>Definition:</b> <a href="Dict_8cc_source.html#l00038">Dict.cc:38</a></div></div>
<div class="ttc" id="classConnection_html"><div class="ttname"><a href="classConnection.html">Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00059">Conn.h:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5dcf5a33a113d4952c735572817f3bed"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int NetSessions::CurrentConnections </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00125">125</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">return</span> tcp_conns.Length() + udp_conns.Length() +</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            icmp_conns.Length();</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad64904c56e977fd13613138cf55e6b64"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetSessions::Done </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l00165">165</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3f3161c112a2c9fdd0dd5a2b418926e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetSessions::DoNextInnerPacket </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classPacket.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>inner</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classEncapsulationStack.html">EncapsulationStack</a> *&#160;</td>
          <td class="paramname"><em>prev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classEncapsulatingConn.html">EncapsulatingConn</a> &amp;&#160;</td>
          <td class="paramname"><em>ec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Wrapper that recurses on DoNextPacket for encapsulated IP packets.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>Network time. </td></tr>
    <tr><td class="paramname">hdr</td><td>If the outer pcap header is available, this pointer can be set so that the fake pcap header passed to DoNextPacket will use the same timeval. The caplen and len fields of the fake pcap header are always set to the TotalLength() of <em>inner</em>. </td></tr>
    <tr><td class="paramname">inner</td><td>Pointer to IP header wrapper of the inner packet, ownership of the pointer's memory is assumed by this function. </td></tr>
    <tr><td class="paramname">prev</td><td>Any previous encapsulation stack of the caller, not including the most-recently found depth of encapsulation. </td></tr>
    <tr><td class="paramname">ec</td><td>The most-recently found depth of encapsulation. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l00788">788</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    {</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> caplen, len;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    caplen = len = inner-&gt;<a class="code" href="classIP__Hdr.html#a564d7f86b1bb3b27e7f432c52d67d6db">TotalLen</a>();</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <a class="code" href="Packet_8h.html#a7b8dd9dfe5581544a3aff6615494e78d">pkt_timeval</a> ts;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keywordtype">int</span> link_type;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <a class="code" href="Packet_8h.html#a009f8fad15663c609d975eba4b4cc6e9">Layer3Proto</a> l3_proto;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordflow">if</span> ( pkt )</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        ts = pkt-&gt;<a class="code" href="classPacket.html#ac5eed9854596d4d71dfa78c148495a47">ts</a>;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        {</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        ts.tv_sec = (time_t) <a class="code" href="Net_8cc.html#aafa2480e4a23e3822f639319b8a62ef3">network_time</a>;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        ts.tv_usec = (suseconds_t)</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            ((<a class="code" href="Net_8cc.html#aafa2480e4a23e3822f639319b8a62ef3">network_time</a> - (<span class="keywordtype">double</span>)ts.tv_sec) * 1000000);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        }</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keyword">const</span> u_char* data = 0;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">if</span> ( inner-&gt;<a class="code" href="classIP__Hdr.html#afb58edf347f5ace9703948f5d5cb3c28">IP4_Hdr</a>() )</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        {</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        data = (<span class="keyword">const</span> u_char*) inner-&gt;<a class="code" href="classIP__Hdr.html#afb58edf347f5ace9703948f5d5cb3c28">IP4_Hdr</a>();</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        l3_proto = <a class="code" href="Packet_8h.html#a009f8fad15663c609d975eba4b4cc6e9a35241f77b72fe00b11180ddcd31bc803">L3_IPV4</a>;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        }</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        {</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        data = (<span class="keyword">const</span> u_char*) inner-&gt;<a class="code" href="classIP__Hdr.html#a6f98ec8e4202eeb186928f7fd00e2d43">IP6_Hdr</a>();</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        l3_proto = <a class="code" href="Packet_8h.html#a009f8fad15663c609d975eba4b4cc6e9aeff6ddd2c7304a21cee15a6abb40d4af">L3_IPV6</a>;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        }</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <a class="code" href="classEncapsulationStack.html">EncapsulationStack</a>* outer = prev ?</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            <span class="keyword">new</span> <a class="code" href="classEncapsulationStack.html">EncapsulationStack</a>(*prev) : new EncapsulationStack();</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    outer-&gt;<a class="code" href="classEncapsulationStack.html#ad1f062175da64abfd1f6a1f7fb27c824">Add</a>(ec);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="comment">// Construct fake packet for DoNextPacket</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <a class="code" href="classPacket.html">Packet</a> p;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    p.<a class="code" href="classPacket.html#a680bb7b7e3cc666af6e3469384add363">Init</a>(DLT_RAW, &amp;ts, caplen, len, data, <span class="keyword">false</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <a class="code" href="classNetSessions.html#aa9e7d4c9ca9f04b797f8090bc88f37cc">DoNextPacket</a>(t, &amp;p, inner, outer);</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keyword">delete</span> inner;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keyword">delete</span> outer;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    }</div><div class="ttc" id="classPacket_html_ac5eed9854596d4d71dfa78c148495a47"><div class="ttname"><a href="classPacket.html#ac5eed9854596d4d71dfa78c148495a47">Packet::ts</a></div><div class="ttdeci">pkt_timeval ts</div><div class="ttdoc">Timestamp reconstituted as float. </div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00165">Packet.h:165</a></div></div>
<div class="ttc" id="Packet_8h_html_a009f8fad15663c609d975eba4b4cc6e9"><div class="ttname"><a href="Packet_8h.html#a009f8fad15663c609d975eba4b4cc6e9">Layer3Proto</a></div><div class="ttdeci">Layer3Proto</div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00018">Packet.h:18</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a564d7f86b1bb3b27e7f432c52d67d6db"><div class="ttname"><a href="classIP__Hdr.html#a564d7f86b1bb3b27e7f432c52d67d6db">IP_Hdr::TotalLen</a></div><div class="ttdeci">uint32 TotalLen() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00473">IP.h:473</a></div></div>
<div class="ttc" id="classNetSessions_html_aa9e7d4c9ca9f04b797f8090bc88f37cc"><div class="ttname"><a href="classNetSessions.html#aa9e7d4c9ca9f04b797f8090bc88f37cc">NetSessions::DoNextPacket</a></div><div class="ttdeci">void DoNextPacket(double t, const Packet *pkt, const IP_Hdr *ip_hdr, const EncapsulationStack *encapsulation)</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l00318">Sessions.cc:318</a></div></div>
<div class="ttc" id="classPacket_html_a680bb7b7e3cc666af6e3469384add363"><div class="ttname"><a href="classPacket.html#a680bb7b7e3cc666af6e3469384add363">Packet::Init</a></div><div class="ttdeci">void Init(int link_type, pkt_timeval *ts, uint32 caplen, uint32 len, const u_char *data, int copy=false, std::string tag=std::string(&quot;&quot;))</div><div class="ttdef"><b>Definition:</b> <a href="Packet_8cc_source.html#l00019">Packet.cc:19</a></div></div>
<div class="ttc" id="Packet_8h_html_a009f8fad15663c609d975eba4b4cc6e9aeff6ddd2c7304a21cee15a6abb40d4af"><div class="ttname"><a href="Packet_8h.html#a009f8fad15663c609d975eba4b4cc6e9aeff6ddd2c7304a21cee15a6abb40d4af">L3_IPV6</a></div><div class="ttdoc">Layer 3 is IPv4. </div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00021">Packet.h:21</a></div></div>
<div class="ttc" id="Packet_8h_html_a009f8fad15663c609d975eba4b4cc6e9a35241f77b72fe00b11180ddcd31bc803"><div class="ttname"><a href="Packet_8h.html#a009f8fad15663c609d975eba4b4cc6e9a35241f77b72fe00b11180ddcd31bc803">L3_IPV4</a></div><div class="ttdoc">Layer 3 type could not be determined. </div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00020">Packet.h:20</a></div></div>
<div class="ttc" id="Net_8cc_html_aafa2480e4a23e3822f639319b8a62ef3"><div class="ttname"><a href="Net_8cc.html#aafa2480e4a23e3822f639319b8a62ef3">network_time</a></div><div class="ttdeci">double network_time</div><div class="ttdef"><b>Definition:</b> <a href="Net_8cc_source.html#l00054">Net.cc:54</a></div></div>
<div class="ttc" id="classEncapsulationStack_html_ad1f062175da64abfd1f6a1f7fb27c824"><div class="ttname"><a href="classEncapsulationStack.html#ad1f062175da64abfd1f6a1f7fb27c824">EncapsulationStack::Add</a></div><div class="ttdeci">void Add(const EncapsulatingConn &amp;c)</div><div class="ttdef"><b>Definition:</b> <a href="TunnelEncapsulation_8h_source.html#l00156">TunnelEncapsulation.h:156</a></div></div>
<div class="ttc" id="Packet_8h_html_a7b8dd9dfe5581544a3aff6615494e78d"><div class="ttname"><a href="Packet_8h.html#a7b8dd9dfe5581544a3aff6615494e78d">pkt_timeval</a></div><div class="ttdeci">struct timeval pkt_timeval</div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00012">Packet.h:12</a></div></div>
<div class="ttc" id="classPacket_html"><div class="ttname"><a href="classPacket.html">Packet</a></div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00034">Packet.h:34</a></div></div>
<div class="ttc" id="classIP__Hdr_html_afb58edf347f5ace9703948f5d5cb3c28"><div class="ttname"><a href="classIP__Hdr.html#afb58edf347f5ace9703948f5d5cb3c28">IP_Hdr::IP4_Hdr</a></div><div class="ttdeci">const struct ip * IP4_Hdr() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00394">IP.h:394</a></div></div>
<div class="ttc" id="classEncapsulationStack_html"><div class="ttname"><a href="classEncapsulationStack.html">EncapsulationStack</a></div><div class="ttdef"><b>Definition:</b> <a href="TunnelEncapsulation_8h_source.html#l00121">TunnelEncapsulation.h:121</a></div></div>
<div class="ttc" id="util_8h_html_acbd4acd0d29e2d6c43104827f77d9cd2"><div class="ttname"><a href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00064">util.h:64</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a6f98ec8e4202eeb186928f7fd00e2d43"><div class="ttname"><a href="classIP__Hdr.html#a6f98ec8e4202eeb186928f7fd00e2d43">IP_Hdr::IP6_Hdr</a></div><div class="ttdeci">const struct ip6_hdr * IP6_Hdr() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00399">IP.h:399</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa9e7d4c9ca9f04b797f8090bc88f37cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetSessions::DoNextPacket </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classPacket.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>ip_hdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classEncapsulationStack.html">EncapsulationStack</a> *&#160;</td>
          <td class="paramname"><em>encapsulation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l00318">318</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    {</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> caplen = pkt-&gt;<a class="code" href="classPacket.html#ac0d8af22ea8d9a67d4952241d95d4a0d">cap_len</a> - pkt-&gt;<a class="code" href="classPacket.html#a394c54942ec7d3c8c5aeae5b5afe6560">hdr_size</a>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span>ip* ip4 = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#afb58edf347f5ace9703948f5d5cb3c28">IP4_Hdr</a>();</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> len = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a564d7f86b1bb3b27e7f432c52d67d6db">TotalLen</a>();</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">if</span> ( len == 0 )</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="comment">// TCP segmentation offloading can zero out the ip_len field.</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;ip_hdr_len_zero&quot;</span>, pkt, encapsulation);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="comment">// Cope with the zero&#39;d out ip_len field by using the caplen.</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        len = pkt-&gt;<a class="code" href="classPacket.html#ac0d8af22ea8d9a67d4952241d95d4a0d">cap_len</a> - pkt-&gt;<a class="code" href="classPacket.html#a394c54942ec7d3c8c5aeae5b5afe6560">hdr_size</a>;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        }</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">if</span> ( pkt-&gt;<a class="code" href="classPacket.html#a98bbeb102dbb9788c434fbcfaada52f0">len</a> &lt; len + pkt-&gt;<a class="code" href="classPacket.html#a394c54942ec7d3c8c5aeae5b5afe6560">hdr_size</a> )</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;truncated_IP&quot;</span>, pkt, encapsulation);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        }</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">// For both of these it is safe to pass ip_hdr because the presence</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// is guaranteed for the functions that pass data to us.</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a> ip_hdr_len = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a86ccf5d09d6e00dc0229b065ffda3ed6">HdrLen</a>();</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">if</span> ( ip_hdr_len &gt; len )</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;invalid_IP_header_size&quot;</span>, ip_hdr, encapsulation);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">if</span> ( ip_hdr_len &gt; caplen )</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;internally_truncated_header&quot;</span>, ip_hdr, encapsulation);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        }</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// Ignore if packet matches packet filter.</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="classNetSessions.html#af1e4a540b075b3fc41bc2d74faf14373">packet_filter</a> &amp;&amp; <a class="code" href="classNetSessions.html#af1e4a540b075b3fc41bc2d74faf14373">packet_filter</a>-&gt;<a class="code" href="classPacketFilter.html#ad1b04f9afdbbf3bf1d25f23c95807a7b">Match</a>(ip_hdr, len, caplen) )</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">if</span> ( ! <a class="code" href="NetVar_8cc.html#a9bbf0baaee40c7cc0033ff2bacad5fb7">ignore_checksums</a> &amp;&amp; ip4 &amp;&amp;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;         <a class="code" href="net__util_8cc.html#a1fa292138b3efe46f399c93a156b198b">ones_complement_checksum</a>((<span class="keywordtype">void</span>*) ip4, ip_hdr_len, 0) != 0xffff )</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        {</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;bad_IP_checksum&quot;</span>, pkt, encapsulation);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        }</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="classNetSessions.html#a8249bf085beaed0edf1d054a929d7ae9">discarder</a> &amp;&amp; <a class="code" href="classNetSessions.html#a8249bf085beaed0edf1d054a929d7ae9">discarder</a>-&gt;<a class="code" href="classDiscarder.html#a0c901b5fd68e28117e3815589fe7ae20">NextPacket</a>(ip_hdr, len, caplen) )</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <a class="code" href="classFragReassembler.html">FragReassembler</a>* f = 0;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">if</span> ( ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a197e626c8b127b00932706021fe68f5e">IsFragment</a>() )</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <a class="code" href="classNetSessions.html#abb38b95e4eae2b4ecb38e1bb481e2522">dump_this_packet</a> = 1;   <span class="comment">// always record fragments</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordflow">if</span> ( caplen &lt; len )</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            {</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;incompletely_captured_fragment&quot;</span>, ip_hdr, encapsulation);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            <span class="comment">// Don&#39;t try to reassemble, that&#39;s doomed.</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="comment">// Discard all except the first fragment (which</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <span class="comment">// is useful in analyzing header-only traces)</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            <span class="keywordflow">if</span> ( ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a643c8d91bcd09a904501d9959748a3e9">FragOffset</a>() != 0 )</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            }</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            {</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            f = <a class="code" href="classNetSessions.html#a83c4d484f576c82038cea5cd91f7f552">NextFragment</a>(t, ip_hdr, pkt-&gt;<a class="code" href="classPacket.html#aa1f4f749e6ed1c424ff6da4efe814fc9">data</a> + pkt-&gt;<a class="code" href="classPacket.html#a394c54942ec7d3c8c5aeae5b5afe6560">hdr_size</a>);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            <span class="keyword">const</span> <a class="code" href="classIP__Hdr.html">IP_Hdr</a>* ih = f-&gt;<a class="code" href="classFragReassembler.html#aa92cc4cd7847475ed6a226bf4761c771">ReassembledPkt</a>();</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            <span class="keywordflow">if</span> ( ! ih )</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                <span class="comment">// It didn&#39;t reassemble into anything yet.</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            ip4 = ih-&gt;<a class="code" href="classIP__Hdr.html#afb58edf347f5ace9703948f5d5cb3c28">IP4_Hdr</a>();</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            ip_hdr = ih;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            caplen = len = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a564d7f86b1bb3b27e7f432c52d67d6db">TotalLen</a>();</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            ip_hdr_len = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a86ccf5d09d6e00dc0229b065ffda3ed6">HdrLen</a>();</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <span class="keywordflow">if</span> ( ip_hdr_len &gt; len )</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;invalid_IP_header_size&quot;</span>, ip_hdr, encapsulation);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            }</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        }</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="classFragReassemblerTracker.html">FragReassemblerTracker</a> frt(<span class="keyword">this</span>, f);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    len -= ip_hdr_len;  <span class="comment">// remove IP header</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    caplen -= ip_hdr_len;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">// We stop building the chain when seeing IPPROTO_ESP so if it&#39;s</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">// there, it&#39;s always the last.</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">if</span> ( ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#ae0bb85b14ebaa65bd0889171d46c04e8">LastHeader</a>() == IPPROTO_ESP )</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <a class="code" href="classNetSessions.html#abb38b95e4eae2b4ecb38e1bb481e2522">dump_this_packet</a> = 1;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keywordflow">if</span> ( esp_packet )</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            {</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            val_list* vl = <span class="keyword">new</span> val_list();</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            vl-&gt;append(ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a0da7bf24230ff8cb5a6e997c82c6ffbd">BuildPktHdrVal</a>());</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <a class="code" href="Event_8cc.html#ab301a03781c6c07cacb1f9cb07214b83">mgr</a>.<a class="code" href="classEventMgr.html#a5f91cb07c02ed60fb39e65147af322b7">QueueEvent</a>(esp_packet, vl);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="comment">// Can&#39;t do more since upper-layer payloads are going to be encrypted.</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="preprocessor">#ifdef ENABLE_MOBILE_IPV6</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">// We stop building the chain when seeing IPPROTO_MOBILITY so it&#39;s always</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">// last if present.</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">if</span> ( ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#ae0bb85b14ebaa65bd0889171d46c04e8">LastHeader</a>() == IPPROTO_MOBILITY )</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        {</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <a class="code" href="classNetSessions.html#abb38b95e4eae2b4ecb38e1bb481e2522">dump_this_packet</a> = 1;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="NetVar_8cc.html#a9bbf0baaee40c7cc0033ff2bacad5fb7">ignore_checksums</a> &amp;&amp; mobility_header_checksum(ip_hdr) != 0xffff )</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;bad_MH_checksum&quot;</span>, pkt, encapsulation);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            }</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">if</span> ( mobile_ipv6_message )</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            val_list* vl = <span class="keyword">new</span> val_list();</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            vl-&gt;append(ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a0da7bf24230ff8cb5a6e997c82c6ffbd">BuildPktHdrVal</a>());</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <a class="code" href="Event_8cc.html#ab301a03781c6c07cacb1f9cb07214b83">mgr</a>.<a class="code" href="classEventMgr.html#a5f91cb07c02ed60fb39e65147af322b7">QueueEvent</a>(mobile_ipv6_message, vl);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordflow">if</span> ( ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a7ec0fdb8132b43b74a16bfef5c7b851e">NextProto</a>() != IPPROTO_NONE )</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;mobility_piggyback&quot;</span>, pkt, encapsulation);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        }</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordtype">int</span> proto = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a7ec0fdb8132b43b74a16bfef5c7b851e">NextProto</a>();</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="classNetSessions.html#acad75ee2d3507036e5ef35d1374de67d">CheckHeaderTrunc</a>(proto, len, caplen, pkt, encapsulation) )</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keyword">const</span> u_char* data = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a952385246a37590fdb72db6d291c76e1">Payload</a>();</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="structConnID.html">ConnID</a> id;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordtype">id</span>.<a class="code" href="structConnID.html#ab31d61d52f47a05528fc220c295d6f29">src_addr</a> = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a8256bb033063a8e8034beb36bc3bff5c">SrcAddr</a>();</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordtype">id</span>.dst_addr = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a5c09f4d749016bc3cf3dbee8a048bcfc">DstAddr</a>();</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <a class="code" href="classDictionary.html">Dictionary</a>* d = 0;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <a class="code" href="namespaceplugin_1_1component.html#ad40aa2fc2c79c814dfb2a971e93ce86d">BifEnum::Tunnel::Type</a> tunnel_type = BifEnum::Tunnel::IP;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">switch</span> ( proto ) {</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">case</span> IPPROTO_TCP:</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        {</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span>tcphdr* tp = (<span class="keyword">const</span> <span class="keyword">struct </span>tcphdr *) data;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordtype">id</span>.src_port = tp-&gt;th_sport;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordtype">id</span>.dst_port = tp-&gt;th_dport;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="keywordtype">id</span>.is_one_way = 0;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        d = &amp;tcp_conns;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">case</span> IPPROTO_UDP:</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        {</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span>udphdr* up = (<span class="keyword">const</span> <span class="keyword">struct </span>udphdr *) data;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="keywordtype">id</span>.src_port = up-&gt;uh_sport;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="keywordtype">id</span>.dst_port = up-&gt;uh_dport;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="keywordtype">id</span>.is_one_way = 0;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        d = &amp;udp_conns;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">case</span> IPPROTO_ICMP:</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span>icmp* icmpp = (<span class="keyword">const</span> <span class="keyword">struct </span>icmp *) data;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordtype">id</span>.src_port = icmpp-&gt;icmp_type;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="keywordtype">id</span>.dst_port = <a class="code" href="namespaceanalyzer_1_1icmp.html#af3fc0c0e38a9e6478131b96dcef47efa">analyzer::icmp::ICMP4_counterpart</a>(icmpp-&gt;icmp_type,</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                icmpp-&gt;icmp_code,</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                                <span class="keywordtype">id</span>.is_one_way);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keywordtype">id</span>.src_port = htons(<span class="keywordtype">id</span>.src_port);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keywordtype">id</span>.dst_port = htons(<span class="keywordtype">id</span>.dst_port);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        d = &amp;icmp_conns;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        }</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">case</span> IPPROTO_ICMPV6:</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        {</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span>icmp* icmpp = (<span class="keyword">const</span> <span class="keyword">struct </span>icmp *) data;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="keywordtype">id</span>.src_port = icmpp-&gt;icmp_type;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keywordtype">id</span>.dst_port = <a class="code" href="namespaceanalyzer_1_1icmp.html#acdbd9cf674f0f6f4ebea24b04de2ed6e">analyzer::icmp::ICMP6_counterpart</a>(icmpp-&gt;icmp_type,</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                icmpp-&gt;icmp_code,</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                <span class="keywordtype">id</span>.is_one_way);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keywordtype">id</span>.src_port = htons(<span class="keywordtype">id</span>.src_port);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordtype">id</span>.dst_port = htons(<span class="keywordtype">id</span>.dst_port);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        d = &amp;icmp_conns;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        }</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">case</span> IPPROTO_GRE:</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        {</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordflow">if</span> ( ! BifConst::Tunnel::enable_gre )</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            {</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;GRE_tunnel&quot;</span>, ip_hdr, encapsulation);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            }</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <a class="code" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a> flags_ver = ntohs(*((<a class="code" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a>*)(data + 0)));</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <a class="code" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a> proto_typ = ntohs(*((<a class="code" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a>*)(data + 2)));</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="keywordtype">int</span> gre_version = flags_ver &amp; 0x0007;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="comment">// If a carried packet has ethernet, this will help skip it.</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> eth_len = 0;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> gre_len = <a class="code" href="Sessions_8cc.html#a2a7732ddcad8e107d1c0d888f3e4c1e9">gre_header_len</a>(flags_ver);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ppp_len = gre_version == 1 ? 4 : 0;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keywordflow">if</span> ( gre_version != 0 &amp;&amp; gre_version != 1 )</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            {</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<a class="code" href="util_8cc.html#acd55da5095039a6a84317688425cac72">fmt</a>(<span class="stringliteral">&quot;unknown_gre_version_%d&quot;</span>, gre_version), ip_hdr,</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                  encapsulation);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            }</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="keywordflow">if</span> ( gre_version == 0 )</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            <span class="keywordflow">if</span> ( proto_typ == 0x6558 &amp;&amp; len &gt; gre_len + 14 )</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                {</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                <span class="comment">// transparent ethernet bridging</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                eth_len = 14;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                proto_typ = ntohs(*((<a class="code" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a>*)(data + gre_len + 12)));</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                }</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <span class="keywordflow">if</span> ( proto_typ == 0x0800 )</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                proto = IPPROTO_IPV4;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( proto_typ == 0x86dd )</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                proto = IPPROTO_IPV6;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                {</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                <span class="comment">// Not IPv4/IPv6 payload.</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<a class="code" href="util_8cc.html#acd55da5095039a6a84317688425cac72">fmt</a>(<span class="stringliteral">&quot;unknown_gre_protocol_%&quot;</span> PRIu16, proto_typ), ip_hdr,</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                      encapsulation);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                }</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            }</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="keywordflow">else</span> <span class="comment">// gre_version == 1</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            {</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            <span class="keywordflow">if</span> ( proto_typ != 0x880b )</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                {</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                <span class="comment">// Enhanced GRE payload must be PPP.</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;egre_protocol_type&quot;</span>, ip_hdr, encapsulation);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                }</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keywordflow">if</span> ( flags_ver &amp; 0x4000 )</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            {</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <span class="comment">// RFC 2784 deprecates the variable length routing field</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <span class="comment">// specified by RFC 1701. It could be parsed here, but easiest</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            <span class="comment">// to just skip for now.</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;gre_routing&quot;</span>, ip_hdr, encapsulation);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            }</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <span class="keywordflow">if</span> ( flags_ver &amp; 0x0078 )</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            {</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            <span class="comment">// Expect last 4 bits of flags are reserved, undefined.</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;unknown_gre_flags&quot;</span>, ip_hdr, encapsulation);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            }</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="keywordflow">if</span> ( len &lt; gre_len + ppp_len + eth_len || caplen &lt; gre_len + ppp_len + eth_len )</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            {</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;truncated_GRE&quot;</span>, ip_hdr, encapsulation);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            }</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordflow">if</span> ( gre_version == 1 )</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            {</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            <a class="code" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a> ppp_proto = ntohs(*((<a class="code" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a>*)(data + gre_len + 2)));</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="keywordflow">if</span> ( ppp_proto != 0x0021 &amp;&amp; ppp_proto != 0x0057 )</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                {</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;non_ip_packet_in_encap&quot;</span>, ip_hdr, encapsulation);</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                }</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            proto = (ppp_proto == 0x0021) ? IPPROTO_IPV4 : IPPROTO_IPV6;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            }</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        data += gre_len + ppp_len + eth_len;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        len -= gre_len + ppp_len + eth_len;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        caplen -= gre_len + ppp_len + eth_len;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="comment">// Treat GRE tunnel like IP tunnels, fallthrough to logic below now</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="comment">// that GRE header is stripped and only payload packet remains.</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="comment">// The only thing different is the tunnel type enum value to use.</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        tunnel_type = BifEnum::Tunnel::GRE;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        }</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">case</span> IPPROTO_IPV4:</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordflow">case</span> IPPROTO_IPV6:</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        {</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keywordflow">if</span> ( ! BifConst::Tunnel::enable_ip )</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            {</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;IP_tunnel&quot;</span>, ip_hdr, encapsulation);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            }</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="keywordflow">if</span> ( encapsulation &amp;&amp;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;             encapsulation-&gt;<a class="code" href="classEncapsulationStack.html#a4a1fffb3d4e01e58d9f80f2d6aa44992">Depth</a>() &gt;= BifConst::Tunnel::max_depth )</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            {</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;exceeded_tunnel_max_depth&quot;</span>, ip_hdr, encapsulation);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            }</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="comment">// Check for a valid inner packet first.</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <a class="code" href="classIP__Hdr.html">IP_Hdr</a>* inner = 0;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="keywordtype">int</span> result = <a class="code" href="classNetSessions.html#a8566b0fbe1879eb0508039f2e3edb5bd">ParseIPPacket</a>(caplen, data, proto, inner);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <span class="keywordflow">if</span> ( result == -2 )</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;invalid_inner_IP_version&quot;</span>, ip_hdr, encapsulation);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( result &lt; 0 )</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;truncated_inner_IP&quot;</span>, ip_hdr, encapsulation);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( result &gt; 0 )</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;inner_IP_payload_length_mismatch&quot;</span>, ip_hdr, encapsulation);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <span class="keywordflow">if</span> ( result != 0 )</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            {</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            <span class="keyword">delete</span> inner;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            }</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="comment">// Look up to see if we&#39;ve already seen this IP tunnel, identified</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="comment">// by the pair of IP addresses, so that we can always associate the</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="comment">// same UID with it.</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <a class="code" href="classNetSessions.html#ab7675fcc36494512228d1c3a282d22ce">IPPair</a> tunnel_idx;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="keywordflow">if</span> ( ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a8256bb033063a8e8034beb36bc3bff5c">SrcAddr</a>() &lt; ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a5c09f4d749016bc3cf3dbee8a048bcfc">DstAddr</a>() )</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            tunnel_idx = <a class="code" href="classNetSessions.html#ab7675fcc36494512228d1c3a282d22ce">IPPair</a>(ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a8256bb033063a8e8034beb36bc3bff5c">SrcAddr</a>(), ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a5c09f4d749016bc3cf3dbee8a048bcfc">DstAddr</a>());</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            tunnel_idx = <a class="code" href="classNetSessions.html#ab7675fcc36494512228d1c3a282d22ce">IPPair</a>(ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a5c09f4d749016bc3cf3dbee8a048bcfc">DstAddr</a>(), ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a8256bb033063a8e8034beb36bc3bff5c">SrcAddr</a>());</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        IPTunnelMap::iterator it = <a class="code" href="classNetSessions.html#ae2d46a6940ab5c04945729f85c5aa6fa">ip_tunnels</a>.find(tunnel_idx);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="keywordflow">if</span> ( it == <a class="code" href="classNetSessions.html#ae2d46a6940ab5c04945729f85c5aa6fa">ip_tunnels</a>.end() )</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <a class="code" href="classEncapsulatingConn.html">EncapsulatingConn</a> ec(ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a8256bb033063a8e8034beb36bc3bff5c">SrcAddr</a>(), ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a5c09f4d749016bc3cf3dbee8a048bcfc">DstAddr</a>(),</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                                 tunnel_type);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            <a class="code" href="classNetSessions.html#ae2d46a6940ab5c04945729f85c5aa6fa">ip_tunnels</a>[tunnel_idx] = <a class="code" href="classNetSessions.html#a14cbb326c4dc8196cced2706925cf0f9">TunnelActivity</a>(ec, <a class="code" href="Net_8cc.html#aafa2480e4a23e3822f639319b8a62ef3">network_time</a>);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            <a class="code" href="main_8cc.html#a36d412e0f4c6a9403bf08b697828e16b">timer_mgr</a>-&gt;<a class="code" href="classTimerMgr.html#aa84391d9c69cee2285928e873ed846fe">Add</a>(<span class="keyword">new</span> <a class="code" href="classNetSessions.html#a46461efab16220523fa26f185e7daadb">IPTunnelTimer</a>(<a class="code" href="Net_8cc.html#aafa2480e4a23e3822f639319b8a62ef3">network_time</a>, tunnel_idx));</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            }</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            it-&gt;second.second = <a class="code" href="Net_8cc.html#aafa2480e4a23e3822f639319b8a62ef3">network_time</a>;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <a class="code" href="classNetSessions.html#a3f3161c112a2c9fdd0dd5a2b418926e0">DoNextInnerPacket</a>(t, pkt, inner, encapsulation,</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                          ip_tunnels[tunnel_idx].first);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        }</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordflow">case</span> IPPROTO_NONE:</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        {</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <span class="comment">// If the packet is encapsulated in Teredo, then it was a bubble and</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="comment">// the Teredo analyzer may have raised an event for that, else we&#39;re</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <span class="comment">// not sure the reason for the No Next header in the packet.</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordflow">if</span> ( ! ( encapsulation &amp;&amp;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;             encapsulation-&gt;<a class="code" href="classEncapsulationStack.html#aa8424f24d54c7071d2ec43678cee87a9">LastType</a>() == BifEnum::Tunnel::TEREDO ) )</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;ipv6_no_next&quot;</span>, pkt);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        }</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<a class="code" href="util_8cc.html#acd55da5095039a6a84317688425cac72">fmt</a>(<span class="stringliteral">&quot;unknown_protocol_%d&quot;</span>, proto), pkt, encapsulation);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    }</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <a class="code" href="classHashKey.html">HashKey</a>* h = <a class="code" href="IPAddr_8cc.html#a22e65999823d6fe15637ee48bb81c8e2">BuildConnIDHashKey</a>(<span class="keywordtype">id</span>);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordflow">if</span> ( ! h )</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <a class="code" href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a>-&gt;<a class="code" href="classReporter.html#a1820e1da136fa37d8c7561b5a831392d">InternalError</a>(<span class="stringliteral">&quot;hash computation failed&quot;</span>);</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <a class="code" href="classConnection.html">Connection</a>* conn = 0;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">// FIXME: The following is getting pretty complex. Need to split up</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="comment">// into separate functions.</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    conn = (<a class="code" href="classConnection.html">Connection</a>*) d-&gt;<a class="code" href="classDictionary.html#a6cc32b90c020a4d9094d37265b4d15db">Lookup</a>(h);</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordflow">if</span> ( ! conn )</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        {</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        conn = <a class="code" href="classNetSessions.html#ad3965a2f68ea9c8cdd2b7c729af33720">NewConn</a>(h, t, &amp;<span class="keywordtype">id</span>, data, proto, ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#af63ed1a463e01d55db6c1cf2b336e359">FlowLabel</a>(), pkt, encapsulation);</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="keywordflow">if</span> ( conn )</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            d-&gt;<a class="code" href="classDictionary.html#ab9d46308fc8f399f0d7653f73d6c5bf8">Insert</a>(h, conn);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        }</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        {</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="comment">// We already know that connection.</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="keywordtype">int</span> consistent = <a class="code" href="classNetSessions.html#a8e1b9845ff7597ff1e44c67d6139173a">CheckConnectionTag</a>(conn);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="keywordflow">if</span> ( consistent &lt; 0 )</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            {</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            <span class="keyword">delete</span> h;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            }</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="keywordflow">if</span> ( ! consistent || conn-&gt;<a class="code" href="classConnection.html#a0e657fdaf9a05ec4f0fb9499173f5ace">IsReuse</a>(t, data) )</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            {</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            <span class="keywordflow">if</span> ( consistent )</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                conn-&gt;<a class="code" href="classConnection.html#ae8480aebbcac15331efe7a1591eaaca8">Event</a>(connection_reused, 0);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            <a class="code" href="classNetSessions.html#a1c8b3c4f33f8932e3ba6914b9cec52c3">Remove</a>(conn);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            conn = <a class="code" href="classNetSessions.html#ad3965a2f68ea9c8cdd2b7c729af33720">NewConn</a>(h, t, &amp;<span class="keywordtype">id</span>, data, proto, ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#af63ed1a463e01d55db6c1cf2b336e359">FlowLabel</a>(), pkt, encapsulation);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            <span class="keywordflow">if</span> ( conn )</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                d-&gt;<a class="code" href="classDictionary.html#ab9d46308fc8f399f0d7653f73d6c5bf8">Insert</a>(h, conn);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            }</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            {</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            <span class="keyword">delete</span> h;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            conn-&gt;<a class="code" href="classConnection.html#a6544135de28d0596a46a069aab3797dd">CheckEncapsulation</a>(encapsulation);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            }</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        }</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordflow">if</span> ( ! conn )</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        {</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="keyword">delete</span> h;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        }</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordtype">int</span> record_packet = 1;  <span class="comment">// whether to record the packet at all</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordtype">int</span> record_content = 1; <span class="comment">// whether to record its data</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordtype">int</span> is_orig = (<span class="keywordtype">id</span>.src_addr == conn-&gt;<a class="code" href="classConnection.html#a2807492e6d4a7e525082873aa3a06ba1">OrigAddr</a>()) &amp;&amp;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            (<span class="keywordtype">id</span>.src_port == conn-&gt;<a class="code" href="classConnection.html#a9df9d1798854bd69944e838de68ed136">OrigPort</a>());</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    conn-&gt;<a class="code" href="classConnection.html#a5f459c677c449b4209d00085d2a0c975">CheckFlowLabel</a>(is_orig, ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#af63ed1a463e01d55db6c1cf2b336e359">FlowLabel</a>());</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <a class="code" href="classVal.html">Val</a>* pkt_hdr_val = 0;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordflow">if</span> ( ipv6_ext_headers &amp;&amp; ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a90d5a84e4a15a16c4fae107ec8664866">NumHeaders</a>() &gt; 1 )</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        {</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        pkt_hdr_val = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a0da7bf24230ff8cb5a6e997c82c6ffbd">BuildPktHdrVal</a>();</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        conn-&gt;<a class="code" href="classConnection.html#ae8480aebbcac15331efe7a1591eaaca8">Event</a>(ipv6_ext_headers, 0, pkt_hdr_val);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        }</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordflow">if</span> ( new_packet )</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        conn-&gt;<a class="code" href="classConnection.html#ae8480aebbcac15331efe7a1591eaaca8">Event</a>(new_packet, 0,</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                pkt_hdr_val ? pkt_hdr_val-&gt;<a class="code" href="classVal.html#a20bda9245d8259a400c7b7cba4168a50">Ref</a>() : ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a0da7bf24230ff8cb5a6e997c82c6ffbd">BuildPktHdrVal</a>());</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    conn-&gt;<a class="code" href="classConnection.html#aecfad0032fdfca27c44349f0718b2924">NextPacket</a>(t, is_orig, ip_hdr, len, caplen, data,</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                record_packet, record_content, pkt);</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordflow">if</span> ( f )</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        {</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="comment">// Above we already recorded the fragment in its entirety.</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        f-&gt;<a class="code" href="classFragReassembler.html#ada2e97f056bf68d023511ca7ccc2cda8">DeleteTimer</a>();</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( record_packet )</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        {</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <span class="keywordflow">if</span> ( record_content )</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            <a class="code" href="classNetSessions.html#abb38b95e4eae2b4ecb38e1bb481e2522">dump_this_packet</a> = 1;   <span class="comment">// save the whole thing</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            {</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            <span class="keywordtype">int</span> hdr_len = data - pkt-&gt;<a class="code" href="classPacket.html#aa1f4f749e6ed1c424ff6da4efe814fc9">data</a>;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            <a class="code" href="classNetSessions.html#ab8a81976f7c6230a5d8f0e50d6cda708">DumpPacket</a>(pkt, hdr_len);   <span class="comment">// just save the header</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            }</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        }</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    }</div><div class="ttc" id="classIP__Hdr_html_a8256bb033063a8e8034beb36bc3bff5c"><div class="ttname"><a href="classIP__Hdr.html#a8256bb033063a8e8034beb36bc3bff5c">IP_Hdr::SrcAddr</a></div><div class="ttdeci">IPAddr SrcAddr() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00418">IP.h:418</a></div></div>
<div class="ttc" id="classNetSessions_html_af1e4a540b075b3fc41bc2d74faf14373"><div class="ttname"><a href="classNetSessions.html#af1e4a540b075b3fc41bc2d74faf14373">NetSessions::packet_filter</a></div><div class="ttdeci">PacketFilter * packet_filter</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00243">Sessions.h:243</a></div></div>
<div class="ttc" id="structConnID_html"><div class="ttname"><a href="structConnID.html">ConnID</a></div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00043">Conn.h:43</a></div></div>
<div class="ttc" id="NetVar_8cc_html_a9bbf0baaee40c7cc0033ff2bacad5fb7"><div class="ttname"><a href="NetVar_8cc.html#a9bbf0baaee40c7cc0033ff2bacad5fb7">ignore_checksums</a></div><div class="ttdeci">int ignore_checksums</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00035">NetVar.cc:35</a></div></div>
<div class="ttc" id="classConnection_html_ae8480aebbcac15331efe7a1591eaaca8"><div class="ttname"><a href="classConnection.html#ae8480aebbcac15331efe7a1591eaaca8">Connection::Event</a></div><div class="ttdeci">void Event(EventHandlerPtr f, analyzer::Analyzer *analyzer, const char *name=0)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00682">Conn.cc:682</a></div></div>
<div class="ttc" id="classTimerMgr_html_aa84391d9c69cee2285928e873ed846fe"><div class="ttname"><a href="classTimerMgr.html#aa84391d9c69cee2285928e873ed846fe">TimerMgr::Add</a></div><div class="ttdeci">virtual void Add(Timer *timer)=0</div></div>
<div class="ttc" id="classVal_html_a20bda9245d8259a400c7b7cba4168a50"><div class="ttname"><a href="classVal.html#a20bda9245d8259a400c7b7cba4168a50">Val::Ref</a></div><div class="ttdeci">Val * Ref()</div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00159">Val.h:159</a></div></div>
<div class="ttc" id="classVal_html"><div class="ttname"><a href="classVal.html">Val</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00078">Val.h:78</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a952385246a37590fdb72db6d291c76e1"><div class="ttname"><a href="classIP__Hdr.html#a952385246a37590fdb72db6d291c76e1">IP_Hdr::Payload</a></div><div class="ttdeci">const u_char * Payload() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00434">IP.h:434</a></div></div>
<div class="ttc" id="classFragReassembler_html_ada2e97f056bf68d023511ca7ccc2cda8"><div class="ttname"><a href="classFragReassembler.html#ada2e97f056bf68d023511ca7ccc2cda8">FragReassembler::DeleteTimer</a></div><div class="ttdeci">void DeleteTimer()</div><div class="ttdef"><b>Definition:</b> <a href="Frag_8cc_source.html#l00316">Frag.cc:316</a></div></div>
<div class="ttc" id="classNetSessions_html_acad75ee2d3507036e5ef35d1374de67d"><div class="ttname"><a href="classNetSessions.html#acad75ee2d3507036e5ef35d1374de67d">NetSessions::CheckHeaderTrunc</a></div><div class="ttdeci">bool CheckHeaderTrunc(int proto, uint32 len, uint32 caplen, const Packet *pkt, const EncapsulationStack *encap)</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l00872">Sessions.cc:872</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a197e626c8b127b00932706021fe68f5e"><div class="ttname"><a href="classIP__Hdr.html#a197e626c8b127b00932706021fe68f5e">IP_Hdr::IsFragment</a></div><div class="ttdeci">bool IsFragment() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00523">IP.h:523</a></div></div>
<div class="ttc" id="namespaceplugin_1_1component_html_ad40aa2fc2c79c814dfb2a971e93ce86d"><div class="ttname"><a href="namespaceplugin_1_1component.html#ad40aa2fc2c79c814dfb2a971e93ce86d">plugin::component::Type</a></div><div class="ttdeci">Type</div><div class="ttdef"><b>Definition:</b> <a href="plugin_2Component_8h_source.html#l00017">Component.h:17</a></div></div>
<div class="ttc" id="namespaceanalyzer_1_1icmp_html_af3fc0c0e38a9e6478131b96dcef47efa"><div class="ttname"><a href="namespaceanalyzer_1_1icmp.html#af3fc0c0e38a9e6478131b96dcef47efa">analyzer::icmp::ICMP4_counterpart</a></div><div class="ttdeci">int ICMP4_counterpart(int icmp_type, int icmp_code, bool &amp;is_one_way)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00847">ICMP.cc:847</a></div></div>
<div class="ttc" id="classNetSessions_html_a3f3161c112a2c9fdd0dd5a2b418926e0"><div class="ttname"><a href="classNetSessions.html#a3f3161c112a2c9fdd0dd5a2b418926e0">NetSessions::DoNextInnerPacket</a></div><div class="ttdeci">void DoNextInnerPacket(double t, const Packet *pkt, const IP_Hdr *inner, const EncapsulationStack *prev, const EncapsulatingConn &amp;ec)</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l00788">Sessions.cc:788</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a564d7f86b1bb3b27e7f432c52d67d6db"><div class="ttname"><a href="classIP__Hdr.html#a564d7f86b1bb3b27e7f432c52d67d6db">IP_Hdr::TotalLen</a></div><div class="ttdeci">uint32 TotalLen() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00473">IP.h:473</a></div></div>
<div class="ttc" id="classNetSessions_html_a14cbb326c4dc8196cced2706925cf0f9"><div class="ttname"><a href="classNetSessions.html#a14cbb326c4dc8196cced2706925cf0f9">NetSessions::TunnelActivity</a></div><div class="ttdeci">pair&lt; EncapsulatingConn, double &gt; TunnelActivity</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00235">Sessions.h:235</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a643c8d91bcd09a904501d9959748a3e9"><div class="ttname"><a href="classIP__Hdr.html#a643c8d91bcd09a904501d9959748a3e9">IP_Hdr::FragOffset</a></div><div class="ttdeci">uint16 FragOffset() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00531">IP.h:531</a></div></div>
<div class="ttc" id="Event_8cc_html_ab301a03781c6c07cacb1f9cb07214b83"><div class="ttname"><a href="Event_8cc.html#ab301a03781c6c07cacb1f9cb07214b83">mgr</a></div><div class="ttdeci">EventMgr mgr</div><div class="ttdef"><b>Definition:</b> <a href="Event_8cc_source.html#l00011">Event.cc:11</a></div></div>
<div class="ttc" id="classDictionary_html_a6cc32b90c020a4d9094d37265b4d15db"><div class="ttname"><a href="classDictionary.html#a6cc32b90c020a4d9094d37265b4d15db">Dictionary::Lookup</a></div><div class="ttdeci">void * Lookup(const HashKey *key) const </div><div class="ttdef"><b>Definition:</b> <a href="Dict_8h_source.html#l00040">Dict.h:40</a></div></div>
<div class="ttc" id="Reporter_8cc_html_a25adbcf7f40a03cf61ce36b1e10bbf91"><div class="ttname"><a href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a></div><div class="ttdeci">Reporter * reporter</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00025">Reporter.cc:25</a></div></div>
<div class="ttc" id="namespaceanalyzer_1_1icmp_html_acdbd9cf674f0f6f4ebea24b04de2ed6e"><div class="ttname"><a href="namespaceanalyzer_1_1icmp.html#acdbd9cf674f0f6f4ebea24b04de2ed6e">analyzer::icmp::ICMP6_counterpart</a></div><div class="ttdeci">int ICMP6_counterpart(int icmp_type, int icmp_code, bool &amp;is_one_way)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00874">ICMP.cc:874</a></div></div>
<div class="ttc" id="classConnection_html_a5f459c677c449b4209d00085d2a0c975"><div class="ttname"><a href="classConnection.html#a5f459c677c449b4209d00085d2a0c975">Connection::CheckFlowLabel</a></div><div class="ttdeci">void CheckFlowLabel(bool is_orig, uint32 flow_label)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l01043">Conn.cc:1043</a></div></div>
<div class="ttc" id="classFragReassembler_html_aa92cc4cd7847475ed6a226bf4761c771"><div class="ttname"><a href="classFragReassembler.html#aa92cc4cd7847475ed6a226bf4761c771">FragReassembler::ReassembledPkt</a></div><div class="ttdeci">const IP_Hdr * ReassembledPkt()</div><div class="ttdef"><b>Definition:</b> <a href="Frag_8h_source.html#l00032">Frag.h:32</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a0da7bf24230ff8cb5a6e997c82c6ffbd"><div class="ttname"><a href="classIP__Hdr.html#a0da7bf24230ff8cb5a6e997c82c6ffbd">IP_Hdr::BuildPktHdrVal</a></div><div class="ttdeci">RecordVal * BuildPktHdrVal() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8cc_source.html#l00331">IP.cc:331</a></div></div>
<div class="ttc" id="classDictionary_html"><div class="ttname"><a href="classDictionary.html">Dictionary</a></div><div class="ttdef"><b>Definition:</b> <a href="Dict_8h_source.html#l00030">Dict.h:30</a></div></div>
<div class="ttc" id="classConnection_html_a2807492e6d4a7e525082873aa3a06ba1"><div class="ttname"><a href="classConnection.html#a2807492e6d4a7e525082873aa3a06ba1">Connection::OrigAddr</a></div><div class="ttdeci">const IPAddr &amp; OrigAddr() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00102">Conn.h:102</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a5c09f4d749016bc3cf3dbee8a048bcfc"><div class="ttname"><a href="classIP__Hdr.html#a5c09f4d749016bc3cf3dbee8a048bcfc">IP_Hdr::DstAddr</a></div><div class="ttdeci">IPAddr DstAddr() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00427">IP.h:427</a></div></div>
<div class="ttc" id="classHashKey_html"><div class="ttname"><a href="classHashKey.html">HashKey</a></div><div class="ttdef"><b>Definition:</b> <a href="Hash_8h_source.html#l00021">Hash.h:21</a></div></div>
<div class="ttc" id="classIP__Hdr_html"><div class="ttname"><a href="classIP__Hdr.html">IP_Hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00339">IP.h:339</a></div></div>
<div class="ttc" id="util_8cc_html_acd55da5095039a6a84317688425cac72"><div class="ttname"><a href="util_8cc.html#acd55da5095039a6a84317688425cac72">fmt</a></div><div class="ttdeci">const char * fmt(const char *format, va_list al)</div><div class="ttdef"><b>Definition:</b> <a href="util_8cc_source.html#l00545">util.cc:545</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a7ec0fdb8132b43b74a16bfef5c7b851e"><div class="ttname"><a href="classIP__Hdr.html#a7ec0fdb8132b43b74a16bfef5c7b851e">IP_Hdr::NextProto</a></div><div class="ttdeci">unsigned char NextProto() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00502">IP.h:502</a></div></div>
<div class="ttc" id="classNetSessions_html_a46461efab16220523fa26f185e7daadb"><div class="ttname"><a href="classNetSessions.html#a46461efab16220523fa26f185e7daadb">NetSessions::IPTunnelTimer</a></div><div class="ttdeci">friend class IPTunnelTimer</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00186">Sessions.h:186</a></div></div>
<div class="ttc" id="classConnection_html_aecfad0032fdfca27c44349f0718b2924"><div class="ttname"><a href="classConnection.html#aecfad0032fdfca27c44349f0718b2924">Connection::NextPacket</a></div><div class="ttdeci">void NextPacket(double t, int is_orig, const IP_Hdr *ip, int len, int caplen, const u_char *&amp;data, int &amp;record_packet, int &amp;record_content, const Packet *pkt)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00253">Conn.cc:253</a></div></div>
<div class="ttc" id="classEncapsulationStack_html_aa8424f24d54c7071d2ec43678cee87a9"><div class="ttname"><a href="classEncapsulationStack.html#aa8424f24d54c7071d2ec43678cee87a9">EncapsulationStack::LastType</a></div><div class="ttdeci">BifEnum::Tunnel::Type LastType() const </div><div class="ttdef"><b>Definition:</b> <a href="TunnelEncapsulation_8h_source.html#l00176">TunnelEncapsulation.h:176</a></div></div>
<div class="ttc" id="classFragReassemblerTracker_html"><div class="ttname"><a href="classFragReassemblerTracker.html">FragReassemblerTracker</a></div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00272">Sessions.h:272</a></div></div>
<div class="ttc" id="util_8h_html_ac2a9e79eb120216f855626495b7bd18a"><div class="ttname"><a href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a></div><div class="ttdeci">uint16_t uint16</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00065">util.h:65</a></div></div>
<div class="ttc" id="Net_8cc_html_aafa2480e4a23e3822f639319b8a62ef3"><div class="ttname"><a href="Net_8cc.html#aafa2480e4a23e3822f639319b8a62ef3">network_time</a></div><div class="ttdeci">double network_time</div><div class="ttdef"><b>Definition:</b> <a href="Net_8cc_source.html#l00054">Net.cc:54</a></div></div>
<div class="ttc" id="classPacket_html_a98bbeb102dbb9788c434fbcfaada52f0"><div class="ttname"><a href="classPacket.html#a98bbeb102dbb9788c434fbcfaada52f0">Packet::len</a></div><div class="ttdeci">uint32 len</div><div class="ttdoc">Packet data. </div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00167">Packet.h:167</a></div></div>
<div class="ttc" id="classNetSessions_html_ad3965a2f68ea9c8cdd2b7c729af33720"><div class="ttname"><a href="classNetSessions.html#ad3965a2f68ea9c8cdd2b7c729af33720">NetSessions::NewConn</a></div><div class="ttdeci">Connection * NewConn(HashKey *k, double t, const ConnID *id, const u_char *data, int proto, uint32 flow_label, const Packet *pkt, const EncapsulationStack *encapsulation)</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l01212">Sessions.cc:1212</a></div></div>
<div class="ttc" id="net__util_8cc_html_a1fa292138b3efe46f399c93a156b198b"><div class="ttname"><a href="net__util_8cc.html#a1fa292138b3efe46f399c93a156b198b">ones_complement_checksum</a></div><div class="ttdeci">int ones_complement_checksum(const void *p, int b, uint32 sum)</div><div class="ttdef"><b>Definition:</b> <a href="net__util_8cc_source.html#l00019">net_util.cc:19</a></div></div>
<div class="ttc" id="IPAddr_8cc_html_a22e65999823d6fe15637ee48bb81c8e2"><div class="ttname"><a href="IPAddr_8cc.html#a22e65999823d6fe15637ee48bb81c8e2">BuildConnIDHashKey</a></div><div class="ttdeci">HashKey * BuildConnIDHashKey(const ConnID &amp;id)</div><div class="ttdef"><b>Definition:</b> <a href="IPAddr_8cc_source.html#l00017">IPAddr.cc:17</a></div></div>
<div class="ttc" id="classNetSessions_html_ae2d46a6940ab5c04945729f85c5aa6fa"><div class="ttname"><a href="classNetSessions.html#ae2d46a6940ab5c04945729f85c5aa6fa">NetSessions::ip_tunnels</a></div><div class="ttdeci">IPTunnelMap ip_tunnels</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00237">Sessions.h:237</a></div></div>
<div class="ttc" id="classNetSessions_html_a8e1b9845ff7597ff1e44c67d6139173a"><div class="ttname"><a href="classNetSessions.html#a8e1b9845ff7597ff1e44c67d6139173a">NetSessions::CheckConnectionTag</a></div><div class="ttdeci">int CheckConnectionTag(Connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l00240">Sessions.cc:240</a></div></div>
<div class="ttc" id="classConnection_html_a9df9d1798854bd69944e838de68ed136"><div class="ttname"><a href="classConnection.html#a9df9d1798854bd69944e838de68ed136">Connection::OrigPort</a></div><div class="ttdeci">uint32 OrigPort() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00105">Conn.h:105</a></div></div>
<div class="ttc" id="classEventMgr_html_a5f91cb07c02ed60fb39e65147af322b7"><div class="ttname"><a href="classEventMgr.html#a5f91cb07c02ed60fb39e65147af322b7">EventMgr::QueueEvent</a></div><div class="ttdeci">void QueueEvent(const EventHandlerPtr &amp;h, val_list *vl, SourceID src=SOURCE_LOCAL, analyzer::ID aid=0, TimerMgr *mgr=0, BroObj *obj=0)</div><div class="ttdef"><b>Definition:</b> <a href="Event_8h_source.html#l00056">Event.h:56</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a86ccf5d09d6e00dc0229b065ffda3ed6"><div class="ttname"><a href="classIP__Hdr.html#a86ccf5d09d6e00dc0229b065ffda3ed6">IP_Hdr::HdrLen</a></div><div class="ttdeci">uint16 HdrLen() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00479">IP.h:479</a></div></div>
<div class="ttc" id="classIP__Hdr_html_afb58edf347f5ace9703948f5d5cb3c28"><div class="ttname"><a href="classIP__Hdr.html#afb58edf347f5ace9703948f5d5cb3c28">IP_Hdr::IP4_Hdr</a></div><div class="ttdeci">const struct ip * IP4_Hdr() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00394">IP.h:394</a></div></div>
<div class="ttc" id="classNetSessions_html_a8249bf085beaed0edf1d054a929d7ae9"><div class="ttname"><a href="classNetSessions.html#a8249bf085beaed0edf1d054a929d7ae9">NetSessions::discarder</a></div><div class="ttdeci">Discarder * discarder</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00242">Sessions.h:242</a></div></div>
<div class="ttc" id="classConnection_html_a0e657fdaf9a05ec4f0fb9499173f5ace"><div class="ttname"><a href="classConnection.html#a0e657fdaf9a05ec4f0fb9499173f5ace">Connection::IsReuse</a></div><div class="ttdeci">bool IsReuse(double t, const u_char *pkt)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00287">Conn.cc:287</a></div></div>
<div class="ttc" id="classFragReassembler_html"><div class="ttname"><a href="classFragReassembler.html">FragReassembler</a></div><div class="ttdef"><b>Definition:</b> <a href="Frag_8h_source.html#l00020">Frag.h:20</a></div></div>
<div class="ttc" id="main_8cc_html_a36d412e0f4c6a9403bf08b697828e16b"><div class="ttname"><a href="main_8cc.html#a36d412e0f4c6a9403bf08b697828e16b">timer_mgr</a></div><div class="ttdeci">TimerMgr * timer_mgr</div><div class="ttdef"><b>Definition:</b> <a href="main_8cc_source.html#l00085">main.cc:85</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a90d5a84e4a15a16c4fae107ec8664866"><div class="ttname"><a href="classIP__Hdr.html#a90d5a84e4a15a16c4fae107ec8664866">IP_Hdr::NumHeaders</a></div><div class="ttdeci">size_t NumHeaders() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00563">IP.h:563</a></div></div>
<div class="ttc" id="util_8h_html_acbd4acd0d29e2d6c43104827f77d9cd2"><div class="ttname"><a href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00064">util.h:64</a></div></div>
<div class="ttc" id="classDiscarder_html_a0c901b5fd68e28117e3815589fe7ae20"><div class="ttname"><a href="classDiscarder.html#a0c901b5fd68e28117e3815589fe7ae20">Discarder::NextPacket</a></div><div class="ttdeci">int NextPacket(const IP_Hdr *ip, int len, int caplen)</div><div class="ttdef"><b>Definition:</b> <a href="Discard_8cc_source.html#l00030">Discard.cc:30</a></div></div>
<div class="ttc" id="classEncapsulatingConn_html"><div class="ttname"><a href="classEncapsulatingConn.html">EncapsulatingConn</a></div><div class="ttdef"><b>Definition:</b> <a href="TunnelEncapsulation_8h_source.html#l00022">TunnelEncapsulation.h:22</a></div></div>
<div class="ttc" id="classPacket_html_a394c54942ec7d3c8c5aeae5b5afe6560"><div class="ttname"><a href="classPacket.html#a394c54942ec7d3c8c5aeae5b5afe6560">Packet::hdr_size</a></div><div class="ttdeci">uint32 hdr_size</div><div class="ttdoc">pcap link_type (DLT_EN10MB, DLT_RAW, etc) </div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00177">Packet.h:177</a></div></div>
<div class="ttc" id="classConnection_html_a6544135de28d0596a46a069aab3797dd"><div class="ttname"><a href="classConnection.html#a6544135de28d0596a46a069aab3797dd">Connection::CheckEncapsulation</a></div><div class="ttdeci">void CheckEncapsulation(const EncapsulationStack *encap)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00218">Conn.cc:218</a></div></div>
<div class="ttc" id="classNetSessions_html_abb38b95e4eae2b4ecb38e1bb481e2522"><div class="ttname"><a href="classNetSessions.html#abb38b95e4eae2b4ecb38e1bb481e2522">NetSessions::dump_this_packet</a></div><div class="ttdeci">int dump_this_packet</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00246">Sessions.h:246</a></div></div>
<div class="ttc" id="classNetSessions_html_a83c4d484f576c82038cea5cd91f7f552"><div class="ttname"><a href="classNetSessions.html#a83c4d484f576c82038cea5cd91f7f552">NetSessions::NextFragment</a></div><div class="ttdeci">FragReassembler * NextFragment(double t, const IP_Hdr *ip, const u_char *pkt)</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l00918">Sessions.cc:918</a></div></div>
<div class="ttc" id="classEncapsulationStack_html_a4a1fffb3d4e01e58d9f80f2d6aa44992"><div class="ttname"><a href="classEncapsulationStack.html#a4a1fffb3d4e01e58d9f80f2d6aa44992">EncapsulationStack::Depth</a></div><div class="ttdeci">size_t Depth() const </div><div class="ttdef"><b>Definition:</b> <a href="TunnelEncapsulation_8h_source.html#l00168">TunnelEncapsulation.h:168</a></div></div>
<div class="ttc" id="classPacketFilter_html_ad1b04f9afdbbf3bf1d25f23c95807a7b"><div class="ttname"><a href="classPacketFilter.html#ad1b04f9afdbbf3bf1d25f23c95807a7b">PacketFilter::Match</a></div><div class="ttdeci">bool Match(const IP_Hdr *ip, int len, int caplen)</div><div class="ttdef"><b>Definition:</b> <a href="PacketFilter_8cc_source.html#l00055">PacketFilter.cc:55</a></div></div>
<div class="ttc" id="classPacket_html_aa1f4f749e6ed1c424ff6da4efe814fc9"><div class="ttname"><a href="classPacket.html#aa1f4f749e6ed1c424ff6da4efe814fc9">Packet::data</a></div><div class="ttdeci">const u_char * data</div><div class="ttdoc">Capture timestamp. </div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00166">Packet.h:166</a></div></div>
<div class="ttc" id="classNetSessions_html_ab8a81976f7c6230a5d8f0e50d6cda708"><div class="ttname"><a href="classNetSessions.html#ab8a81976f7c6230a5d8f0e50d6cda708">NetSessions::DumpPacket</a></div><div class="ttdeci">void DumpPacket(const Packet *pkt, int len=0)</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l01401">Sessions.cc:1401</a></div></div>
<div class="ttc" id="classNetSessions_html_ac693cf1ddd40bc732b9e988d11ed25f1"><div class="ttname"><a href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">NetSessions::Weird</a></div><div class="ttdeci">void Weird(const char *name, const Packet *pkt, const EncapsulationStack *encap=0)</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l01417">Sessions.cc:1417</a></div></div>
<div class="ttc" id="classIP__Hdr_html_ae0bb85b14ebaa65bd0889171d46c04e8"><div class="ttname"><a href="classIP__Hdr.html#ae0bb85b14ebaa65bd0889171d46c04e8">IP_Hdr::LastHeader</a></div><div class="ttdeci">uint8 LastHeader() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00485">IP.h:485</a></div></div>
<div class="ttc" id="structConnID_html_ab31d61d52f47a05528fc220c295d6f29"><div class="ttname"><a href="structConnID.html#ab31d61d52f47a05528fc220c295d6f29">ConnID::src_addr</a></div><div class="ttdeci">IPAddr src_addr</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00044">Conn.h:44</a></div></div>
<div class="ttc" id="classReporter_html_a1820e1da136fa37d8c7561b5a831392d"><div class="ttname"><a href="classReporter.html#a1820e1da136fa37d8c7561b5a831392d">Reporter::InternalError</a></div><div class="ttdeci">void InternalError(const char *fmt,...) FMT_ATTR</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00165">Reporter.cc:165</a></div></div>
<div class="ttc" id="classConnection_html"><div class="ttname"><a href="classConnection.html">Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00059">Conn.h:59</a></div></div>
<div class="ttc" id="classPacket_html_ac0d8af22ea8d9a67d4952241d95d4a0d"><div class="ttname"><a href="classPacket.html#ac0d8af22ea8d9a67d4952241d95d4a0d">Packet::cap_len</a></div><div class="ttdeci">uint32 cap_len</div><div class="ttdoc">Actual length on wire. </div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00168">Packet.h:168</a></div></div>
<div class="ttc" id="classNetSessions_html_a8566b0fbe1879eb0508039f2e3edb5bd"><div class="ttname"><a href="classNetSessions.html#a8566b0fbe1879eb0508039f2e3edb5bd">NetSessions::ParseIPPacket</a></div><div class="ttdeci">int ParseIPPacket(int caplen, const u_char *const pkt, int proto, IP_Hdr *&amp;inner)</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l00835">Sessions.cc:835</a></div></div>
<div class="ttc" id="classDictionary_html_ab9d46308fc8f399f0d7653f73d6c5bf8"><div class="ttname"><a href="classDictionary.html#ab9d46308fc8f399f0d7653f73d6c5bf8">Dictionary::Insert</a></div><div class="ttdeci">void * Insert(HashKey *key, void *val)</div><div class="ttdef"><b>Definition:</b> <a href="Dict_8h_source.html#l00045">Dict.h:45</a></div></div>
<div class="ttc" id="classNetSessions_html_a1c8b3c4f33f8932e3ba6914b9cec52c3"><div class="ttname"><a href="classNetSessions.html#a1c8b3c4f33f8932e3ba6914b9cec52c3">NetSessions::Remove</a></div><div class="ttdeci">void Remove(Connection *c)</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l01045">Sessions.cc:1045</a></div></div>
<div class="ttc" id="classNetSessions_html_ab7675fcc36494512228d1c3a282d22ce"><div class="ttname"><a href="classNetSessions.html#ab7675fcc36494512228d1c3a282d22ce">NetSessions::IPPair</a></div><div class="ttdeci">pair&lt; IPAddr, IPAddr &gt; IPPair</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00234">Sessions.h:234</a></div></div>
<div class="ttc" id="Sessions_8cc_html_a2a7732ddcad8e107d1c0d888f3e4c1e9"><div class="ttname"><a href="Sessions_8cc.html#a2a7732ddcad8e107d1c0d888f3e4c1e9">gre_header_len</a></div><div class="ttdeci">static unsigned int gre_header_len(uint16 flags)</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l00293">Sessions.cc:293</a></div></div>
<div class="ttc" id="classIP__Hdr_html_af63ed1a463e01d55db6c1cf2b336e359"><div class="ttname"><a href="classIP__Hdr.html#af63ed1a463e01d55db6c1cf2b336e359">IP_Hdr::FlowLabel</a></div><div class="ttdeci">uint32 FlowLabel() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00557">IP.h:557</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9df7541b681ef6ec0d690db4b0c40edb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetSessions::Drain </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l01163">1163</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    {</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <a class="code" href="classIterCookie.html">IterCookie</a>* cookie = tcp_conns.InitForIteration();</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <a class="code" href="classConnection.html">Connection</a>* tc;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keywordflow">while</span> ( (tc = tcp_conns.NextEntry(cookie)) )</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        {</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        tc-&gt;<a class="code" href="classConnection.html#a27a89759136c363f10260f4cf6d9b44c">Done</a>();</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        tc-&gt;<a class="code" href="classConnection.html#ae8480aebbcac15331efe7a1591eaaca8">Event</a>(connection_state_remove, 0);</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;        }</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    cookie = udp_conns.InitForIteration();</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <a class="code" href="classConnection.html">Connection</a>* uc;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordflow">while</span> ( (uc = udp_conns.NextEntry(cookie)) )</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        {</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;        uc-&gt;<a class="code" href="classConnection.html#a27a89759136c363f10260f4cf6d9b44c">Done</a>();</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        uc-&gt;<a class="code" href="classConnection.html#ae8480aebbcac15331efe7a1591eaaca8">Event</a>(connection_state_remove, 0);</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        }</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    cookie = icmp_conns.InitForIteration();</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <a class="code" href="classConnection.html">Connection</a>* ic;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordflow">while</span> ( (ic = icmp_conns.NextEntry(cookie)) )</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        {</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        ic-&gt;<a class="code" href="classConnection.html#a27a89759136c363f10260f4cf6d9b44c">Done</a>();</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        ic-&gt;<a class="code" href="classConnection.html#ae8480aebbcac15331efe7a1591eaaca8">Event</a>(connection_state_remove, 0);</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        }</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <a class="code" href="classNetSessions.html#ac93a4cf63254c310f216c317157df02c">ExpireTimerMgrs</a>();</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    }</div><div class="ttc" id="classConnection_html_ae8480aebbcac15331efe7a1591eaaca8"><div class="ttname"><a href="classConnection.html#ae8480aebbcac15331efe7a1591eaaca8">Connection::Event</a></div><div class="ttdeci">void Event(EventHandlerPtr f, analyzer::Analyzer *analyzer, const char *name=0)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00682">Conn.cc:682</a></div></div>
<div class="ttc" id="classIterCookie_html"><div class="ttname"><a href="classIterCookie.html">IterCookie</a></div><div class="ttdef"><b>Definition:</b> <a href="Dict_8cc_source.html#l00038">Dict.cc:38</a></div></div>
<div class="ttc" id="classConnection_html_a27a89759136c363f10260f4cf6d9b44c"><div class="ttname"><a href="classConnection.html#a27a89759136c363f10260f4cf6d9b44c">Connection::Done</a></div><div class="ttdeci">void Done()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00245">Conn.cc:245</a></div></div>
<div class="ttc" id="classConnection_html"><div class="ttname"><a href="classConnection.html">Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00059">Conn.h:59</a></div></div>
<div class="ttc" id="classNetSessions_html_ac93a4cf63254c310f216c317157df02c"><div class="ttname"><a href="classNetSessions.html#ac93a4cf63254c310f216c317157df02c">NetSessions::ExpireTimerMgrs</a></div><div class="ttdeci">void ExpireTimerMgrs()</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l01391">Sessions.cc:1391</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab8a81976f7c6230a5d8f0e50d6cda708"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void NetSessions::DumpPacket </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classPacket.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l01401">1401</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    {</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keywordflow">if</span> ( ! <a class="code" href="Net_8cc.html#a9f1bc60cd8e59720235847fb46d9e585">pkt_dumper</a> )</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="keywordflow">if</span> ( len != 0 )</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;        {</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        <span class="keywordflow">if</span> ( (<a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>)len &gt; pkt-&gt;<a class="code" href="classPacket.html#ac0d8af22ea8d9a67d4952241d95d4a0d">cap_len</a> )</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;            <a class="code" href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a>-&gt;<a class="code" href="classReporter.html#a8ec1f660c5f253e61b7b28655e98e101">Warning</a>(<span class="stringliteral">&quot;bad modified caplen&quot;</span>);</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;            <span class="keyword">const_cast&lt;</span><a class="code" href="classPacket.html">Packet</a> *<span class="keyword">&gt;</span>(pkt)-&gt;cap_len = len;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        }</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <a class="code" href="Net_8cc.html#a9f1bc60cd8e59720235847fb46d9e585">pkt_dumper</a>-&gt;<a class="code" href="classiosource_1_1PktDumper.html#a6326de249dc8c25733cadfb5e3a0ae7e">Dump</a>(pkt);</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    }</div><div class="ttc" id="classiosource_1_1PktDumper_html_a6326de249dc8c25733cadfb5e3a0ae7e"><div class="ttname"><a href="classiosource_1_1PktDumper.html#a6326de249dc8c25733cadfb5e3a0ae7e">iosource::PktDumper::Dump</a></div><div class="ttdeci">virtual bool Dump(const Packet *pkt)=0</div></div>
<div class="ttc" id="Reporter_8cc_html_a25adbcf7f40a03cf61ce36b1e10bbf91"><div class="ttname"><a href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a></div><div class="ttdeci">Reporter * reporter</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00025">Reporter.cc:25</a></div></div>
<div class="ttc" id="classPacket_html"><div class="ttname"><a href="classPacket.html">Packet</a></div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00034">Packet.h:34</a></div></div>
<div class="ttc" id="classReporter_html_a8ec1f660c5f253e61b7b28655e98e101"><div class="ttname"><a href="classReporter.html#a8ec1f660c5f253e61b7b28655e98e101">Reporter::Warning</a></div><div class="ttdeci">void Warning(const char *fmt,...) FMT_ATTR</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00087">Reporter.cc:87</a></div></div>
<div class="ttc" id="util_8h_html_acbd4acd0d29e2d6c43104827f77d9cd2"><div class="ttname"><a href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00064">util.h:64</a></div></div>
<div class="ttc" id="Net_8cc_html_a9f1bc60cd8e59720235847fb46d9e585"><div class="ttname"><a href="Net_8cc.html#a9f1bc60cd8e59720235847fb46d9e585">pkt_dumper</a></div><div class="ttdeci">iosource::PktDumper * pkt_dumper</div><div class="ttdef"><b>Definition:</b> <a href="Net_8cc_source.html#l00046">Net.cc:46</a></div></div>
<div class="ttc" id="classPacket_html_ac0d8af22ea8d9a67d4952241d95d4a0d"><div class="ttname"><a href="classPacket.html#ac0d8af22ea8d9a67d4952241d95d4a0d">Packet::cap_len</a></div><div class="ttdeci">uint32 cap_len</div><div class="ttdoc">Actual length on wire. </div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00168">Packet.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac93a4cf63254c310f216c317157df02c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetSessions::ExpireTimerMgrs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l01391">1391</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    {</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="keywordflow">for</span> ( TimerMgrMap::iterator i = <a class="code" href="classNetSessions.html#a5118a8f46d752cfe03b7dbebc4fc3fc1">timer_mgrs</a>.begin();</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;          i != <a class="code" href="classNetSessions.html#a5118a8f46d752cfe03b7dbebc4fc3fc1">timer_mgrs</a>.end(); ++i )</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;        {</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        i-&gt;second-&gt;Expire();</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;        <span class="keyword">delete</span> i-&gt;second;</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        }</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    }</div><div class="ttc" id="classNetSessions_html_a5118a8f46d752cfe03b7dbebc4fc3fc1"><div class="ttname"><a href="classNetSessions.html#a5118a8f46d752cfe03b7dbebc4fc3fc1">NetSessions::timer_mgrs</a></div><div class="ttdeci">TimerMgrMap timer_mgrs</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00253">Sessions.h:253</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afeaf4c86e37fbf50b6e7a6c33f8c33aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classConnection.html">Connection</a> * NetSessions::FindConnection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVal.html">Val</a> *&#160;</td>
          <td class="paramname"><em>v</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l00966">966</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    {</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <a class="code" href="classBroType.html">BroType</a>* vt = v-&gt;<a class="code" href="classVal.html#aabca6f9cf53fa07022cd42c9f16e1f63">Type</a>();</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordflow">if</span> ( ! <a class="code" href="Type_8h.html#aa1b0625fd68cbfaea63d8523d431d7c4">IsRecord</a>(vt-&gt;<a class="code" href="classBroType.html#a228653e592d0e53ecbb80cd0ebd002ef">Tag</a>()) )</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <a class="code" href="classRecordType.html">RecordType</a>* vr = vt-&gt;<a class="code" href="classBroType.html#af86ed0d0a3df584e5f768668a0c639af">AsRecordType</a>();</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keyword">const</span> val_list* vl = v-&gt;AsRecord();</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordtype">int</span> orig_h, orig_p; <span class="comment">// indices into record&#39;s value list</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="keywordtype">int</span> resp_h, resp_p;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keywordflow">if</span> ( vr == <a class="code" href="NetVar_8cc.html#a8d644d6bce5d2a287bbc022dde89ec98">conn_id</a> )</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        orig_h = 0;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        orig_p = 1;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        resp_h = 2;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        resp_p = 3;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        }</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        {</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        <span class="comment">// While it&#39;s not a conn_id, it may have equivalent fields.</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        orig_h = vr-&gt;<a class="code" href="classRecordType.html#a3b774cdf14a5108734b6e81b9d2ae8fe">FieldOffset</a>(<span class="stringliteral">&quot;orig_h&quot;</span>);</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        resp_h = vr-&gt;<a class="code" href="classRecordType.html#a3b774cdf14a5108734b6e81b9d2ae8fe">FieldOffset</a>(<span class="stringliteral">&quot;resp_h&quot;</span>);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        orig_p = vr-&gt;<a class="code" href="classRecordType.html#a3b774cdf14a5108734b6e81b9d2ae8fe">FieldOffset</a>(<span class="stringliteral">&quot;orig_p&quot;</span>);</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        resp_p = vr-&gt;<a class="code" href="classRecordType.html#a3b774cdf14a5108734b6e81b9d2ae8fe">FieldOffset</a>(<span class="stringliteral">&quot;resp_p&quot;</span>);</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <span class="keywordflow">if</span> ( orig_h &lt; 0 || resp_h &lt; 0 || orig_p &lt; 0 || resp_p &lt; 0 )</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <span class="comment">// ### we ought to check that the fields have the right</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <span class="comment">// types, too.</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        }</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keyword">const</span> <a class="code" href="classIPAddr.html">IPAddr</a>&amp; orig_addr = (*vl)[orig_h]-&gt;AsAddr();</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keyword">const</span> <a class="code" href="classIPAddr.html">IPAddr</a>&amp; resp_addr = (*vl)[resp_h]-&gt;AsAddr();</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <a class="code" href="classPortVal.html">PortVal</a>* orig_portv = (*vl)[orig_p]-&gt;AsPortVal();</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <a class="code" href="classPortVal.html">PortVal</a>* resp_portv = (*vl)[resp_p]-&gt;AsPortVal();</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <a class="code" href="structConnID.html">ConnID</a> id;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="keywordtype">id</span>.<a class="code" href="structConnID.html#ab31d61d52f47a05528fc220c295d6f29">src_addr</a> = orig_addr;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keywordtype">id</span>.dst_addr = resp_addr;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="keywordtype">id</span>.src_port = htons((<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>) orig_portv-&gt;<a class="code" href="classPortVal.html#a8a75508c9f862ca54d0bb212b2419667">Port</a>());</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="keywordtype">id</span>.dst_port = htons((<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>) resp_portv-&gt;<a class="code" href="classPortVal.html#a8a75508c9f862ca54d0bb212b2419667">Port</a>());</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="keywordtype">id</span>.is_one_way = 0;  <span class="comment">// ### incorrect for ICMP connections</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <a class="code" href="classHashKey.html">HashKey</a>* h = <a class="code" href="IPAddr_8cc.html#a22e65999823d6fe15637ee48bb81c8e2">BuildConnIDHashKey</a>(<span class="keywordtype">id</span>);</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="keywordflow">if</span> ( ! h )</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        <a class="code" href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a>-&gt;<a class="code" href="classReporter.html#a1820e1da136fa37d8c7561b5a831392d">InternalError</a>(<span class="stringliteral">&quot;hash computation failed&quot;</span>);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <a class="code" href="classDictionary.html">Dictionary</a>* d;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="keywordflow">if</span> ( orig_portv-&gt;<a class="code" href="classPortVal.html#ac7fd54de415476fd34d6f28a11425e42">IsTCP</a>() )</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        d = &amp;tcp_conns;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( orig_portv-&gt;<a class="code" href="classPortVal.html#a10879784e0c630a24d93438a11220006">IsUDP</a>() )</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        d = &amp;udp_conns;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( orig_portv-&gt;<a class="code" href="classPortVal.html#a8406a0c55d53acb45233cde84772ea12">IsICMP</a>() )</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        d = &amp;icmp_conns;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        {</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        <span class="comment">// This can happen due to pseudo-connections we</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        <span class="comment">// construct, for example for packet headers embedded</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        <span class="comment">// in ICMPs.</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        <span class="keyword">delete</span> h;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        }</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <a class="code" href="classConnection.html">Connection</a>* conn = (<a class="code" href="classConnection.html">Connection</a>*) d-&gt;<a class="code" href="classDictionary.html#a6cc32b90c020a4d9094d37265b4d15db">Lookup</a>(h);</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keyword">delete</span> h;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keywordflow">return</span> conn;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    }</div><div class="ttc" id="structConnID_html"><div class="ttname"><a href="structConnID.html">ConnID</a></div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00043">Conn.h:43</a></div></div>
<div class="ttc" id="classRecordType_html_a3b774cdf14a5108734b6e81b9d2ae8fe"><div class="ttname"><a href="classRecordType.html#a3b774cdf14a5108734b6e81b9d2ae8fe">RecordType::FieldOffset</a></div><div class="ttdeci">int FieldOffset(const char *field) const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8cc_source.html#l01019">Type.cc:1019</a></div></div>
<div class="ttc" id="classBroType_html_a228653e592d0e53ecbb80cd0ebd002ef"><div class="ttname"><a href="classBroType.html#a228653e592d0e53ecbb80cd0ebd002ef">BroType::Tag</a></div><div class="ttdeci">TypeTag Tag() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00090">Type.h:90</a></div></div>
<div class="ttc" id="classVal_html_aabca6f9cf53fa07022cd42c9f16e1f63"><div class="ttname"><a href="classVal.html#aabca6f9cf53fa07022cd42c9f16e1f63">Val::Type</a></div><div class="ttdeci">BroType * Type()</div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00189">Val.h:189</a></div></div>
<div class="ttc" id="classDictionary_html_a6cc32b90c020a4d9094d37265b4d15db"><div class="ttname"><a href="classDictionary.html#a6cc32b90c020a4d9094d37265b4d15db">Dictionary::Lookup</a></div><div class="ttdeci">void * Lookup(const HashKey *key) const </div><div class="ttdef"><b>Definition:</b> <a href="Dict_8h_source.html#l00040">Dict.h:40</a></div></div>
<div class="ttc" id="NetVar_8cc_html_a8d644d6bce5d2a287bbc022dde89ec98"><div class="ttname"><a href="NetVar_8cc.html#a8d644d6bce5d2a287bbc022dde89ec98">conn_id</a></div><div class="ttdeci">RecordType * conn_id</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00008">NetVar.cc:8</a></div></div>
<div class="ttc" id="Reporter_8cc_html_a25adbcf7f40a03cf61ce36b1e10bbf91"><div class="ttname"><a href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a></div><div class="ttdeci">Reporter * reporter</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00025">Reporter.cc:25</a></div></div>
<div class="ttc" id="classIPAddr_html"><div class="ttname"><a href="classIPAddr.html">IPAddr</a></div><div class="ttdef"><b>Definition:</b> <a href="IPAddr_8h_source.html#l00024">IPAddr.h:24</a></div></div>
<div class="ttc" id="classRecordType_html"><div class="ttname"><a href="classRecordType.html">RecordType</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00461">Type.h:461</a></div></div>
<div class="ttc" id="classDictionary_html"><div class="ttname"><a href="classDictionary.html">Dictionary</a></div><div class="ttdef"><b>Definition:</b> <a href="Dict_8h_source.html#l00030">Dict.h:30</a></div></div>
<div class="ttc" id="classHashKey_html"><div class="ttname"><a href="classHashKey.html">HashKey</a></div><div class="ttdef"><b>Definition:</b> <a href="Hash_8h_source.html#l00021">Hash.h:21</a></div></div>
<div class="ttc" id="classBroType_html_af86ed0d0a3df584e5f768668a0c639af"><div class="ttname"><a href="classBroType.html#af86ed0d0a3df584e5f768668a0c639af">BroType::AsRecordType</a></div><div class="ttdeci">const RecordType * AsRecordType() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00157">Type.h:157</a></div></div>
<div class="ttc" id="classPortVal_html_a8406a0c55d53acb45233cde84772ea12"><div class="ttname"><a href="classPortVal.html#a8406a0c55d53acb45233cde84772ea12">PortVal::IsICMP</a></div><div class="ttdeci">int IsICMP() const </div><div class="ttdef"><b>Definition:</b> <a href="Val_8cc_source.html#l00881">Val.cc:881</a></div></div>
<div class="ttc" id="IPAddr_8cc_html_a22e65999823d6fe15637ee48bb81c8e2"><div class="ttname"><a href="IPAddr_8cc.html#a22e65999823d6fe15637ee48bb81c8e2">BuildConnIDHashKey</a></div><div class="ttdeci">HashKey * BuildConnIDHashKey(const ConnID &amp;id)</div><div class="ttdef"><b>Definition:</b> <a href="IPAddr_8cc_source.html#l00017">IPAddr.cc:17</a></div></div>
<div class="ttc" id="classBroType_html"><div class="ttname"><a href="classBroType.html">BroType</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00083">Type.h:83</a></div></div>
<div class="ttc" id="classPortVal_html"><div class="ttname"><a href="classPortVal.html">PortVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00527">Val.h:527</a></div></div>
<div class="ttc" id="classPortVal_html_a8a75508c9f862ca54d0bb212b2419667"><div class="ttname"><a href="classPortVal.html#a8a75508c9f862ca54d0bb212b2419667">PortVal::Port</a></div><div class="ttdeci">uint32 Port() const </div><div class="ttdef"><b>Definition:</b> <a href="Val_8cc_source.html#l00865">Val.cc:865</a></div></div>
<div class="ttc" id="classPortVal_html_ac7fd54de415476fd34d6f28a11425e42"><div class="ttname"><a href="classPortVal.html#ac7fd54de415476fd34d6f28a11425e42">PortVal::IsTCP</a></div><div class="ttdeci">int IsTCP() const </div><div class="ttdef"><b>Definition:</b> <a href="Val_8cc_source.html#l00871">Val.cc:871</a></div></div>
<div class="ttc" id="Type_8h_html_aa1b0625fd68cbfaea63d8523d431d7c4"><div class="ttname"><a href="Type_8h.html#aa1b0625fd68cbfaea63d8523d431d7c4">IsRecord</a></div><div class="ttdeci">#define IsRecord(t)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00695">Type.h:695</a></div></div>
<div class="ttc" id="structConnID_html_ab31d61d52f47a05528fc220c295d6f29"><div class="ttname"><a href="structConnID.html#ab31d61d52f47a05528fc220c295d6f29">ConnID::src_addr</a></div><div class="ttdeci">IPAddr src_addr</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00044">Conn.h:44</a></div></div>
<div class="ttc" id="classReporter_html_a1820e1da136fa37d8c7561b5a831392d"><div class="ttname"><a href="classReporter.html#a1820e1da136fa37d8c7561b5a831392d">Reporter::InternalError</a></div><div class="ttdeci">void InternalError(const char *fmt,...) FMT_ATTR</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00165">Reporter.cc:165</a></div></div>
<div class="ttc" id="classConnection_html"><div class="ttname"><a href="classConnection.html">Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00059">Conn.h:59</a></div></div>
<div class="ttc" id="classPortVal_html_a10879784e0c630a24d93438a11220006"><div class="ttname"><a href="classPortVal.html#a10879784e0c630a24d93438a11220006">PortVal::IsUDP</a></div><div class="ttdeci">int IsUDP() const </div><div class="ttdef"><b>Definition:</b> <a href="Val_8cc_source.html#l00876">Val.cc:876</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adbc01be5dd34c7627b0c907be2f007e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NetSessions::Get_OS_From_SYN </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structos__type.html">os_type</a> *&#160;</td>
          <td class="paramname"><em>retval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a>&#160;</td>
          <td class="paramname"><em>tot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a>&#160;</td>
          <td class="paramname"><em>DF_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a>&#160;</td>
          <td class="paramname"><em>TTL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a>&#160;</td>
          <td class="paramname"><em>WSS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a>&#160;</td>
          <td class="paramname"><em>ocnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> *&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a>&#160;</td>
          <td class="paramname"><em>MSS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a>&#160;</td>
          <td class="paramname"><em>win_scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&#160;</td>
          <td class="paramname"><em>tstamp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&#160;</td>
          <td class="paramname"><em>quirks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a>&#160;</td>
          <td class="paramname"><em>ECN</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l00948">948</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    {</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classNetSessions.html#a62bf64617bf9ecfb22b8e8894a168a12">SYN_OS_Fingerprinter</a> ?</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <a class="code" href="classNetSessions.html#a62bf64617bf9ecfb22b8e8894a168a12">SYN_OS_Fingerprinter</a>-&gt;<a class="code" href="classOSFingerprint.html#a58be3af65a34784ae04bc3ff381f4d66">FindMatch</a>(retval, tot, DF_flag, TTL,</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                WSS, ocnt, op, MSS, win_scale, tstamp,</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                quirks, ECN) : 0;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    }</div><div class="ttc" id="classOSFingerprint_html_a58be3af65a34784ae04bc3ff381f4d66"><div class="ttname"><a href="classOSFingerprint.html#a58be3af65a34784ae04bc3ff381f4d66">OSFingerprint::FindMatch</a></div><div class="ttdeci">int FindMatch(struct os_type *retval, uint16 tot, uint8 DF_flag, uint8 TTL, uint16 WSS, uint8 ocnt, uint8 *op, uint16 MSS, uint8 win_scale, uint32 tstamp, uint32 quirks, uint8 ECN) const </div><div class="ttdef"><b>Definition:</b> <a href="OSFinger_8cc_source.html#l00524">OSFinger.cc:524</a></div></div>
<div class="ttc" id="classNetSessions_html_a62bf64617bf9ecfb22b8e8894a168a12"><div class="ttname"><a href="classNetSessions.html#a62bf64617bf9ecfb22b8e8894a168a12">NetSessions::SYN_OS_Fingerprinter</a></div><div class="ttdeci">OSFingerprint * SYN_OS_Fingerprinter</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00244">Sessions.h:244</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5a1d583d93f2c06d79c6f2e797b74a56"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPacketFilter.html">PacketFilter</a>* NetSessions::GetPacketFilter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00109">109</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        {</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="classNetSessions.html#af1e4a540b075b3fc41bc2d74faf14373">packet_filter</a> )</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <a class="code" href="classNetSessions.html#af1e4a540b075b3fc41bc2d74faf14373">packet_filter</a> = <span class="keyword">new</span> <a class="code" href="classPacketFilter.html">PacketFilter</a>(<a class="code" href="NetVar_8cc.html#a6b05be4a29b4bbffddeef4c111374621">packet_filter_default</a>);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classNetSessions.html#af1e4a540b075b3fc41bc2d74faf14373">packet_filter</a>;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        }</div><div class="ttc" id="classNetSessions_html_af1e4a540b075b3fc41bc2d74faf14373"><div class="ttname"><a href="classNetSessions.html#af1e4a540b075b3fc41bc2d74faf14373">NetSessions::packet_filter</a></div><div class="ttdeci">PacketFilter * packet_filter</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00243">Sessions.h:243</a></div></div>
<div class="ttc" id="classPacketFilter_html"><div class="ttname"><a href="classPacketFilter.html">PacketFilter</a></div><div class="ttdef"><b>Definition:</b> <a href="PacketFilter_8h_source.html#l00009">PacketFilter.h:9</a></div></div>
<div class="ttc" id="NetVar_8cc_html_a6b05be4a29b4bbffddeef4c111374621"><div class="ttname"><a href="NetVar_8cc.html#a6b05be4a29b4bbffddeef4c111374621">packet_filter_default</a></div><div class="ttdeci">int packet_filter_default</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00194">NetVar.cc:194</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ada15fb2d4acef2840b25ad722a31b8a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetSessions::GetStats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSessionStats.html">SessionStats</a> &amp;&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l01195">1195</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    {</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    s.<a class="code" href="structSessionStats.html#ac75f6ac4c227892aec646d2c682cc454">num_TCP_conns</a> = tcp_conns.Length();</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    s.<a class="code" href="structSessionStats.html#a7f009fa340e590713f25d48efd51f727">cumulative_TCP_conns</a> = tcp_conns.NumCumulativeInserts();</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    s.<a class="code" href="structSessionStats.html#a57740b7c22fcad9ff70af0cc1d4a0850">num_UDP_conns</a> = udp_conns.Length();</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    s.<a class="code" href="structSessionStats.html#a1f3f39c1d4f030670176f5644f968187">cumulative_UDP_conns</a> = udp_conns.NumCumulativeInserts();</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    s.<a class="code" href="structSessionStats.html#a14b1ea9f478dc01a4e7d1725e20927d4">num_ICMP_conns</a> = icmp_conns.Length();</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    s.<a class="code" href="structSessionStats.html#ab4f7dd188efe742e08ead0d197276128">cumulative_ICMP_conns</a> = icmp_conns.NumCumulativeInserts();</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    s.<a class="code" href="structSessionStats.html#aac898df0b6c547124f02acb9ec62601b">num_fragments</a> = fragments.Length();</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    s.<a class="code" href="structSessionStats.html#a18d7a466671956c427611e8e9d06706b">num_packets</a> = <a class="code" href="classNetSessions.html#a26490773024adcd5527bdc17d98957f9">num_packets_processed</a>;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    s.<a class="code" href="structSessionStats.html#acb4bb6f72596706987cf75d4d75fa828">max_TCP_conns</a> = tcp_conns.MaxLength();</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    s.<a class="code" href="structSessionStats.html#ab6fbaedc9c9213d74d14117bbe5f8cce">max_UDP_conns</a> = udp_conns.MaxLength();</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    s.<a class="code" href="structSessionStats.html#a6cca3e8be2086c6dcc2b1a3a7c288380">max_ICMP_conns</a> = icmp_conns.MaxLength();</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    s.<a class="code" href="structSessionStats.html#a32a67037a5d43666450b33235a08042c">max_fragments</a> = fragments.MaxLength();</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    }</div><div class="ttc" id="structSessionStats_html_aac898df0b6c547124f02acb9ec62601b"><div class="ttname"><a href="structSessionStats.html#aac898df0b6c547124f02acb9ec62601b">SessionStats::num_fragments</a></div><div class="ttdeci">int num_fragments</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00046">Sessions.h:46</a></div></div>
<div class="ttc" id="structSessionStats_html_acb4bb6f72596706987cf75d4d75fa828"><div class="ttname"><a href="structSessionStats.html#acb4bb6f72596706987cf75d4d75fa828">SessionStats::max_TCP_conns</a></div><div class="ttdeci">int max_TCP_conns</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00035">Sessions.h:35</a></div></div>
<div class="ttc" id="structSessionStats_html_ac75f6ac4c227892aec646d2c682cc454"><div class="ttname"><a href="structSessionStats.html#ac75f6ac4c227892aec646d2c682cc454">SessionStats::num_TCP_conns</a></div><div class="ttdeci">int num_TCP_conns</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00034">Sessions.h:34</a></div></div>
<div class="ttc" id="structSessionStats_html_a6cca3e8be2086c6dcc2b1a3a7c288380"><div class="ttname"><a href="structSessionStats.html#a6cca3e8be2086c6dcc2b1a3a7c288380">SessionStats::max_ICMP_conns</a></div><div class="ttdeci">int max_ICMP_conns</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00043">Sessions.h:43</a></div></div>
<div class="ttc" id="structSessionStats_html_a7f009fa340e590713f25d48efd51f727"><div class="ttname"><a href="structSessionStats.html#a7f009fa340e590713f25d48efd51f727">SessionStats::cumulative_TCP_conns</a></div><div class="ttdeci">uint64 cumulative_TCP_conns</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00036">Sessions.h:36</a></div></div>
<div class="ttc" id="structSessionStats_html_ab6fbaedc9c9213d74d14117bbe5f8cce"><div class="ttname"><a href="structSessionStats.html#ab6fbaedc9c9213d74d14117bbe5f8cce">SessionStats::max_UDP_conns</a></div><div class="ttdeci">int max_UDP_conns</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00039">Sessions.h:39</a></div></div>
<div class="ttc" id="structSessionStats_html_ab4f7dd188efe742e08ead0d197276128"><div class="ttname"><a href="structSessionStats.html#ab4f7dd188efe742e08ead0d197276128">SessionStats::cumulative_ICMP_conns</a></div><div class="ttdeci">uint64 cumulative_ICMP_conns</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00044">Sessions.h:44</a></div></div>
<div class="ttc" id="structSessionStats_html_a18d7a466671956c427611e8e9d06706b"><div class="ttname"><a href="structSessionStats.html#a18d7a466671956c427611e8e9d06706b">SessionStats::num_packets</a></div><div class="ttdeci">uint64 num_packets</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00048">Sessions.h:48</a></div></div>
<div class="ttc" id="structSessionStats_html_a1f3f39c1d4f030670176f5644f968187"><div class="ttname"><a href="structSessionStats.html#a1f3f39c1d4f030670176f5644f968187">SessionStats::cumulative_UDP_conns</a></div><div class="ttdeci">uint64 cumulative_UDP_conns</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00040">Sessions.h:40</a></div></div>
<div class="ttc" id="classNetSessions_html_a26490773024adcd5527bdc17d98957f9"><div class="ttname"><a href="classNetSessions.html#a26490773024adcd5527bdc17d98957f9">NetSessions::num_packets_processed</a></div><div class="ttdeci">uint64 num_packets_processed</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00247">Sessions.h:247</a></div></div>
<div class="ttc" id="structSessionStats_html_a57740b7c22fcad9ff70af0cc1d4a0850"><div class="ttname"><a href="structSessionStats.html#a57740b7c22fcad9ff70af0cc1d4a0850">SessionStats::num_UDP_conns</a></div><div class="ttdeci">int num_UDP_conns</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00038">Sessions.h:38</a></div></div>
<div class="ttc" id="structSessionStats_html_a14b1ea9f478dc01a4e7d1725e20927d4"><div class="ttname"><a href="structSessionStats.html#a14b1ea9f478dc01a4e7d1725e20927d4">SessionStats::num_ICMP_conns</a></div><div class="ttdeci">int num_ICMP_conns</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00042">Sessions.h:42</a></div></div>
<div class="ttc" id="structSessionStats_html_a32a67037a5d43666450b33235a08042c"><div class="ttname"><a href="structSessionStats.html#a32a67037a5d43666450b33235a08042c">SessionStats::max_fragments</a></div><div class="ttdeci">int max_fragments</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00047">Sessions.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1187590287d147c8da07fa3dade1b689"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classanalyzer_1_1stepping__stone_1_1SteppingStoneManager.html">analyzer::stepping_stone::SteppingStoneManager</a>* NetSessions::GetSTPManager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00123">123</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classNetSessions.html#a4845dfcb5ecc5319f682387c0208809b">stp_manager</a>; }</div><div class="ttc" id="classNetSessions_html_a4845dfcb5ecc5319f682387c0208809b"><div class="ttname"><a href="classNetSessions.html#a4845dfcb5ecc5319f682387c0208809b">NetSessions::stp_manager</a></div><div class="ttdeci">analyzer::stepping_stone::SteppingStoneManager * stp_manager</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00241">Sessions.h:241</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0d3aec7911aed6175f95e45c3cfbcd6d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetSessions::Insert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classConnection.html">Connection</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l01119">1119</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    {</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    assert(c-&gt;<a class="code" href="classConnection.html#a36e522312fdae78fef83d54c84f0e0b5">Key</a>());</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <a class="code" href="classConnection.html">Connection</a>* old = 0;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keywordflow">switch</span> ( c-&gt;<a class="code" href="classConnection.html#a643bd6206b2b153fb082773e2c5f7a5e">ConnTransport</a>() ) {</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="comment">// Remove first. Otherwise the dictioanry would still</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="comment">// reference the old key for already existing connections.</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b">TRANSPORT_TCP</a>:</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        old = (<a class="code" href="classConnection.html">Connection</a>*) tcp_conns.Remove(c-&gt;<a class="code" href="classConnection.html#a36e522312fdae78fef83d54c84f0e0b5">Key</a>());</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        tcp_conns.Insert(c-&gt;<a class="code" href="classConnection.html#a36e522312fdae78fef83d54c84f0e0b5">Key</a>(), c);</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c">TRANSPORT_UDP</a>:</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        old = (<a class="code" href="classConnection.html">Connection</a>*) udp_conns.Remove(c-&gt;<a class="code" href="classConnection.html#a36e522312fdae78fef83d54c84f0e0b5">Key</a>());</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        udp_conns.Insert(c-&gt;<a class="code" href="classConnection.html#a36e522312fdae78fef83d54c84f0e0b5">Key</a>(), c);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba01288141eb45cb369f93202bfbb2635d">TRANSPORT_ICMP</a>:</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        old = (<a class="code" href="classConnection.html">Connection</a>*) icmp_conns.Remove(c-&gt;<a class="code" href="classConnection.html#a36e522312fdae78fef83d54c84f0e0b5">Key</a>());</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        icmp_conns.Insert(c-&gt;<a class="code" href="classConnection.html#a36e522312fdae78fef83d54c84f0e0b5">Key</a>(), c);</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        <a class="code" href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a>-&gt;<a class="code" href="classReporter.html#a94861b8c52a1e09bbea25eaef85a91f6">InternalWarning</a>(<span class="stringliteral">&quot;unknown connection type&quot;</span>);</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <a class="code" href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a>(c);</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    }</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="keywordflow">if</span> ( old &amp;&amp; old != c )</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        {</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        <span class="comment">// Some clean-ups similar to those in Remove() (but invisible</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        <span class="comment">// to the script layer).</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        old-&gt;CancelTimers();</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        <span class="keywordflow">if</span> ( old-&gt;IsPersistent() )</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            <a class="code" href="main_8cc.html#a1aff8a1f8e9083728732277f4726ad8d">persistence_serializer</a>-&gt;<a class="code" href="classPersistenceSerializer.html#aa4bd023d8ffe0981235ab8ffa114aff1">Unregister</a>(old);</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        <span class="keyword">delete</span> old-&gt;Key();</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        old-&gt;ClearKey();</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        <a class="code" href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a>(old);</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        }</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    }</div><div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b">TRANSPORT_TCP</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c">TRANSPORT_UDP</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7ba01288141eb45cb369f93202bfbb2635d"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba01288141eb45cb369f93202bfbb2635d">TRANSPORT_ICMP</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="classConnection_html_a643bd6206b2b153fb082773e2c5f7a5e"><div class="ttname"><a href="classConnection.html#a643bd6206b2b153fb082773e2c5f7a5e">Connection::ConnTransport</a></div><div class="ttdeci">TransportProto ConnTransport() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00114">Conn.h:114</a></div></div>
<div class="ttc" id="Reporter_8cc_html_a25adbcf7f40a03cf61ce36b1e10bbf91"><div class="ttname"><a href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a></div><div class="ttdeci">Reporter * reporter</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00025">Reporter.cc:25</a></div></div>
<div class="ttc" id="classReporter_html_a94861b8c52a1e09bbea25eaef85a91f6"><div class="ttname"><a href="classReporter.html#a94861b8c52a1e09bbea25eaef85a91f6">Reporter::InternalWarning</a></div><div class="ttdeci">void InternalWarning(const char *fmt,...) FMT_ATTR</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00194">Reporter.cc:194</a></div></div>
<div class="ttc" id="classPersistenceSerializer_html_aa4bd023d8ffe0981235ab8ffa114aff1"><div class="ttname"><a href="classPersistenceSerializer.html#aa4bd023d8ffe0981235ab8ffa114aff1">PersistenceSerializer::Unregister</a></div><div class="ttdeci">void Unregister(ID *id)</div><div class="ttdef"><b>Definition:</b> <a href="PersistenceSerializer_8cc_source.html#l00070">PersistenceSerializer.cc:70</a></div></div>
<div class="ttc" id="main_8cc_html_a1aff8a1f8e9083728732277f4726ad8d"><div class="ttname"><a href="main_8cc.html#a1aff8a1f8e9083728732277f4726ad8d">persistence_serializer</a></div><div class="ttdeci">PersistenceSerializer * persistence_serializer</div><div class="ttdef"><b>Definition:</b> <a href="main_8cc_source.html#l00103">main.cc:103</a></div></div>
<div class="ttc" id="classConnection_html"><div class="ttname"><a href="classConnection.html">Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00059">Conn.h:59</a></div></div>
<div class="ttc" id="classConnection_html_a36e522312fdae78fef83d54c84f0e0b5"><div class="ttname"><a href="classConnection.html#a36e522312fdae78fef83d54c84f0e0b5">Connection::Key</a></div><div class="ttdeci">HashKey * Key() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00094">Conn.h:94</a></div></div>
<div class="ttc" id="Obj_8h_html_a3bc2efaea5f7739dc79d7f733f6ee6fe"><div class="ttname"><a href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a></div><div class="ttdeci">void Unref(BroObj *o)</div><div class="ttdef"><b>Definition:</b> <a href="Obj_8h_source.html#l00216">Obj.h:216</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad613585ffce6da5ccaf4069628c463fb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool NetSessions::IsLikelyServerPort </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7b">TransportProto</a>&#160;</td>
          <td class="paramname"><em>transport_proto</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l01288">1288</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    {</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="comment">// We keep a cached in-core version of the table to speed up the lookup.</span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="keyword">static</span> set&lt;bro_uint_t&gt; port_cache;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> have_cache = <span class="keyword">false</span>;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="keywordflow">if</span> ( ! have_cache )</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        {</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        <a class="code" href="classListVal.html">ListVal</a>* lv = <a class="code" href="NetVar_8cc.html#a0413016fc69863a43911432ae0e7cf3f">likely_server_ports</a>-&gt;<a class="code" href="classTableVal.html#ad8c1e421a8c0d261b797f9316ec71e87">ConvertToPureList</a>();</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; lv-&gt;<a class="code" href="classListVal.html#a2b232ace0b5f5c752a2ab846d7066d54">Length</a>(); i++ )</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;            port_cache.insert(lv-&gt;<a class="code" href="classListVal.html#ae001ba9e3bb4483a2a60e6f36f346cbe">Index</a>(i)-&gt;<a class="code" href="classVal.html#a202fb242367a6d0adc9dde5295d053b8">InternalUnsigned</a>());</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        have_cache = <span class="keyword">true</span>;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        <a class="code" href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a>(lv);</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        }</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <span class="comment">// We exploit our knowledge of PortVal&#39;s internal storage mechanism</span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <span class="comment">// here.</span></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="keywordflow">if</span> ( proto == <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b">TRANSPORT_TCP</a> )</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        port |= <a class="code" href="Val_8h.html#a7612d156546b334566850a9593067ad5">TCP_PORT_MASK</a>;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( proto == <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c">TRANSPORT_UDP</a> )</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        port |= <a class="code" href="Val_8h.html#ab68974eef3d456b8f1d8d4fd5cbaef77">UDP_PORT_MASK</a>;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( proto == <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba01288141eb45cb369f93202bfbb2635d">TRANSPORT_ICMP</a> )</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        port |= <a class="code" href="Val_8h.html#a04876abed734bcc5faf74f84b4ace0fd">ICMP_PORT_MASK</a>;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="keywordflow">return</span> port_cache.find(port) != port_cache.end();</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    }</div><div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b">TRANSPORT_TCP</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="classListVal_html_ae001ba9e3bb4483a2a60e6f36f346cbe"><div class="ttname"><a href="classListVal.html#ae001ba9e3bb4483a2a60e6f36f346cbe">ListVal::Index</a></div><div class="ttdeci">Val * Index(const int n)</div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00687">Val.h:687</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c">TRANSPORT_UDP</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7ba01288141eb45cb369f93202bfbb2635d"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba01288141eb45cb369f93202bfbb2635d">TRANSPORT_ICMP</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="Val_8h_html_ab68974eef3d456b8f1d8d4fd5cbaef77"><div class="ttname"><a href="Val_8h.html#ab68974eef3d456b8f1d8d4fd5cbaef77">UDP_PORT_MASK</a></div><div class="ttdeci">#define UDP_PORT_MASK</div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00504">Val.h:504</a></div></div>
<div class="ttc" id="classListVal_html"><div class="ttname"><a href="classListVal.html">ListVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00677">Val.h:677</a></div></div>
<div class="ttc" id="classTableVal_html_ad8c1e421a8c0d261b797f9316ec71e87"><div class="ttname"><a href="classTableVal.html#ad8c1e421a8c0d261b797f9316ec71e87">TableVal::ConvertToPureList</a></div><div class="ttdeci">ListVal * ConvertToPureList() const </div><div class="ttdef"><b>Definition:</b> <a href="Val_8cc_source.html#l02174">Val.cc:2174</a></div></div>
<div class="ttc" id="classListVal_html_a2b232ace0b5f5c752a2ab846d7066d54"><div class="ttname"><a href="classListVal.html#a2b232ace0b5f5c752a2ab846d7066d54">ListVal::Length</a></div><div class="ttdeci">int Length() const </div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00686">Val.h:686</a></div></div>
<div class="ttc" id="Val_8h_html_a7612d156546b334566850a9593067ad5"><div class="ttname"><a href="Val_8h.html#a7612d156546b334566850a9593067ad5">TCP_PORT_MASK</a></div><div class="ttdeci">#define TCP_PORT_MASK</div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00503">Val.h:503</a></div></div>
<div class="ttc" id="NetVar_8cc_html_a0413016fc69863a43911432ae0e7cf3f"><div class="ttname"><a href="NetVar_8cc.html#a0413016fc69863a43911432ae0e7cf3f">likely_server_ports</a></div><div class="ttdeci">TableVal * likely_server_ports</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00209">NetVar.cc:209</a></div></div>
<div class="ttc" id="Val_8h_html_a04876abed734bcc5faf74f84b4ace0fd"><div class="ttname"><a href="Val_8h.html#a04876abed734bcc5faf74f84b4ace0fd">ICMP_PORT_MASK</a></div><div class="ttdeci">#define ICMP_PORT_MASK</div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00505">Val.h:505</a></div></div>
<div class="ttc" id="classVal_html_a202fb242367a6d0adc9dde5295d053b8"><div class="ttname"><a href="classVal.html#a202fb242367a6d0adc9dde5295d053b8">Val::InternalUnsigned</a></div><div class="ttdeci">bro_uint_t InternalUnsigned() const </div><div class="ttdef"><b>Definition:</b> <a href="Val_8cc_source.html#l00351">Val.cc:351</a></div></div>
<div class="ttc" id="Obj_8h_html_a3bc2efaea5f7739dc79d7f733f6ee6fe"><div class="ttname"><a href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a></div><div class="ttdeci">void Unref(BroObj *o)</div><div class="ttdef"><b>Definition:</b> <a href="Obj_8h_source.html#l00216">Obj.h:216</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af2649c0e26761e93a7ed4b49e39004f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTimerMgr.html">TimerMgr</a> * NetSessions::LookupTimerMgr </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTimerMgr.html#a8d797fd4f0dc6dcf1e81026f0265c5f6">TimerMgr::Tag</a> *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>create</em> = <code><a class="el" href="ConvertUTF_8c.html#a41f9c5fb8b08eb5dc3edce4dcb37fee7">true</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l01362">1362</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    {</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="keywordflow">if</span> ( ! tag )</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        {</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        <a class="code" href="DebugLogger_8h.html#a6ae561b796b2ef9273683b54d8b6937e">DBG_LOG</a>(DBG_TM, <span class="stringliteral">&quot;no tag, using global timer mgr %p&quot;</span>, <a class="code" href="main_8cc.html#a36d412e0f4c6a9403bf08b697828e16b">timer_mgr</a>);</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="main_8cc.html#a36d412e0f4c6a9403bf08b697828e16b">timer_mgr</a>;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        }</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    TimerMgrMap::iterator i = <a class="code" href="classNetSessions.html#a5118a8f46d752cfe03b7dbebc4fc3fc1">timer_mgrs</a>.find(*tag);</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="keywordflow">if</span> ( i != <a class="code" href="classNetSessions.html#a5118a8f46d752cfe03b7dbebc4fc3fc1">timer_mgrs</a>.end() )</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        {</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        <a class="code" href="DebugLogger_8h.html#a6ae561b796b2ef9273683b54d8b6937e">DBG_LOG</a>(DBG_TM, <span class="stringliteral">&quot;tag %s, using non-global timer mgr %p&quot;</span>, tag-&gt;c_str(), i-&gt;second);</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        <span class="keywordflow">return</span> i-&gt;second;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        }</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        {</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        <span class="keywordflow">if</span> ( ! create )</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;        <span class="comment">// Create new queue for tag.</span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;        <a class="code" href="classTimerMgr.html">TimerMgr</a>* <a class="code" href="Event_8cc.html#ab301a03781c6c07cacb1f9cb07214b83">mgr</a> = <span class="keyword">new</span> <a class="code" href="classCQ__TimerMgr.html">CQ_TimerMgr</a>(*tag);</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        <a class="code" href="DebugLogger_8h.html#a6ae561b796b2ef9273683b54d8b6937e">DBG_LOG</a>(DBG_TM, <span class="stringliteral">&quot;tag %s, creating new non-global timer mgr %p&quot;</span>, tag-&gt;c_str(), <a class="code" href="Event_8cc.html#ab301a03781c6c07cacb1f9cb07214b83">mgr</a>);</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        <a class="code" href="classNetSessions.html#a5118a8f46d752cfe03b7dbebc4fc3fc1">timer_mgrs</a>.insert(TimerMgrMap::value_type(*tag, mgr));</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        <span class="keywordtype">double</span> t = <a class="code" href="main_8cc.html#a36d412e0f4c6a9403bf08b697828e16b">timer_mgr</a>-&gt;<a class="code" href="classTimerMgr.html#ab77e36741d37990b3173bb93813d09c0">Time</a>() + <a class="code" href="NetVar_8cc.html#a462d52698e3499c0671c06eb6fff9d47">timer_mgr_inactivity_timeout</a>;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        <a class="code" href="main_8cc.html#a36d412e0f4c6a9403bf08b697828e16b">timer_mgr</a>-&gt;<a class="code" href="classTimerMgr.html#aa84391d9c69cee2285928e873ed846fe">Add</a>(<span class="keyword">new</span> <a class="code" href="classNetSessions.html#a633c39d095c642e834eb81c60c14eef7">TimerMgrExpireTimer</a>(t, mgr));</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="Event_8cc.html#ab301a03781c6c07cacb1f9cb07214b83">mgr</a>;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        }</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    }</div><div class="ttc" id="classTimerMgr_html_ab77e36741d37990b3173bb93813d09c0"><div class="ttname"><a href="classTimerMgr.html#ab77e36741d37990b3173bb93813d09c0">TimerMgr::Time</a></div><div class="ttdeci">double Time() const </div><div class="ttdef"><b>Definition:</b> <a href="Timer_8h_source.html#l00107">Timer.h:107</a></div></div>
<div class="ttc" id="classTimerMgr_html_aa84391d9c69cee2285928e873ed846fe"><div class="ttname"><a href="classTimerMgr.html#aa84391d9c69cee2285928e873ed846fe">TimerMgr::Add</a></div><div class="ttdeci">virtual void Add(Timer *timer)=0</div></div>
<div class="ttc" id="Event_8cc_html_ab301a03781c6c07cacb1f9cb07214b83"><div class="ttname"><a href="Event_8cc.html#ab301a03781c6c07cacb1f9cb07214b83">mgr</a></div><div class="ttdeci">EventMgr mgr</div><div class="ttdef"><b>Definition:</b> <a href="Event_8cc_source.html#l00011">Event.cc:11</a></div></div>
<div class="ttc" id="classNetSessions_html_a5118a8f46d752cfe03b7dbebc4fc3fc1"><div class="ttname"><a href="classNetSessions.html#a5118a8f46d752cfe03b7dbebc4fc3fc1">NetSessions::timer_mgrs</a></div><div class="ttdeci">TimerMgrMap timer_mgrs</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00253">Sessions.h:253</a></div></div>
<div class="ttc" id="classTimerMgr_html"><div class="ttname"><a href="classTimerMgr.html">TimerMgr</a></div><div class="ttdef"><b>Definition:</b> <a href="Timer_8h_source.html#l00083">Timer.h:83</a></div></div>
<div class="ttc" id="NetVar_8cc_html_a462d52698e3499c0671c06eb6fff9d47"><div class="ttname"><a href="NetVar_8cc.html#a462d52698e3499c0671c06eb6fff9d47">timer_mgr_inactivity_timeout</a></div><div class="ttdeci">double timer_mgr_inactivity_timeout</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00219">NetVar.cc:219</a></div></div>
<div class="ttc" id="main_8cc_html_a36d412e0f4c6a9403bf08b697828e16b"><div class="ttname"><a href="main_8cc.html#a36d412e0f4c6a9403bf08b697828e16b">timer_mgr</a></div><div class="ttdeci">TimerMgr * timer_mgr</div><div class="ttdef"><b>Definition:</b> <a href="main_8cc_source.html#l00085">main.cc:85</a></div></div>
<div class="ttc" id="DebugLogger_8h_html_a6ae561b796b2ef9273683b54d8b6937e"><div class="ttname"><a href="DebugLogger_8h.html#a6ae561b796b2ef9273683b54d8b6937e">DBG_LOG</a></div><div class="ttdeci">#define DBG_LOG(args...)</div><div class="ttdef"><b>Definition:</b> <a href="DebugLogger_8h_source.html#l00104">DebugLogger.h:104</a></div></div>
<div class="ttc" id="classCQ__TimerMgr_html"><div class="ttname"><a href="classCQ__TimerMgr.html">CQ_TimerMgr</a></div><div class="ttdef"><b>Definition:</b> <a href="Timer_8h_source.html#l00166">Timer.h:166</a></div></div>
<div class="ttc" id="classNetSessions_html_a633c39d095c642e834eb81c60c14eef7"><div class="ttname"><a href="classNetSessions.html#a633c39d095c642e834eb81c60c14eef7">NetSessions::TimerMgrExpireTimer</a></div><div class="ttdeci">friend class TimerMgrExpireTimer</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00185">Sessions.h:185</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0c389409036bfe683b2abb144e6cae7e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int NetSessions::MemoryAllocation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l01497">1497</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    {</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="Net_8cc.html#ad34ddf7f16a2b8ba8547e4f464148077">terminating</a> )</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        <span class="comment">// Connections have been flushed already.</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classNetSessions.html#ad2523153a05c3bd6bf119923fe3b2d4b">ConnectionMemoryUsage</a>()</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        + <a class="code" href="util_8h.html#adc0a69a644240180cd1a3d3566182956">padded_sizeof</a>(*<span class="keyword">this</span>)</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        + <a class="code" href="classNetSessions.html#a7fb2cf6c9b3cdfeb9921f0eef2889fe4">ch</a>-&gt;<a class="code" href="classCompositeHash.html#ad9bba475e289d960f32cdbe1b59b3a1d">MemoryAllocation</a>()</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        <span class="comment">// must take care we don&#39;t count the HaskKeys twice.</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        + tcp_conns.MemoryAllocation() - <a class="code" href="util_8h.html#adc0a69a644240180cd1a3d3566182956">padded_sizeof</a>(tcp_conns) -</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        <span class="comment">// 12 is sizeof(Key) from ConnID::BuildConnKey();</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        <span class="comment">// it can&#39;t be (easily) accessed here. :-(</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;            (tcp_conns.Length() * <a class="code" href="util_8h.html#ac2781c6386de363430a78589fb90b801">pad_size</a>(12))</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        + udp_conns.MemoryAllocation() - <a class="code" href="util_8h.html#adc0a69a644240180cd1a3d3566182956">padded_sizeof</a>(udp_conns) -</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;            (udp_conns.Length() * <a class="code" href="util_8h.html#ac2781c6386de363430a78589fb90b801">pad_size</a>(12))</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        + icmp_conns.MemoryAllocation() - <a class="code" href="util_8h.html#adc0a69a644240180cd1a3d3566182956">padded_sizeof</a>(icmp_conns) -</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;            (icmp_conns.Length() * <a class="code" href="util_8h.html#ac2781c6386de363430a78589fb90b801">pad_size</a>(12))</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        + fragments.MemoryAllocation() - <a class="code" href="util_8h.html#adc0a69a644240180cd1a3d3566182956">padded_sizeof</a>(fragments)</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        <span class="comment">// FIXME: MemoryAllocation() not implemented for rest.</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        ;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    }</div><div class="ttc" id="Net_8cc_html_ad34ddf7f16a2b8ba8547e4f464148077"><div class="ttname"><a href="Net_8cc.html#ad34ddf7f16a2b8ba8547e4f464148077">terminating</a></div><div class="ttdeci">bool terminating</div><div class="ttdef"><b>Definition:</b> <a href="Net_8cc_source.html#l00060">Net.cc:60</a></div></div>
<div class="ttc" id="classCompositeHash_html_ad9bba475e289d960f32cdbe1b59b3a1d"><div class="ttname"><a href="classCompositeHash.html#ad9bba475e289d960f32cdbe1b59b3a1d">CompositeHash::MemoryAllocation</a></div><div class="ttdeci">unsigned int MemoryAllocation() const </div><div class="ttdef"><b>Definition:</b> <a href="CompHash_8h_source.html#l00023">CompHash.h:23</a></div></div>
<div class="ttc" id="classNetSessions_html_a7fb2cf6c9b3cdfeb9921f0eef2889fe4"><div class="ttname"><a href="classNetSessions.html#a7fb2cf6c9b3cdfeb9921f0eef2889fe4">NetSessions::ch</a></div><div class="ttdeci">CompositeHash * ch</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00228">Sessions.h:228</a></div></div>
<div class="ttc" id="util_8h_html_adc0a69a644240180cd1a3d3566182956"><div class="ttname"><a href="util_8h.html#adc0a69a644240180cd1a3d3566182956">padded_sizeof</a></div><div class="ttdeci">#define padded_sizeof(x)</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00455">util.h:455</a></div></div>
<div class="ttc" id="util_8h_html_ac2781c6386de363430a78589fb90b801"><div class="ttname"><a href="util_8h.html#ac2781c6386de363430a78589fb90b801">pad_size</a></div><div class="ttdeci">size_t pad_size(size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00441">util.h:441</a></div></div>
<div class="ttc" id="classNetSessions_html_ad2523153a05c3bd6bf119923fe3b2d4b"><div class="ttname"><a href="classNetSessions.html#ad2523153a05c3bd6bf119923fe3b2d4b">NetSessions::ConnectionMemoryUsage</a></div><div class="ttdeci">unsigned int ConnectionMemoryUsage()</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l01439">Sessions.cc:1439</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad3965a2f68ea9c8cdd2b7c729af33720"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classConnection.html">Connection</a> * NetSessions::NewConn </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classHashKey.html">HashKey</a> *&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structConnID.html">ConnID</a> *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>proto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&#160;</td>
          <td class="paramname"><em>flow_label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classPacket.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classEncapsulationStack.html">EncapsulationStack</a> *&#160;</td>
          <td class="paramname"><em>encapsulation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l01212">1212</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    {</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="comment">// FIXME: This should be cleaned up a bit, it&#39;s too protocol-specific.</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="comment">// But I&#39;m not yet sure what the right abstraction for these things is.</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keywordtype">int</span> src_h = ntohs(id-&gt;<a class="code" href="structConnID.html#ae9ad37d2e62210daa8955938351b61a2">src_port</a>);</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordtype">int</span> dst_h = ntohs(id-&gt;<a class="code" href="structConnID.html#a76f9ae769858dca80ed4d4c254194300">dst_port</a>);</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="keywordtype">int</span> flags = 0;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="comment">// Hmm... This is not great.</span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7b">TransportProto</a> tproto = <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba469684f53d3c998404f68f8ec9949a31">TRANSPORT_UNKNOWN</a>;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">switch</span> ( proto ) {</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <span class="keywordflow">case</span> IPPROTO_ICMP:</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;            tproto = <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba01288141eb45cb369f93202bfbb2635d">TRANSPORT_ICMP</a>;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        <span class="keywordflow">case</span> IPPROTO_TCP:</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;            tproto = <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b">TRANSPORT_TCP</a>;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <span class="keywordflow">case</span> IPPROTO_UDP:</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;            tproto = <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c">TRANSPORT_UDP</a>;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        <span class="keywordflow">case</span> IPPROTO_ICMPV6:</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;            tproto = <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba01288141eb45cb369f93202bfbb2635d">TRANSPORT_ICMP</a>;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;            <a class="code" href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a>-&gt;<a class="code" href="classReporter.html#a94861b8c52a1e09bbea25eaef85a91f6">InternalWarning</a>(<span class="stringliteral">&quot;unknown transport protocol&quot;</span>);</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    };</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="keywordflow">if</span> ( tproto == <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b">TRANSPORT_TCP</a> )</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        {</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span>tcphdr* tp = (<span class="keyword">const</span> <span class="keyword">struct </span>tcphdr*) data;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        flags = tp-&gt;th_flags;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        }</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="keywordtype">bool</span> flip = <span class="keyword">false</span>;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="keywordflow">if</span> ( ! <a class="code" href="classNetSessions.html#af4be660e05101732d5eea8e6911eff62">WantConnection</a>(src_h, dst_h, tproto, flags, flip) )</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <a class="code" href="classConnection.html">Connection</a>* conn = <span class="keyword">new</span> <a class="code" href="classConnection.html">Connection</a>(<span class="keyword">this</span>, k, t, <span class="keywordtype">id</span>, flow_label, pkt, encapsulation);</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    conn-&gt;<a class="code" href="classConnection.html#a13d3b4489fdba64ebe5ff817764c9863">SetTransport</a>(tproto);</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="keywordflow">if</span> ( flip )</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        conn-&gt;<a class="code" href="classConnection.html#a604262e1bacd78e75bfae5ef14842614">FlipRoles</a>();</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">if</span> ( ! <a class="code" href="analyzer_2Manager_8h.html#a25cdba2acf7169ec48d7083f1bee49cf">analyzer_mgr</a>-&gt;<a class="code" href="classanalyzer_1_1Manager.html#a7e8ed0f63b8c18ea9aa044bb15d71500">BuildInitialAnalyzerTree</a>(conn) )</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        {</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        conn-&gt;<a class="code" href="classConnection.html#a27a89759136c363f10260f4cf6d9b44c">Done</a>();</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        <a class="code" href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a>(conn);</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        }</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <span class="keywordtype">bool</span> external = conn-&gt;<a class="code" href="classConnection.html#adfcaaf6597ba088d49c347a88a1bc5a9">IsExternal</a>();</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <span class="keywordflow">if</span> ( external )</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        conn-&gt;<a class="code" href="classConnection.html#a4e5faa89c36bead277ba8993d5b75589">AppendAddl</a>(<a class="code" href="util_8cc.html#acd55da5095039a6a84317688425cac72">fmt</a>(<span class="stringliteral">&quot;tag=%s&quot;</span>,</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                    conn-&gt;<a class="code" href="classConnection.html#ab9824df8fee17aefafef0053973f1c97">GetTimerMgr</a>()-&gt;<a class="code" href="classTimerMgr.html#a11e88dbb93a6602ad380a6af17f6d8e4">GetTag</a>().c_str()));</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <span class="keywordflow">if</span> ( new_connection )</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        {</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        conn-&gt;<a class="code" href="classConnection.html#ae8480aebbcac15331efe7a1591eaaca8">Event</a>(new_connection, 0);</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <span class="keywordflow">if</span> ( external )</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;            {</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            val_list* vl = <span class="keyword">new</span> val_list(2);</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;            vl-&gt;append(conn-&gt;<a class="code" href="classConnection.html#ab93ac995df88932d9bf877429e57bc0f">BuildConnVal</a>());</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;            vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classStringVal.html">StringVal</a>(conn-&gt;<a class="code" href="classConnection.html#ab9824df8fee17aefafef0053973f1c97">GetTimerMgr</a>()-&gt;<a class="code" href="classTimerMgr.html#a11e88dbb93a6602ad380a6af17f6d8e4">GetTag</a>().c_str()));</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;            conn-&gt;<a class="code" href="classConnection.html#a8a0c52c8878b83aab9006d781f8fa7b9">ConnectionEvent</a>(connection_external, 0, vl);</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;            }</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        }</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="keywordflow">return</span> conn;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    }</div><div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b">TRANSPORT_TCP</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="classConnection_html_ae8480aebbcac15331efe7a1591eaaca8"><div class="ttname"><a href="classConnection.html#ae8480aebbcac15331efe7a1591eaaca8">Connection::Event</a></div><div class="ttdeci">void Event(EventHandlerPtr f, analyzer::Analyzer *analyzer, const char *name=0)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00682">Conn.cc:682</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7b"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7b">TransportProto</a></div><div class="ttdeci">TransportProto</div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00009">net_util.h:9</a></div></div>
<div class="ttc" id="classTimerMgr_html_a11e88dbb93a6602ad380a6af17f6d8e4"><div class="ttname"><a href="classTimerMgr.html#a11e88dbb93a6602ad380a6af17f6d8e4">TimerMgr::GetTag</a></div><div class="ttdeci">const Tag &amp; GetTag() const </div><div class="ttdef"><b>Definition:</b> <a href="Timer_8h_source.html#l00110">Timer.h:110</a></div></div>
<div class="ttc" id="classConnection_html_adfcaaf6597ba088d49c347a88a1bc5a9"><div class="ttname"><a href="classConnection.html#adfcaaf6597ba088d49c347a88a1bc5a9">Connection::IsExternal</a></div><div class="ttdeci">bool IsExternal() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00213">Conn.h:213</a></div></div>
<div class="ttc" id="structConnID_html_ae9ad37d2e62210daa8955938351b61a2"><div class="ttname"><a href="structConnID.html#ae9ad37d2e62210daa8955938351b61a2">ConnID::src_port</a></div><div class="ttdeci">uint32 src_port</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00046">Conn.h:46</a></div></div>
<div class="ttc" id="classStringVal_html"><div class="ttname"><a href="classStringVal.html">StringVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00623">Val.h:623</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c">TRANSPORT_UDP</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7ba01288141eb45cb369f93202bfbb2635d"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba01288141eb45cb369f93202bfbb2635d">TRANSPORT_ICMP</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="classConnection_html_a8a0c52c8878b83aab9006d781f8fa7b9"><div class="ttname"><a href="classConnection.html#a8a0c52c8878b83aab9006d781f8fa7b9">Connection::ConnectionEvent</a></div><div class="ttdeci">void ConnectionEvent(EventHandlerPtr f, analyzer::Analyzer *analyzer, val_list *vl)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00714">Conn.cc:714</a></div></div>
<div class="ttc" id="Reporter_8cc_html_a25adbcf7f40a03cf61ce36b1e10bbf91"><div class="ttname"><a href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a></div><div class="ttdeci">Reporter * reporter</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00025">Reporter.cc:25</a></div></div>
<div class="ttc" id="classReporter_html_a94861b8c52a1e09bbea25eaef85a91f6"><div class="ttname"><a href="classReporter.html#a94861b8c52a1e09bbea25eaef85a91f6">Reporter::InternalWarning</a></div><div class="ttdeci">void InternalWarning(const char *fmt,...) FMT_ATTR</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00194">Reporter.cc:194</a></div></div>
<div class="ttc" id="structConnID_html_a76f9ae769858dca80ed4d4c254194300"><div class="ttname"><a href="structConnID.html#a76f9ae769858dca80ed4d4c254194300">ConnID::dst_port</a></div><div class="ttdeci">uint32 dst_port</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00047">Conn.h:47</a></div></div>
<div class="ttc" id="classNetSessions_html_af4be660e05101732d5eea8e6911eff62"><div class="ttname"><a href="classNetSessions.html#af4be660e05101732d5eea8e6911eff62">NetSessions::WantConnection</a></div><div class="ttdeci">bool WantConnection(uint16 src_port, uint16 dest_port, TransportProto transport_proto, uint8 tcp_flags, bool &amp;flip_roles)</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l01315">Sessions.cc:1315</a></div></div>
<div class="ttc" id="analyzer_2Manager_8h_html_a25cdba2acf7169ec48d7083f1bee49cf"><div class="ttname"><a href="analyzer_2Manager_8h.html#a25cdba2acf7169ec48d7083f1bee49cf">analyzer_mgr</a></div><div class="ttdeci">analyzer::Manager * analyzer_mgr</div><div class="ttdef"><b>Definition:</b> <a href="main_8cc_source.html#l00091">main.cc:91</a></div></div>
<div class="ttc" id="classConnection_html_a604262e1bacd78e75bfae5ef14842614"><div class="ttname"><a href="classConnection.html#a604262e1bacd78e75bfae5ef14842614">Connection::FlipRoles</a></div><div class="ttdeci">void FlipRoles()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00789">Conn.cc:789</a></div></div>
<div class="ttc" id="util_8cc_html_acd55da5095039a6a84317688425cac72"><div class="ttname"><a href="util_8cc.html#acd55da5095039a6a84317688425cac72">fmt</a></div><div class="ttdeci">const char * fmt(const char *format, va_list al)</div><div class="ttdef"><b>Definition:</b> <a href="util_8cc_source.html#l00545">util.cc:545</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7ba469684f53d3c998404f68f8ec9949a31"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba469684f53d3c998404f68f8ec9949a31">TRANSPORT_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="classConnection_html_a4e5faa89c36bead277ba8993d5b75589"><div class="ttname"><a href="classConnection.html#a4e5faa89c36bead277ba8993d5b75589">Connection::AppendAddl</a></div><div class="ttdeci">void AppendAddl(const char *str)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00486">Conn.cc:486</a></div></div>
<div class="ttc" id="classConnection_html_a27a89759136c363f10260f4cf6d9b44c"><div class="ttname"><a href="classConnection.html#a27a89759136c363f10260f4cf6d9b44c">Connection::Done</a></div><div class="ttdeci">void Done()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00245">Conn.cc:245</a></div></div>
<div class="ttc" id="classConnection_html_a13d3b4489fdba64ebe5ff817764c9863"><div class="ttname"><a href="classConnection.html#a13d3b4489fdba64ebe5ff817764c9863">Connection::SetTransport</a></div><div class="ttdeci">void SetTransport(TransportProto arg_proto)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00267">Conn.h:267</a></div></div>
<div class="ttc" id="classConnection_html"><div class="ttname"><a href="classConnection.html">Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00059">Conn.h:59</a></div></div>
<div class="ttc" id="Obj_8h_html_a3bc2efaea5f7739dc79d7f733f6ee6fe"><div class="ttname"><a href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a></div><div class="ttdeci">void Unref(BroObj *o)</div><div class="ttdef"><b>Definition:</b> <a href="Obj_8h_source.html#l00216">Obj.h:216</a></div></div>
<div class="ttc" id="classanalyzer_1_1Manager_html_a7e8ed0f63b8c18ea9aa044bb15d71500"><div class="ttname"><a href="classanalyzer_1_1Manager.html#a7e8ed0f63b8c18ea9aa044bb15d71500">analyzer::Manager::BuildInitialAnalyzerTree</a></div><div class="ttdeci">bool BuildInitialAnalyzerTree(Connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Manager_8cc_source.html#l00357">Manager.cc:357</a></div></div>
<div class="ttc" id="classConnection_html_ab9824df8fee17aefafef0053973f1c97"><div class="ttname"><a href="classConnection.html#ab9824df8fee17aefafef0053973f1c97">Connection::GetTimerMgr</a></div><div class="ttdeci">TimerMgr * GetTimerMgr() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00776">Conn.cc:776</a></div></div>
<div class="ttc" id="classConnection_html_ab93ac995df88932d9bf877429e57bc0f"><div class="ttname"><a href="classConnection.html#ab93ac995df88932d9bf877429e57bc0f">Connection::BuildConnVal</a></div><div class="ttdeci">RecordVal * BuildConnVal()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00401">Conn.cc:401</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a83c4d484f576c82038cea5cd91f7f552"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classFragReassembler.html">FragReassembler</a> * NetSessions::NextFragment </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&#160;</td>
          <td class="paramname"><em>pkt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l00918">918</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    {</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> frag_id = ip-&gt;<a class="code" href="classIP__Hdr.html#a9ddce824b8b97f1b4b8fac9c861d5ab1">ID</a>();</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <a class="code" href="classListVal.html">ListVal</a>* key = <span class="keyword">new</span> <a class="code" href="classListVal.html">ListVal</a>(<a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af173f42b16daa16262e56c2e12fb11b3">TYPE_ANY</a>);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    key-&gt;<a class="code" href="classListVal.html#ade3ceb680c202c56ce0e4ef849b7fb6b">Append</a>(<span class="keyword">new</span> <a class="code" href="classAddrVal.html">AddrVal</a>(ip-&gt;<a class="code" href="classIP__Hdr.html#a8256bb033063a8e8034beb36bc3bff5c">SrcAddr</a>()));</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    key-&gt;<a class="code" href="classListVal.html#ade3ceb680c202c56ce0e4ef849b7fb6b">Append</a>(<span class="keyword">new</span> <a class="code" href="classAddrVal.html">AddrVal</a>(ip-&gt;<a class="code" href="classIP__Hdr.html#a5c09f4d749016bc3cf3dbee8a048bcfc">DstAddr</a>()));</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    key-&gt;<a class="code" href="classListVal.html#ade3ceb680c202c56ce0e4ef849b7fb6b">Append</a>(<span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(frag_id, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <a class="code" href="classHashKey.html">HashKey</a>* h = <a class="code" href="classNetSessions.html#a7fb2cf6c9b3cdfeb9921f0eef2889fe4">ch</a>-&gt;<a class="code" href="classCompositeHash.html#af33eb73df08ae956279a55a00f8c119a">ComputeHash</a>(key, 1);</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="keywordflow">if</span> ( ! h )</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <a class="code" href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a>-&gt;<a class="code" href="classReporter.html#a1820e1da136fa37d8c7561b5a831392d">InternalError</a>(<span class="stringliteral">&quot;hash computation failed&quot;</span>);</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <a class="code" href="classFragReassembler.html">FragReassembler</a>* f = fragments.Lookup(h);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="keywordflow">if</span> ( ! f )</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        {</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        f = <span class="keyword">new</span> <a class="code" href="classFragReassembler.html">FragReassembler</a>(<span class="keyword">this</span>, ip, pkt, h, t);</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        fragments.Insert(h, f);</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <a class="code" href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a>(key);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <span class="keywordflow">return</span> f;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        }</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="keyword">delete</span> h;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <a class="code" href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a>(key);</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    f-&gt;<a class="code" href="classFragReassembler.html#a007d4c6f4f70c1ca4c2e61dea9fbf15e">AddFragment</a>(t, ip, pkt);</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keywordflow">return</span> f;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    }</div><div class="ttc" id="classIP__Hdr_html_a8256bb033063a8e8034beb36bc3bff5c"><div class="ttname"><a href="classIP__Hdr.html#a8256bb033063a8e8034beb36bc3bff5c">IP_Hdr::SrcAddr</a></div><div class="ttdeci">IPAddr SrcAddr() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00418">IP.h:418</a></div></div>
<div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76af173f42b16daa16262e56c2e12fb11b3"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af173f42b16daa16262e56c2e12fb11b3">TYPE_ANY</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00034">Type.h:34</a></div></div>
<div class="ttc" id="classVal_html"><div class="ttname"><a href="classVal.html">Val</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00078">Val.h:78</a></div></div>
<div class="ttc" id="Reporter_8cc_html_a25adbcf7f40a03cf61ce36b1e10bbf91"><div class="ttname"><a href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a></div><div class="ttdeci">Reporter * reporter</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00025">Reporter.cc:25</a></div></div>
<div class="ttc" id="classListVal_html"><div class="ttname"><a href="classListVal.html">ListVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00677">Val.h:677</a></div></div>
<div class="ttc" id="classNetSessions_html_a7fb2cf6c9b3cdfeb9921f0eef2889fe4"><div class="ttname"><a href="classNetSessions.html#a7fb2cf6c9b3cdfeb9921f0eef2889fe4">NetSessions::ch</a></div><div class="ttdeci">CompositeHash * ch</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00228">Sessions.h:228</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a5c09f4d749016bc3cf3dbee8a048bcfc"><div class="ttname"><a href="classIP__Hdr.html#a5c09f4d749016bc3cf3dbee8a048bcfc">IP_Hdr::DstAddr</a></div><div class="ttdeci">IPAddr DstAddr() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00427">IP.h:427</a></div></div>
<div class="ttc" id="classHashKey_html"><div class="ttname"><a href="classHashKey.html">HashKey</a></div><div class="ttdef"><b>Definition:</b> <a href="Hash_8h_source.html#l00021">Hash.h:21</a></div></div>
<div class="ttc" id="classFragReassembler_html_a007d4c6f4f70c1ca4c2e61dea9fbf15e"><div class="ttname"><a href="classFragReassembler.html#a007d4c6f4f70c1ca4c2e61dea9fbf15e">FragReassembler::AddFragment</a></div><div class="ttdeci">void AddFragment(double t, const IP_Hdr *ip, const u_char *pkt)</div><div class="ttdef"><b>Definition:</b> <a href="Frag_8cc_source.html#l00074">Frag.cc:74</a></div></div>
<div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00022">Type.h:22</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a9ddce824b8b97f1b4b8fac9c861d5ab1"><div class="ttname"><a href="classIP__Hdr.html#a9ddce824b8b97f1b4b8fac9c861d5ab1">IP_Hdr::ID</a></div><div class="ttdeci">uint32 ID() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00538">IP.h:538</a></div></div>
<div class="ttc" id="classAddrVal_html"><div class="ttname"><a href="classAddrVal.html">AddrVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00570">Val.h:570</a></div></div>
<div class="ttc" id="classFragReassembler_html"><div class="ttname"><a href="classFragReassembler.html">FragReassembler</a></div><div class="ttdef"><b>Definition:</b> <a href="Frag_8h_source.html#l00020">Frag.h:20</a></div></div>
<div class="ttc" id="classListVal_html_ade3ceb680c202c56ce0e4ef849b7fb6b"><div class="ttname"><a href="classListVal.html#ade3ceb680c202c56ce0e4ef849b7fb6b">ListVal::Append</a></div><div class="ttdeci">void Append(Val *v)</div><div class="ttdef"><b>Definition:</b> <a href="Val_8cc_source.html#l01244">Val.cc:1244</a></div></div>
<div class="ttc" id="util_8h_html_acbd4acd0d29e2d6c43104827f77d9cd2"><div class="ttname"><a href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00064">util.h:64</a></div></div>
<div class="ttc" id="classCompositeHash_html_af33eb73df08ae956279a55a00f8c119a"><div class="ttname"><a href="classCompositeHash.html#af33eb73df08ae956279a55a00f8c119a">CompositeHash::ComputeHash</a></div><div class="ttdeci">HashKey * ComputeHash(const Val *v, int type_check) const </div><div class="ttdef"><b>Definition:</b> <a href="CompHash_8cc_source.html#l00282">CompHash.cc:282</a></div></div>
<div class="ttc" id="classReporter_html_a1820e1da136fa37d8c7561b5a831392d"><div class="ttname"><a href="classReporter.html#a1820e1da136fa37d8c7561b5a831392d">Reporter::InternalError</a></div><div class="ttdeci">void InternalError(const char *fmt,...) FMT_ATTR</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00165">Reporter.cc:165</a></div></div>
<div class="ttc" id="Obj_8h_html_a3bc2efaea5f7739dc79d7f733f6ee6fe"><div class="ttname"><a href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a></div><div class="ttdeci">void Unref(BroObj *o)</div><div class="ttdef"><b>Definition:</b> <a href="Obj_8h_source.html#l00216">Obj.h:216</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa52dd9eb1caa1b54c66c3d4846fa16ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetSessions::NextPacket </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classPacket.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>pkt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l00169">169</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="classSegmentProfiler.html">SegmentProfiler</a>(<a class="code" href="main_8cc.html#aa98864cd95ce95d95ad07fbd163531e1">segment_logger</a>, <span class="stringliteral">&quot;dispatching-packet&quot;</span>);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">if</span> ( raw_packet )</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        val_list* vl = <span class="keyword">new</span> val_list();</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        vl-&gt;append(pkt-&gt;<a class="code" href="classPacket.html#a288d84e462bc379a9e5b2366f04f3955">BuildPktHdrVal</a>());</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <a class="code" href="Event_8cc.html#ab301a03781c6c07cacb1f9cb07214b83">mgr</a>.<a class="code" href="classEventMgr.html#a5f91cb07c02ed60fb39e65147af322b7">QueueEvent</a>(raw_packet, vl);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="classNetSessions.html#aafee75c822a3c0c0f5468c0e75789229">pkt_profiler</a> )</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <a class="code" href="classNetSessions.html#aafee75c822a3c0c0f5468c0e75789229">pkt_profiler</a>-&gt;<a class="code" href="classPacketProfiler.html#a9b1dc69a27b4bff2c3a99bae49bf0ee6">ProfilePkt</a>(t, pkt-&gt;<a class="code" href="classPacket.html#ac0d8af22ea8d9a67d4952241d95d4a0d">cap_len</a>);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    ++<a class="code" href="classNetSessions.html#a26490773024adcd5527bdc17d98957f9">num_packets_processed</a>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="classNetSessions.html#abb38b95e4eae2b4ecb38e1bb481e2522">dump_this_packet</a> = 0;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="NetVar_8cc.html#a4326d8b0a49f6c774021ef250ad1e5e8">record_all_packets</a> )</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <a class="code" href="classNetSessions.html#ab8a81976f7c6230a5d8f0e50d6cda708">DumpPacket</a>(pkt);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">if</span> ( pkt-&gt;<a class="code" href="classPacket.html#a394c54942ec7d3c8c5aeae5b5afe6560">hdr_size</a> &gt; pkt-&gt;<a class="code" href="classPacket.html#ac0d8af22ea8d9a67d4952241d95d4a0d">cap_len</a> )</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;truncated_link_frame&quot;</span>, pkt);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> caplen = pkt-&gt;<a class="code" href="classPacket.html#ac0d8af22ea8d9a67d4952241d95d4a0d">cap_len</a> - pkt-&gt;<a class="code" href="classPacket.html#a394c54942ec7d3c8c5aeae5b5afe6560">hdr_size</a>;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">if</span> ( pkt-&gt;<a class="code" href="classPacket.html#a1150032cf37e9a741c0208e00a538d3b">l3_proto</a> == <a class="code" href="Packet_8h.html#a009f8fad15663c609d975eba4b4cc6e9a35241f77b72fe00b11180ddcd31bc803">L3_IPV4</a> )</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordflow">if</span> ( caplen &lt; <span class="keyword">sizeof</span>(<span class="keyword">struct</span> ip) )</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;truncated_IP&quot;</span>, pkt);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span>ip* ip = (<span class="keyword">const</span> <span class="keyword">struct </span>ip*) (pkt-&gt;<a class="code" href="classPacket.html#aa1f4f749e6ed1c424ff6da4efe814fc9">data</a> + pkt-&gt;<a class="code" href="classPacket.html#a394c54942ec7d3c8c5aeae5b5afe6560">hdr_size</a>);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <a class="code" href="classIP__Hdr.html">IP_Hdr</a> ip_hdr(ip, <span class="keyword">false</span>);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <a class="code" href="classNetSessions.html#aa9e7d4c9ca9f04b797f8090bc88f37cc">DoNextPacket</a>(t, pkt, &amp;ip_hdr, 0);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pkt-&gt;<a class="code" href="classPacket.html#a1150032cf37e9a741c0208e00a538d3b">l3_proto</a> == <a class="code" href="Packet_8h.html#a009f8fad15663c609d975eba4b4cc6e9aeff6ddd2c7304a21cee15a6abb40d4af">L3_IPV6</a> )</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        {</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keywordflow">if</span> ( caplen &lt; <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structip6__hdr.html">ip6_hdr</a>) )</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;truncated_IP&quot;</span>, pkt);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <a class="code" href="classIP__Hdr.html">IP_Hdr</a> ip_hdr((<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structip6__hdr.html">ip6_hdr</a>*) (pkt-&gt;<a class="code" href="classPacket.html#aa1f4f749e6ed1c424ff6da4efe814fc9">data</a> + pkt-&gt;<a class="code" href="classPacket.html#a394c54942ec7d3c8c5aeae5b5afe6560">hdr_size</a>), <span class="keyword">false</span>, caplen);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <a class="code" href="classNetSessions.html#aa9e7d4c9ca9f04b797f8090bc88f37cc">DoNextPacket</a>(t, pkt, &amp;ip_hdr, 0);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pkt-&gt;<a class="code" href="classPacket.html#a1150032cf37e9a741c0208e00a538d3b">l3_proto</a> == <a class="code" href="Packet_8h.html#a009f8fad15663c609d975eba4b4cc6e9ab05fbe8d94251eca586060955b69b65f">L3_ARP</a> )</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="classNetSessions.html#ae746b070666b44da520738283037b24b">arp_analyzer</a> )</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <a class="code" href="classNetSessions.html#ae746b070666b44da520738283037b24b">arp_analyzer</a>-&gt;<a class="code" href="classanalyzer_1_1arp_1_1ARP__Analyzer.html#a8e222c5349d7c7a171efd4f19fab1e97">NextPacket</a>(t, pkt);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <a class="code" href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">Weird</a>(<span class="stringliteral">&quot;unknown_packet_type&quot;</span>, pkt);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="classNetSessions.html#abb38b95e4eae2b4ecb38e1bb481e2522">dump_this_packet</a> &amp;&amp; ! <a class="code" href="NetVar_8cc.html#a4326d8b0a49f6c774021ef250ad1e5e8">record_all_packets</a> )</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="classNetSessions.html#ab8a81976f7c6230a5d8f0e50d6cda708">DumpPacket</a>(pkt);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div><div class="ttc" id="classNetSessions_html_aa9e7d4c9ca9f04b797f8090bc88f37cc"><div class="ttname"><a href="classNetSessions.html#aa9e7d4c9ca9f04b797f8090bc88f37cc">NetSessions::DoNextPacket</a></div><div class="ttdeci">void DoNextPacket(double t, const Packet *pkt, const IP_Hdr *ip_hdr, const EncapsulationStack *encapsulation)</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l00318">Sessions.cc:318</a></div></div>
<div class="ttc" id="Event_8cc_html_ab301a03781c6c07cacb1f9cb07214b83"><div class="ttname"><a href="Event_8cc.html#ab301a03781c6c07cacb1f9cb07214b83">mgr</a></div><div class="ttdeci">EventMgr mgr</div><div class="ttdef"><b>Definition:</b> <a href="Event_8cc_source.html#l00011">Event.cc:11</a></div></div>
<div class="ttc" id="Packet_8h_html_a009f8fad15663c609d975eba4b4cc6e9aeff6ddd2c7304a21cee15a6abb40d4af"><div class="ttname"><a href="Packet_8h.html#a009f8fad15663c609d975eba4b4cc6e9aeff6ddd2c7304a21cee15a6abb40d4af">L3_IPV6</a></div><div class="ttdoc">Layer 3 is IPv4. </div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00021">Packet.h:21</a></div></div>
<div class="ttc" id="NetVar_8cc_html_a4326d8b0a49f6c774021ef250ad1e5e8"><div class="ttname"><a href="NetVar_8cc.html#a4326d8b0a49f6c774021ef250ad1e5e8">record_all_packets</a></div><div class="ttdeci">int record_all_packets</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00223">NetVar.cc:223</a></div></div>
<div class="ttc" id="Packet_8h_html_a009f8fad15663c609d975eba4b4cc6e9a35241f77b72fe00b11180ddcd31bc803"><div class="ttname"><a href="Packet_8h.html#a009f8fad15663c609d975eba4b4cc6e9a35241f77b72fe00b11180ddcd31bc803">L3_IPV4</a></div><div class="ttdoc">Layer 3 type could not be determined. </div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00020">Packet.h:20</a></div></div>
<div class="ttc" id="classSegmentProfiler_html"><div class="ttname"><a href="classSegmentProfiler.html">SegmentProfiler</a></div><div class="ttdef"><b>Definition:</b> <a href="Stats_8h_source.html#l00027">Stats.h:27</a></div></div>
<div class="ttc" id="classIP__Hdr_html"><div class="ttname"><a href="classIP__Hdr.html">IP_Hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00339">IP.h:339</a></div></div>
<div class="ttc" id="classPacketProfiler_html_a9b1dc69a27b4bff2c3a99bae49bf0ee6"><div class="ttname"><a href="classPacketProfiler.html#a9b1dc69a27b4bff2c3a99bae49bf0ee6">PacketProfiler::ProfilePkt</a></div><div class="ttdeci">void ProfilePkt(double t, unsigned int bytes)</div><div class="ttdef"><b>Definition:</b> <a href="Stats_8cc_source.html#l00431">Stats.cc:431</a></div></div>
<div class="ttc" id="main_8cc_html_aa98864cd95ce95d95ad07fbd163531e1"><div class="ttname"><a href="main_8cc.html#aa98864cd95ce95d95ad07fbd163531e1">segment_logger</a></div><div class="ttdeci">ProfileLogger * segment_logger</div><div class="ttdef"><b>Definition:</b> <a href="main_8cc_source.html#l00110">main.cc:110</a></div></div>
<div class="ttc" id="classanalyzer_1_1arp_1_1ARP__Analyzer_html_a8e222c5349d7c7a171efd4f19fab1e97"><div class="ttname"><a href="classanalyzer_1_1arp_1_1ARP__Analyzer.html#a8e222c5349d7c7a171efd4f19fab1e97">analyzer::arp::ARP_Analyzer::NextPacket</a></div><div class="ttdeci">void NextPacket(double t, const Packet *pkt)</div><div class="ttdef"><b>Definition:</b> <a href="ARP_8cc_source.html#l00078">ARP.cc:78</a></div></div>
<div class="ttc" id="classNetSessions_html_ae746b070666b44da520738283037b24b"><div class="ttname"><a href="classNetSessions.html#ae746b070666b44da520738283037b24b">NetSessions::arp_analyzer</a></div><div class="ttdeci">analyzer::arp::ARP_Analyzer * arp_analyzer</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00239">Sessions.h:239</a></div></div>
<div class="ttc" id="Packet_8h_html_a009f8fad15663c609d975eba4b4cc6e9ab05fbe8d94251eca586060955b69b65f"><div class="ttname"><a href="Packet_8h.html#a009f8fad15663c609d975eba4b4cc6e9ab05fbe8d94251eca586060955b69b65f">L3_ARP</a></div><div class="ttdoc">Layer 3 is IPv6. </div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00022">Packet.h:22</a></div></div>
<div class="ttc" id="classNetSessions_html_aafee75c822a3c0c0f5468c0e75789229"><div class="ttname"><a href="classNetSessions.html#aafee75c822a3c0c0f5468c0e75789229">NetSessions::pkt_profiler</a></div><div class="ttdeci">PacketProfiler * pkt_profiler</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00248">Sessions.h:248</a></div></div>
<div class="ttc" id="classPacket_html_a1150032cf37e9a741c0208e00a538d3b"><div class="ttname"><a href="classPacket.html#a1150032cf37e9a741c0208e00a538d3b">Packet::l3_proto</a></div><div class="ttdeci">Layer3Proto l3_proto</div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00183">Packet.h:183</a></div></div>
<div class="ttc" id="classPacket_html_a288d84e462bc379a9e5b2366f04f3955"><div class="ttname"><a href="classPacket.html#a288d84e462bc379a9e5b2366f04f3955">Packet::BuildPktHdrVal</a></div><div class="ttdeci">RecordVal * BuildPktHdrVal() const </div><div class="ttdef"><b>Definition:</b> <a href="Packet_8cc_source.html#l00496">Packet.cc:496</a></div></div>
<div class="ttc" id="classEventMgr_html_a5f91cb07c02ed60fb39e65147af322b7"><div class="ttname"><a href="classEventMgr.html#a5f91cb07c02ed60fb39e65147af322b7">EventMgr::QueueEvent</a></div><div class="ttdeci">void QueueEvent(const EventHandlerPtr &amp;h, val_list *vl, SourceID src=SOURCE_LOCAL, analyzer::ID aid=0, TimerMgr *mgr=0, BroObj *obj=0)</div><div class="ttdef"><b>Definition:</b> <a href="Event_8h_source.html#l00056">Event.h:56</a></div></div>
<div class="ttc" id="classNetSessions_html_a26490773024adcd5527bdc17d98957f9"><div class="ttname"><a href="classNetSessions.html#a26490773024adcd5527bdc17d98957f9">NetSessions::num_packets_processed</a></div><div class="ttdeci">uint64 num_packets_processed</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00247">Sessions.h:247</a></div></div>
<div class="ttc" id="util_8h_html_acbd4acd0d29e2d6c43104827f77d9cd2"><div class="ttname"><a href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00064">util.h:64</a></div></div>
<div class="ttc" id="classPacket_html_a394c54942ec7d3c8c5aeae5b5afe6560"><div class="ttname"><a href="classPacket.html#a394c54942ec7d3c8c5aeae5b5afe6560">Packet::hdr_size</a></div><div class="ttdeci">uint32 hdr_size</div><div class="ttdoc">pcap link_type (DLT_EN10MB, DLT_RAW, etc) </div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00177">Packet.h:177</a></div></div>
<div class="ttc" id="classNetSessions_html_abb38b95e4eae2b4ecb38e1bb481e2522"><div class="ttname"><a href="classNetSessions.html#abb38b95e4eae2b4ecb38e1bb481e2522">NetSessions::dump_this_packet</a></div><div class="ttdeci">int dump_this_packet</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00246">Sessions.h:246</a></div></div>
<div class="ttc" id="classPacket_html_aa1f4f749e6ed1c424ff6da4efe814fc9"><div class="ttname"><a href="classPacket.html#aa1f4f749e6ed1c424ff6da4efe814fc9">Packet::data</a></div><div class="ttdeci">const u_char * data</div><div class="ttdoc">Capture timestamp. </div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00166">Packet.h:166</a></div></div>
<div class="ttc" id="classNetSessions_html_ab8a81976f7c6230a5d8f0e50d6cda708"><div class="ttname"><a href="classNetSessions.html#ab8a81976f7c6230a5d8f0e50d6cda708">NetSessions::DumpPacket</a></div><div class="ttdeci">void DumpPacket(const Packet *pkt, int len=0)</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l01401">Sessions.cc:1401</a></div></div>
<div class="ttc" id="classNetSessions_html_ac693cf1ddd40bc732b9e988d11ed25f1"><div class="ttname"><a href="classNetSessions.html#ac693cf1ddd40bc732b9e988d11ed25f1">NetSessions::Weird</a></div><div class="ttdeci">void Weird(const char *name, const Packet *pkt, const EncapsulationStack *encap=0)</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l01417">Sessions.cc:1417</a></div></div>
<div class="ttc" id="classPacket_html_ac0d8af22ea8d9a67d4952241d95d4a0d"><div class="ttname"><a href="classPacket.html#ac0d8af22ea8d9a67d4952241d95d4a0d">Packet::cap_len</a></div><div class="ttdeci">uint32 cap_len</div><div class="ttdoc">Actual length on wire. </div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00168">Packet.h:168</a></div></div>
<div class="ttc" id="structip6__hdr_html"><div class="ttname"><a href="structip6__hdr.html">ip6_hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00051">net_util.h:51</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8566b0fbe1879eb0508039f2e3edb5bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NetSessions::ParseIPPacket </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>caplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *const&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>proto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&amp;&#160;</td>
          <td class="paramname"><em>inner</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns a wrapper <a class="el" href="classIP__Hdr.html">IP_Hdr</a> object if <em>pkt</em> appears to be a valid IPv4 or IPv6 header based on whether it's long enough to contain such a header, if version given in the header matches the proto argument, and also checks that the payload length field of that header matches the actual length of <em>pkt</em> given by <em>caplen</em>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">caplen</td><td>The length of <em>pkt</em> in bytes. </td></tr>
    <tr><td class="paramname">pkt</td><td>The inner IP packet data. </td></tr>
    <tr><td class="paramname">proto</td><td>Either IPPROTO_IPV6 or IPPROTO_IPV4 to indicate which IP protocol <em>pkt</em> corresponds to. </td></tr>
    <tr><td class="paramname">inner</td><td>The inner IP packet wrapper pointer to be allocated/assigned if <em>pkt</em> looks like a valid IP packet or at least long enough to hold an IP header. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 If the inner IP packet appeared valid, else -1 if <em>caplen</em> is greater than the supposed IP packet's payload length field, -2 if the version of the inner header does not match proto or 1 if <em>caplen</em> is less than the supposed packet's payload length. In the -1 case, <em>inner</em> may still be non-null if <em>caplen</em> was long enough to be an IP header, and <em>inner</em> is always non-null for other return values. </dd></dl>

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l00835">835</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    {</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keywordflow">if</span> ( proto == IPPROTO_IPV6 )</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        {</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <span class="keywordflow">if</span> ( caplen &lt; (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structip6__hdr.html">ip6_hdr</a>) )</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structip6__hdr.html">ip6_hdr</a>* ip6 = (<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structip6__hdr.html">ip6_hdr</a>*) pkt;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        inner = <span class="keyword">new</span> <a class="code" href="classIP__Hdr.html">IP_Hdr</a>(ip6, <span class="keyword">false</span>, caplen);</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <span class="keywordflow">if</span> ( ( ip6-&gt;<a class="code" href="structip6__hdr.html#a5668480f6df6770cbb4826ad825a26c5">ip6_ctlun</a>.<a class="code" href="structip6__hdr.html#a1a58cd2d3dccaae66ee482c36e19cd9f">ip6_un2_vfc</a> &amp; 0xF0 ) != 0x60 )</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            <span class="keywordflow">return</span> -2;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        }</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( proto == IPPROTO_IPV4 )</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        {</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="keywordflow">if</span> ( caplen &lt; (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keyword">struct</span> ip) )</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span>ip* ip4 = (<span class="keyword">const</span> <span class="keyword">struct </span>ip*) pkt;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        inner = <span class="keyword">new</span> <a class="code" href="classIP__Hdr.html">IP_Hdr</a>(ip4, <span class="keyword">false</span>);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="keywordflow">if</span> ( ip4-&gt;ip_v != 4 )</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            <span class="keywordflow">return</span> -2;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        }</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        {</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        <a class="code" href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a>-&gt;<a class="code" href="classReporter.html#a94861b8c52a1e09bbea25eaef85a91f6">InternalWarning</a>(<span class="stringliteral">&quot;Bad IP protocol version in ParseIPPacket&quot;</span>);</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        }</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordflow">if</span> ( (<a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>)caplen != inner-&gt;<a class="code" href="classIP__Hdr.html#a564d7f86b1bb3b27e7f432c52d67d6db">TotalLen</a>() )</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <span class="keywordflow">return</span> (<a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>)caplen &lt; inner-&gt;<a class="code" href="classIP__Hdr.html#a564d7f86b1bb3b27e7f432c52d67d6db">TotalLen</a>() ? -1 : 1;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    }</div><div class="ttc" id="classIP__Hdr_html_a564d7f86b1bb3b27e7f432c52d67d6db"><div class="ttname"><a href="classIP__Hdr.html#a564d7f86b1bb3b27e7f432c52d67d6db">IP_Hdr::TotalLen</a></div><div class="ttdeci">uint32 TotalLen() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00473">IP.h:473</a></div></div>
<div class="ttc" id="Reporter_8cc_html_a25adbcf7f40a03cf61ce36b1e10bbf91"><div class="ttname"><a href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a></div><div class="ttdeci">Reporter * reporter</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00025">Reporter.cc:25</a></div></div>
<div class="ttc" id="classReporter_html_a94861b8c52a1e09bbea25eaef85a91f6"><div class="ttname"><a href="classReporter.html#a94861b8c52a1e09bbea25eaef85a91f6">Reporter::InternalWarning</a></div><div class="ttdeci">void InternalWarning(const char *fmt,...) FMT_ATTR</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00194">Reporter.cc:194</a></div></div>
<div class="ttc" id="classIP__Hdr_html"><div class="ttname"><a href="classIP__Hdr.html">IP_Hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00339">IP.h:339</a></div></div>
<div class="ttc" id="util_8h_html_acbd4acd0d29e2d6c43104827f77d9cd2"><div class="ttname"><a href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00064">util.h:64</a></div></div>
<div class="ttc" id="structip6__hdr_html_a1a58cd2d3dccaae66ee482c36e19cd9f"><div class="ttname"><a href="structip6__hdr.html#a1a58cd2d3dccaae66ee482c36e19cd9f">ip6_hdr::ip6_un2_vfc</a></div><div class="ttdeci">uint8 ip6_un2_vfc</div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00060">net_util.h:60</a></div></div>
<div class="ttc" id="structip6__hdr_html"><div class="ttname"><a href="structip6__hdr.html">ip6_hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00051">net_util.h:51</a></div></div>
<div class="ttc" id="structip6__hdr_html_a5668480f6df6770cbb4826ad825a26c5"><div class="ttname"><a href="structip6__hdr.html#a5668480f6df6770cbb4826ad825a26c5">ip6_hdr::ip6_ctlun</a></div><div class="ttdeci">union ip6_hdr::@14 ip6_ctlun</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a81c169d53b4107c0d6ff059b181a9c72"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">NetSessions::PDict </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classConnection.html">Connection</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="accedbe7d4d4893a2f42d794e849a33d4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">NetSessions::PDict </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classConnection.html">Connection</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ae67e50e6366e3d19858f78ba378afa2b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">NetSessions::PDict </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classConnection.html">Connection</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4ffd6b6d37347df70e12defbcd068ab9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">NetSessions::PDict </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classFragReassembler.html">FragReassembler</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a1c8b3c4f33f8932e3ba6914b9cec52c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetSessions::Remove </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classConnection.html">Connection</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l01045">1045</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    {</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <a class="code" href="classHashKey.html">HashKey</a>* k = c-&gt;<a class="code" href="classConnection.html#a36e522312fdae78fef83d54c84f0e0b5">Key</a>();</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="keywordflow">if</span> ( k )</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        {</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        c-&gt;<a class="code" href="classConnection.html#a203da8c00663ebf8266572edb94c482c">CancelTimers</a>();</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        <a class="code" href="classanalyzer_1_1tcp_1_1TCP__Analyzer.html">analyzer::tcp::TCP_Analyzer</a>* ta = (<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Analyzer.html">analyzer::tcp::TCP_Analyzer</a>*) c-&gt;<a class="code" href="classConnection.html#a52274612e2dbc076a2c5620c8215c50c">GetRootAnalyzer</a>();</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <span class="keywordflow">if</span> ( ta &amp;&amp; c-&gt;<a class="code" href="classConnection.html#a643bd6206b2b153fb082773e2c5f7a5e">ConnTransport</a>() == <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b">TRANSPORT_TCP</a> )</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;            {</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;            assert(ta-&gt;<a class="code" href="classanalyzer_1_1Analyzer.html#ac40890384a1932a1ed72f13574becfe0">IsAnalyzer</a>(<span class="stringliteral">&quot;TCP&quot;</span>));</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;            <a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">analyzer::tcp::TCP_Endpoint</a>* to = ta-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Analyzer.html#ab9e252a9f05720fb39eb56336aa91685">Orig</a>();</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            <a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">analyzer::tcp::TCP_Endpoint</a>* tr = ta-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Analyzer.html#a2635edcabb9aa170f86729c6f9942e38">Resp</a>();</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;            <a class="code" href="classNetSessions.html#a45d7e6f22fb6ad866723e64530c915a3">tcp_stats</a>.<a class="code" href="classanalyzer_1_1tcp_1_1TCPStateStats.html#a67de6a9a261f7746d4876f2e6890fff3">StateLeft</a>(to-&gt;state, tr-&gt;<a class="code" href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#ae0ecc95ab857e4af3fe472f63a8e3337">state</a>);</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;            }</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="keywordflow">if</span> ( c-&gt;<a class="code" href="classConnection.html#ac30060d5450264467706a0036ef9044b">IsPersistent</a>() )</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            <a class="code" href="main_8cc.html#a1aff8a1f8e9083728732277f4726ad8d">persistence_serializer</a>-&gt;<a class="code" href="classPersistenceSerializer.html#aa4bd023d8ffe0981235ab8ffa114aff1">Unregister</a>(c);</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        c-&gt;<a class="code" href="classConnection.html#a27a89759136c363f10260f4cf6d9b44c">Done</a>();</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="keywordflow">if</span> ( connection_state_remove )</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            c-&gt;<a class="code" href="classConnection.html#ae8480aebbcac15331efe7a1591eaaca8">Event</a>(connection_state_remove, 0);</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="comment">// Zero out c&#39;s copy of the key, so that if c has been Ref()&#39;d</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <span class="comment">// up, we know on a future call to Remove() that it&#39;s no</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        <span class="comment">// longer in the dictionary.</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        c-&gt;<a class="code" href="classConnection.html#a76de4f28f08057de1c37910113989f7b">ClearKey</a>();</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        <span class="keywordflow">switch</span> ( c-&gt;<a class="code" href="classConnection.html#a643bd6206b2b153fb082773e2c5f7a5e">ConnTransport</a>() ) {</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b">TRANSPORT_TCP</a>:</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            <span class="keywordflow">if</span> ( ! tcp_conns.RemoveEntry(k) )</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                <a class="code" href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a>-&gt;<a class="code" href="classReporter.html#a94861b8c52a1e09bbea25eaef85a91f6">InternalWarning</a>(<span class="stringliteral">&quot;connection missing&quot;</span>);</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c">TRANSPORT_UDP</a>:</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            <span class="keywordflow">if</span> ( ! udp_conns.RemoveEntry(k) )</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                <a class="code" href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a>-&gt;<a class="code" href="classReporter.html#a94861b8c52a1e09bbea25eaef85a91f6">InternalWarning</a>(<span class="stringliteral">&quot;connection missing&quot;</span>);</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba01288141eb45cb369f93202bfbb2635d">TRANSPORT_ICMP</a>:</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            <span class="keywordflow">if</span> ( ! icmp_conns.RemoveEntry(k) )</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                <a class="code" href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a>-&gt;<a class="code" href="classReporter.html#a94861b8c52a1e09bbea25eaef85a91f6">InternalWarning</a>(<span class="stringliteral">&quot;connection missing&quot;</span>);</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba469684f53d3c998404f68f8ec9949a31">TRANSPORT_UNKNOWN</a>:</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;            <a class="code" href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a>-&gt;<a class="code" href="classReporter.html#a94861b8c52a1e09bbea25eaef85a91f6">InternalWarning</a>(<span class="stringliteral">&quot;unknown transport when removing connection&quot;</span>);</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        }</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <a class="code" href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a>(c);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        <span class="keyword">delete</span> k;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        }</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Analyzer_html_ab9e252a9f05720fb39eb56336aa91685"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Analyzer.html#ab9e252a9f05720fb39eb56336aa91685">analyzer::tcp::TCP_Analyzer::Orig</a></div><div class="ttdeci">TCP_Endpoint * Orig() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP_8h_source.html#l00048">TCP.h:48</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b">TRANSPORT_TCP</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="classConnection_html_ae8480aebbcac15331efe7a1591eaaca8"><div class="ttname"><a href="classConnection.html#ae8480aebbcac15331efe7a1591eaaca8">Connection::Event</a></div><div class="ttdeci">void Event(EventHandlerPtr f, analyzer::Analyzer *analyzer, const char *name=0)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00682">Conn.cc:682</a></div></div>
<div class="ttc" id="classConnection_html_a76de4f28f08057de1c37910113989f7b"><div class="ttname"><a href="classConnection.html#a76de4f28f08057de1c37910113989f7b">Connection::ClearKey</a></div><div class="ttdeci">void ClearKey()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00095">Conn.h:95</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCPStateStats_html_a67de6a9a261f7746d4876f2e6890fff3"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCPStateStats.html#a67de6a9a261f7746d4876f2e6890fff3">analyzer::tcp::TCPStateStats::StateLeft</a></div><div class="ttdeci">void StateLeft(EndpointState o_state, EndpointState r_state)</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2protocol_2tcp_2Stats_8h_source.html#l00022">Stats.h:22</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Analyzer_html"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Analyzer.html">analyzer::tcp::TCP_Analyzer</a></div><div class="ttdef"><b>Definition:</b> <a href="TCP_8h_source.html#l00026">TCP.h:26</a></div></div>
<div class="ttc" id="classConnection_html_ac30060d5450264467706a0036ef9044b"><div class="ttname"><a href="classConnection.html#ac30060d5450264467706a0036ef9044b">Connection::IsPersistent</a></div><div class="ttdeci">bool IsPersistent()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00205">Conn.h:205</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c">TRANSPORT_UDP</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7ba01288141eb45cb369f93202bfbb2635d"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba01288141eb45cb369f93202bfbb2635d">TRANSPORT_ICMP</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="classConnection_html_a643bd6206b2b153fb082773e2c5f7a5e"><div class="ttname"><a href="classConnection.html#a643bd6206b2b153fb082773e2c5f7a5e">Connection::ConnTransport</a></div><div class="ttdeci">TransportProto ConnTransport() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00114">Conn.h:114</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html">analyzer::tcp::TCP_Endpoint</a></div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00028">TCP_Endpoint.h:28</a></div></div>
<div class="ttc" id="Reporter_8cc_html_a25adbcf7f40a03cf61ce36b1e10bbf91"><div class="ttname"><a href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a></div><div class="ttdeci">Reporter * reporter</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00025">Reporter.cc:25</a></div></div>
<div class="ttc" id="classReporter_html_a94861b8c52a1e09bbea25eaef85a91f6"><div class="ttname"><a href="classReporter.html#a94861b8c52a1e09bbea25eaef85a91f6">Reporter::InternalWarning</a></div><div class="ttdeci">void InternalWarning(const char *fmt,...) FMT_ATTR</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00194">Reporter.cc:194</a></div></div>
<div class="ttc" id="classConnection_html_a203da8c00663ebf8266572edb94c482c"><div class="ttname"><a href="classConnection.html#a203da8c00663ebf8266572edb94c482c">Connection::CancelTimers</a></div><div class="ttdeci">void CancelTimers()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00759">Conn.cc:759</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_ac40890384a1932a1ed72f13574becfe0"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#ac40890384a1932a1ed72f13574becfe0">analyzer::Analyzer::IsAnalyzer</a></div><div class="ttdeci">bool IsAnalyzer(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00088">Analyzer.cc:88</a></div></div>
<div class="ttc" id="classHashKey_html"><div class="ttname"><a href="classHashKey.html">HashKey</a></div><div class="ttdef"><b>Definition:</b> <a href="Hash_8h_source.html#l00021">Hash.h:21</a></div></div>
<div class="ttc" id="classPersistenceSerializer_html_aa4bd023d8ffe0981235ab8ffa114aff1"><div class="ttname"><a href="classPersistenceSerializer.html#aa4bd023d8ffe0981235ab8ffa114aff1">PersistenceSerializer::Unregister</a></div><div class="ttdeci">void Unregister(ID *id)</div><div class="ttdef"><b>Definition:</b> <a href="PersistenceSerializer_8cc_source.html#l00070">PersistenceSerializer.cc:70</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7ba469684f53d3c998404f68f8ec9949a31"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba469684f53d3c998404f68f8ec9949a31">TRANSPORT_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="classConnection_html_a52274612e2dbc076a2c5620c8215c50c"><div class="ttname"><a href="classConnection.html#a52274612e2dbc076a2c5620c8215c50c">Connection::GetRootAnalyzer</a></div><div class="ttdeci">analyzer::TransportLayerAnalyzer * GetRootAnalyzer()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00263">Conn.h:263</a></div></div>
<div class="ttc" id="main_8cc_html_a1aff8a1f8e9083728732277f4726ad8d"><div class="ttname"><a href="main_8cc.html#a1aff8a1f8e9083728732277f4726ad8d">persistence_serializer</a></div><div class="ttdeci">PersistenceSerializer * persistence_serializer</div><div class="ttdef"><b>Definition:</b> <a href="main_8cc_source.html#l00103">main.cc:103</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Analyzer_html_a2635edcabb9aa170f86729c6f9942e38"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Analyzer.html#a2635edcabb9aa170f86729c6f9942e38">analyzer::tcp::TCP_Analyzer::Resp</a></div><div class="ttdeci">TCP_Endpoint * Resp() const </div><div class="ttdef"><b>Definition:</b> <a href="TCP_8h_source.html#l00049">TCP.h:49</a></div></div>
<div class="ttc" id="classConnection_html_a27a89759136c363f10260f4cf6d9b44c"><div class="ttname"><a href="classConnection.html#a27a89759136c363f10260f4cf6d9b44c">Connection::Done</a></div><div class="ttdeci">void Done()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00245">Conn.cc:245</a></div></div>
<div class="ttc" id="classConnection_html_a36e522312fdae78fef83d54c84f0e0b5"><div class="ttname"><a href="classConnection.html#a36e522312fdae78fef83d54c84f0e0b5">Connection::Key</a></div><div class="ttdeci">HashKey * Key() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00094">Conn.h:94</a></div></div>
<div class="ttc" id="classanalyzer_1_1tcp_1_1TCP__Endpoint_html_ae0ecc95ab857e4af3fe472f63a8e3337"><div class="ttname"><a href="classanalyzer_1_1tcp_1_1TCP__Endpoint.html#ae0ecc95ab857e4af3fe472f63a8e3337">analyzer::tcp::TCP_Endpoint::state</a></div><div class="ttdeci">EndpointState state</div><div class="ttdef"><b>Definition:</b> <a href="TCP__Endpoint_8h_source.html#l00205">TCP_Endpoint.h:205</a></div></div>
<div class="ttc" id="classNetSessions_html_a45d7e6f22fb6ad866723e64530c915a3"><div class="ttname"><a href="classNetSessions.html#a45d7e6f22fb6ad866723e64530c915a3">NetSessions::tcp_stats</a></div><div class="ttdeci">analyzer::tcp::TCPStateStats tcp_stats</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00180">Sessions.h:180</a></div></div>
<div class="ttc" id="Obj_8h_html_a3bc2efaea5f7739dc79d7f733f6ee6fe"><div class="ttname"><a href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a></div><div class="ttdeci">void Unref(BroObj *o)</div><div class="ttdef"><b>Definition:</b> <a href="Obj_8h_source.html#l00216">Obj.h:216</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa757979936bea61cce0fdd371f04b82b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetSessions::Remove </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classFragReassembler.html">FragReassembler</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l01101">1101</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    {</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="keywordflow">if</span> ( ! f )</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <a class="code" href="classHashKey.html">HashKey</a>* k = f-&gt;<a class="code" href="classFragReassembler.html#a75d1a8977120bb01f4c34b90a0190c9f">Key</a>();</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keywordflow">if</span> ( k )</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        {</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        <span class="keywordflow">if</span> ( ! fragments.RemoveEntry(k) )</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;            <a class="code" href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a>-&gt;<a class="code" href="classReporter.html#a94861b8c52a1e09bbea25eaef85a91f6">InternalWarning</a>(<span class="stringliteral">&quot;fragment reassembler not in dict&quot;</span>);</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        }</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <a class="code" href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a>-&gt;<a class="code" href="classReporter.html#a94861b8c52a1e09bbea25eaef85a91f6">InternalWarning</a>(<span class="stringliteral">&quot;missing fragment reassembler hash key&quot;</span>);</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <a class="code" href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a>(f);</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    }</div><div class="ttc" id="classFragReassembler_html_a75d1a8977120bb01f4c34b90a0190c9f"><div class="ttname"><a href="classFragReassembler.html#a75d1a8977120bb01f4c34b90a0190c9f">FragReassembler::Key</a></div><div class="ttdeci">HashKey * Key() const </div><div class="ttdef"><b>Definition:</b> <a href="Frag_8h_source.html#l00033">Frag.h:33</a></div></div>
<div class="ttc" id="Reporter_8cc_html_a25adbcf7f40a03cf61ce36b1e10bbf91"><div class="ttname"><a href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a></div><div class="ttdeci">Reporter * reporter</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00025">Reporter.cc:25</a></div></div>
<div class="ttc" id="classReporter_html_a94861b8c52a1e09bbea25eaef85a91f6"><div class="ttname"><a href="classReporter.html#a94861b8c52a1e09bbea25eaef85a91f6">Reporter::InternalWarning</a></div><div class="ttdeci">void InternalWarning(const char *fmt,...) FMT_ATTR</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00194">Reporter.cc:194</a></div></div>
<div class="ttc" id="classHashKey_html"><div class="ttname"><a href="classHashKey.html">HashKey</a></div><div class="ttdef"><b>Definition:</b> <a href="Hash_8h_source.html#l00021">Hash.h:21</a></div></div>
<div class="ttc" id="Obj_8h_html_a3bc2efaea5f7739dc79d7f733f6ee6fe"><div class="ttname"><a href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a></div><div class="ttdeci">void Unref(BroObj *o)</div><div class="ttdef"><b>Definition:</b> <a href="Obj_8h_source.html#l00216">Obj.h:216</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af4be660e05101732d5eea8e6911eff62"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool NetSessions::WantConnection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a>&#160;</td>
          <td class="paramname"><em>src_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a>&#160;</td>
          <td class="paramname"><em>dest_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7b">TransportProto</a>&#160;</td>
          <td class="paramname"><em>transport_proto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a>&#160;</td>
          <td class="paramname"><em>tcp_flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>flip_roles</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l01315">1315</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    {</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    flip_roles = <span class="keyword">false</span>;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="NetVar_8cc.html#a3a02cc4f8fe1642ffabc4ad51ce42dab">transport_proto</a> == <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b">TRANSPORT_TCP</a> )</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        {</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        <span class="keywordflow">if</span> ( ! (tcp_flags &amp; TH_SYN) || (tcp_flags &amp; TH_ACK) )</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;            {</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            <span class="comment">// The new connection is starting either without a SYN,</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;            <span class="comment">// or with a SYN ack. This means it&#39;s a partial connection.</span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            <span class="keywordflow">if</span> ( ! <a class="code" href="NetVar_8cc.html#aba0717d6aef0d5622162022bb8e4557b">partial_connection_ok</a> )</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;            <span class="keywordflow">if</span> ( tcp_flags &amp; TH_SYN &amp;&amp; ! <a class="code" href="NetVar_8cc.html#af10348511f55636c5f7ff8229026cb60">tcp_SYN_ack_ok</a> )</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            <span class="comment">// Try to guess true responder by the port numbers.</span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;            <span class="comment">// (We might also think that for SYN acks we could</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;            <span class="comment">// safely flip the roles, but that doesn&#39;t work</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            <span class="comment">// for stealth scans.)</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="classNetSessions.html#ad613585ffce6da5ccaf4069628c463fb">IsLikelyServerPort</a>(src_port, <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b">TRANSPORT_TCP</a>) )</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                { <span class="comment">// connection is a candidate for flipping</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                <span class="keywordflow">if</span> ( <a class="code" href="classNetSessions.html#ad613585ffce6da5ccaf4069628c463fb">IsLikelyServerPort</a>(dst_port, <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b">TRANSPORT_TCP</a>) )</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                    <span class="comment">// Hmmm, both source and destination</span></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                    <span class="comment">// are plausible.  Heuristic: flip only</span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                    <span class="comment">// if (1) this isn&#39;t a SYN ACK (to avoid</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                    <span class="comment">// confusing stealth scans) and</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                    <span class="comment">// (2) dest port &gt; src port (to favor</span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                    <span class="comment">// more plausible servers).</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                    flip_roles = ! (tcp_flags &amp; TH_SYN) &amp;&amp; src_port &lt; dst_port;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                    <span class="comment">// Source is plausible, destination isn&#39;t.</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                    flip_roles = <span class="keyword">true</span>;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                }</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;            }</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        }</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="NetVar_8cc.html#a3a02cc4f8fe1642ffabc4ad51ce42dab">transport_proto</a> == <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c">TRANSPORT_UDP</a> )</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;        flip_roles =</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            <a class="code" href="classNetSessions.html#ad613585ffce6da5ccaf4069628c463fb">IsLikelyServerPort</a>(src_port, <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c">TRANSPORT_UDP</a>) &amp;&amp;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            ! <a class="code" href="classNetSessions.html#ad613585ffce6da5ccaf4069628c463fb">IsLikelyServerPort</a>(dst_port, <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c">TRANSPORT_UDP</a>);</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    }</div><div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b">TRANSPORT_TCP</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="NetVar_8cc_html_aba0717d6aef0d5622162022bb8e4557b"><div class="ttname"><a href="NetVar_8cc.html#aba0717d6aef0d5622162022bb8e4557b">partial_connection_ok</a></div><div class="ttdeci">int partial_connection_ok</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00036">NetVar.cc:36</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c">TRANSPORT_UDP</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="classNetSessions_html_ad613585ffce6da5ccaf4069628c463fb"><div class="ttname"><a href="classNetSessions.html#ad613585ffce6da5ccaf4069628c463fb">NetSessions::IsLikelyServerPort</a></div><div class="ttdeci">bool IsLikelyServerPort(uint32 port, TransportProto transport_proto) const </div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8cc_source.html#l01288">Sessions.cc:1288</a></div></div>
<div class="ttc" id="NetVar_8cc_html_af10348511f55636c5f7ff8229026cb60"><div class="ttname"><a href="NetVar_8cc.html#af10348511f55636c5f7ff8229026cb60">tcp_SYN_ack_ok</a></div><div class="ttdeci">int tcp_SYN_ack_ok</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00037">NetVar.cc:37</a></div></div>
<div class="ttc" id="NetVar_8cc_html_a3a02cc4f8fe1642ffabc4ad51ce42dab"><div class="ttname"><a href="NetVar_8cc.html#a3a02cc4f8fe1642ffabc4ad51ce42dab">transport_proto</a></div><div class="ttdeci">EnumType * transport_proto</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00021">NetVar.cc:21</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac693cf1ddd40bc732b9e988d11ed25f1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetSessions::Weird </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classPacket.html">Packet</a> *&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classEncapsulationStack.html">EncapsulationStack</a> *&#160;</td>
          <td class="paramname"><em>encap</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l01417">1417</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    {</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <span class="keywordflow">if</span> ( pkt )</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        <a class="code" href="classNetSessions.html#abb38b95e4eae2b4ecb38e1bb481e2522">dump_this_packet</a> = 1;</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="keywordflow">if</span> ( encap &amp;&amp; encap-&gt;<a class="code" href="classEncapsulationStack.html#aa8424f24d54c7071d2ec43678cee87a9">LastType</a>() != BifEnum::Tunnel::NONE )</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        <a class="code" href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a>-&gt;<a class="code" href="classReporter.html#a47293c9028cfea0d7f4cfb56f48e8530">Weird</a>(<a class="code" href="util_8cc.html#acd55da5095039a6a84317688425cac72">fmt</a>(<span class="stringliteral">&quot;%s_in_tunnel&quot;</span>, name));</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        <a class="code" href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a>-&gt;<a class="code" href="classReporter.html#a47293c9028cfea0d7f4cfb56f48e8530">Weird</a>(name);</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    }</div><div class="ttc" id="Reporter_8cc_html_a25adbcf7f40a03cf61ce36b1e10bbf91"><div class="ttname"><a href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a></div><div class="ttdeci">Reporter * reporter</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00025">Reporter.cc:25</a></div></div>
<div class="ttc" id="util_8cc_html_acd55da5095039a6a84317688425cac72"><div class="ttname"><a href="util_8cc.html#acd55da5095039a6a84317688425cac72">fmt</a></div><div class="ttdeci">const char * fmt(const char *format, va_list al)</div><div class="ttdef"><b>Definition:</b> <a href="util_8cc_source.html#l00545">util.cc:545</a></div></div>
<div class="ttc" id="classEncapsulationStack_html_aa8424f24d54c7071d2ec43678cee87a9"><div class="ttname"><a href="classEncapsulationStack.html#aa8424f24d54c7071d2ec43678cee87a9">EncapsulationStack::LastType</a></div><div class="ttdeci">BifEnum::Tunnel::Type LastType() const </div><div class="ttdef"><b>Definition:</b> <a href="TunnelEncapsulation_8h_source.html#l00176">TunnelEncapsulation.h:176</a></div></div>
<div class="ttc" id="classNetSessions_html_abb38b95e4eae2b4ecb38e1bb481e2522"><div class="ttname"><a href="classNetSessions.html#abb38b95e4eae2b4ecb38e1bb481e2522">NetSessions::dump_this_packet</a></div><div class="ttdeci">int dump_this_packet</div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00246">Sessions.h:246</a></div></div>
<div class="ttc" id="classReporter_html_a47293c9028cfea0d7f4cfb56f48e8530"><div class="ttname"><a href="classReporter.html#a47293c9028cfea0d7f4cfb56f48e8530">Reporter::Weird</a></div><div class="ttdeci">void void void Weird(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00332">Reporter.cc:332</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a88bcdb35bdaa1a74294719166024ff44"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NetSessions::Weird </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classEncapsulationStack.html">EncapsulationStack</a> *&#160;</td>
          <td class="paramname"><em>encap</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8cc_source.html#l01429">1429</a> of file <a class="el" href="Sessions_8cc_source.html">Sessions.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    {</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="keywordflow">if</span> ( encap &amp;&amp; encap-&gt;<a class="code" href="classEncapsulationStack.html#aa8424f24d54c7071d2ec43678cee87a9">LastType</a>() != BifEnum::Tunnel::NONE )</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        <a class="code" href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a>-&gt;<a class="code" href="classReporter.html#a47293c9028cfea0d7f4cfb56f48e8530">Weird</a>(ip-&gt;<a class="code" href="classIP__Hdr.html#a8256bb033063a8e8034beb36bc3bff5c">SrcAddr</a>(), ip-&gt;<a class="code" href="classIP__Hdr.html#a5c09f4d749016bc3cf3dbee8a048bcfc">DstAddr</a>(),</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                        <a class="code" href="util_8cc.html#acd55da5095039a6a84317688425cac72">fmt</a>(<span class="stringliteral">&quot;%s_in_tunnel&quot;</span>, name));</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <a class="code" href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a>-&gt;<a class="code" href="classReporter.html#a47293c9028cfea0d7f4cfb56f48e8530">Weird</a>(ip-&gt;<a class="code" href="classIP__Hdr.html#a8256bb033063a8e8034beb36bc3bff5c">SrcAddr</a>(), ip-&gt;<a class="code" href="classIP__Hdr.html#a5c09f4d749016bc3cf3dbee8a048bcfc">DstAddr</a>(), name);</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    }</div><div class="ttc" id="classIP__Hdr_html_a8256bb033063a8e8034beb36bc3bff5c"><div class="ttname"><a href="classIP__Hdr.html#a8256bb033063a8e8034beb36bc3bff5c">IP_Hdr::SrcAddr</a></div><div class="ttdeci">IPAddr SrcAddr() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00418">IP.h:418</a></div></div>
<div class="ttc" id="Reporter_8cc_html_a25adbcf7f40a03cf61ce36b1e10bbf91"><div class="ttname"><a href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a></div><div class="ttdeci">Reporter * reporter</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00025">Reporter.cc:25</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a5c09f4d749016bc3cf3dbee8a048bcfc"><div class="ttname"><a href="classIP__Hdr.html#a5c09f4d749016bc3cf3dbee8a048bcfc">IP_Hdr::DstAddr</a></div><div class="ttdeci">IPAddr DstAddr() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00427">IP.h:427</a></div></div>
<div class="ttc" id="util_8cc_html_acd55da5095039a6a84317688425cac72"><div class="ttname"><a href="util_8cc.html#acd55da5095039a6a84317688425cac72">fmt</a></div><div class="ttdeci">const char * fmt(const char *format, va_list al)</div><div class="ttdef"><b>Definition:</b> <a href="util_8cc_source.html#l00545">util.cc:545</a></div></div>
<div class="ttc" id="classEncapsulationStack_html_aa8424f24d54c7071d2ec43678cee87a9"><div class="ttname"><a href="classEncapsulationStack.html#aa8424f24d54c7071d2ec43678cee87a9">EncapsulationStack::LastType</a></div><div class="ttdeci">BifEnum::Tunnel::Type LastType() const </div><div class="ttdef"><b>Definition:</b> <a href="TunnelEncapsulation_8h_source.html#l00176">TunnelEncapsulation.h:176</a></div></div>
<div class="ttc" id="classReporter_html_a47293c9028cfea0d7f4cfb56f48e8530"><div class="ttname"><a href="classReporter.html#a47293c9028cfea0d7f4cfb56f48e8530">Reporter::Weird</a></div><div class="ttdeci">void void void Weird(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00332">Reporter.cc:332</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="ad14666fbd39879a687c9406615f8f1fa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class ConnCompressor</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00184">184</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a46461efab16220523fa26f185e7daadb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classIPTunnelTimer.html">IPTunnelTimer</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00186">186</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<a class="anchor" id="af1ff7f1837b4faee8509df88c2edbcf0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classRemoteSerializer.html">RemoteSerializer</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00183">183</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a633c39d095c642e834eb81c60c14eef7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classTimerMgrExpireTimer.html">TimerMgrExpireTimer</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00185">185</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="ae746b070666b44da520738283037b24b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classanalyzer_1_1arp_1_1ARP__Analyzer.html">analyzer::arp::ARP_Analyzer</a>* NetSessions::arp_analyzer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00239">239</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<a class="anchor" id="adc4ddb2a9c75fa2f960f8bf1745badd3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int NetSessions::build_backdoor_analyzer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00245">245</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7fb2cf6c9b3cdfeb9921f0eef2889fe4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCompositeHash.html">CompositeHash</a>* NetSessions::ch</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00228">228</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8249bf085beaed0edf1d054a929d7ae9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDiscarder.html">Discarder</a>* NetSessions::discarder</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00242">242</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<a class="anchor" id="abb38b95e4eae2b4ecb38e1bb481e2522"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int NetSessions::dump_this_packet</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00246">246</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae2d46a6940ab5c04945729f85c5aa6fa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNetSessions.html#a16e080f164d73987f1673f6e888b44b2">IPTunnelMap</a> NetSessions::ip_tunnels</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00237">237</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a26490773024adcd5527bdc17d98957f9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> NetSessions::num_packets_processed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00247">247</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<a class="anchor" id="af1e4a540b075b3fc41bc2d74faf14373"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPacketFilter.html">PacketFilter</a>* NetSessions::packet_filter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00243">243</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<a class="anchor" id="aafee75c822a3c0c0f5468c0e75789229"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPacketProfiler.html">PacketProfiler</a>* NetSessions::pkt_profiler</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00248">248</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4845dfcb5ecc5319f682387c0208809b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classanalyzer_1_1stepping__stone_1_1SteppingStoneManager.html">analyzer::stepping_stone::SteppingStoneManager</a>* NetSessions::stp_manager</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00241">241</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a62bf64617bf9ecfb22b8e8894a168a12"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOSFingerprint.html">OSFingerprint</a>* NetSessions::SYN_OS_Fingerprinter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00244">244</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a45d7e6f22fb6ad866723e64530c915a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classanalyzer_1_1tcp_1_1TCPStateStats.html">analyzer::tcp::TCPStateStats</a> NetSessions::tcp_stats</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00180">180</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5118a8f46d752cfe03b7dbebc4fc3fc1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNetSessions.html#a588c15a15bb6f54d196e37b7baf2e445">TimerMgrMap</a> NetSessions::timer_mgrs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Sessions_8h_source.html#l00253">253</a> of file <a class="el" href="Sessions_8h_source.html">Sessions.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/jasonlu/bro/src/<a class="el" href="Sessions_8h_source.html">Sessions.h</a></li>
<li>/home/jasonlu/bro/src/<a class="el" href="Sessions_8cc_source.html">Sessions.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
