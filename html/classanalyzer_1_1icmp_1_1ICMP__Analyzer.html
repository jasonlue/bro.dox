<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>bro: analyzer::icmp::ICMP_Analyzer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">bro
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceanalyzer.html">analyzer</a></li><li class="navelem"><a class="el" href="namespaceanalyzer_1_1icmp.html">icmp</a></li><li class="navelem"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html">ICMP_Analyzer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">analyzer::icmp::ICMP_Analyzer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="ICMP_8h_source.html">ICMP.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for analyzer::icmp::ICMP_Analyzer:</div>
<div class="dyncontent">
<div class="center"><img src="classanalyzer_1_1icmp_1_1ICMP__Analyzer__inherit__graph.png" border="0" usemap="#analyzer_1_1icmp_1_1ICMP__Analyzer_inherit__map" alt="Inheritance graph"/></div>
<map name="analyzer_1_1icmp_1_1ICMP__Analyzer_inherit__map" id="analyzer_1_1icmp_1_1ICMP__Analyzer_inherit__map">
<area shape="rect" id="node2" href="classanalyzer_1_1TransportLayerAnalyzer.html" title="analyzer::TransportLayer\lAnalyzer" alt="" coords="5,80,172,121"/>
<area shape="rect" id="node3" href="classanalyzer_1_1Analyzer.html" title="analyzer::Analyzer" alt="" coords="23,5,154,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for analyzer::icmp::ICMP_Analyzer:</div>
<div class="dyncontent">
<div class="center"><img src="classanalyzer_1_1icmp_1_1ICMP__Analyzer__coll__graph.png" border="0" usemap="#analyzer_1_1icmp_1_1ICMP__Analyzer_coll__map" alt="Collaboration graph"/></div>
<map name="analyzer_1_1icmp_1_1ICMP__Analyzer_coll__map" id="analyzer_1_1icmp_1_1ICMP__Analyzer_coll__map">
<area shape="rect" id="node2" href="classanalyzer_1_1TransportLayerAnalyzer.html" title="analyzer::TransportLayer\lAnalyzer" alt="" coords="2124,146,2291,187"/>
<area shape="rect" id="node22" href="classConnection.html" title="Connection" alt="" coords="2477,592,2565,619"/>
<area shape="rect" id="node3" href="classanalyzer_1_1Analyzer.html" title="analyzer::Analyzer" alt="" coords="2740,445,2871,472"/>
<area shape="rect" id="node5" href="classanalyzer_1_1SupportAnalyzer.html" title="analyzer::SupportAnalyzer" alt="" coords="3012,473,3187,500"/>
<area shape="rect" id="node25" href="classanalyzer_1_1pia_1_1PIA.html" title="analyzer::pia::PIA" alt="" coords="3618,551,3745,577"/>
<area shape="rect" id="node27" href="classRuleEndpointState.html" title="RuleEndpointState" alt="" coords="3034,384,3165,411"/>
<area shape="rect" id="node4" href="classanalyzer_1_1OutputHandler.html" title="analyzer::OutputHandler" alt="" coords="2440,445,2603,472"/>
<area shape="rect" id="node6" href="classRule.html" title="Rule" alt="" coords="429,44,479,71"/>
<area shape="rect" id="node7" href="classLocation.html" title="Location" alt="" coords="129,143,200,169"/>
<area shape="rect" id="node10" href="classBroObj.html" title="BroObj" alt="" coords="343,297,405,324"/>
<area shape="rect" id="node8" href="classSerialObj.html" title="SerialObj" alt="" coords="5,193,80,220"/>
<area shape="rect" id="node19" href="classRE__Matcher.html" title="RE_Matcher" alt="" coords="224,156,319,183"/>
<area shape="rect" id="node9" href="classID.html" title="ID" alt="" coords="1830,328,1869,355"/>
<area shape="rect" id="node34" href="classMutableVal.html" title="MutableVal" alt="" coords="1988,317,2075,344"/>
<area shape="rect" id="node11" href="classVal.html" title="Val" alt="" coords="1637,425,1679,452"/>
<area shape="rect" id="node13" href="classFunc.html" title="Func" alt="" coords="769,776,819,803"/>
<area shape="rect" id="node15" href="classBroType.html" title="BroType" alt="" coords="503,601,573,628"/>
<area shape="rect" id="node17" href="classBroFile.html" title="BroFile" alt="" coords="983,843,1045,869"/>
<area shape="rect" id="node18" href="classAttributes.html" title="Attributes" alt="" coords="755,373,833,400"/>
<area shape="rect" id="node33" href="classRecordVal.html" title="RecordVal" alt="" coords="2166,263,2249,289"/>
<area shape="rect" id="node43" href="classanalyzer_1_1arp_1_1ARP__Analyzer.html" title="analyzer::arp::ARP\l_Analyzer" alt="" coords="597,1037,731,1078"/>
<area shape="rect" id="node50" href="classEnumVal.html" title="EnumVal" alt="" coords="1812,443,1887,469"/>
<area shape="rect" id="node12" href="unionBroValUnion.html" title="BroValUnion" alt="" coords="1275,501,1369,528"/>
<area shape="rect" id="node41" href="classDiscarder.html" title="Discarder" alt="" coords="1097,992,1176,1019"/>
<area shape="rect" id="node35" href="classRecordType.html" title="RecordType" alt="" coords="857,315,951,341"/>
<area shape="rect" id="node39" href="classTypeList.html" title="TypeList" alt="" coords="758,725,830,752"/>
<area shape="rect" id="node16" href="classIPAddr.html" title="IPAddr" alt="" coords="763,561,825,588"/>
<area shape="rect" id="node21" href="classIPPrefix.html" title="IPPrefix" alt="" coords="979,563,1049,589"/>
<area shape="rect" id="node31" href="classIPv6__Hdr__Chain.html" title="IPv6_Hdr_Chain" alt="" coords="1077,1233,1196,1260"/>
<area shape="rect" id="node42" href="classPacketProfiler.html" title="PacketProfiler" alt="" coords="1270,765,1374,792"/>
<area shape="rect" id="node20" href="classBroString.html" title="BroString" alt="" coords="976,449,1052,476"/>
<area shape="rect" id="node23" href="classBro_1_1UID.html" title="Bro::UID" alt="" coords="2170,507,2245,533"/>
<area shape="rect" id="node24" href="classEncapsulationStack.html" title="EncapsulationStack" alt="" coords="2138,557,2277,584"/>
<area shape="rect" id="node26" href="classRuleMatcherState.html" title="RuleMatcherState" alt="" coords="3344,384,3471,411"/>
<area shape="rect" id="node28" href="structanalyzer_1_1pia_1_1PIA_1_1Buffer.html" title="analyzer::pia::PIA\l::Buffer" alt="" coords="3344,753,3471,794"/>
<area shape="rect" id="node29" href="structanalyzer_1_1pia_1_1PIA_1_1DataBlock.html" title="analyzer::pia::PIA\l::DataBlock" alt="" coords="3036,753,3163,794"/>
<area shape="rect" id="node30" href="classIP__Hdr.html" title="IP_Hdr" alt="" coords="2774,987,2837,1013"/>
<area shape="rect" id="node32" href="structip6__hdr.html" title="ip6_hdr" alt="" coords="2489,987,2553,1013"/>
<area shape="rect" id="node36" href="classHashKey.html" title="HashKey" alt="" coords="2169,608,2245,635"/>
<area shape="rect" id="node37" href="classNetSessions.html" title="NetSessions" alt="" coords="1609,981,1707,1008"/>
<area shape="rect" id="node38" href="classCompositeHash.html" title="CompositeHash" alt="" coords="1079,928,1195,955"/>
<area shape="rect" id="node40" href="classanalyzer_1_1tcp_1_1TCPStateStats.html" title="analyzer::tcp::TCPStateStats" alt="" coords="1225,1093,1419,1120"/>
<area shape="rect" id="node44" href="classOSFingerprint.html" title="OSFingerprint" alt="" coords="1271,1043,1373,1069"/>
<area shape="rect" id="node45" href="structfp__entry.html" title="fp_entry" alt="" coords="979,1092,1049,1119"/>
<area shape="rect" id="node46" href="classPacketFilter.html" title="PacketFilter" alt="" coords="1276,867,1368,893"/>
<area shape="rect" id="node47" href="classanalyzer_1_1stepping__stone_1_1SteppingStoneManager.html" title="analyzer::stepping\l_stone::SteppingStoneManager" alt="" coords="1220,1195,1424,1237"/>
<area shape="rect" id="node48" href="classanalyzer_1_1Tag.html" title="analyzer::Tag" alt="" coords="2315,469,2416,496"/>
<area shape="rect" id="node49" href="classTag.html" title="Tag" alt="" coords="2009,451,2053,477"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1a731675510864f64174f96cdb342152"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a1a731675510864f64174f96cdb342152">ICMP_Analyzer</a> (<a class="el" href="classConnection.html">Connection</a> *<a class="el" href="classanalyzer_1_1Analyzer.html#a1630044ed7c43e8d79cacf4bfc580d61">conn</a>)</td></tr>
<tr class="separator:a1a731675510864f64174f96cdb342152"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3aa909ddcd8c158969575fab1693ffd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#af3aa909ddcd8c158969575fab1693ffd">UpdateConnVal</a> (<a class="el" href="classRecordVal.html">RecordVal</a> *conn_val) override</td></tr>
<tr class="separator:af3aa909ddcd8c158969575fab1693ffd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classanalyzer_1_1TransportLayerAnalyzer"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classanalyzer_1_1TransportLayerAnalyzer')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classanalyzer_1_1TransportLayerAnalyzer.html">analyzer::TransportLayerAnalyzer</a></td></tr>
<tr class="memitem:a5eb617297a0f98f4d3a1bf2fb654d948 inherit pub_methods_classanalyzer_1_1TransportLayerAnalyzer"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1TransportLayerAnalyzer.html#a5eb617297a0f98f4d3a1bf2fb654d948">TransportLayerAnalyzer</a> (const char *name, <a class="el" href="classConnection.html">Connection</a> *<a class="el" href="classanalyzer_1_1Analyzer.html#a1630044ed7c43e8d79cacf4bfc580d61">conn</a>)</td></tr>
<tr class="separator:a5eb617297a0f98f4d3a1bf2fb654d948 inherit pub_methods_classanalyzer_1_1TransportLayerAnalyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a466e74ddf672142212eaa069886850cc inherit pub_methods_classanalyzer_1_1TransportLayerAnalyzer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1TransportLayerAnalyzer.html#a466e74ddf672142212eaa069886850cc">SetContentsFile</a> (unsigned int direction, <a class="el" href="classBroFile.html">BroFile</a> *f)</td></tr>
<tr class="separator:a466e74ddf672142212eaa069886850cc inherit pub_methods_classanalyzer_1_1TransportLayerAnalyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b99d5e42795155bf05269f1cbd53162 inherit pub_methods_classanalyzer_1_1TransportLayerAnalyzer"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classBroFile.html">BroFile</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1TransportLayerAnalyzer.html#a7b99d5e42795155bf05269f1cbd53162">GetContentsFile</a> (unsigned int direction) const </td></tr>
<tr class="separator:a7b99d5e42795155bf05269f1cbd53162 inherit pub_methods_classanalyzer_1_1TransportLayerAnalyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85d2e780b1ee14a2d9281dc7d058bc2a inherit pub_methods_classanalyzer_1_1TransportLayerAnalyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1TransportLayerAnalyzer.html#a85d2e780b1ee14a2d9281dc7d058bc2a">SetPIA</a> (<a class="el" href="classanalyzer_1_1pia_1_1PIA.html">pia::PIA</a> *arg_PIA)</td></tr>
<tr class="separator:a85d2e780b1ee14a2d9281dc7d058bc2a inherit pub_methods_classanalyzer_1_1TransportLayerAnalyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab82fa338c002aad8fc6b5f44aefdb9d4 inherit pub_methods_classanalyzer_1_1TransportLayerAnalyzer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classanalyzer_1_1pia_1_1PIA.html">pia::PIA</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1TransportLayerAnalyzer.html#ab82fa338c002aad8fc6b5f44aefdb9d4">GetPIA</a> () const </td></tr>
<tr class="separator:ab82fa338c002aad8fc6b5f44aefdb9d4 inherit pub_methods_classanalyzer_1_1TransportLayerAnalyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd0078d1762578eaca6d3e5f60f8fa12 inherit pub_methods_classanalyzer_1_1TransportLayerAnalyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1TransportLayerAnalyzer.html#acd0078d1762578eaca6d3e5f60f8fa12">PacketContents</a> (const u_char *data, int len)</td></tr>
<tr class="separator:acd0078d1762578eaca6d3e5f60f8fa12 inherit pub_methods_classanalyzer_1_1TransportLayerAnalyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classanalyzer_1_1Analyzer"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classanalyzer_1_1Analyzer')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classanalyzer_1_1Analyzer.html">analyzer::Analyzer</a></td></tr>
<tr class="memitem:a08d37509e899ff9e96a5976362fb9d75 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a08d37509e899ff9e96a5976362fb9d75">Analyzer</a> (const char *name, <a class="el" href="classConnection.html">Connection</a> *<a class="el" href="classanalyzer_1_1Analyzer.html#a1630044ed7c43e8d79cacf4bfc580d61">conn</a>)</td></tr>
<tr class="separator:a08d37509e899ff9e96a5976362fb9d75 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70d2fedeaf5b12a1f6f8b11c83501f1b inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a70d2fedeaf5b12a1f6f8b11c83501f1b">Analyzer</a> (const <a class="el" href="classanalyzer_1_1Tag.html">Tag</a> &amp;<a class="el" href="classanalyzer_1_1Analyzer.html#a95d7c49d423c8633b6fe493ea4f3112a">tag</a>, <a class="el" href="classConnection.html">Connection</a> *<a class="el" href="classanalyzer_1_1Analyzer.html#a1630044ed7c43e8d79cacf4bfc580d61">conn</a>)</td></tr>
<tr class="separator:a70d2fedeaf5b12a1f6f8b11c83501f1b inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a949f79bf9bc61aed3dbfc5e8515cc791 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a949f79bf9bc61aed3dbfc5e8515cc791">Analyzer</a> (<a class="el" href="classConnection.html">Connection</a> *<a class="el" href="classanalyzer_1_1Analyzer.html#a1630044ed7c43e8d79cacf4bfc580d61">conn</a>)</td></tr>
<tr class="separator:a949f79bf9bc61aed3dbfc5e8515cc791 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa899ac3a6aabbe59f791f69368ad740 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#afa899ac3a6aabbe59f791f69368ad740">~Analyzer</a> ()</td></tr>
<tr class="separator:afa899ac3a6aabbe59f791f69368ad740 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a913e4c70443cdb53e733e8796b5e11ea inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a913e4c70443cdb53e733e8796b5e11ea">Init</a> ()</td></tr>
<tr class="separator:a913e4c70443cdb53e733e8796b5e11ea inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98111a0e45449d4155d97e68194a8cc8 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a98111a0e45449d4155d97e68194a8cc8">NextPacket</a> (int len, const u_char *data, bool is_orig, <a class="el" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> seq=-1, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip=0, int caplen=0)</td></tr>
<tr class="separator:a98111a0e45449d4155d97e68194a8cc8 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14de24c4ba316122c91201077c6a3977 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a14de24c4ba316122c91201077c6a3977">NextStream</a> (int len, const u_char *data, bool is_orig)</td></tr>
<tr class="separator:a14de24c4ba316122c91201077c6a3977 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36fce52398b0a5009e08fb123f55d0da inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a36fce52398b0a5009e08fb123f55d0da">NextUndelivered</a> (<a class="el" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> seq, int len, bool is_orig)</td></tr>
<tr class="separator:a36fce52398b0a5009e08fb123f55d0da inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08704c74e985d3ddf885413ae89b6433 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a08704c74e985d3ddf885413ae89b6433">NextEndOfData</a> (bool is_orig)</td></tr>
<tr class="separator:a08704c74e985d3ddf885413ae89b6433 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea4ed94981758c2faa5f566ee1f69796 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#aea4ed94981758c2faa5f566ee1f69796">ForwardPacket</a> (int len, const u_char *data, bool orig, <a class="el" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> seq, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip, int caplen)</td></tr>
<tr class="separator:aea4ed94981758c2faa5f566ee1f69796 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43abc450c708c11f3d1678d2f4674e60 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a43abc450c708c11f3d1678d2f4674e60">ForwardStream</a> (int len, const u_char *data, bool orig)</td></tr>
<tr class="separator:a43abc450c708c11f3d1678d2f4674e60 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa5b1e1e039c2d2053c9a2eaa370d546 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#afa5b1e1e039c2d2053c9a2eaa370d546">ForwardUndelivered</a> (<a class="el" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> seq, int len, bool orig)</td></tr>
<tr class="separator:afa5b1e1e039c2d2053c9a2eaa370d546 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a324c88dc2202b41dd1b49e6063b6de91 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a324c88dc2202b41dd1b49e6063b6de91">ForwardEndOfData</a> (bool orig)</td></tr>
<tr class="separator:a324c88dc2202b41dd1b49e6063b6de91 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02f923b537572031e7783e6d7812dce8 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a02f923b537572031e7783e6d7812dce8">DeliverStream</a> (int len, const u_char *data, bool orig)</td></tr>
<tr class="separator:a02f923b537572031e7783e6d7812dce8 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12e4870a8ee9e8327800298333e1de21 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a12e4870a8ee9e8327800298333e1de21">Undelivered</a> (<a class="el" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> seq, int len, bool orig)</td></tr>
<tr class="separator:a12e4870a8ee9e8327800298333e1de21 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac37864cb863596d588c43ce13efa68b6 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#ac37864cb863596d588c43ce13efa68b6">EndOfData</a> (bool is_orig)</td></tr>
<tr class="separator:ac37864cb863596d588c43ce13efa68b6 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade161235985696e8aba7644b95e69097 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#ade161235985696e8aba7644b95e69097">FlipRoles</a> ()</td></tr>
<tr class="separator:ade161235985696e8aba7644b95e69097 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cff02ba9cf4d37d9787a200928a1eb7 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceanalyzer.html#a0f3859fceea28de62b71f4997f5f6c4f">ID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a6cff02ba9cf4d37d9787a200928a1eb7">GetID</a> () const </td></tr>
<tr class="separator:a6cff02ba9cf4d37d9787a200928a1eb7 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aee2807c8bbdc99f863e27523cf785f inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classConnection.html">Connection</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a5aee2807c8bbdc99f863e27523cf785f">Conn</a> () const </td></tr>
<tr class="separator:a5aee2807c8bbdc99f863e27523cf785f inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90d08474f9b18e76166c704868c80695 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classanalyzer_1_1OutputHandler.html">OutputHandler</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a90d08474f9b18e76166c704868c80695">GetOutputHandler</a> () const </td></tr>
<tr class="separator:a90d08474f9b18e76166c704868c80695 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae35780db556c1d4f86a57917964953b5 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#ae35780db556c1d4f86a57917964953b5">SetOutputHandler</a> (<a class="el" href="classanalyzer_1_1OutputHandler.html">OutputHandler</a> *handler)</td></tr>
<tr class="separator:ae35780db556c1d4f86a57917964953b5 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b92c574785fbc75f976f759a2bec2f6 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classRule.html">Rule</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a6b92c574785fbc75f976f759a2bec2f6">Signature</a> () const </td></tr>
<tr class="separator:a6b92c574785fbc75f976f759a2bec2f6 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bc1dae4e319aaeac11806fe1d98c23d inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a5bc1dae4e319aaeac11806fe1d98c23d">SetSignature</a> (const <a class="el" href="classRule.html">Rule</a> *sig)</td></tr>
<tr class="separator:a5bc1dae4e319aaeac11806fe1d98c23d inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea0076a1a30829ec8f8c9538d894b66b inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#aea0076a1a30829ec8f8c9538d894b66b">SetSkip</a> (bool do_skip)</td></tr>
<tr class="separator:aea0076a1a30829ec8f8c9538d894b66b inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae58a1564685d1feef7a638ba21ee40fd inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#ae58a1564685d1feef7a638ba21ee40fd">Skipping</a> () const </td></tr>
<tr class="separator:ae58a1564685d1feef7a638ba21ee40fd inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d2d13470d90102b1e1a67bed212fb25 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a3d2d13470d90102b1e1a67bed212fb25">IsFinished</a> () const </td></tr>
<tr class="separator:a3d2d13470d90102b1e1a67bed212fb25 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2b128a86268126dac9cc3a18e2525f2 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classanalyzer_1_1Tag.html">Tag</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#af2b128a86268126dac9cc3a18e2525f2">GetAnalyzerTag</a> () const </td></tr>
<tr class="separator:af2b128a86268126dac9cc3a18e2525f2 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae13857115e2e12e3114ca81aaade70b1 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#ae13857115e2e12e3114ca81aaade70b1">SetAnalyzerTag</a> (const <a class="el" href="classanalyzer_1_1Tag.html">Tag</a> &amp;<a class="el" href="classanalyzer_1_1Analyzer.html#a95d7c49d423c8633b6fe493ea4f3112a">tag</a>)</td></tr>
<tr class="separator:ae13857115e2e12e3114ca81aaade70b1 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f4783d7f96b69b25414e48924e12520 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a3f4783d7f96b69b25414e48924e12520">GetAnalyzerName</a> () const </td></tr>
<tr class="separator:a3f4783d7f96b69b25414e48924e12520 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac40890384a1932a1ed72f13574becfe0 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#ac40890384a1932a1ed72f13574becfe0">IsAnalyzer</a> (const char *name)</td></tr>
<tr class="separator:ac40890384a1932a1ed72f13574becfe0 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fa782676e3392d549e0e9e140f0d552 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a7fa782676e3392d549e0e9e140f0d552">AddChildAnalyzer</a> (<a class="el" href="classanalyzer_1_1Analyzer.html">Analyzer</a> *analyzer)</td></tr>
<tr class="separator:a7fa782676e3392d549e0e9e140f0d552 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed17f8d1a1d5d2fadebe1c9109d96061 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classanalyzer_1_1Analyzer.html">Analyzer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#aed17f8d1a1d5d2fadebe1c9109d96061">AddChildAnalyzer</a> (<a class="el" href="classanalyzer_1_1Tag.html">Tag</a> <a class="el" href="classanalyzer_1_1Analyzer.html#a95d7c49d423c8633b6fe493ea4f3112a">tag</a>)</td></tr>
<tr class="separator:aed17f8d1a1d5d2fadebe1c9109d96061 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5f815285513eb3abf4ab67c5bda8ac4 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#ac5f815285513eb3abf4ab67c5bda8ac4">RemoveChildAnalyzer</a> (<a class="el" href="classanalyzer_1_1Analyzer.html">Analyzer</a> *analyzer)</td></tr>
<tr class="separator:ac5f815285513eb3abf4ab67c5bda8ac4 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a821ff1b79aa172f874427a92d1668287 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a821ff1b79aa172f874427a92d1668287">RemoveChildAnalyzer</a> (<a class="el" href="namespaceanalyzer.html#a0f3859fceea28de62b71f4997f5f6c4f">ID</a> <a class="el" href="classanalyzer_1_1Analyzer.html#a8ca1757265e955b04ba4ad8ed2c30524">id</a>)</td></tr>
<tr class="separator:a821ff1b79aa172f874427a92d1668287 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44257dbbbac6ca4c69241499dd3b0096 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a44257dbbbac6ca4c69241499dd3b0096">HasChildAnalyzer</a> (<a class="el" href="classanalyzer_1_1Tag.html">Tag</a> <a class="el" href="classanalyzer_1_1Analyzer.html#a95d7c49d423c8633b6fe493ea4f3112a">tag</a>)</td></tr>
<tr class="separator:a44257dbbbac6ca4c69241499dd3b0096 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c106f14a194e5053c86d7777c3d1f27 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classanalyzer_1_1Analyzer.html">Analyzer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a2c106f14a194e5053c86d7777c3d1f27">FindChild</a> (<a class="el" href="namespaceanalyzer.html#a0f3859fceea28de62b71f4997f5f6c4f">ID</a> <a class="el" href="classanalyzer_1_1Analyzer.html#a8ca1757265e955b04ba4ad8ed2c30524">id</a>)</td></tr>
<tr class="separator:a2c106f14a194e5053c86d7777c3d1f27 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36436cd17000acaee421f5d54b64ac55 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classanalyzer_1_1Analyzer.html">Analyzer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a36436cd17000acaee421f5d54b64ac55">FindChild</a> (<a class="el" href="classanalyzer_1_1Tag.html">Tag</a> <a class="el" href="classanalyzer_1_1Analyzer.html#a95d7c49d423c8633b6fe493ea4f3112a">tag</a>)</td></tr>
<tr class="separator:a36436cd17000acaee421f5d54b64ac55 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e38b4e2f0a7ae8793072539dd14a959 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classanalyzer_1_1Analyzer.html">Analyzer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a8e38b4e2f0a7ae8793072539dd14a959">FindChild</a> (const char *name)</td></tr>
<tr class="separator:a8e38b4e2f0a7ae8793072539dd14a959 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adae65ba764c40a1022a4e8e87aa43a9b inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="namespaceanalyzer.html#a1a5dc1e780a90208c879a2927cdf71f0">analyzer_list</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#adae65ba764c40a1022a4e8e87aa43a9b">GetChildren</a> ()</td></tr>
<tr class="separator:adae65ba764c40a1022a4e8e87aa43a9b inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f2c97e513b73d21c33d96d58c9c41c6 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classanalyzer_1_1Analyzer.html">Analyzer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a9f2c97e513b73d21c33d96d58c9c41c6">Parent</a> () const </td></tr>
<tr class="separator:a9f2c97e513b73d21c33d96d58c9c41c6 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7118aeb325556b0c707ba4a82c318f8c inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a7118aeb325556b0c707ba4a82c318f8c">SetParent</a> (<a class="el" href="classanalyzer_1_1Analyzer.html">Analyzer</a> *p)</td></tr>
<tr class="separator:a7118aeb325556b0c707ba4a82c318f8c inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f090eade33e0581074caecf4180bf80 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a0f090eade33e0581074caecf4180bf80">Remove</a> ()</td></tr>
<tr class="separator:a0f090eade33e0581074caecf4180bf80 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa887bdcefada87e7f06d6b5b8b8b76e2 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#aa887bdcefada87e7f06d6b5b8b8b76e2">AddSupportAnalyzer</a> (<a class="el" href="classanalyzer_1_1SupportAnalyzer.html">SupportAnalyzer</a> *analyzer)</td></tr>
<tr class="separator:aa887bdcefada87e7f06d6b5b8b8b76e2 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ff6b8add1ab09babc4ebd67ae298811 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a4ff6b8add1ab09babc4ebd67ae298811">RemoveSupportAnalyzer</a> (<a class="el" href="classanalyzer_1_1SupportAnalyzer.html">SupportAnalyzer</a> *analyzer)</td></tr>
<tr class="separator:a4ff6b8add1ab09babc4ebd67ae298811 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54e2d616853b7863693fcc3bb6a34b16 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a54e2d616853b7863693fcc3bb6a34b16">ProtocolConfirmation</a> (<a class="el" href="classanalyzer_1_1Tag.html">Tag</a> <a class="el" href="classanalyzer_1_1Analyzer.html#a95d7c49d423c8633b6fe493ea4f3112a">tag</a>=<a class="el" href="classanalyzer_1_1Tag.html">Tag</a>())</td></tr>
<tr class="separator:a54e2d616853b7863693fcc3bb6a34b16 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55b3a5e2457a47421dab175e60902700 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a55b3a5e2457a47421dab175e60902700">ProtocolViolation</a> (const char *reason, const char *data=0, int len=0)</td></tr>
<tr class="separator:a55b3a5e2457a47421dab175e60902700 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a872f2a1a4721f3a59a0b566eeb64701c inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a872f2a1a4721f3a59a0b566eeb64701c">ProtocolConfirmed</a> () const </td></tr>
<tr class="separator:a872f2a1a4721f3a59a0b566eeb64701c inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c95b7a2821ab00dbf331534d4accc89 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRecordVal.html">RecordVal</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">BuildConnVal</a> ()</td></tr>
<tr class="separator:a4c95b7a2821ab00dbf331534d4accc89 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a694d33b64c3b2e85d062a8b9570797bc inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a694d33b64c3b2e85d062a8b9570797bc">Event</a> (<a class="el" href="classEventHandlerPtr.html">EventHandlerPtr</a> f, const char *name=0)</td></tr>
<tr class="separator:a694d33b64c3b2e85d062a8b9570797bc inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50b9d89d68e9a03b1dcd339f598dbc85 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a50b9d89d68e9a03b1dcd339f598dbc85">Event</a> (<a class="el" href="classEventHandlerPtr.html">EventHandlerPtr</a> f, <a class="el" href="classVal.html">Val</a> *v1, <a class="el" href="classVal.html">Val</a> *v2=0)</td></tr>
<tr class="separator:a50b9d89d68e9a03b1dcd339f598dbc85 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33fbd3099c09106bff5e5900091ec69e inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">ConnectionEvent</a> (<a class="el" href="classEventHandlerPtr.html">EventHandlerPtr</a> f, val_list *vl)</td></tr>
<tr class="separator:a33fbd3099c09106bff5e5900091ec69e inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a64857836a27d9c1b3b9de6369d8fa4 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a3a64857836a27d9c1b3b9de6369d8fa4">Weird</a> (const char *name, const char *addl=&quot;&quot;)</td></tr>
<tr class="separator:a3a64857836a27d9c1b3b9de6369d8fa4 inherit pub_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a48a8ae39e6497e4ec4f970faf509221a"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classanalyzer_1_1Analyzer.html">analyzer::Analyzer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a48a8ae39e6497e4ec4f970faf509221a">Instantiate</a> (<a class="el" href="classConnection.html">Connection</a> *<a class="el" href="classanalyzer_1_1Analyzer.html#a1630044ed7c43e8d79cacf4bfc580d61">conn</a>)</td></tr>
<tr class="separator:a48a8ae39e6497e4ec4f970faf509221a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ab26c697a86f0a5c9f14aa9c65b6a963e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ab26c697a86f0a5c9f14aa9c65b6a963e">Done</a> () override</td></tr>
<tr class="separator:ab26c697a86f0a5c9f14aa9c65b6a963e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3595428e6c7ca7ad2c0ce52700a5bf41"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a3595428e6c7ca7ad2c0ce52700a5bf41">DeliverPacket</a> (int len, const u_char *data, bool orig, <a class="el" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> seq, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip, int caplen) override</td></tr>
<tr class="separator:a3595428e6c7ca7ad2c0ce52700a5bf41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a87c8de9dd4e2a1c126bab64af9ee0e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a4a87c8de9dd4e2a1c126bab64af9ee0e">IsReuse</a> (double t, const u_char *pkt) override</td></tr>
<tr class="separator:a4a87c8de9dd4e2a1c126bab64af9ee0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac18206c52be3d1cedeb7b7af55ade5e5"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ac18206c52be3d1cedeb7b7af55ade5e5">MemoryAllocation</a> () const override</td></tr>
<tr class="separator:ac18206c52be3d1cedeb7b7af55ade5e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb9920eee6f3086dc08260f840c134a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb9920eee6f3086dc08260f840c134a7">ICMP_Sent</a> (const struct icmp *icmpp, int len, int caplen, int icmpv6, const u_char *data, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip_hdr)</td></tr>
<tr class="separator:afb9920eee6f3086dc08260f840c134a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8f1f204e015fd4e6a68dbe67a49d865"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#aa8f1f204e015fd4e6a68dbe67a49d865">Echo</a> (double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip_hdr)</td></tr>
<tr class="separator:aa8f1f204e015fd4e6a68dbe67a49d865"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add5a77503e4ac6fcdddc7bcb7ccd70c9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#add5a77503e4ac6fcdddc7bcb7ccd70c9">Redirect</a> (double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip_hdr)</td></tr>
<tr class="separator:add5a77503e4ac6fcdddc7bcb7ccd70c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b2e830de064c8024e6777fb7a5f4213"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a3b2e830de064c8024e6777fb7a5f4213">RouterAdvert</a> (double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip_hdr)</td></tr>
<tr class="separator:a3b2e830de064c8024e6777fb7a5f4213"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6b784c209a08090dadf50df738ab350"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ac6b784c209a08090dadf50df738ab350">NeighborAdvert</a> (double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip_hdr)</td></tr>
<tr class="separator:ac6b784c209a08090dadf50df738ab350"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00b0c746a5d910dea730dbb38960f42f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a00b0c746a5d910dea730dbb38960f42f">NeighborSolicit</a> (double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip_hdr)</td></tr>
<tr class="separator:a00b0c746a5d910dea730dbb38960f42f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c988723d5cd0d475768c5b2522c21d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a2c988723d5cd0d475768c5b2522c21d6">RouterSolicit</a> (double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip_hdr)</td></tr>
<tr class="separator:a2c988723d5cd0d475768c5b2522c21d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cf314b1efb9663e0042010e797b87a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a9cf314b1efb9663e0042010e797b87a6">Describe</a> (<a class="el" href="classODesc.html">ODesc</a> *d) const </td></tr>
<tr class="separator:a9cf314b1efb9663e0042010e797b87a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb5ebe883d1b0dec4dc5396d31f144c1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRecordVal.html">RecordVal</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb5ebe883d1b0dec4dc5396d31f144c1">BuildICMPVal</a> (const struct icmp *icmpp, int len, int icmpv6, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip_hdr)</td></tr>
<tr class="separator:afb5ebe883d1b0dec4dc5396d31f144c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3907cd5d838bf0794781cb66915c259d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a3907cd5d838bf0794781cb66915c259d">NextICMP4</a> (double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip_hdr)</td></tr>
<tr class="separator:a3907cd5d838bf0794781cb66915c259d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e9444187e36ecb8abbc93f6c0d5c864"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRecordVal.html">RecordVal</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a1e9444187e36ecb8abbc93f6c0d5c864">ExtractICMP4Context</a> (int len, const u_char *&amp;data)</td></tr>
<tr class="separator:a1e9444187e36ecb8abbc93f6c0d5c864"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbe1d6a5777abf2f068614d71222ac54"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#abbe1d6a5777abf2f068614d71222ac54">Context4</a> (double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip_hdr)</td></tr>
<tr class="separator:abbe1d6a5777abf2f068614d71222ac54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a743b644306afca88916112b2e6580642"><td class="memItemLeft" align="right" valign="top"><a class="el" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7b">TransportProto</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a743b644306afca88916112b2e6580642">GetContextProtocol</a> (const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip_hdr, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> *src_port, <a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> *dst_port)</td></tr>
<tr class="separator:a743b644306afca88916112b2e6580642"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae030feef6ec752b9c0d4fcf8d3301a74"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae030feef6ec752b9c0d4fcf8d3301a74">NextICMP6</a> (double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip_hdr)</td></tr>
<tr class="separator:ae030feef6ec752b9c0d4fcf8d3301a74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66e0e5a307221650b2b9a1f2de65caaf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRecordVal.html">RecordVal</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a66e0e5a307221650b2b9a1f2de65caaf">ExtractICMP6Context</a> (int len, const u_char *&amp;data)</td></tr>
<tr class="separator:a66e0e5a307221650b2b9a1f2de65caaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a358def43caf5209364f490352f60b6f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a358def43caf5209364f490352f60b6f0">Context6</a> (double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *ip_hdr)</td></tr>
<tr class="separator:a358def43caf5209364f490352f60b6f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab844db89298e6cf64c2d84cf5a0f5bf9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classVectorVal.html">VectorVal</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ab844db89298e6cf64c2d84cf5a0f5bf9">BuildNDOptionsVal</a> (int caplen, const u_char *data)</td></tr>
<tr class="separator:ab844db89298e6cf64c2d84cf5a0f5bf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classanalyzer_1_1Analyzer"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classanalyzer_1_1Analyzer')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classanalyzer_1_1Analyzer.html">analyzer::Analyzer</a></td></tr>
<tr class="memitem:a62206e02effa0ef9edf2f19bd6a01e69 inherit pro_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a62206e02effa0ef9edf2f19bd6a01e69">SetConnection</a> (<a class="el" href="classConnection.html">Connection</a> *c)</td></tr>
<tr class="separator:a62206e02effa0ef9edf2f19bd6a01e69 inherit pro_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01adbfd18b97f0a053e6869810d33fa2 inherit pro_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a01adbfd18b97f0a053e6869810d33fa2">AddTimer</a> (<a class="el" href="namespaceanalyzer.html#a2188da050ba48bf4b245902f646dcdd0">analyzer_timer_func</a> timer, double t, int do_expire, <a class="el" href="Timer_8h.html#ad3a7c38fbde9814e427a75171fe8939d">TimerType</a> type)</td></tr>
<tr class="separator:a01adbfd18b97f0a053e6869810d33fa2 inherit pro_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdaecf955b9fb6f6ae3424443328eefa inherit pro_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#acdaecf955b9fb6f6ae3424443328eefa">CancelTimers</a> ()</td></tr>
<tr class="separator:acdaecf955b9fb6f6ae3424443328eefa inherit pro_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad07266dbda51ca9382c4e1808dbea72d inherit pro_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#ad07266dbda51ca9382c4e1808dbea72d">RemoveTimer</a> (<a class="el" href="classTimer.html">Timer</a> *t)</td></tr>
<tr class="separator:ad07266dbda51ca9382c4e1808dbea72d inherit pro_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9115f508118f93537e537da78ac29fe4 inherit pro_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a9115f508118f93537e537da78ac29fe4">HasSupportAnalyzer</a> (<a class="el" href="classanalyzer_1_1Tag.html">Tag</a> <a class="el" href="classanalyzer_1_1Analyzer.html#a95d7c49d423c8633b6fe493ea4f3112a">tag</a>, bool orig)</td></tr>
<tr class="separator:a9115f508118f93537e537da78ac29fe4 inherit pro_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb471c7c1e5f8502796b6526499224cb inherit pro_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classanalyzer_1_1SupportAnalyzer.html">SupportAnalyzer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#aeb471c7c1e5f8502796b6526499224cb">FirstSupportAnalyzer</a> (bool orig)</td></tr>
<tr class="separator:aeb471c7c1e5f8502796b6526499224cb inherit pro_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93c3f3547d24a71d5f5dd2eb9109de02 inherit pro_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a93c3f3547d24a71d5f5dd2eb9109de02">AddChildAnalyzer</a> (<a class="el" href="classanalyzer_1_1Analyzer.html">Analyzer</a> *analyzer, bool init)</td></tr>
<tr class="separator:a93c3f3547d24a71d5f5dd2eb9109de02 inherit pro_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a186d430659d7f9d5fe734e8150145b32 inherit pro_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a186d430659d7f9d5fe734e8150145b32">InitChildren</a> ()</td></tr>
<tr class="separator:a186d430659d7f9d5fe734e8150145b32 inherit pro_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58c21735438552843b4049ce297d9dcc inherit pro_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#a58c21735438552843b4049ce297d9dcc">AppendNewChildren</a> ()</td></tr>
<tr class="separator:a58c21735438552843b4049ce297d9dcc inherit pro_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4e5cb41fe0d07a97b581c49dbd5f643 inherit pro_methods_classanalyzer_1_1Analyzer"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1Analyzer.html#ad4e5cb41fe0d07a97b581c49dbd5f643">Removing</a> () const </td></tr>
<tr class="separator:ad4e5cb41fe0d07a97b581c49dbd5f643 inherit pro_methods_classanalyzer_1_1Analyzer"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ae6fca59ca5559b54efcee453a82643a8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRecordVal.html">RecordVal</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae6fca59ca5559b54efcee453a82643a8">icmp_conn_val</a></td></tr>
<tr class="separator:ae6fca59ca5559b54efcee453a82643a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ac8365c0e88becbfb53dd116a43c489"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a5ac8365c0e88becbfb53dd116a43c489">type</a></td></tr>
<tr class="separator:a5ac8365c0e88becbfb53dd116a43c489"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4da708767b3b9d52f245c98404c5db05"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a4da708767b3b9d52f245c98404c5db05">code</a></td></tr>
<tr class="separator:a4da708767b3b9d52f245c98404c5db05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80abf56d64914c491521fe0a0aff4e76"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a80abf56d64914c491521fe0a0aff4e76">request_len</a></td></tr>
<tr class="separator:a80abf56d64914c491521fe0a0aff4e76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc5800875d89641609b6da8b13b39f0a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#acc5800875d89641609b6da8b13b39f0a">reply_len</a></td></tr>
<tr class="separator:acc5800875d89641609b6da8b13b39f0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c7726dc04dac4b593970635477c1ac9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRuleMatcherState.html">RuleMatcherState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a7c7726dc04dac4b593970635477c1ac9">matcher_state</a></td></tr>
<tr class="separator:a7c7726dc04dac4b593970635477c1ac9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a49b9ebc70e8cdeac5961ff308f1aeb41"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a49b9ebc70e8cdeac5961ff308f1aeb41">UpdateEndpointVal</a> (<a class="el" href="classRecordVal.html">RecordVal</a> *endp, int is_orig)</td></tr>
<tr class="separator:a49b9ebc70e8cdeac5961ff308f1aeb41"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="ICMP_8h_source.html#l00018">18</a> of file <a class="el" href="ICMP_8h_source.html">ICMP.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a1a731675510864f64174f96cdb342152"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ICMP_Analyzer::ICMP_Analyzer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classConnection.html">Connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00019">19</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    : <a class="code" href="classanalyzer_1_1TransportLayerAnalyzer.html#a5eb617297a0f98f4d3a1bf2fb654d948">TransportLayerAnalyzer</a>(<span class="stringliteral">&quot;ICMP&quot;</span>, c),</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae6fca59ca5559b54efcee453a82643a8">icmp_conn_val</a>(), <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a5ac8365c0e88becbfb53dd116a43c489">type</a>(), <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a4da708767b3b9d52f245c98404c5db05">code</a>(), <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a80abf56d64914c491521fe0a0aff4e76">request_len</a>(-1), <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#acc5800875d89641609b6da8b13b39f0a">reply_len</a>(-1)</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    {</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    c-&gt;SetInactivityTimeout(<a class="code" href="NetVar_8cc.html#a212a8128e6d56aec0202954f0fb4f9d5">icmp_inactivity_timeout</a>);</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_acc5800875d89641609b6da8b13b39f0a"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#acc5800875d89641609b6da8b13b39f0a">analyzer::icmp::ICMP_Analyzer::reply_len</a></div><div class="ttdeci">int reply_len</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00080">ICMP.h:80</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a5ac8365c0e88becbfb53dd116a43c489"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a5ac8365c0e88becbfb53dd116a43c489">analyzer::icmp::ICMP_Analyzer::type</a></div><div class="ttdeci">int type</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00078">ICMP.h:78</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a80abf56d64914c491521fe0a0aff4e76"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a80abf56d64914c491521fe0a0aff4e76">analyzer::icmp::ICMP_Analyzer::request_len</a></div><div class="ttdeci">int request_len</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00080">ICMP.h:80</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_ae6fca59ca5559b54efcee453a82643a8"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae6fca59ca5559b54efcee453a82643a8">analyzer::icmp::ICMP_Analyzer::icmp_conn_val</a></div><div class="ttdeci">RecordVal * icmp_conn_val</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00077">ICMP.h:77</a></div></div>
<div class="ttc" id="classanalyzer_1_1TransportLayerAnalyzer_html_a5eb617297a0f98f4d3a1bf2fb654d948"><div class="ttname"><a href="classanalyzer_1_1TransportLayerAnalyzer.html#a5eb617297a0f98f4d3a1bf2fb654d948">analyzer::TransportLayerAnalyzer::TransportLayerAnalyzer</a></div><div class="ttdeci">TransportLayerAnalyzer(const char *name, Connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8h_source.html#l00811">Analyzer.h:811</a></div></div>
<div class="ttc" id="NetVar_8cc_html_a212a8128e6d56aec0202954f0fb4f9d5"><div class="ttname"><a href="NetVar_8cc.html#a212a8128e6d56aec0202954f0fb4f9d5">icmp_inactivity_timeout</a></div><div class="ttdeci">double icmp_inactivity_timeout</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00062">NetVar.cc:62</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a4da708767b3b9d52f245c98404c5db05"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a4da708767b3b9d52f245c98404c5db05">analyzer::icmp::ICMP_Analyzer::code</a></div><div class="ttdeci">int code</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00079">ICMP.h:79</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="afb5ebe883d1b0dec4dc5396d31f144c1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRecordVal.html">RecordVal</a> * ICMP_Analyzer::BuildICMPVal </td>
          <td>(</td>
          <td class="paramtype">const struct icmp *&#160;</td>
          <td class="paramname"><em>icmpp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>icmpv6</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>ip_hdr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00219">219</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    {</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">if</span> ( ! <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae6fca59ca5559b54efcee453a82643a8">icmp_conn_val</a> )</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae6fca59ca5559b54efcee453a82643a8">icmp_conn_val</a> = <span class="keyword">new</span> <a class="code" href="classRecordVal.html">RecordVal</a>(<a class="code" href="NetVar_8cc.html#aa12de90a63a666f6fa1c011ea412e07f">icmp_conn</a>);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae6fca59ca5559b54efcee453a82643a8">icmp_conn_val</a>-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(0, <span class="keyword">new</span> <a class="code" href="classAddrVal.html">AddrVal</a>(<a class="code" href="classanalyzer_1_1Analyzer.html#a5aee2807c8bbdc99f863e27523cf785f">Conn</a>()-&gt;OrigAddr()));</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae6fca59ca5559b54efcee453a82643a8">icmp_conn_val</a>-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(1, <span class="keyword">new</span> <a class="code" href="classAddrVal.html">AddrVal</a>(<a class="code" href="classanalyzer_1_1Analyzer.html#a5aee2807c8bbdc99f863e27523cf785f">Conn</a>()-&gt;RespAddr()));</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae6fca59ca5559b54efcee453a82643a8">icmp_conn_val</a>-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(2, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(icmpp-&gt;icmp_type, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae6fca59ca5559b54efcee453a82643a8">icmp_conn_val</a>-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(3, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(icmpp-&gt;icmp_code, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae6fca59ca5559b54efcee453a82643a8">icmp_conn_val</a>-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(4, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(len, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae6fca59ca5559b54efcee453a82643a8">icmp_conn_val</a>-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(5, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a387fd92f715e230e9db5553ebc3f6374">TTL</a>(), <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae6fca59ca5559b54efcee453a82643a8">icmp_conn_val</a>-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(6, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(icmpv6, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>));</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="Obj_8h.html#a1f4709815c0908bb09e9d7bcb0bf1ac1">Ref</a>(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae6fca59ca5559b54efcee453a82643a8">icmp_conn_val</a>);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae6fca59ca5559b54efcee453a82643a8">icmp_conn_val</a>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div><div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00020">Type.h:20</a></div></div>
<div class="ttc" id="classVal_html"><div class="ttname"><a href="classVal.html">Val</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00078">Val.h:78</a></div></div>
<div class="ttc" id="Obj_8h_html_a1f4709815c0908bb09e9d7bcb0bf1ac1"><div class="ttname"><a href="Obj_8h.html#a1f4709815c0908bb09e9d7bcb0bf1ac1">Ref</a></div><div class="ttdeci">void Ref(BroObj *o)</div><div class="ttdef"><b>Definition:</b> <a href="Obj_8h_source.html#l00208">Obj.h:208</a></div></div>
<div class="ttc" id="classRecordVal_html"><div class="ttname"><a href="classRecordVal.html">RecordVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00937">Val.h:937</a></div></div>
<div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00022">Type.h:22</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_ae6fca59ca5559b54efcee453a82643a8"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae6fca59ca5559b54efcee453a82643a8">analyzer::icmp::ICMP_Analyzer::icmp_conn_val</a></div><div class="ttdeci">RecordVal * icmp_conn_val</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00077">ICMP.h:77</a></div></div>
<div class="ttc" id="classRecordVal_html_a5c6a817fc30e555ddb9708a83ffbdfaf"><div class="ttname"><a href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">RecordVal::Assign</a></div><div class="ttdeci">void Assign(int field, Val *new_val, Opcode op=OP_ASSIGN)</div><div class="ttdef"><b>Definition:</b> <a href="Val_8cc_source.html#l02873">Val.cc:2873</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a387fd92f715e230e9db5553ebc3f6374"><div class="ttname"><a href="classIP__Hdr.html#a387fd92f715e230e9db5553ebc3f6374">IP_Hdr::TTL</a></div><div class="ttdeci">unsigned char TTL() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00517">IP.h:517</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a5aee2807c8bbdc99f863e27523cf785f"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a5aee2807c8bbdc99f863e27523cf785f">analyzer::Analyzer::Conn</a></div><div class="ttdeci">Connection * Conn() const </div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8h_source.html#l00273">Analyzer.h:273</a></div></div>
<div class="ttc" id="classAddrVal_html"><div class="ttname"><a href="classAddrVal.html">AddrVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00570">Val.h:570</a></div></div>
<div class="ttc" id="NetVar_8cc_html_aa12de90a63a666f6fa1c011ea412e07f"><div class="ttname"><a href="NetVar_8cc.html#aa12de90a63a666f6fa1c011ea412e07f">icmp_conn</a></div><div class="ttdeci">RecordType * icmp_conn</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00014">NetVar.cc:14</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab844db89298e6cf64c2d84cf5a0f5bf9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classVectorVal.html">VectorVal</a> * ICMP_Analyzer::BuildNDOptionsVal </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>caplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00709">709</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    {</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keyword">static</span> <a class="code" href="classRecordType.html">RecordType</a>* icmp6_nd_option_type = 0;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keyword">static</span> <a class="code" href="classRecordType.html">RecordType</a>* icmp6_nd_prefix_info_type = 0;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordflow">if</span> ( ! icmp6_nd_option_type )</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        {</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        icmp6_nd_option_type = <a class="code" href="Var_8cc.html#a6920a2e1ca01099545ee06711bbad168">internal_type</a>(<span class="stringliteral">&quot;icmp6_nd_option&quot;</span>)-&gt;<a class="code" href="classBroType.html#af86ed0d0a3df584e5f768668a0c639af">AsRecordType</a>();</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        icmp6_nd_prefix_info_type =</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                <a class="code" href="Var_8cc.html#a6920a2e1ca01099545ee06711bbad168">internal_type</a>(<span class="stringliteral">&quot;icmp6_nd_prefix_info&quot;</span>)-&gt;<a class="code" href="classBroType.html#af86ed0d0a3df584e5f768668a0c639af">AsRecordType</a>();</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        }</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <a class="code" href="classVectorVal.html">VectorVal</a>* vv = <span class="keyword">new</span> <a class="code" href="classVectorVal.html">VectorVal</a>(</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            <a class="code" href="Var_8cc.html#a6920a2e1ca01099545ee06711bbad168">internal_type</a>(<span class="stringliteral">&quot;icmp6_nd_options&quot;</span>)-&gt;AsVectorType());</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keywordflow">while</span> ( caplen &gt; 0 )</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        {</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <span class="comment">// Must have at least type &amp; length to continue parsing options.</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">if</span> ( caplen &lt; 2 )</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            {</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            <a class="code" href="classanalyzer_1_1Analyzer.html#a3a64857836a27d9c1b3b9de6369d8fa4">Weird</a>(<span class="stringliteral">&quot;truncated_ICMPv6_ND_options&quot;</span>);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            }</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <a class="code" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a5ac8365c0e88becbfb53dd116a43c489">type</a> = *((<span class="keyword">const</span> <a class="code" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a>*)data);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        <a class="code" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> length = *((<span class="keyword">const</span> <a class="code" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a>*)(data + 1));</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <span class="keywordflow">if</span> ( length == 0 )</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            {</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            <a class="code" href="classanalyzer_1_1Analyzer.html#a3a64857836a27d9c1b3b9de6369d8fa4">Weird</a>(<span class="stringliteral">&quot;zero_length_ICMPv6_ND_option&quot;</span>);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            }</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <a class="code" href="classRecordVal.html">RecordVal</a>* rv = <span class="keyword">new</span> <a class="code" href="classRecordVal.html">RecordVal</a>(icmp6_nd_option_type);</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        rv-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(0, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(type, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        rv-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(1, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(length, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <span class="comment">// Adjust length to be in units of bytes, exclude type/length fields.</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        length = length * 8 - 2;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        data += 2;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        caplen -= 2;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="keywordtype">bool</span> set_payload_field = <span class="keyword">false</span>;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="comment">// Only parse out known options that are there in full.</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="keywordflow">switch</span> ( type ) {</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            <span class="comment">// Source/Target Link-layer Address option</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            {</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            <span class="keywordflow">if</span> ( caplen &gt;= length )</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                {</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                <a class="code" href="classBroString.html">BroString</a>* link_addr = <span class="keyword">new</span> <a class="code" href="classBroString.html">BroString</a>(data, length, 0);</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                rv-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(2, <span class="keyword">new</span> <a class="code" href="classStringVal.html">StringVal</a>(link_addr));</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                }</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                set_payload_field = <span class="keyword">true</span>;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            <span class="comment">// Prefix Information option</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            {</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            <span class="keywordflow">if</span> ( caplen &gt;= 30 )</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                {</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                <a class="code" href="classRecordVal.html">RecordVal</a>* info = <span class="keyword">new</span> <a class="code" href="classRecordVal.html">RecordVal</a>(icmp6_nd_prefix_info_type);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                <a class="code" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> prefix_len = *((<span class="keyword">const</span> <a class="code" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a>*)(data));</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                <span class="keywordtype">bool</span> L_flag = (*((<span class="keyword">const</span> <a class="code" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a>*)(data + 1)) &amp; 0x80) != 0;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                <span class="keywordtype">bool</span> A_flag = (*((<span class="keyword">const</span> <a class="code" href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a>*)(data + 1)) &amp; 0x40) != 0;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> valid_life = *((<span class="keyword">const</span> <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>*)(data + 2));</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> prefer_life = *((<span class="keyword">const</span> <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>*)(data + 6));</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                in6_addr prefix = *((<span class="keyword">const</span> in6_addr*)(data + 14));</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                info-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(0, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(prefix_len, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                info-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(1, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(L_flag, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>));</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                info-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(2, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(A_flag, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>));</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                info-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(3, <span class="keyword">new</span> <a class="code" href="classIntervalVal.html">IntervalVal</a>((<span class="keywordtype">double</span>)ntohl(valid_life), <a class="code" href="Val_8h.html#a46299c0ec2e71a21f923d4976596571e">Seconds</a>));</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                info-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(4, <span class="keyword">new</span> <a class="code" href="classIntervalVal.html">IntervalVal</a>((<span class="keywordtype">double</span>)ntohl(prefer_life), <a class="code" href="Val_8h.html#a46299c0ec2e71a21f923d4976596571e">Seconds</a>));</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                info-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(5, <span class="keyword">new</span> <a class="code" href="classAddrVal.html">AddrVal</a>(<a class="code" href="classIPAddr.html">IPAddr</a>(prefix)));</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                rv-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(3, info);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                }</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                set_payload_field = <span class="keyword">true</span>;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            }</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            <span class="comment">// Redirected Header option</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            {</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            <span class="keywordflow">if</span> ( caplen &gt;= length )</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                {</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                <span class="keyword">const</span> u_char* hdr = data + 6;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                rv-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(4, <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a66e0e5a307221650b2b9a1f2de65caaf">ExtractICMP6Context</a>(length - 6, hdr));</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                }</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                set_payload_field = <span class="keyword">true</span>;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            }</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            <span class="comment">// MTU option</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            {</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            <span class="keywordflow">if</span> ( caplen &gt;= 6 )</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                rv-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(5, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(ntohl(*((<span class="keyword">const</span> <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>*)(data + 2))),</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                                      <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                set_payload_field = <span class="keyword">true</span>;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            }</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            {</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            set_payload_field = <span class="keyword">true</span>;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            }</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        }</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <span class="keywordflow">if</span> ( set_payload_field )</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            {</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <a class="code" href="classBroString.html">BroString</a>* payload =</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                    <span class="keyword">new</span> <a class="code" href="classBroString.html">BroString</a>(data, min((<span class="keywordtype">int</span>)length, caplen), 0);</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            rv-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(6, <span class="keyword">new</span> <a class="code" href="classStringVal.html">StringVal</a>(payload));</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            }</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        data += length;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        caplen -= length;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        vv-&gt;<a class="code" href="classVectorVal.html#a02a4ad1a1798a5f9c1209d5ae130d9c9">Assign</a>(vv-&gt;<a class="code" href="classVectorVal.html#a5c18312e7087ced068faed371ee3fb7e">Size</a>(), rv);</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        }</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">return</span> vv;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    }</div><div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00020">Type.h:20</a></div></div>
<div class="ttc" id="classVal_html"><div class="ttname"><a href="classVal.html">Val</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00078">Val.h:78</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a5ac8365c0e88becbfb53dd116a43c489"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a5ac8365c0e88becbfb53dd116a43c489">analyzer::icmp::ICMP_Analyzer::type</a></div><div class="ttdeci">int type</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00078">ICMP.h:78</a></div></div>
<div class="ttc" id="classStringVal_html"><div class="ttname"><a href="classStringVal.html">StringVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00623">Val.h:623</a></div></div>
<div class="ttc" id="classBroString_html"><div class="ttname"><a href="classBroString.html">BroString</a></div><div class="ttdef"><b>Definition:</b> <a href="BroString_8h_source.html#l00022">BroString.h:22</a></div></div>
<div class="ttc" id="classIPAddr_html"><div class="ttname"><a href="classIPAddr.html">IPAddr</a></div><div class="ttdef"><b>Definition:</b> <a href="IPAddr_8h_source.html#l00024">IPAddr.h:24</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a3a64857836a27d9c1b3b9de6369d8fa4"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a3a64857836a27d9c1b3b9de6369d8fa4">analyzer::Analyzer::Weird</a></div><div class="ttdeci">void Weird(const char *name, const char *addl=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00785">Analyzer.cc:785</a></div></div>
<div class="ttc" id="classRecordType_html"><div class="ttname"><a href="classRecordType.html">RecordType</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00461">Type.h:461</a></div></div>
<div class="ttc" id="classVectorVal_html"><div class="ttname"><a href="classVectorVal.html">VectorVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l01024">Val.h:1024</a></div></div>
<div class="ttc" id="classVectorVal_html_a5c18312e7087ced068faed371ee3fb7e"><div class="ttname"><a href="classVectorVal.html#a5c18312e7087ced068faed371ee3fb7e">VectorVal::Size</a></div><div class="ttdeci">unsigned int Size() const </div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l01063">Val.h:1063</a></div></div>
<div class="ttc" id="classRecordVal_html"><div class="ttname"><a href="classRecordVal.html">RecordVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00937">Val.h:937</a></div></div>
<div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00022">Type.h:22</a></div></div>
<div class="ttc" id="classBroType_html_af86ed0d0a3df584e5f768668a0c639af"><div class="ttname"><a href="classBroType.html#af86ed0d0a3df584e5f768668a0c639af">BroType::AsRecordType</a></div><div class="ttdeci">const RecordType * AsRecordType() const </div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00157">Type.h:157</a></div></div>
<div class="ttc" id="classRecordVal_html_a5c6a817fc30e555ddb9708a83ffbdfaf"><div class="ttname"><a href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">RecordVal::Assign</a></div><div class="ttdeci">void Assign(int field, Val *new_val, Opcode op=OP_ASSIGN)</div><div class="ttdef"><b>Definition:</b> <a href="Val_8cc_source.html#l02873">Val.cc:2873</a></div></div>
<div class="ttc" id="Val_8h_html_a46299c0ec2e71a21f923d4976596571e"><div class="ttname"><a href="Val_8h.html#a46299c0ec2e71a21f923d4976596571e">Seconds</a></div><div class="ttdeci">#define Seconds</div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00479">Val.h:479</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a66e0e5a307221650b2b9a1f2de65caaf"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a66e0e5a307221650b2b9a1f2de65caaf">analyzer::icmp::ICMP_Analyzer::ExtractICMP6Context</a></div><div class="ttdeci">RecordVal * ExtractICMP6Context(int len, const u_char *&amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00371">ICMP.cc:371</a></div></div>
<div class="ttc" id="classAddrVal_html"><div class="ttname"><a href="classAddrVal.html">AddrVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00570">Val.h:570</a></div></div>
<div class="ttc" id="util_8h_html_acbd4acd0d29e2d6c43104827f77d9cd2"><div class="ttname"><a href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00064">util.h:64</a></div></div>
<div class="ttc" id="Var_8cc_html_a6920a2e1ca01099545ee06711bbad168"><div class="ttname"><a href="Var_8cc.html#a6920a2e1ca01099545ee06711bbad168">internal_type</a></div><div class="ttdeci">BroType * internal_type(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="Var_8cc_source.html#l00606">Var.cc:606</a></div></div>
<div class="ttc" id="classIntervalVal_html"><div class="ttname"><a href="classIntervalVal.html">IntervalVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00484">Val.h:484</a></div></div>
<div class="ttc" id="classVectorVal_html_a02a4ad1a1798a5f9c1209d5ae130d9c9"><div class="ttname"><a href="classVectorVal.html#a02a4ad1a1798a5f9c1209d5ae130d9c9">VectorVal::Assign</a></div><div class="ttdeci">bool Assign(unsigned int index, Val *element, Opcode op=OP_ASSIGN)</div><div class="ttdef"><b>Definition:</b> <a href="Val_8cc_source.html#l03246">Val.cc:3246</a></div></div>
<div class="ttc" id="util_8h_html_a33a5e996e7a90acefb8b1c0bea47e365"><div class="ttname"><a href="util_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a></div><div class="ttdeci">uint8_t uint8</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00066">util.h:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abbe1d6a5777abf2f068614d71222ac54"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ICMP_Analyzer::Context4 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct icmp *&#160;</td>
          <td class="paramname"><em>icmpp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>caplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>ip_hdr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00642">642</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    {</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <a class="code" href="classEventHandlerPtr.html">EventHandlerPtr</a> f = 0;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordflow">switch</span> ( icmpp-&gt;icmp_type )</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="keywordflow">case</span> ICMP_UNREACH:</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            f = icmp_unreachable;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="keywordflow">case</span> ICMP_TIMXCEED:</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            f = icmp_time_exceeded;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        }</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordflow">if</span> ( f )</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        {</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        val_list* vl = <span class="keyword">new</span> val_list;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        vl-&gt;append(<a class="code" href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">BuildConnVal</a>());</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        vl-&gt;append(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb5ebe883d1b0dec4dc5396d31f144c1">BuildICMPVal</a>(icmpp, len, 0, ip_hdr));</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(icmpp-&gt;icmp_code, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        vl-&gt;append(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a1e9444187e36ecb8abbc93f6c0d5c864">ExtractICMP4Context</a>(caplen, data));</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <a class="code" href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">ConnectionEvent</a>(f, vl);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        }</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1Analyzer_html_a33fbd3099c09106bff5e5900091ec69e"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">analyzer::Analyzer::ConnectionEvent</a></div><div class="ttdeci">void ConnectionEvent(EventHandlerPtr f, val_list *vl)</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00780">Analyzer.cc:780</a></div></div>
<div class="ttc" id="classVal_html"><div class="ttname"><a href="classVal.html">Val</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00078">Val.h:78</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a1e9444187e36ecb8abbc93f6c0d5c864"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a1e9444187e36ecb8abbc93f6c0d5c864">analyzer::icmp::ICMP_Analyzer::ExtractICMP4Context</a></div><div class="ttdeci">RecordVal * ExtractICMP4Context(int len, const u_char *&amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00305">ICMP.cc:305</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_afb5ebe883d1b0dec4dc5396d31f144c1"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb5ebe883d1b0dec4dc5396d31f144c1">analyzer::icmp::ICMP_Analyzer::BuildICMPVal</a></div><div class="ttdeci">RecordVal * BuildICMPVal(const struct icmp *icmpp, int len, int icmpv6, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00219">ICMP.cc:219</a></div></div>
<div class="ttc" id="classEventHandlerPtr_html"><div class="ttname"><a href="classEventHandlerPtr.html">EventHandlerPtr</a></div><div class="ttdef"><b>Definition:</b> <a href="EventHandler_8h_source.html#l00086">EventHandler.h:86</a></div></div>
<div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00022">Type.h:22</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a4c95b7a2821ab00dbf331534d4accc89"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">analyzer::Analyzer::BuildConnVal</a></div><div class="ttdeci">RecordVal * BuildConnVal()</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00765">Analyzer.cc:765</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a358def43caf5209364f490352f60b6f0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ICMP_Analyzer::Context6 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct icmp *&#160;</td>
          <td class="paramname"><em>icmpp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>caplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>ip_hdr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00670">670</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    {</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <a class="code" href="classEventHandlerPtr.html">EventHandlerPtr</a> f = 0;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">switch</span> ( icmpp-&gt;icmp_type )</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        {</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="keywordflow">case</span> ICMP6_DST_UNREACH:</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            f = icmp_unreachable;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="keywordflow">case</span> ICMP6_PARAM_PROB:</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            f = icmp_parameter_problem;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <span class="keywordflow">case</span> ICMP6_TIME_EXCEEDED:</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            f = icmp_time_exceeded;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="keywordflow">case</span> ICMP6_PACKET_TOO_BIG:</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            f = icmp_packet_too_big;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            f = icmp_error_message;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        }</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordflow">if</span> ( f )</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        {</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        val_list* vl = <span class="keyword">new</span> val_list;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        vl-&gt;append(<a class="code" href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">BuildConnVal</a>());</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        vl-&gt;append(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb5ebe883d1b0dec4dc5396d31f144c1">BuildICMPVal</a>(icmpp, len, 1, ip_hdr));</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(icmpp-&gt;icmp_code, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        vl-&gt;append(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a66e0e5a307221650b2b9a1f2de65caaf">ExtractICMP6Context</a>(caplen, data));</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <a class="code" href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">ConnectionEvent</a>(f, vl);</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        }</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1Analyzer_html_a33fbd3099c09106bff5e5900091ec69e"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">analyzer::Analyzer::ConnectionEvent</a></div><div class="ttdeci">void ConnectionEvent(EventHandlerPtr f, val_list *vl)</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00780">Analyzer.cc:780</a></div></div>
<div class="ttc" id="classVal_html"><div class="ttname"><a href="classVal.html">Val</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00078">Val.h:78</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_afb5ebe883d1b0dec4dc5396d31f144c1"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb5ebe883d1b0dec4dc5396d31f144c1">analyzer::icmp::ICMP_Analyzer::BuildICMPVal</a></div><div class="ttdeci">RecordVal * BuildICMPVal(const struct icmp *icmpp, int len, int icmpv6, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00219">ICMP.cc:219</a></div></div>
<div class="ttc" id="classEventHandlerPtr_html"><div class="ttname"><a href="classEventHandlerPtr.html">EventHandlerPtr</a></div><div class="ttdef"><b>Definition:</b> <a href="EventHandler_8h_source.html#l00086">EventHandler.h:86</a></div></div>
<div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00022">Type.h:22</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a66e0e5a307221650b2b9a1f2de65caaf"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a66e0e5a307221650b2b9a1f2de65caaf">analyzer::icmp::ICMP_Analyzer::ExtractICMP6Context</a></div><div class="ttdeci">RecordVal * ExtractICMP6Context(int len, const u_char *&amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00371">ICMP.cc:371</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a4c95b7a2821ab00dbf331534d4accc89"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">analyzer::Analyzer::BuildConnVal</a></div><div class="ttdeci">RecordVal * BuildConnVal()</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00765">Analyzer.cc:765</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3595428e6c7ca7ad2c0ce52700a5bf41"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ICMP_Analyzer::DeliverPacket </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>orig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a>&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>caplen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Hook for accessing packet input for parsing. This is called by NextDeliverPacket() and can be overridden by derived classes. Parameters are the same. </p>

<p>Reimplemented from <a class="el" href="classanalyzer_1_1Analyzer.html#a07c339e4d1d365450a186bdd8d8e927b">analyzer::Analyzer</a>.</p>

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00033">33</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    {</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    assert(ip);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="classanalyzer_1_1Analyzer.html#a07c339e4d1d365450a186bdd8d8e927b">TransportLayerAnalyzer::DeliverPacket</a>(len, data, is_orig, seq, ip, caplen);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// We need the min() here because Ethernet frame padding can lead to</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// caplen &gt; len.</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">if</span> ( packet_contents )</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="comment">// Subtract off the common part of ICMP header.</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <a class="code" href="classanalyzer_1_1TransportLayerAnalyzer.html#acd0078d1762578eaca6d3e5f60f8fa12">PacketContents</a>(data + 8, min(len, caplen) - 8);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span>icmp* icmpp = (<span class="keyword">const</span> <span class="keyword">struct </span>icmp*) data;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">if</span> ( ! <a class="code" href="NetVar_8cc.html#a9bbf0baaee40c7cc0033ff2bacad5fb7">ignore_checksums</a> &amp;&amp; caplen &gt;= len )</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordtype">int</span> chksum = 0;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordflow">switch</span> ( ip-&gt;<a class="code" href="classIP__Hdr.html#a7ec0fdb8132b43b74a16bfef5c7b851e">NextProto</a>() )</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">case</span> IPPROTO_ICMP:</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            chksum = <a class="code" href="net__util_8cc.html#a14441a9a828596079db2e81ccdddd107">icmp_checksum</a>(icmpp, len);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordflow">case</span> IPPROTO_ICMPV6:</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            chksum = <a class="code" href="net__util_8cc.html#aeb68475761269bce1514ba0205fcb6e7">icmp6_checksum</a>(icmpp, ip, len);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            <a class="code" href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a>-&gt;<a class="code" href="classReporter.html#a77f3ece256445a9db418a23b5eb732cc">AnalyzerError</a>(<span class="keyword">this</span>,</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;              <span class="stringliteral">&quot;unexpected IP proto in ICMP analyzer: %d&quot;</span>, ip-&gt;<a class="code" href="classIP__Hdr.html#a7ec0fdb8132b43b74a16bfef5c7b851e">NextProto</a>());</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        }</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordflow">if</span> ( chksum != 0xffff )</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <a class="code" href="classanalyzer_1_1Analyzer.html#a3a64857836a27d9c1b3b9de6369d8fa4">Weird</a>(<span class="stringliteral">&quot;bad_ICMP_checksum&quot;</span>);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        }</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="classanalyzer_1_1Analyzer.html#a5aee2807c8bbdc99f863e27523cf785f">Conn</a>()-&gt;<a class="code" href="classConnection.html#af4df7e68c03f2c898845ab2132a93180">SetLastTime</a>(<a class="code" href="Net_8cc.html#ab722cfd8a04055a2ee129225ad39fc62">current_timestamp</a>);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="main_8cc.html#ab439ed8d6aeda04ac031a22ba741b04e">rule_matcher</a> )</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a7c7726dc04dac4b593970635477c1ac9">matcher_state</a>.<a class="code" href="classRuleMatcherState.html#a60ab63d142ee441993d60bebbf9f8f78">MatcherInitialized</a>(is_orig) )</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a7c7726dc04dac4b593970635477c1ac9">matcher_state</a>.<a class="code" href="classRuleMatcherState.html#ab914e3f44e02b16cdf016de5ea873d5a">InitEndpointMatcher</a>(<span class="keyword">this</span>, ip, len, is_orig, 0);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        }</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a5ac8365c0e88becbfb53dd116a43c489">type</a> = icmpp-&gt;icmp_type;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a4da708767b3b9d52f245c98404c5db05">code</a> = icmpp-&gt;icmp_code;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// Move past common portion of ICMP header.</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    data += 8;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    caplen -= 8;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    len -= 8;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">int</span>&amp; len_stat = is_orig ? <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a80abf56d64914c491521fe0a0aff4e76">request_len</a> : <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#acc5800875d89641609b6da8b13b39f0a">reply_len</a>;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">if</span> ( len_stat &lt; 0 )</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        len_stat = len;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        len_stat += len;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">if</span> ( ip-&gt;<a class="code" href="classIP__Hdr.html#a7ec0fdb8132b43b74a16bfef5c7b851e">NextProto</a>() == IPPROTO_ICMP )</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a3907cd5d838bf0794781cb66915c259d">NextICMP4</a>(<a class="code" href="Net_8cc.html#ab722cfd8a04055a2ee129225ad39fc62">current_timestamp</a>, icmpp, len, caplen, data, ip);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ip-&gt;<a class="code" href="classIP__Hdr.html#a7ec0fdb8132b43b74a16bfef5c7b851e">NextProto</a>() == IPPROTO_ICMPV6 )</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae030feef6ec752b9c0d4fcf8d3301a74">NextICMP6</a>(<a class="code" href="Net_8cc.html#ab722cfd8a04055a2ee129225ad39fc62">current_timestamp</a>, icmpp, len, caplen, data, ip);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a>-&gt;<a class="code" href="classReporter.html#a77f3ece256445a9db418a23b5eb732cc">AnalyzerError</a>(<span class="keyword">this</span>,</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;          <span class="stringliteral">&quot;expected ICMP as IP packet&#39;s protocol, got %d&quot;</span>, ip-&gt;<a class="code" href="classIP__Hdr.html#a7ec0fdb8132b43b74a16bfef5c7b851e">NextProto</a>());</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        }</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">if</span> ( caplen &gt;= len )</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <a class="code" href="classanalyzer_1_1Analyzer.html#aea4ed94981758c2faa5f566ee1f69796">ForwardPacket</a>(len, data, is_orig, seq, ip, caplen);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="main_8cc.html#ab439ed8d6aeda04ac031a22ba741b04e">rule_matcher</a> )</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a7c7726dc04dac4b593970635477c1ac9">matcher_state</a>.<a class="code" href="classRuleMatcherState.html#ae4f226474608f3dd7183cea0f8de9f3f">Match</a>(<a class="code" href="classRule.html#af6be8dfd23098aad37f3cd0188a0953ba9dac31faaf24d45cfa13c5ef3e2e9a8d">Rule::PAYLOAD</a>, data, len, is_orig,</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                    <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_acc5800875d89641609b6da8b13b39f0a"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#acc5800875d89641609b6da8b13b39f0a">analyzer::icmp::ICMP_Analyzer::reply_len</a></div><div class="ttdeci">int reply_len</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00080">ICMP.h:80</a></div></div>
<div class="ttc" id="classRuleMatcherState_html_a60ab63d142ee441993d60bebbf9f8f78"><div class="ttname"><a href="classRuleMatcherState.html#a60ab63d142ee441993d60bebbf9f8f78">RuleMatcherState::MatcherInitialized</a></div><div class="ttdeci">bool MatcherInitialized(bool orig)</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00392">RuleMatcher.h:392</a></div></div>
<div class="ttc" id="NetVar_8cc_html_a9bbf0baaee40c7cc0033ff2bacad5fb7"><div class="ttname"><a href="NetVar_8cc.html#a9bbf0baaee40c7cc0033ff2bacad5fb7">ignore_checksums</a></div><div class="ttdeci">int ignore_checksums</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00035">NetVar.cc:35</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_ae030feef6ec752b9c0d4fcf8d3301a74"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae030feef6ec752b9c0d4fcf8d3301a74">analyzer::icmp::ICMP_Analyzer::NextICMP6</a></div><div class="ttdeci">void NextICMP6(double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00138">ICMP.cc:138</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a5ac8365c0e88becbfb53dd116a43c489"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a5ac8365c0e88becbfb53dd116a43c489">analyzer::icmp::ICMP_Analyzer::type</a></div><div class="ttdeci">int type</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00078">ICMP.h:78</a></div></div>
<div class="ttc" id="classConnection_html_af4df7e68c03f2c898845ab2132a93180"><div class="ttname"><a href="classConnection.html#af4df7e68c03f2c898845ab2132a93180">Connection::SetLastTime</a></div><div class="ttdeci">void SetLastTime(double t)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00100">Conn.h:100</a></div></div>
<div class="ttc" id="classanalyzer_1_1TransportLayerAnalyzer_html_acd0078d1762578eaca6d3e5f60f8fa12"><div class="ttname"><a href="classanalyzer_1_1TransportLayerAnalyzer.html#acd0078d1762578eaca6d3e5f60f8fa12">analyzer::TransportLayerAnalyzer::PacketContents</a></div><div class="ttdeci">void PacketContents(const u_char *data, int len)</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00882">Analyzer.cc:882</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a07c339e4d1d365450a186bdd8d8e927b"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a07c339e4d1d365450a186bdd8d8e927b">analyzer::Analyzer::DeliverPacket</a></div><div class="ttdeci">virtual void DeliverPacket(int len, const u_char *data, bool orig, uint64 seq, const IP_Hdr *ip, int caplen)</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00612">Analyzer.cc:612</a></div></div>
<div class="ttc" id="Reporter_8cc_html_a25adbcf7f40a03cf61ce36b1e10bbf91"><div class="ttname"><a href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a></div><div class="ttdeci">Reporter * reporter</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00025">Reporter.cc:25</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a3a64857836a27d9c1b3b9de6369d8fa4"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a3a64857836a27d9c1b3b9de6369d8fa4">analyzer::Analyzer::Weird</a></div><div class="ttdeci">void Weird(const char *name, const char *addl=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00785">Analyzer.cc:785</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a80abf56d64914c491521fe0a0aff4e76"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a80abf56d64914c491521fe0a0aff4e76">analyzer::icmp::ICMP_Analyzer::request_len</a></div><div class="ttdeci">int request_len</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00080">ICMP.h:80</a></div></div>
<div class="ttc" id="classRuleMatcherState_html_ab914e3f44e02b16cdf016de5ea873d5a"><div class="ttname"><a href="classRuleMatcherState.html#ab914e3f44e02b16cdf016de5ea873d5a">RuleMatcherState::InitEndpointMatcher</a></div><div class="ttdeci">void InitEndpointMatcher(analyzer::Analyzer *analyzer, const IP_Hdr *ip, int caplen, bool from_orig, analyzer::pia::PIA *pia=0)</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8cc_source.html#l01404">RuleMatcher.cc:1404</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a7ec0fdb8132b43b74a16bfef5c7b851e"><div class="ttname"><a href="classIP__Hdr.html#a7ec0fdb8132b43b74a16bfef5c7b851e">IP_Hdr::NextProto</a></div><div class="ttdeci">unsigned char NextProto() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00502">IP.h:502</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a3907cd5d838bf0794781cb66915c259d"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a3907cd5d838bf0794781cb66915c259d">analyzer::icmp::ICMP_Analyzer::NextICMP4</a></div><div class="ttdeci">void NextICMP4(double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00117">ICMP.cc:117</a></div></div>
<div class="ttc" id="Net_8cc_html_ab722cfd8a04055a2ee129225ad39fc62"><div class="ttname"><a href="Net_8cc.html#ab722cfd8a04055a2ee129225ad39fc62">current_timestamp</a></div><div class="ttdeci">double current_timestamp</div><div class="ttdef"><b>Definition:</b> <a href="Net_8cc_source.html#l00065">Net.cc:65</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_aea4ed94981758c2faa5f566ee1f69796"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#aea4ed94981758c2faa5f566ee1f69796">analyzer::Analyzer::ForwardPacket</a></div><div class="ttdeci">virtual void ForwardPacket(int len, const u_char *data, bool orig, uint64 seq, const IP_Hdr *ip, int caplen)</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00290">Analyzer.cc:290</a></div></div>
<div class="ttc" id="classRuleMatcherState_html_ae4f226474608f3dd7183cea0f8de9f3f"><div class="ttname"><a href="classRuleMatcherState.html#ae4f226474608f3dd7183cea0f8de9f3f">RuleMatcherState::Match</a></div><div class="ttdeci">void Match(Rule::PatternType type, const u_char *data, int data_len, bool from_orig, bool bol, bool eol, bool clear_state)</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8cc_source.html#l01454">RuleMatcher.cc:1454</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a5aee2807c8bbdc99f863e27523cf785f"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a5aee2807c8bbdc99f863e27523cf785f">analyzer::Analyzer::Conn</a></div><div class="ttdeci">Connection * Conn() const </div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8h_source.html#l00273">Analyzer.h:273</a></div></div>
<div class="ttc" id="classRule_html_af6be8dfd23098aad37f3cd0188a0953ba9dac31faaf24d45cfa13c5ef3e2e9a8d"><div class="ttname"><a href="classRule.html#af6be8dfd23098aad37f3cd0188a0953ba9dac31faaf24d45cfa13c5ef3e2e9a8d">Rule::PAYLOAD</a></div><div class="ttdef"><b>Definition:</b> <a href="Rule_8h_source.html#l00040">Rule.h:40</a></div></div>
<div class="ttc" id="net__util_8cc_html_aeb68475761269bce1514ba0205fcb6e7"><div class="ttname"><a href="net__util_8cc.html#aeb68475761269bce1514ba0205fcb6e7">icmp6_checksum</a></div><div class="ttdeci">int icmp6_checksum(const struct icmp *icmpp, const IP_Hdr *ip, int len)</div><div class="ttdef"><b>Definition:</b> <a href="net__util_8cc_source.html#l00086">net_util.cc:86</a></div></div>
<div class="ttc" id="classReporter_html_a77f3ece256445a9db418a23b5eb732cc"><div class="ttname"><a href="classReporter.html#a77f3ece256445a9db418a23b5eb732cc">Reporter::AnalyzerError</a></div><div class="ttdeci">void AnalyzerError(analyzer::Analyzer *a, const char *fmt,...) __attribute__((format(printf</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00179">Reporter.cc:179</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a4da708767b3b9d52f245c98404c5db05"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a4da708767b3b9d52f245c98404c5db05">analyzer::icmp::ICMP_Analyzer::code</a></div><div class="ttdeci">int code</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00079">ICMP.h:79</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a7c7726dc04dac4b593970635477c1ac9"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a7c7726dc04dac4b593970635477c1ac9">analyzer::icmp::ICMP_Analyzer::matcher_state</a></div><div class="ttdeci">RuleMatcherState matcher_state</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00082">ICMP.h:82</a></div></div>
<div class="ttc" id="net__util_8cc_html_a14441a9a828596079db2e81ccdddd107"><div class="ttname"><a href="net__util_8cc.html#a14441a9a828596079db2e81ccdddd107">icmp_checksum</a></div><div class="ttdeci">int icmp_checksum(const struct icmp *icmpp, int len)</div><div class="ttdef"><b>Definition:</b> <a href="net__util_8cc_source.html#l00045">net_util.cc:45</a></div></div>
<div class="ttc" id="main_8cc_html_ab439ed8d6aeda04ac031a22ba741b04e"><div class="ttname"><a href="main_8cc.html#ab439ed8d6aeda04ac031a22ba741b04e">rule_matcher</a></div><div class="ttdeci">RuleMatcher * rule_matcher</div><div class="ttdef"><b>Definition:</b> <a href="main_8cc_source.html#l00102">main.cc:102</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9cf314b1efb9663e0042010e797b87a6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ICMP_Analyzer::Describe </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classODesc.html">ODesc</a> *&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00436">436</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    {</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    d-&gt;<a class="code" href="classODesc.html#aa2e466eec7958271b4563ab70f187128">Add</a>(<a class="code" href="classanalyzer_1_1Analyzer.html#a5aee2807c8bbdc99f863e27523cf785f">Conn</a>()-&gt;StartTime());</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    d-&gt;<a class="code" href="classODesc.html#aa2e466eec7958271b4563ab70f187128">Add</a>(<span class="stringliteral">&quot;(&quot;</span>);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    d-&gt;<a class="code" href="classODesc.html#aa2e466eec7958271b4563ab70f187128">Add</a>(<a class="code" href="classanalyzer_1_1Analyzer.html#a5aee2807c8bbdc99f863e27523cf785f">Conn</a>()-&gt;LastTime());</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    d-&gt;<a class="code" href="classODesc.html#a8abcfc7f0b9394ac39dc3c93cfed8c0d">AddSP</a>(<span class="stringliteral">&quot;)&quot;</span>);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    d-&gt;<a class="code" href="classODesc.html#aa2e466eec7958271b4563ab70f187128">Add</a>(<a class="code" href="classanalyzer_1_1Analyzer.html#a5aee2807c8bbdc99f863e27523cf785f">Conn</a>()-&gt;OrigAddr());</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    d-&gt;<a class="code" href="classODesc.html#aa2e466eec7958271b4563ab70f187128">Add</a>(<span class="stringliteral">&quot;.&quot;</span>);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    d-&gt;<a class="code" href="classODesc.html#aa2e466eec7958271b4563ab70f187128">Add</a>(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a5ac8365c0e88becbfb53dd116a43c489">type</a>);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    d-&gt;<a class="code" href="classODesc.html#aa2e466eec7958271b4563ab70f187128">Add</a>(<span class="stringliteral">&quot;.&quot;</span>);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    d-&gt;<a class="code" href="classODesc.html#aa2e466eec7958271b4563ab70f187128">Add</a>(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a4da708767b3b9d52f245c98404c5db05">code</a>);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    d-&gt;<a class="code" href="classODesc.html#aa8362af4b2fdf8053aaaf8009a6178c8">SP</a>();</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    d-&gt;<a class="code" href="classODesc.html#a8abcfc7f0b9394ac39dc3c93cfed8c0d">AddSP</a>(<span class="stringliteral">&quot;-&gt;&quot;</span>);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    d-&gt;<a class="code" href="classODesc.html#aa2e466eec7958271b4563ab70f187128">Add</a>(<a class="code" href="classanalyzer_1_1Analyzer.html#a5aee2807c8bbdc99f863e27523cf785f">Conn</a>()-&gt;RespAddr());</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div><div class="ttc" id="classODesc_html_aa8362af4b2fdf8053aaaf8009a6178c8"><div class="ttname"><a href="classODesc.html#aa8362af4b2fdf8053aaaf8009a6178c8">ODesc::SP</a></div><div class="ttdeci">void SP()</div><div class="ttdef"><b>Definition:</b> <a href="Desc_8h_source.html#l00111">Desc.h:111</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a5ac8365c0e88becbfb53dd116a43c489"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a5ac8365c0e88becbfb53dd116a43c489">analyzer::icmp::ICMP_Analyzer::type</a></div><div class="ttdeci">int type</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00078">ICMP.h:78</a></div></div>
<div class="ttc" id="classODesc_html_a8abcfc7f0b9394ac39dc3c93cfed8c0d"><div class="ttname"><a href="classODesc.html#a8abcfc7f0b9394ac39dc3c93cfed8c0d">ODesc::AddSP</a></div><div class="ttdeci">void AddSP(const char *s1, const char *s2)</div><div class="ttdef"><b>Definition:</b> <a href="Desc_8h_source.html#l00096">Desc.h:96</a></div></div>
<div class="ttc" id="classODesc_html_aa2e466eec7958271b4563ab70f187128"><div class="ttname"><a href="classODesc.html#aa2e466eec7958271b4563ab70f187128">ODesc::Add</a></div><div class="ttdeci">void Add(const char *s, int do_indent=1)</div><div class="ttdef"><b>Definition:</b> <a href="Desc_8cc_source.html#l00080">Desc.cc:80</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a5aee2807c8bbdc99f863e27523cf785f"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a5aee2807c8bbdc99f863e27523cf785f">analyzer::Analyzer::Conn</a></div><div class="ttdeci">Connection * Conn() const </div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8h_source.html#l00273">Analyzer.h:273</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a4da708767b3b9d52f245c98404c5db05"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a4da708767b3b9d52f245c98404c5db05">analyzer::icmp::ICMP_Analyzer::code</a></div><div class="ttdeci">int code</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00079">ICMP.h:79</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab26c697a86f0a5c9f14aa9c65b6a963e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ICMP_Analyzer::Done </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Overridden from parent class. </p>

<p>Reimplemented from <a class="el" href="classanalyzer_1_1TransportLayerAnalyzer.html#a13092caf9b4c9e7966ab1c544497812e">analyzer::TransportLayerAnalyzer</a>.</p>

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00026">26</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    {</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="classanalyzer_1_1TransportLayerAnalyzer.html#a13092caf9b4c9e7966ab1c544497812e">TransportLayerAnalyzer::Done</a>();</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a>(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae6fca59ca5559b54efcee453a82643a8">icmp_conn_val</a>);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a7c7726dc04dac4b593970635477c1ac9">matcher_state</a>.<a class="code" href="classRuleMatcherState.html#add1837f1c25e87519268bce4bfb90462">FinishEndpointMatcher</a>();</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    }</div><div class="ttc" id="classRuleMatcherState_html_add1837f1c25e87519268bce4bfb90462"><div class="ttname"><a href="classRuleMatcherState.html#add1837f1c25e87519268bce4bfb90462">RuleMatcherState::FinishEndpointMatcher</a></div><div class="ttdeci">void FinishEndpointMatcher()</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8cc_source.html#l01437">RuleMatcher.cc:1437</a></div></div>
<div class="ttc" id="classanalyzer_1_1TransportLayerAnalyzer_html_a13092caf9b4c9e7966ab1c544497812e"><div class="ttname"><a href="classanalyzer_1_1TransportLayerAnalyzer.html#a13092caf9b4c9e7966ab1c544497812e">analyzer::TransportLayerAnalyzer::Done</a></div><div class="ttdeci">void Done() override</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00865">Analyzer.cc:865</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_ae6fca59ca5559b54efcee453a82643a8"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae6fca59ca5559b54efcee453a82643a8">analyzer::icmp::ICMP_Analyzer::icmp_conn_val</a></div><div class="ttdeci">RecordVal * icmp_conn_val</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00077">ICMP.h:77</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a7c7726dc04dac4b593970635477c1ac9"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a7c7726dc04dac4b593970635477c1ac9">analyzer::icmp::ICMP_Analyzer::matcher_state</a></div><div class="ttdeci">RuleMatcherState matcher_state</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00082">ICMP.h:82</a></div></div>
<div class="ttc" id="Obj_8h_html_a3bc2efaea5f7739dc79d7f733f6ee6fe"><div class="ttname"><a href="Obj_8h.html#a3bc2efaea5f7739dc79d7f733f6ee6fe">Unref</a></div><div class="ttdeci">void Unref(BroObj *o)</div><div class="ttdef"><b>Definition:</b> <a href="Obj_8h_source.html#l00216">Obj.h:216</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa8f1f204e015fd4e6a68dbe67a49d865"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ICMP_Analyzer::Echo </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct icmp *&#160;</td>
          <td class="paramname"><em>icmpp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>caplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>ip_hdr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00493">493</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="comment">// For handling all Echo related ICMP messages</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <a class="code" href="classEventHandlerPtr.html">EventHandlerPtr</a> f = 0;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">if</span> ( ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a7ec0fdb8132b43b74a16bfef5c7b851e">NextProto</a>() == IPPROTO_ICMPV6 )</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        f = (icmpp-&gt;icmp_type == ICMP6_ECHO_REQUEST)</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            ? icmp_echo_request : icmp_echo_reply;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        f = (icmpp-&gt;icmp_type == ICMP_ECHO)</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            ? icmp_echo_request : icmp_echo_reply;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">if</span> ( ! f )</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordtype">int</span> iid = ntohs(icmpp-&gt;icmp_hun.ih_idseq.icd_id);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordtype">int</span> iseq = ntohs(icmpp-&gt;icmp_hun.ih_idseq.icd_seq);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <a class="code" href="classBroString.html">BroString</a>* payload = <span class="keyword">new</span> <a class="code" href="classBroString.html">BroString</a>(data, caplen, 0);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    val_list* vl = <span class="keyword">new</span> val_list;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    vl-&gt;append(<a class="code" href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">BuildConnVal</a>());</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    vl-&gt;append(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb5ebe883d1b0dec4dc5396d31f144c1">BuildICMPVal</a>(icmpp, len, ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a7ec0fdb8132b43b74a16bfef5c7b851e">NextProto</a>() != IPPROTO_ICMP, ip_hdr));</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(iid, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(iseq, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classStringVal.html">StringVal</a>(payload));</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <a class="code" href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">ConnectionEvent</a>(f, vl);</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1Analyzer_html_a33fbd3099c09106bff5e5900091ec69e"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">analyzer::Analyzer::ConnectionEvent</a></div><div class="ttdeci">void ConnectionEvent(EventHandlerPtr f, val_list *vl)</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00780">Analyzer.cc:780</a></div></div>
<div class="ttc" id="classVal_html"><div class="ttname"><a href="classVal.html">Val</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00078">Val.h:78</a></div></div>
<div class="ttc" id="classStringVal_html"><div class="ttname"><a href="classStringVal.html">StringVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00623">Val.h:623</a></div></div>
<div class="ttc" id="classBroString_html"><div class="ttname"><a href="classBroString.html">BroString</a></div><div class="ttdef"><b>Definition:</b> <a href="BroString_8h_source.html#l00022">BroString.h:22</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_afb5ebe883d1b0dec4dc5396d31f144c1"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb5ebe883d1b0dec4dc5396d31f144c1">analyzer::icmp::ICMP_Analyzer::BuildICMPVal</a></div><div class="ttdeci">RecordVal * BuildICMPVal(const struct icmp *icmpp, int len, int icmpv6, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00219">ICMP.cc:219</a></div></div>
<div class="ttc" id="classEventHandlerPtr_html"><div class="ttname"><a href="classEventHandlerPtr.html">EventHandlerPtr</a></div><div class="ttdef"><b>Definition:</b> <a href="EventHandler_8h_source.html#l00086">EventHandler.h:86</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a7ec0fdb8132b43b74a16bfef5c7b851e"><div class="ttname"><a href="classIP__Hdr.html#a7ec0fdb8132b43b74a16bfef5c7b851e">IP_Hdr::NextProto</a></div><div class="ttdeci">unsigned char NextProto() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00502">IP.h:502</a></div></div>
<div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00022">Type.h:22</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a4c95b7a2821ab00dbf331534d4accc89"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">analyzer::Analyzer::BuildConnVal</a></div><div class="ttdeci">RecordVal * BuildConnVal()</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00765">Analyzer.cc:765</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1e9444187e36ecb8abbc93f6c0d5c864"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRecordVal.html">RecordVal</a> * ICMP_Analyzer::ExtractICMP4Context </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&amp;&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00305">305</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    {</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keyword">const</span> <a class="code" href="classIP__Hdr.html">IP_Hdr</a> ip_hdr_data((<span class="keyword">const</span> <span class="keyword">struct</span> ip*) data, <span class="keyword">false</span>);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keyword">const</span> <a class="code" href="classIP__Hdr.html">IP_Hdr</a>* ip_hdr = &amp;ip_hdr_data;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> ip_hdr_len = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a86ccf5d09d6e00dc0229b065ffda3ed6">HdrLen</a>();</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> ip_len, frag_offset;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7b">TransportProto</a> proto = <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba469684f53d3c998404f68f8ec9949a31">TRANSPORT_UNKNOWN</a>;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordtype">int</span> DF, MF, bad_hdr_len, bad_checksum;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="classIPAddr.html">IPAddr</a> src_addr, dst_addr;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> src_port, dst_port;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">if</span> ( len &lt; (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keyword">struct</span> ip) || ip_hdr_len &gt; <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>(len) )</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="comment">// We don&#39;t have an entire IP header.</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        bad_hdr_len = 1;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        ip_len = frag_offset = 0;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        DF = MF = bad_checksum = 0;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        src_port = dst_port = 0;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        {</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        bad_hdr_len = 0;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        ip_len = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a564d7f86b1bb3b27e7f432c52d67d6db">TotalLen</a>();</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        bad_checksum = (<a class="code" href="net__util_8cc.html#a1fa292138b3efe46f399c93a156b198b">ones_complement_checksum</a>((<span class="keywordtype">void</span>*) ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#afb58edf347f5ace9703948f5d5cb3c28">IP4_Hdr</a>(), ip_hdr_len, 0) != 0xffff);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        src_addr = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a8256bb033063a8e8034beb36bc3bff5c">SrcAddr</a>();</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        dst_addr = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a5c09f4d749016bc3cf3dbee8a048bcfc">DstAddr</a>();</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        DF = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#ad6414f085f7f1d3f703a75acfd9a546b">DF</a>();</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        MF = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#ac357492112c1910e76d6c1b9551d3548">MF</a>();</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        frag_offset = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a643c8d91bcd09a904501d9959748a3e9">FragOffset</a>();</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>(len) &gt;= ip_hdr_len + 4 )</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            proto = <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a743b644306afca88916112b2e6580642">GetContextProtocol</a>(ip_hdr, &amp;src_port, &amp;dst_port);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <span class="comment">// 4 above is the magic number meaning that both</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <span class="comment">// port numbers are included in the ICMP.</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            src_port = dst_port = 0;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            bad_hdr_len = 1;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <a class="code" href="classRecordVal.html">RecordVal</a>* iprec = <span class="keyword">new</span> <a class="code" href="classRecordVal.html">RecordVal</a>(<a class="code" href="NetVar_8cc.html#afd5f044c8535ca393ef1e0e5da705071">icmp_context</a>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <a class="code" href="classRecordVal.html">RecordVal</a>* id_val = <span class="keyword">new</span> <a class="code" href="classRecordVal.html">RecordVal</a>(<a class="code" href="NetVar_8cc.html#a8d644d6bce5d2a287bbc022dde89ec98">conn_id</a>);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    id_val-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(0, <span class="keyword">new</span> <a class="code" href="classAddrVal.html">AddrVal</a>(src_addr));</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    id_val-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(1, <a class="code" href="main_8cc.html#a7c7192e73dece5eb9743d7ae7ad44fcf">port_mgr</a>-&gt;<a class="code" href="classPortManager.html#abb2876df1fd169c105c2ecf5f0f7fce7">Get</a>(src_port, proto));</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    id_val-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(2, <span class="keyword">new</span> <a class="code" href="classAddrVal.html">AddrVal</a>(dst_addr));</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    id_val-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(3, <a class="code" href="main_8cc.html#a7c7192e73dece5eb9743d7ae7ad44fcf">port_mgr</a>-&gt;<a class="code" href="classPortManager.html#abb2876df1fd169c105c2ecf5f0f7fce7">Get</a>(dst_port, proto));</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    iprec-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(0, id_val);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    iprec-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(1, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(ip_len, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    iprec-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(2, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(proto, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    iprec-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(3, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(frag_offset, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    iprec-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(4, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(bad_hdr_len, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>));</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    iprec-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(5, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(bad_checksum, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>));</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    iprec-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(6, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(MF, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>));</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    iprec-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(7, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(DF, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>));</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">return</span> iprec;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    }</div><div class="ttc" id="classIP__Hdr_html_a8256bb033063a8e8034beb36bc3bff5c"><div class="ttname"><a href="classIP__Hdr.html#a8256bb033063a8e8034beb36bc3bff5c">IP_Hdr::SrcAddr</a></div><div class="ttdeci">IPAddr SrcAddr() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00418">IP.h:418</a></div></div>
<div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00020">Type.h:20</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7b"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7b">TransportProto</a></div><div class="ttdeci">TransportProto</div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00009">net_util.h:9</a></div></div>
<div class="ttc" id="classVal_html"><div class="ttname"><a href="classVal.html">Val</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00078">Val.h:78</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a564d7f86b1bb3b27e7f432c52d67d6db"><div class="ttname"><a href="classIP__Hdr.html#a564d7f86b1bb3b27e7f432c52d67d6db">IP_Hdr::TotalLen</a></div><div class="ttdeci">uint32 TotalLen() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00473">IP.h:473</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a643c8d91bcd09a904501d9959748a3e9"><div class="ttname"><a href="classIP__Hdr.html#a643c8d91bcd09a904501d9959748a3e9">IP_Hdr::FragOffset</a></div><div class="ttdeci">uint16 FragOffset() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00531">IP.h:531</a></div></div>
<div class="ttc" id="NetVar_8cc_html_a8d644d6bce5d2a287bbc022dde89ec98"><div class="ttname"><a href="NetVar_8cc.html#a8d644d6bce5d2a287bbc022dde89ec98">conn_id</a></div><div class="ttdeci">RecordType * conn_id</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00008">NetVar.cc:8</a></div></div>
<div class="ttc" id="NetVar_8cc_html_afd5f044c8535ca393ef1e0e5da705071"><div class="ttname"><a href="NetVar_8cc.html#afd5f044c8535ca393ef1e0e5da705071">icmp_context</a></div><div class="ttdeci">RecordType * icmp_context</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00015">NetVar.cc:15</a></div></div>
<div class="ttc" id="classIPAddr_html"><div class="ttname"><a href="classIPAddr.html">IPAddr</a></div><div class="ttdef"><b>Definition:</b> <a href="IPAddr_8h_source.html#l00024">IPAddr.h:24</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a5c09f4d749016bc3cf3dbee8a048bcfc"><div class="ttname"><a href="classIP__Hdr.html#a5c09f4d749016bc3cf3dbee8a048bcfc">IP_Hdr::DstAddr</a></div><div class="ttdeci">IPAddr DstAddr() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00427">IP.h:427</a></div></div>
<div class="ttc" id="classIP__Hdr_html"><div class="ttname"><a href="classIP__Hdr.html">IP_Hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00339">IP.h:339</a></div></div>
<div class="ttc" id="classIP__Hdr_html_ac357492112c1910e76d6c1b9551d3548"><div class="ttname"><a href="classIP__Hdr.html#ac357492112c1910e76d6c1b9551d3548">IP_Hdr::MF</a></div><div class="ttdeci">int MF() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00544">IP.h:544</a></div></div>
<div class="ttc" id="classRecordVal_html"><div class="ttname"><a href="classRecordVal.html">RecordVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00937">Val.h:937</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7ba469684f53d3c998404f68f8ec9949a31"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba469684f53d3c998404f68f8ec9949a31">TRANSPORT_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00022">Type.h:22</a></div></div>
<div class="ttc" id="net__util_8cc_html_a1fa292138b3efe46f399c93a156b198b"><div class="ttname"><a href="net__util_8cc.html#a1fa292138b3efe46f399c93a156b198b">ones_complement_checksum</a></div><div class="ttdeci">int ones_complement_checksum(const void *p, int b, uint32 sum)</div><div class="ttdef"><b>Definition:</b> <a href="net__util_8cc_source.html#l00019">net_util.cc:19</a></div></div>
<div class="ttc" id="classRecordVal_html_a5c6a817fc30e555ddb9708a83ffbdfaf"><div class="ttname"><a href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">RecordVal::Assign</a></div><div class="ttdeci">void Assign(int field, Val *new_val, Opcode op=OP_ASSIGN)</div><div class="ttdef"><b>Definition:</b> <a href="Val_8cc_source.html#l02873">Val.cc:2873</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a86ccf5d09d6e00dc0229b065ffda3ed6"><div class="ttname"><a href="classIP__Hdr.html#a86ccf5d09d6e00dc0229b065ffda3ed6">IP_Hdr::HdrLen</a></div><div class="ttdeci">uint16 HdrLen() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00479">IP.h:479</a></div></div>
<div class="ttc" id="classIP__Hdr_html_afb58edf347f5ace9703948f5d5cb3c28"><div class="ttname"><a href="classIP__Hdr.html#afb58edf347f5ace9703948f5d5cb3c28">IP_Hdr::IP4_Hdr</a></div><div class="ttdeci">const struct ip * IP4_Hdr() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00394">IP.h:394</a></div></div>
<div class="ttc" id="main_8cc_html_a7c7192e73dece5eb9743d7ae7ad44fcf"><div class="ttname"><a href="main_8cc.html#a7c7192e73dece5eb9743d7ae7ad44fcf">port_mgr</a></div><div class="ttdeci">PortManager * port_mgr</div><div class="ttdef"><b>Definition:</b> <a href="main_8cc_source.html#l00086">main.cc:86</a></div></div>
<div class="ttc" id="classAddrVal_html"><div class="ttname"><a href="classAddrVal.html">AddrVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00570">Val.h:570</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a743b644306afca88916112b2e6580642"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a743b644306afca88916112b2e6580642">analyzer::icmp::ICMP_Analyzer::GetContextProtocol</a></div><div class="ttdeci">TransportProto GetContextProtocol(const IP_Hdr *ip_hdr, uint32 *src_port, uint32 *dst_port)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00240">ICMP.cc:240</a></div></div>
<div class="ttc" id="util_8h_html_acbd4acd0d29e2d6c43104827f77d9cd2"><div class="ttname"><a href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00064">util.h:64</a></div></div>
<div class="ttc" id="classPortManager_html_abb2876df1fd169c105c2ecf5f0f7fce7"><div class="ttname"><a href="classPortManager.html#abb2876df1fd169c105c2ecf5f0f7fce7">PortManager::Get</a></div><div class="ttdeci">PortVal * Get(uint32 port_num, TransportProto port_type) const </div><div class="ttdef"><b>Definition:</b> <a href="Val_8cc_source.html#l00799">Val.cc:799</a></div></div>
<div class="ttc" id="classIP__Hdr_html_ad6414f085f7f1d3f703a75acfd9a546b"><div class="ttname"><a href="classIP__Hdr.html#ad6414f085f7f1d3f703a75acfd9a546b">IP_Hdr::DF</a></div><div class="ttdeci">int DF() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00551">IP.h:551</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a66e0e5a307221650b2b9a1f2de65caaf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRecordVal.html">RecordVal</a> * ICMP_Analyzer::ExtractICMP6Context </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&amp;&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00371">371</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordtype">int</span> DF = 0, MF = 0, bad_hdr_len = 0;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7b">TransportProto</a> proto = <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba469684f53d3c998404f68f8ec9949a31">TRANSPORT_UNKNOWN</a>;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <a class="code" href="classIPAddr.html">IPAddr</a> src_addr;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <a class="code" href="classIPAddr.html">IPAddr</a> dst_addr;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> ip_len, frag_offset = 0;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> src_port, dst_port;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">if</span> ( len &lt; (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structip6__hdr.html">ip6_hdr</a>) )</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        {</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        bad_hdr_len = 1;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        ip_len = 0;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        src_port = dst_port = 0;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        }</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keyword">const</span> <a class="code" href="classIP__Hdr.html">IP_Hdr</a> ip_hdr_data((<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structip6__hdr.html">ip6_hdr</a>*) data, <span class="keyword">false</span>, len);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keyword">const</span> <a class="code" href="classIP__Hdr.html">IP_Hdr</a>* ip_hdr = &amp;ip_hdr_data;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        ip_len = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a564d7f86b1bb3b27e7f432c52d67d6db">TotalLen</a>();</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        src_addr = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a8256bb033063a8e8034beb36bc3bff5c">SrcAddr</a>();</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        dst_addr = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a5c09f4d749016bc3cf3dbee8a048bcfc">DstAddr</a>();</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        frag_offset = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a643c8d91bcd09a904501d9959748a3e9">FragOffset</a>();</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        MF = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#ac357492112c1910e76d6c1b9551d3548">MF</a>();</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        DF = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#ad6414f085f7f1d3f703a75acfd9a546b">DF</a>();</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>(len) &gt;= <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>(ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a86ccf5d09d6e00dc0229b065ffda3ed6">HdrLen</a>() + 4) )</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            proto = <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a743b644306afca88916112b2e6580642">GetContextProtocol</a>(ip_hdr, &amp;src_port, &amp;dst_port);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            {</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="comment">// 4 above is the magic number meaning that both</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="comment">// port numbers are included in the ICMP.</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            src_port = dst_port = 0;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            bad_hdr_len = 1;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            }</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="classRecordVal.html">RecordVal</a>* iprec = <span class="keyword">new</span> <a class="code" href="classRecordVal.html">RecordVal</a>(<a class="code" href="NetVar_8cc.html#afd5f044c8535ca393ef1e0e5da705071">icmp_context</a>);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="classRecordVal.html">RecordVal</a>* id_val = <span class="keyword">new</span> <a class="code" href="classRecordVal.html">RecordVal</a>(<a class="code" href="NetVar_8cc.html#a8d644d6bce5d2a287bbc022dde89ec98">conn_id</a>);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    id_val-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(0, <span class="keyword">new</span> <a class="code" href="classAddrVal.html">AddrVal</a>(src_addr));</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    id_val-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(1, <a class="code" href="main_8cc.html#a7c7192e73dece5eb9743d7ae7ad44fcf">port_mgr</a>-&gt;<a class="code" href="classPortManager.html#abb2876df1fd169c105c2ecf5f0f7fce7">Get</a>(src_port, proto));</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    id_val-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(2, <span class="keyword">new</span> <a class="code" href="classAddrVal.html">AddrVal</a>(dst_addr));</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    id_val-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(3, <a class="code" href="main_8cc.html#a7c7192e73dece5eb9743d7ae7ad44fcf">port_mgr</a>-&gt;<a class="code" href="classPortManager.html#abb2876df1fd169c105c2ecf5f0f7fce7">Get</a>(dst_port, proto));</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    iprec-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(0, id_val);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    iprec-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(1, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(ip_len, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    iprec-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(2, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(proto, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    iprec-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(3, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(frag_offset, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    iprec-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(4, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(bad_hdr_len, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>));</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">// bad_checksum is always false since IPv6 layer doesn&#39;t have a checksum.</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    iprec-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(5, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(0, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>));</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    iprec-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(6, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(MF, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>));</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    iprec-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(7, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(DF, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>));</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">return</span> iprec;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    }</div><div class="ttc" id="classIP__Hdr_html_a8256bb033063a8e8034beb36bc3bff5c"><div class="ttname"><a href="classIP__Hdr.html#a8256bb033063a8e8034beb36bc3bff5c">IP_Hdr::SrcAddr</a></div><div class="ttdeci">IPAddr SrcAddr() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00418">IP.h:418</a></div></div>
<div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00020">Type.h:20</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7b"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7b">TransportProto</a></div><div class="ttdeci">TransportProto</div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00009">net_util.h:9</a></div></div>
<div class="ttc" id="classVal_html"><div class="ttname"><a href="classVal.html">Val</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00078">Val.h:78</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a564d7f86b1bb3b27e7f432c52d67d6db"><div class="ttname"><a href="classIP__Hdr.html#a564d7f86b1bb3b27e7f432c52d67d6db">IP_Hdr::TotalLen</a></div><div class="ttdeci">uint32 TotalLen() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00473">IP.h:473</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a643c8d91bcd09a904501d9959748a3e9"><div class="ttname"><a href="classIP__Hdr.html#a643c8d91bcd09a904501d9959748a3e9">IP_Hdr::FragOffset</a></div><div class="ttdeci">uint16 FragOffset() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00531">IP.h:531</a></div></div>
<div class="ttc" id="NetVar_8cc_html_a8d644d6bce5d2a287bbc022dde89ec98"><div class="ttname"><a href="NetVar_8cc.html#a8d644d6bce5d2a287bbc022dde89ec98">conn_id</a></div><div class="ttdeci">RecordType * conn_id</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00008">NetVar.cc:8</a></div></div>
<div class="ttc" id="NetVar_8cc_html_afd5f044c8535ca393ef1e0e5da705071"><div class="ttname"><a href="NetVar_8cc.html#afd5f044c8535ca393ef1e0e5da705071">icmp_context</a></div><div class="ttdeci">RecordType * icmp_context</div><div class="ttdef"><b>Definition:</b> <a href="NetVar_8cc_source.html#l00015">NetVar.cc:15</a></div></div>
<div class="ttc" id="classIPAddr_html"><div class="ttname"><a href="classIPAddr.html">IPAddr</a></div><div class="ttdef"><b>Definition:</b> <a href="IPAddr_8h_source.html#l00024">IPAddr.h:24</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a5c09f4d749016bc3cf3dbee8a048bcfc"><div class="ttname"><a href="classIP__Hdr.html#a5c09f4d749016bc3cf3dbee8a048bcfc">IP_Hdr::DstAddr</a></div><div class="ttdeci">IPAddr DstAddr() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00427">IP.h:427</a></div></div>
<div class="ttc" id="classIP__Hdr_html"><div class="ttname"><a href="classIP__Hdr.html">IP_Hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00339">IP.h:339</a></div></div>
<div class="ttc" id="classIP__Hdr_html_ac357492112c1910e76d6c1b9551d3548"><div class="ttname"><a href="classIP__Hdr.html#ac357492112c1910e76d6c1b9551d3548">IP_Hdr::MF</a></div><div class="ttdeci">int MF() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00544">IP.h:544</a></div></div>
<div class="ttc" id="classRecordVal_html"><div class="ttname"><a href="classRecordVal.html">RecordVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00937">Val.h:937</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7ba469684f53d3c998404f68f8ec9949a31"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba469684f53d3c998404f68f8ec9949a31">TRANSPORT_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00022">Type.h:22</a></div></div>
<div class="ttc" id="classRecordVal_html_a5c6a817fc30e555ddb9708a83ffbdfaf"><div class="ttname"><a href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">RecordVal::Assign</a></div><div class="ttdeci">void Assign(int field, Val *new_val, Opcode op=OP_ASSIGN)</div><div class="ttdef"><b>Definition:</b> <a href="Val_8cc_source.html#l02873">Val.cc:2873</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a86ccf5d09d6e00dc0229b065ffda3ed6"><div class="ttname"><a href="classIP__Hdr.html#a86ccf5d09d6e00dc0229b065ffda3ed6">IP_Hdr::HdrLen</a></div><div class="ttdeci">uint16 HdrLen() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00479">IP.h:479</a></div></div>
<div class="ttc" id="main_8cc_html_a7c7192e73dece5eb9743d7ae7ad44fcf"><div class="ttname"><a href="main_8cc.html#a7c7192e73dece5eb9743d7ae7ad44fcf">port_mgr</a></div><div class="ttdeci">PortManager * port_mgr</div><div class="ttdef"><b>Definition:</b> <a href="main_8cc_source.html#l00086">main.cc:86</a></div></div>
<div class="ttc" id="classAddrVal_html"><div class="ttname"><a href="classAddrVal.html">AddrVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00570">Val.h:570</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a743b644306afca88916112b2e6580642"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a743b644306afca88916112b2e6580642">analyzer::icmp::ICMP_Analyzer::GetContextProtocol</a></div><div class="ttdeci">TransportProto GetContextProtocol(const IP_Hdr *ip_hdr, uint32 *src_port, uint32 *dst_port)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00240">ICMP.cc:240</a></div></div>
<div class="ttc" id="util_8h_html_acbd4acd0d29e2d6c43104827f77d9cd2"><div class="ttname"><a href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00064">util.h:64</a></div></div>
<div class="ttc" id="classPortManager_html_abb2876df1fd169c105c2ecf5f0f7fce7"><div class="ttname"><a href="classPortManager.html#abb2876df1fd169c105c2ecf5f0f7fce7">PortManager::Get</a></div><div class="ttdeci">PortVal * Get(uint32 port_num, TransportProto port_type) const </div><div class="ttdef"><b>Definition:</b> <a href="Val_8cc_source.html#l00799">Val.cc:799</a></div></div>
<div class="ttc" id="classIP__Hdr_html_ad6414f085f7f1d3f703a75acfd9a546b"><div class="ttname"><a href="classIP__Hdr.html#ad6414f085f7f1d3f703a75acfd9a546b">IP_Hdr::DF</a></div><div class="ttdeci">int DF() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00551">IP.h:551</a></div></div>
<div class="ttc" id="structip6__hdr_html"><div class="ttname"><a href="structip6__hdr.html">ip6_hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00051">net_util.h:51</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a743b644306afca88916112b2e6580642"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7b">TransportProto</a> ICMP_Analyzer::GetContextProtocol </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>ip_hdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> *&#160;</td>
          <td class="paramname"><em>src_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> *&#160;</td>
          <td class="paramname"><em>dst_port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00240">240</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keyword">const</span> u_char* transport_hdr;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> ip_hdr_len = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a86ccf5d09d6e00dc0229b065ffda3ed6">HdrLen</a>();</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">bool</span> ip4 = ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#afb58edf347f5ace9703948f5d5cb3c28">IP4_Hdr</a>();</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">if</span> ( ip4 )</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        transport_hdr = ((u_char *) ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#afb58edf347f5ace9703948f5d5cb3c28">IP4_Hdr</a>() + ip_hdr_len);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        transport_hdr = ((u_char *) ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a6f98ec8e4202eeb186928f7fd00e2d43">IP6_Hdr</a>() + ip_hdr_len);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7b">TransportProto</a> proto;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">switch</span> ( ip_hdr-&gt;<a class="code" href="classIP__Hdr.html#a7ec0fdb8132b43b74a16bfef5c7b851e">NextProto</a>() ) {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">case</span> 1:     proto = <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba01288141eb45cb369f93202bfbb2635d">TRANSPORT_ICMP</a>; <span class="keywordflow">break</span>;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">case</span> 6:     proto = <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b">TRANSPORT_TCP</a>; <span class="keywordflow">break</span>;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">case</span> 17:    proto = <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c">TRANSPORT_UDP</a>; <span class="keywordflow">break</span>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">case</span> 58:    proto = <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba01288141eb45cb369f93202bfbb2635d">TRANSPORT_ICMP</a>; <span class="keywordflow">break</span>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">default</span>:    proto = <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba469684f53d3c998404f68f8ec9949a31">TRANSPORT_UNKNOWN</a>; <span class="keywordflow">break</span>;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">switch</span> ( proto ) {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba01288141eb45cb369f93202bfbb2635d">TRANSPORT_ICMP</a>:</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span>icmp* icmpp =</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            (<span class="keyword">const</span> <span class="keyword">struct </span>icmp *) transport_hdr;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordtype">bool</span> is_one_way;    <span class="comment">// dummy</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        *src_port = ntohs(icmpp-&gt;icmp_type);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">if</span> ( ip4 )</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            *dst_port = ntohs(<a class="code" href="namespaceanalyzer_1_1icmp.html#af3fc0c0e38a9e6478131b96dcef47efa">ICMP4_counterpart</a>(icmpp-&gt;icmp_type,</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                    icmpp-&gt;icmp_code, is_one_way));</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            *dst_port = ntohs(<a class="code" href="namespaceanalyzer_1_1icmp.html#acdbd9cf674f0f6f4ebea24b04de2ed6e">ICMP6_counterpart</a>(icmpp-&gt;icmp_type,</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                    icmpp-&gt;icmp_code, is_one_way));</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b">TRANSPORT_TCP</a>:</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span>tcphdr* tp =</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            (<span class="keyword">const</span> <span class="keyword">struct </span>tcphdr *) transport_hdr;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        *src_port = ntohs(tp-&gt;th_sport);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        *dst_port = ntohs(tp-&gt;th_dport);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        }</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c">TRANSPORT_UDP</a>:</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span>udphdr* up =</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            (<span class="keyword">const</span> <span class="keyword">struct </span>udphdr *) transport_hdr;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        *src_port = ntohs(up-&gt;uh_sport);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        *dst_port = ntohs(up-&gt;uh_dport);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        *src_port = *dst_port = ntohs(0);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">return</span> proto;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    }</div><div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7baffd9e3dec668986fb835e5d1f617742b">TRANSPORT_TCP</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7b"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7b">TransportProto</a></div><div class="ttdeci">TransportProto</div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00009">net_util.h:9</a></div></div>
<div class="ttc" id="namespaceanalyzer_1_1icmp_html_af3fc0c0e38a9e6478131b96dcef47efa"><div class="ttname"><a href="namespaceanalyzer_1_1icmp.html#af3fc0c0e38a9e6478131b96dcef47efa">analyzer::icmp::ICMP4_counterpart</a></div><div class="ttdeci">int ICMP4_counterpart(int icmp_type, int icmp_code, bool &amp;is_one_way)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00847">ICMP.cc:847</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba3d147654237c45a6f068a2a167b9119c">TRANSPORT_UDP</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7ba01288141eb45cb369f93202bfbb2635d"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba01288141eb45cb369f93202bfbb2635d">TRANSPORT_ICMP</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="namespaceanalyzer_1_1icmp_html_acdbd9cf674f0f6f4ebea24b04de2ed6e"><div class="ttname"><a href="namespaceanalyzer_1_1icmp.html#acdbd9cf674f0f6f4ebea24b04de2ed6e">analyzer::icmp::ICMP6_counterpart</a></div><div class="ttdeci">int ICMP6_counterpart(int icmp_type, int icmp_code, bool &amp;is_one_way)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00874">ICMP.cc:874</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a7ec0fdb8132b43b74a16bfef5c7b851e"><div class="ttname"><a href="classIP__Hdr.html#a7ec0fdb8132b43b74a16bfef5c7b851e">IP_Hdr::NextProto</a></div><div class="ttdeci">unsigned char NextProto() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00502">IP.h:502</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7ba469684f53d3c998404f68f8ec9949a31"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7ba469684f53d3c998404f68f8ec9949a31">TRANSPORT_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00010">net_util.h:10</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a86ccf5d09d6e00dc0229b065ffda3ed6"><div class="ttname"><a href="classIP__Hdr.html#a86ccf5d09d6e00dc0229b065ffda3ed6">IP_Hdr::HdrLen</a></div><div class="ttdeci">uint16 HdrLen() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00479">IP.h:479</a></div></div>
<div class="ttc" id="classIP__Hdr_html_afb58edf347f5ace9703948f5d5cb3c28"><div class="ttname"><a href="classIP__Hdr.html#afb58edf347f5ace9703948f5d5cb3c28">IP_Hdr::IP4_Hdr</a></div><div class="ttdeci">const struct ip * IP4_Hdr() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00394">IP.h:394</a></div></div>
<div class="ttc" id="util_8h_html_acbd4acd0d29e2d6c43104827f77d9cd2"><div class="ttname"><a href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00064">util.h:64</a></div></div>
<div class="ttc" id="classIP__Hdr_html_a6f98ec8e4202eeb186928f7fd00e2d43"><div class="ttname"><a href="classIP__Hdr.html#a6f98ec8e4202eeb186928f7fd00e2d43">IP_Hdr::IP6_Hdr</a></div><div class="ttdeci">const struct ip6_hdr * IP6_Hdr() const </div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00399">IP.h:399</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afb9920eee6f3086dc08260f840c134a7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ICMP_Analyzer::ICMP_Sent </td>
          <td>(</td>
          <td class="paramtype">const struct icmp *&#160;</td>
          <td class="paramname"><em>icmpp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>caplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>icmpv6</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>ip_hdr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00196">196</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">if</span> ( icmp_sent )</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        val_list* vl = <span class="keyword">new</span> val_list;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        vl-&gt;append(<a class="code" href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">BuildConnVal</a>());</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        vl-&gt;append(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb5ebe883d1b0dec4dc5396d31f144c1">BuildICMPVal</a>(icmpp, len, icmpv6, ip_hdr));</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <a class="code" href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">ConnectionEvent</a>(icmp_sent, vl);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">if</span> ( icmp_sent_payload )</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        {</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        val_list* vl = <span class="keyword">new</span> val_list;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        vl-&gt;append(<a class="code" href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">BuildConnVal</a>());</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        vl-&gt;append(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb5ebe883d1b0dec4dc5396d31f144c1">BuildICMPVal</a>(icmpp, len, icmpv6, ip_hdr));</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <a class="code" href="classBroString.html">BroString</a>* payload = <span class="keyword">new</span> <a class="code" href="classBroString.html">BroString</a>(data, min(len, caplen), 0);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classStringVal.html">StringVal</a>(payload));</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <a class="code" href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">ConnectionEvent</a>(icmp_sent_payload, vl);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1Analyzer_html_a33fbd3099c09106bff5e5900091ec69e"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">analyzer::Analyzer::ConnectionEvent</a></div><div class="ttdeci">void ConnectionEvent(EventHandlerPtr f, val_list *vl)</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00780">Analyzer.cc:780</a></div></div>
<div class="ttc" id="classStringVal_html"><div class="ttname"><a href="classStringVal.html">StringVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00623">Val.h:623</a></div></div>
<div class="ttc" id="classBroString_html"><div class="ttname"><a href="classBroString.html">BroString</a></div><div class="ttdef"><b>Definition:</b> <a href="BroString_8h_source.html#l00022">BroString.h:22</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_afb5ebe883d1b0dec4dc5396d31f144c1"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb5ebe883d1b0dec4dc5396d31f144c1">analyzer::icmp::ICMP_Analyzer::BuildICMPVal</a></div><div class="ttdeci">RecordVal * BuildICMPVal(const struct icmp *icmpp, int len, int icmpv6, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00219">ICMP.cc:219</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a4c95b7a2821ab00dbf331534d4accc89"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">analyzer::Analyzer::BuildConnVal</a></div><div class="ttdeci">RecordVal * BuildConnVal()</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00765">Analyzer.cc:765</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a48a8ae39e6497e4ec4f970faf509221a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classanalyzer_1_1Analyzer.html">analyzer::Analyzer</a>* analyzer::icmp::ICMP_Analyzer::Instantiate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classConnection.html">Connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8h_source.html#l00024">24</a> of file <a class="el" href="ICMP_8h_source.html">ICMP.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        { <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a1a731675510864f64174f96cdb342152">ICMP_Analyzer</a>(conn); }</div><div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a1a731675510864f64174f96cdb342152"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a1a731675510864f64174f96cdb342152">analyzer::icmp::ICMP_Analyzer::ICMP_Analyzer</a></div><div class="ttdeci">ICMP_Analyzer(Connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00019">ICMP.cc:19</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4a87c8de9dd4e2a1c126bab64af9ee0e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ICMP_Analyzer::IsReuse </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&#160;</td>
          <td class="paramname"><em>pkt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns true if the analyzer determines that in fact a new connection has started without the connection statement having terminated the previous one, i.e., the new data is arriving at what's the analyzer for the previous instance. This is used only for TCP. </p>

<p>Implements <a class="el" href="classanalyzer_1_1TransportLayerAnalyzer.html#a9df286efde7cfb55b398ff3387018190">analyzer::TransportLayerAnalyzer</a>.</p>

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00431">431</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    {</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac18206c52be3d1cedeb7b7af55ade5e5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int ICMP_Analyzer::MemoryAllocation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Internal method. </p>

<p>Reimplemented from <a class="el" href="classanalyzer_1_1Analyzer.html#a33e2acf90e12e8545f877d3add6fc1ff">analyzer::Analyzer</a>.</p>

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00485">485</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    {</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classanalyzer_1_1Analyzer.html#a33e2acf90e12e8545f877d3add6fc1ff">Analyzer::MemoryAllocation</a>()</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        + <a class="code" href="util_8h.html#adc0a69a644240180cd1a3d3566182956">padded_sizeof</a>(*<span class="keyword">this</span>) - <a class="code" href="util_8h.html#adc0a69a644240180cd1a3d3566182956">padded_sizeof</a>(<a class="code" href="classConnection.html">Connection</a>)</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        + (<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae6fca59ca5559b54efcee453a82643a8">icmp_conn_val</a> ? <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae6fca59ca5559b54efcee453a82643a8">icmp_conn_val</a>-&gt;<a class="code" href="classRecordVal.html#aeea5010d2ffc541155a4b6463d4579c2">MemoryAllocation</a>() : 0);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_ae6fca59ca5559b54efcee453a82643a8"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ae6fca59ca5559b54efcee453a82643a8">analyzer::icmp::ICMP_Analyzer::icmp_conn_val</a></div><div class="ttdeci">RecordVal * icmp_conn_val</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00077">ICMP.h:77</a></div></div>
<div class="ttc" id="classRecordVal_html_aeea5010d2ffc541155a4b6463d4579c2"><div class="ttname"><a href="classRecordVal.html#aeea5010d2ffc541155a4b6463d4579c2">RecordVal::MemoryAllocation</a></div><div class="ttdeci">unsigned int MemoryAllocation() const override</div><div class="ttdef"><b>Definition:</b> <a href="Val_8cc_source.html#l03190">Val.cc:3190</a></div></div>
<div class="ttc" id="util_8h_html_adc0a69a644240180cd1a3d3566182956"><div class="ttname"><a href="util_8h.html#adc0a69a644240180cd1a3d3566182956">padded_sizeof</a></div><div class="ttdeci">#define padded_sizeof(x)</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00455">util.h:455</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a33e2acf90e12e8545f877d3add6fc1ff"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a33e2acf90e12e8545f877d3add6fc1ff">analyzer::Analyzer::MemoryAllocation</a></div><div class="ttdeci">virtual unsigned int MemoryAllocation() const </div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00742">Analyzer.cc:742</a></div></div>
<div class="ttc" id="classConnection_html"><div class="ttname"><a href="classConnection.html">Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00059">Conn.h:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac6b784c209a08090dadf50df738ab350"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ICMP_Analyzer::NeighborAdvert </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct icmp *&#160;</td>
          <td class="paramname"><em>icmpp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>caplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>ip_hdr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00558">558</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    {</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <a class="code" href="classEventHandlerPtr.html">EventHandlerPtr</a> f = icmp_neighbor_advertisement;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <a class="code" href="classIPAddr.html">IPAddr</a> tgtaddr;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordflow">if</span> ( caplen &gt;= (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(in6_addr) )</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        tgtaddr = <a class="code" href="classIPAddr.html">IPAddr</a>(*((<span class="keyword">const</span> in6_addr*)data));</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    val_list* vl = <span class="keyword">new</span> val_list;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    vl-&gt;append(<a class="code" href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">BuildConnVal</a>());</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    vl-&gt;append(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb5ebe883d1b0dec4dc5396d31f144c1">BuildICMPVal</a>(icmpp, len, 1, ip_hdr));</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(icmpp-&gt;icmp_num_addrs &amp; 0x80, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>)); <span class="comment">// Router</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(icmpp-&gt;icmp_num_addrs &amp; 0x40, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>)); <span class="comment">// Solicited</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(icmpp-&gt;icmp_num_addrs &amp; 0x20, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>)); <span class="comment">// Override</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classAddrVal.html">AddrVal</a>(tgtaddr));</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordtype">int</span> opt_offset = <span class="keyword">sizeof</span>(in6_addr);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    vl-&gt;append(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ab844db89298e6cf64c2d84cf5a0f5bf9">BuildNDOptionsVal</a>(caplen - opt_offset, data + opt_offset));</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <a class="code" href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">ConnectionEvent</a>(f, vl);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    }</div><div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00020">Type.h:20</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a33fbd3099c09106bff5e5900091ec69e"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">analyzer::Analyzer::ConnectionEvent</a></div><div class="ttdeci">void ConnectionEvent(EventHandlerPtr f, val_list *vl)</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00780">Analyzer.cc:780</a></div></div>
<div class="ttc" id="classVal_html"><div class="ttname"><a href="classVal.html">Val</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00078">Val.h:78</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_ab844db89298e6cf64c2d84cf5a0f5bf9"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ab844db89298e6cf64c2d84cf5a0f5bf9">analyzer::icmp::ICMP_Analyzer::BuildNDOptionsVal</a></div><div class="ttdeci">VectorVal * BuildNDOptionsVal(int caplen, const u_char *data)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00709">ICMP.cc:709</a></div></div>
<div class="ttc" id="classIPAddr_html"><div class="ttname"><a href="classIPAddr.html">IPAddr</a></div><div class="ttdef"><b>Definition:</b> <a href="IPAddr_8h_source.html#l00024">IPAddr.h:24</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_afb5ebe883d1b0dec4dc5396d31f144c1"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb5ebe883d1b0dec4dc5396d31f144c1">analyzer::icmp::ICMP_Analyzer::BuildICMPVal</a></div><div class="ttdeci">RecordVal * BuildICMPVal(const struct icmp *icmpp, int len, int icmpv6, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00219">ICMP.cc:219</a></div></div>
<div class="ttc" id="classEventHandlerPtr_html"><div class="ttname"><a href="classEventHandlerPtr.html">EventHandlerPtr</a></div><div class="ttdef"><b>Definition:</b> <a href="EventHandler_8h_source.html#l00086">EventHandler.h:86</a></div></div>
<div class="ttc" id="classAddrVal_html"><div class="ttname"><a href="classAddrVal.html">AddrVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00570">Val.h:570</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a4c95b7a2821ab00dbf331534d4accc89"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">analyzer::Analyzer::BuildConnVal</a></div><div class="ttdeci">RecordVal * BuildConnVal()</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00765">Analyzer.cc:765</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a00b0c746a5d910dea730dbb38960f42f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ICMP_Analyzer::NeighborSolicit </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct icmp *&#160;</td>
          <td class="paramname"><em>icmpp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>caplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>ip_hdr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00582">582</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    {</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <a class="code" href="classEventHandlerPtr.html">EventHandlerPtr</a> f = icmp_neighbor_solicitation;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <a class="code" href="classIPAddr.html">IPAddr</a> tgtaddr;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordflow">if</span> ( caplen &gt;= (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(in6_addr) )</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        tgtaddr = <a class="code" href="classIPAddr.html">IPAddr</a>(*((<span class="keyword">const</span> in6_addr*)data));</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    val_list* vl = <span class="keyword">new</span> val_list;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    vl-&gt;append(<a class="code" href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">BuildConnVal</a>());</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    vl-&gt;append(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb5ebe883d1b0dec4dc5396d31f144c1">BuildICMPVal</a>(icmpp, len, 1, ip_hdr));</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classAddrVal.html">AddrVal</a>(tgtaddr));</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordtype">int</span> opt_offset = <span class="keyword">sizeof</span>(in6_addr);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    vl-&gt;append(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ab844db89298e6cf64c2d84cf5a0f5bf9">BuildNDOptionsVal</a>(caplen - opt_offset, data + opt_offset));</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <a class="code" href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">ConnectionEvent</a>(f, vl);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1Analyzer_html_a33fbd3099c09106bff5e5900091ec69e"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">analyzer::Analyzer::ConnectionEvent</a></div><div class="ttdeci">void ConnectionEvent(EventHandlerPtr f, val_list *vl)</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00780">Analyzer.cc:780</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_ab844db89298e6cf64c2d84cf5a0f5bf9"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ab844db89298e6cf64c2d84cf5a0f5bf9">analyzer::icmp::ICMP_Analyzer::BuildNDOptionsVal</a></div><div class="ttdeci">VectorVal * BuildNDOptionsVal(int caplen, const u_char *data)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00709">ICMP.cc:709</a></div></div>
<div class="ttc" id="classIPAddr_html"><div class="ttname"><a href="classIPAddr.html">IPAddr</a></div><div class="ttdef"><b>Definition:</b> <a href="IPAddr_8h_source.html#l00024">IPAddr.h:24</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_afb5ebe883d1b0dec4dc5396d31f144c1"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb5ebe883d1b0dec4dc5396d31f144c1">analyzer::icmp::ICMP_Analyzer::BuildICMPVal</a></div><div class="ttdeci">RecordVal * BuildICMPVal(const struct icmp *icmpp, int len, int icmpv6, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00219">ICMP.cc:219</a></div></div>
<div class="ttc" id="classEventHandlerPtr_html"><div class="ttname"><a href="classEventHandlerPtr.html">EventHandlerPtr</a></div><div class="ttdef"><b>Definition:</b> <a href="EventHandler_8h_source.html#l00086">EventHandler.h:86</a></div></div>
<div class="ttc" id="classAddrVal_html"><div class="ttname"><a href="classAddrVal.html">AddrVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00570">Val.h:570</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a4c95b7a2821ab00dbf331534d4accc89"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">analyzer::Analyzer::BuildConnVal</a></div><div class="ttdeci">RecordVal * BuildConnVal()</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00765">Analyzer.cc:765</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3907cd5d838bf0794781cb66915c259d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ICMP_Analyzer::NextICMP4 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct icmp *&#160;</td>
          <td class="paramname"><em>icmpp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>caplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>ip_hdr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00117">117</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    {</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">switch</span> ( icmpp-&gt;icmp_type )</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">case</span> ICMP_ECHO:</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">case</span> ICMP_ECHOREPLY:</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#aa8f1f204e015fd4e6a68dbe67a49d865">Echo</a>(t, icmpp, len, caplen, data, ip_hdr);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">case</span> ICMP_UNREACH:</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">case</span> ICMP_TIMXCEED:</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#abbe1d6a5777abf2f068614d71222ac54">Context4</a>(t, icmpp, len, caplen, data, ip_hdr);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb9920eee6f3086dc08260f840c134a7">ICMP_Sent</a>(icmpp, len, caplen, 0, data, ip_hdr);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_abbe1d6a5777abf2f068614d71222ac54"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#abbe1d6a5777abf2f068614d71222ac54">analyzer::icmp::ICMP_Analyzer::Context4</a></div><div class="ttdeci">void Context4(double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00642">ICMP.cc:642</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_afb9920eee6f3086dc08260f840c134a7"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb9920eee6f3086dc08260f840c134a7">analyzer::icmp::ICMP_Analyzer::ICMP_Sent</a></div><div class="ttdeci">void ICMP_Sent(const struct icmp *icmpp, int len, int caplen, int icmpv6, const u_char *data, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00196">ICMP.cc:196</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_aa8f1f204e015fd4e6a68dbe67a49d865"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#aa8f1f204e015fd4e6a68dbe67a49d865">analyzer::icmp::ICMP_Analyzer::Echo</a></div><div class="ttdeci">void Echo(double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00493">ICMP.cc:493</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae030feef6ec752b9c0d4fcf8d3301a74"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ICMP_Analyzer::NextICMP6 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct icmp *&#160;</td>
          <td class="paramname"><em>icmpp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>caplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>ip_hdr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00138">138</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">switch</span> ( icmpp-&gt;icmp_type )</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="comment">// Echo types.</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">case</span> ICMP6_ECHO_REQUEST:</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordflow">case</span> ICMP6_ECHO_REPLY:</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#aa8f1f204e015fd4e6a68dbe67a49d865">Echo</a>(t, icmpp, len, caplen, data, ip_hdr);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="comment">// Error messages all have the same structure for their context,</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="comment">// and are handled by the same function.</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">case</span> ICMP6_PARAM_PROB:</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">case</span> ICMP6_TIME_EXCEEDED:</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">case</span> ICMP6_PACKET_TOO_BIG:</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">case</span> ICMP6_DST_UNREACH:</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a358def43caf5209364f490352f60b6f0">Context6</a>(t, icmpp, len, caplen, data, ip_hdr);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="comment">// Router related messages.</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">case</span> ND_REDIRECT:</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#add5a77503e4ac6fcdddc7bcb7ccd70c9">Redirect</a>(t, icmpp, len, caplen, data, ip_hdr);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">case</span> ND_ROUTER_ADVERT:</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a3b2e830de064c8024e6777fb7a5f4213">RouterAdvert</a>(t, icmpp, len, caplen, data, ip_hdr);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">case</span> ND_NEIGHBOR_ADVERT:</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ac6b784c209a08090dadf50df738ab350">NeighborAdvert</a>(t, icmpp, len, caplen, data, ip_hdr);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">case</span> ND_NEIGHBOR_SOLICIT:</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a00b0c746a5d910dea730dbb38960f42f">NeighborSolicit</a>(t, icmpp, len, caplen, data, ip_hdr);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">case</span> ND_ROUTER_SOLICIT:</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a2c988723d5cd0d475768c5b2522c21d6">RouterSolicit</a>(t, icmpp, len, caplen, data, ip_hdr);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">case</span> ICMP6_ROUTER_RENUMBERING:</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb9920eee6f3086dc08260f840c134a7">ICMP_Sent</a>(icmpp, len, caplen, 1, data, ip_hdr);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="comment">// Currently not specifically implemented.</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">case</span> MLD_LISTENER_QUERY:</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">case</span> MLD_LISTENER_REPORT:</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">case</span> MLD_LISTENER_REDUCTION:</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="comment">// Error messages (i.e., ICMPv6 type &lt; 128) all have</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="comment">// the same structure for their context, and are</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="comment">// handled by the same function.</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="keywordflow">if</span> ( icmpp-&gt;icmp_type &lt; 128 )</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a358def43caf5209364f490352f60b6f0">Context6</a>(t, icmpp, len, caplen, data, ip_hdr);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb9920eee6f3086dc08260f840c134a7">ICMP_Sent</a>(icmpp, len, caplen, 1, data, ip_hdr);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a00b0c746a5d910dea730dbb38960f42f"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a00b0c746a5d910dea730dbb38960f42f">analyzer::icmp::ICMP_Analyzer::NeighborSolicit</a></div><div class="ttdeci">void NeighborSolicit(double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00582">ICMP.cc:582</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_afb9920eee6f3086dc08260f840c134a7"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb9920eee6f3086dc08260f840c134a7">analyzer::icmp::ICMP_Analyzer::ICMP_Sent</a></div><div class="ttdeci">void ICMP_Sent(const struct icmp *icmpp, int len, int caplen, int icmpv6, const u_char *data, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00196">ICMP.cc:196</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_add5a77503e4ac6fcdddc7bcb7ccd70c9"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#add5a77503e4ac6fcdddc7bcb7ccd70c9">analyzer::icmp::ICMP_Analyzer::Redirect</a></div><div class="ttdeci">void Redirect(double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00603">ICMP.cc:603</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_ac6b784c209a08090dadf50df738ab350"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ac6b784c209a08090dadf50df738ab350">analyzer::icmp::ICMP_Analyzer::NeighborAdvert</a></div><div class="ttdeci">void NeighborAdvert(double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00558">ICMP.cc:558</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a358def43caf5209364f490352f60b6f0"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a358def43caf5209364f490352f60b6f0">analyzer::icmp::ICMP_Analyzer::Context6</a></div><div class="ttdeci">void Context6(double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00670">ICMP.cc:670</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a3b2e830de064c8024e6777fb7a5f4213"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a3b2e830de064c8024e6777fb7a5f4213">analyzer::icmp::ICMP_Analyzer::RouterAdvert</a></div><div class="ttdeci">void RouterAdvert(double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00525">ICMP.cc:525</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a2c988723d5cd0d475768c5b2522c21d6"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a2c988723d5cd0d475768c5b2522c21d6">analyzer::icmp::ICMP_Analyzer::RouterSolicit</a></div><div class="ttdeci">void RouterSolicit(double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00628">ICMP.cc:628</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_aa8f1f204e015fd4e6a68dbe67a49d865"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#aa8f1f204e015fd4e6a68dbe67a49d865">analyzer::icmp::ICMP_Analyzer::Echo</a></div><div class="ttdeci">void Echo(double t, const struct icmp *icmpp, int len, int caplen, const u_char *&amp;data, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00493">ICMP.cc:493</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="add5a77503e4ac6fcdddc7bcb7ccd70c9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ICMP_Analyzer::Redirect </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct icmp *&#160;</td>
          <td class="paramname"><em>icmpp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>caplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>ip_hdr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00603">603</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    {</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <a class="code" href="classEventHandlerPtr.html">EventHandlerPtr</a> f = icmp_redirect;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <a class="code" href="classIPAddr.html">IPAddr</a> tgtaddr, dstaddr;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordflow">if</span> ( caplen &gt;= (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(in6_addr) )</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        tgtaddr = <a class="code" href="classIPAddr.html">IPAddr</a>(*((<span class="keyword">const</span> in6_addr*)data));</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordflow">if</span> ( caplen &gt;= 2 * (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(in6_addr) )</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        dstaddr = <a class="code" href="classIPAddr.html">IPAddr</a>(*((<span class="keyword">const</span> in6_addr*)(data + <span class="keyword">sizeof</span>(in6_addr))));</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    val_list* vl = <span class="keyword">new</span> val_list;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    vl-&gt;append(<a class="code" href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">BuildConnVal</a>());</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    vl-&gt;append(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb5ebe883d1b0dec4dc5396d31f144c1">BuildICMPVal</a>(icmpp, len, 1, ip_hdr));</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classAddrVal.html">AddrVal</a>(tgtaddr));</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classAddrVal.html">AddrVal</a>(dstaddr));</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordtype">int</span> opt_offset = 2 * <span class="keyword">sizeof</span>(in6_addr);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    vl-&gt;append(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ab844db89298e6cf64c2d84cf5a0f5bf9">BuildNDOptionsVal</a>(caplen - opt_offset, data + opt_offset));</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <a class="code" href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">ConnectionEvent</a>(f, vl);</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1Analyzer_html_a33fbd3099c09106bff5e5900091ec69e"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">analyzer::Analyzer::ConnectionEvent</a></div><div class="ttdeci">void ConnectionEvent(EventHandlerPtr f, val_list *vl)</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00780">Analyzer.cc:780</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_ab844db89298e6cf64c2d84cf5a0f5bf9"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ab844db89298e6cf64c2d84cf5a0f5bf9">analyzer::icmp::ICMP_Analyzer::BuildNDOptionsVal</a></div><div class="ttdeci">VectorVal * BuildNDOptionsVal(int caplen, const u_char *data)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00709">ICMP.cc:709</a></div></div>
<div class="ttc" id="classIPAddr_html"><div class="ttname"><a href="classIPAddr.html">IPAddr</a></div><div class="ttdef"><b>Definition:</b> <a href="IPAddr_8h_source.html#l00024">IPAddr.h:24</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_afb5ebe883d1b0dec4dc5396d31f144c1"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb5ebe883d1b0dec4dc5396d31f144c1">analyzer::icmp::ICMP_Analyzer::BuildICMPVal</a></div><div class="ttdeci">RecordVal * BuildICMPVal(const struct icmp *icmpp, int len, int icmpv6, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00219">ICMP.cc:219</a></div></div>
<div class="ttc" id="classEventHandlerPtr_html"><div class="ttname"><a href="classEventHandlerPtr.html">EventHandlerPtr</a></div><div class="ttdef"><b>Definition:</b> <a href="EventHandler_8h_source.html#l00086">EventHandler.h:86</a></div></div>
<div class="ttc" id="classAddrVal_html"><div class="ttname"><a href="classAddrVal.html">AddrVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00570">Val.h:570</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a4c95b7a2821ab00dbf331534d4accc89"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">analyzer::Analyzer::BuildConnVal</a></div><div class="ttdeci">RecordVal * BuildConnVal()</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00765">Analyzer.cc:765</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3b2e830de064c8024e6777fb7a5f4213"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ICMP_Analyzer::RouterAdvert </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct icmp *&#160;</td>
          <td class="paramname"><em>icmpp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>caplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>ip_hdr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00525">525</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    {</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <a class="code" href="classEventHandlerPtr.html">EventHandlerPtr</a> f = icmp_router_advertisement;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> reachable = 0, retrans = 0;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">if</span> ( caplen &gt;= (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(reachable) )</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        memcpy(&amp;reachable, data, <span class="keyword">sizeof</span>(reachable));</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">if</span> ( caplen &gt;= (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(reachable) + (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(retrans) )</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        memcpy(&amp;retrans, data + <span class="keyword">sizeof</span>(reachable), <span class="keyword">sizeof</span>(retrans));</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    val_list* vl = <span class="keyword">new</span> val_list;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    vl-&gt;append(<a class="code" href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">BuildConnVal</a>());</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    vl-&gt;append(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb5ebe883d1b0dec4dc5396d31f144c1">BuildICMPVal</a>(icmpp, len, 1, ip_hdr));</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(icmpp-&gt;icmp_num_addrs, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>)); <span class="comment">// Cur Hop Limit</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(icmpp-&gt;icmp_wpa &amp; 0x80, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>)); <span class="comment">// Managed</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(icmpp-&gt;icmp_wpa &amp; 0x40, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>)); <span class="comment">// Other</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(icmpp-&gt;icmp_wpa &amp; 0x20, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>)); <span class="comment">// Home Agent</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>((icmpp-&gt;icmp_wpa &amp; 0x18)&gt;&gt;3, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>)); <span class="comment">// Pref</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(icmpp-&gt;icmp_wpa &amp; 0x04, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a>)); <span class="comment">// Proxy</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(icmpp-&gt;icmp_wpa &amp; 0x02, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>)); <span class="comment">// Reserved</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classIntervalVal.html">IntervalVal</a>((<span class="keywordtype">double</span>)ntohs(icmpp-&gt;icmp_lifetime), <a class="code" href="Val_8h.html#a46299c0ec2e71a21f923d4976596571e">Seconds</a>));</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classIntervalVal.html">IntervalVal</a>((<span class="keywordtype">double</span>)ntohl(reachable), <a class="code" href="Val_8h.html#acf8e0fddda4f0f45a7c3ed13a694256d">Milliseconds</a>));</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    vl-&gt;append(<span class="keyword">new</span> <a class="code" href="classIntervalVal.html">IntervalVal</a>((<span class="keywordtype">double</span>)ntohl(retrans), <a class="code" href="Val_8h.html#acf8e0fddda4f0f45a7c3ed13a694256d">Milliseconds</a>));</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordtype">int</span> opt_offset = <span class="keyword">sizeof</span>(reachable) + <span class="keyword">sizeof</span>(retrans);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    vl-&gt;append(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ab844db89298e6cf64c2d84cf5a0f5bf9">BuildNDOptionsVal</a>(caplen - opt_offset, data + opt_offset));</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <a class="code" href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">ConnectionEvent</a>(f, vl);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    }</div><div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76a3e0f738756c5205d71c69d955603f46c">TYPE_BOOL</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00020">Type.h:20</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a33fbd3099c09106bff5e5900091ec69e"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">analyzer::Analyzer::ConnectionEvent</a></div><div class="ttdeci">void ConnectionEvent(EventHandlerPtr f, val_list *vl)</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00780">Analyzer.cc:780</a></div></div>
<div class="ttc" id="classVal_html"><div class="ttname"><a href="classVal.html">Val</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00078">Val.h:78</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_ab844db89298e6cf64c2d84cf5a0f5bf9"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ab844db89298e6cf64c2d84cf5a0f5bf9">analyzer::icmp::ICMP_Analyzer::BuildNDOptionsVal</a></div><div class="ttdeci">VectorVal * BuildNDOptionsVal(int caplen, const u_char *data)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00709">ICMP.cc:709</a></div></div>
<div class="ttc" id="Val_8h_html_acf8e0fddda4f0f45a7c3ed13a694256d"><div class="ttname"><a href="Val_8h.html#acf8e0fddda4f0f45a7c3ed13a694256d">Milliseconds</a></div><div class="ttdeci">#define Milliseconds</div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00478">Val.h:478</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_afb5ebe883d1b0dec4dc5396d31f144c1"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb5ebe883d1b0dec4dc5396d31f144c1">analyzer::icmp::ICMP_Analyzer::BuildICMPVal</a></div><div class="ttdeci">RecordVal * BuildICMPVal(const struct icmp *icmpp, int len, int icmpv6, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00219">ICMP.cc:219</a></div></div>
<div class="ttc" id="classEventHandlerPtr_html"><div class="ttname"><a href="classEventHandlerPtr.html">EventHandlerPtr</a></div><div class="ttdef"><b>Definition:</b> <a href="EventHandler_8h_source.html#l00086">EventHandler.h:86</a></div></div>
<div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00022">Type.h:22</a></div></div>
<div class="ttc" id="Val_8h_html_a46299c0ec2e71a21f923d4976596571e"><div class="ttname"><a href="Val_8h.html#a46299c0ec2e71a21f923d4976596571e">Seconds</a></div><div class="ttdeci">#define Seconds</div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00479">Val.h:479</a></div></div>
<div class="ttc" id="util_8h_html_acbd4acd0d29e2d6c43104827f77d9cd2"><div class="ttname"><a href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00064">util.h:64</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a4c95b7a2821ab00dbf331534d4accc89"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">analyzer::Analyzer::BuildConnVal</a></div><div class="ttdeci">RecordVal * BuildConnVal()</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00765">Analyzer.cc:765</a></div></div>
<div class="ttc" id="classIntervalVal_html"><div class="ttname"><a href="classIntervalVal.html">IntervalVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00484">Val.h:484</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2c988723d5cd0d475768c5b2522c21d6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ICMP_Analyzer::RouterSolicit </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct icmp *&#160;</td>
          <td class="paramname"><em>icmpp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>caplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_char *&amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIP__Hdr.html">IP_Hdr</a> *&#160;</td>
          <td class="paramname"><em>ip_hdr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00628">628</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <a class="code" href="classEventHandlerPtr.html">EventHandlerPtr</a> f = icmp_router_solicitation;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    val_list* vl = <span class="keyword">new</span> val_list;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    vl-&gt;append(<a class="code" href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">BuildConnVal</a>());</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    vl-&gt;append(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb5ebe883d1b0dec4dc5396d31f144c1">BuildICMPVal</a>(icmpp, len, 1, ip_hdr));</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    vl-&gt;append(<a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ab844db89298e6cf64c2d84cf5a0f5bf9">BuildNDOptionsVal</a>(caplen, data));</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <a class="code" href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">ConnectionEvent</a>(f, vl);</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1Analyzer_html_a33fbd3099c09106bff5e5900091ec69e"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a33fbd3099c09106bff5e5900091ec69e">analyzer::Analyzer::ConnectionEvent</a></div><div class="ttdeci">void ConnectionEvent(EventHandlerPtr f, val_list *vl)</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00780">Analyzer.cc:780</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_ab844db89298e6cf64c2d84cf5a0f5bf9"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#ab844db89298e6cf64c2d84cf5a0f5bf9">analyzer::icmp::ICMP_Analyzer::BuildNDOptionsVal</a></div><div class="ttdeci">VectorVal * BuildNDOptionsVal(int caplen, const u_char *data)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00709">ICMP.cc:709</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_afb5ebe883d1b0dec4dc5396d31f144c1"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#afb5ebe883d1b0dec4dc5396d31f144c1">analyzer::icmp::ICMP_Analyzer::BuildICMPVal</a></div><div class="ttdeci">RecordVal * BuildICMPVal(const struct icmp *icmpp, int len, int icmpv6, const IP_Hdr *ip_hdr)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00219">ICMP.cc:219</a></div></div>
<div class="ttc" id="classEventHandlerPtr_html"><div class="ttname"><a href="classEventHandlerPtr.html">EventHandlerPtr</a></div><div class="ttdef"><b>Definition:</b> <a href="EventHandler_8h_source.html#l00086">EventHandler.h:86</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a4c95b7a2821ab00dbf331534d4accc89"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">analyzer::Analyzer::BuildConnVal</a></div><div class="ttdeci">RecordVal * BuildConnVal()</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00765">Analyzer.cc:765</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af3aa909ddcd8c158969575fab1693ffd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ICMP_Analyzer::UpdateConnVal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRecordVal.html">RecordVal</a> *&#160;</td>
          <td class="paramname"><em>conn_val</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Called whenever the connection value is updated. Per default, this method will be called for each analyzer in the tree. Analyzers can use this method to attach additional data to the connections. A call to <a class="el" href="classanalyzer_1_1Analyzer.html#a4c95b7a2821ab00dbf331534d4accc89">BuildConnVal()</a> will in turn trigger a call to <a class="el" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#af3aa909ddcd8c158969575fab1693ffd">UpdateConnVal()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn_val</td><td>The connenction value being updated. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classanalyzer_1_1Analyzer.html#a0e32b19246b9561eeca008a4dbd0f9f1">analyzer::Analyzer</a>.</p>

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00455">455</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="classRecordVal.html">RecordVal</a> *orig_endp = conn_val-&gt;<a class="code" href="classRecordVal.html#ab46f1dcbae88f6cad38cf12a3375ab3e">Lookup</a>(<span class="stringliteral">&quot;orig&quot;</span>)-&gt;AsRecordVal();</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="classRecordVal.html">RecordVal</a> *resp_endp = conn_val-&gt;<a class="code" href="classRecordVal.html#ab46f1dcbae88f6cad38cf12a3375ab3e">Lookup</a>(<span class="stringliteral">&quot;resp&quot;</span>)-&gt;AsRecordVal();</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a49b9ebc70e8cdeac5961ff308f1aeb41">UpdateEndpointVal</a>(orig_endp, 1);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a49b9ebc70e8cdeac5961ff308f1aeb41">UpdateEndpointVal</a>(resp_endp, 0);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">// Call children&#39;s UpdateConnVal</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <a class="code" href="classanalyzer_1_1Analyzer.html#a0e32b19246b9561eeca008a4dbd0f9f1">Analyzer::UpdateConnVal</a>(conn_val);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    }</div><div class="ttc" id="classRecordVal_html"><div class="ttname"><a href="classRecordVal.html">RecordVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00937">Val.h:937</a></div></div>
<div class="ttc" id="classRecordVal_html_ab46f1dcbae88f6cad38cf12a3375ab3e"><div class="ttname"><a href="classRecordVal.html#ab46f1dcbae88f6cad38cf12a3375ab3e">RecordVal::Lookup</a></div><div class="ttdeci">Val * Lookup(int field) const </div><div class="ttdef"><b>Definition:</b> <a href="Val_8cc_source.html#l02915">Val.cc:2915</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a0e32b19246b9561eeca008a4dbd0f9f1"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a0e32b19246b9561eeca008a4dbd0f9f1">analyzer::Analyzer::UpdateConnVal</a></div><div class="ttdeci">virtual void UpdateConnVal(RecordVal *conn_val)</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00759">Analyzer.cc:759</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a49b9ebc70e8cdeac5961ff308f1aeb41"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a49b9ebc70e8cdeac5961ff308f1aeb41">analyzer::icmp::ICMP_Analyzer::UpdateEndpointVal</a></div><div class="ttdeci">void UpdateEndpointVal(RecordVal *endp, int is_orig)</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8cc_source.html#l00467">ICMP.cc:467</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a49b9ebc70e8cdeac5961ff308f1aeb41"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ICMP_Analyzer::UpdateEndpointVal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRecordVal.html">RecordVal</a> *&#160;</td>
          <td class="paramname"><em>endp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_orig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8cc_source.html#l00467">467</a> of file <a class="el" href="ICMP_8cc_source.html">ICMP.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    {</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <a class="code" href="classanalyzer_1_1Analyzer.html#a5aee2807c8bbdc99f863e27523cf785f">Conn</a>()-&gt;<a class="code" href="classConnection.html#adc6cf1985f0b047a6bf8fc2cdf20eca5">EnableStatusUpdateTimer</a>();</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordtype">int</span> size = is_orig ? <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a80abf56d64914c491521fe0a0aff4e76">request_len</a> : <a class="code" href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#acc5800875d89641609b6da8b13b39f0a">reply_len</a>;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordflow">if</span> ( size &lt; 0 )</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        {</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        endp-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(0, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(0, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        endp-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(1, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(<span class="keywordtype">int</span>(<a class="code" href="namespaceanalyzer_1_1icmp.html#a5e2886fb0890d0a0bbe4bd7a557f8850adfa0cdb09dbb51c90d437fb3dc42362d">ICMP_INACTIVE</a>), <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        {</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        endp-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(0, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(size, <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        endp-&gt;<a class="code" href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">Assign</a>(1, <span class="keyword">new</span> <a class="code" href="classVal.html">Val</a>(<span class="keywordtype">int</span>(<a class="code" href="namespaceanalyzer_1_1icmp.html#a5e2886fb0890d0a0bbe4bd7a557f8850ae3d7d565e09eda251b4f577990b53255">ICMP_ACTIVE</a>), <a class="code" href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a>));</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        }</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    }</div><div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_acc5800875d89641609b6da8b13b39f0a"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#acc5800875d89641609b6da8b13b39f0a">analyzer::icmp::ICMP_Analyzer::reply_len</a></div><div class="ttdeci">int reply_len</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00080">ICMP.h:80</a></div></div>
<div class="ttc" id="classVal_html"><div class="ttname"><a href="classVal.html">Val</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00078">Val.h:78</a></div></div>
<div class="ttc" id="classConnection_html_adc6cf1985f0b047a6bf8fc2cdf20eca5"><div class="ttname"><a href="classConnection.html#adc6cf1985f0b047a6bf8fc2cdf20eca5">Connection::EnableStatusUpdateTimer</a></div><div class="ttdeci">void EnableStatusUpdateTimer()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8cc_source.html#l00380">Conn.cc:380</a></div></div>
<div class="ttc" id="classanalyzer_1_1icmp_1_1ICMP__Analyzer_html_a80abf56d64914c491521fe0a0aff4e76"><div class="ttname"><a href="classanalyzer_1_1icmp_1_1ICMP__Analyzer.html#a80abf56d64914c491521fe0a0aff4e76">analyzer::icmp::ICMP_Analyzer::request_len</a></div><div class="ttdeci">int request_len</div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00080">ICMP.h:80</a></div></div>
<div class="ttc" id="Type_8h_html_a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99"><div class="ttname"><a href="Type_8h.html#a691dbb391d6f10a0ad4b2281103ddc76af03f11bf987d933c52a4438b206f6b99">TYPE_COUNT</a></div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00022">Type.h:22</a></div></div>
<div class="ttc" id="namespaceanalyzer_1_1icmp_html_a5e2886fb0890d0a0bbe4bd7a557f8850ae3d7d565e09eda251b4f577990b53255"><div class="ttname"><a href="namespaceanalyzer_1_1icmp.html#a5e2886fb0890d0a0bbe4bd7a557f8850ae3d7d565e09eda251b4f577990b53255">analyzer::icmp::ICMP_ACTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00013">ICMP.h:13</a></div></div>
<div class="ttc" id="classRecordVal_html_a5c6a817fc30e555ddb9708a83ffbdfaf"><div class="ttname"><a href="classRecordVal.html#a5c6a817fc30e555ddb9708a83ffbdfaf">RecordVal::Assign</a></div><div class="ttdeci">void Assign(int field, Val *new_val, Opcode op=OP_ASSIGN)</div><div class="ttdef"><b>Definition:</b> <a href="Val_8cc_source.html#l02873">Val.cc:2873</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html_a5aee2807c8bbdc99f863e27523cf785f"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html#a5aee2807c8bbdc99f863e27523cf785f">analyzer::Analyzer::Conn</a></div><div class="ttdeci">Connection * Conn() const </div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8h_source.html#l00273">Analyzer.h:273</a></div></div>
<div class="ttc" id="namespaceanalyzer_1_1icmp_html_a5e2886fb0890d0a0bbe4bd7a557f8850adfa0cdb09dbb51c90d437fb3dc42362d"><div class="ttname"><a href="namespaceanalyzer_1_1icmp.html#a5e2886fb0890d0a0bbe4bd7a557f8850adfa0cdb09dbb51c90d437fb3dc42362d">analyzer::icmp::ICMP_INACTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="ICMP_8h_source.html#l00012">ICMP.h:12</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a4da708767b3b9d52f245c98404c5db05"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int analyzer::icmp::ICMP_Analyzer::code</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8h_source.html#l00079">79</a> of file <a class="el" href="ICMP_8h_source.html">ICMP.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae6fca59ca5559b54efcee453a82643a8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRecordVal.html">RecordVal</a>* analyzer::icmp::ICMP_Analyzer::icmp_conn_val</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8h_source.html#l00077">77</a> of file <a class="el" href="ICMP_8h_source.html">ICMP.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7c7726dc04dac4b593970635477c1ac9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRuleMatcherState.html">RuleMatcherState</a> analyzer::icmp::ICMP_Analyzer::matcher_state</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8h_source.html#l00082">82</a> of file <a class="el" href="ICMP_8h_source.html">ICMP.h</a>.</p>

</div>
</div>
<a class="anchor" id="acc5800875d89641609b6da8b13b39f0a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int analyzer::icmp::ICMP_Analyzer::reply_len</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8h_source.html#l00080">80</a> of file <a class="el" href="ICMP_8h_source.html">ICMP.h</a>.</p>

</div>
</div>
<a class="anchor" id="a80abf56d64914c491521fe0a0aff4e76"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int analyzer::icmp::ICMP_Analyzer::request_len</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8h_source.html#l00080">80</a> of file <a class="el" href="ICMP_8h_source.html">ICMP.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5ac8365c0e88becbfb53dd116a43c489"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int analyzer::icmp::ICMP_Analyzer::type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ICMP_8h_source.html#l00078">78</a> of file <a class="el" href="ICMP_8h_source.html">ICMP.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/jasonlu/bro/src/analyzer/protocol/icmp/<a class="el" href="ICMP_8h_source.html">ICMP.h</a></li>
<li>/home/jasonlu/bro/src/analyzer/protocol/icmp/<a class="el" href="ICMP_8cc_source.html">ICMP.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
