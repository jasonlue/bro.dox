<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>bro: /home/jasonlu/bro/src/RuleMatcher.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">bro
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5b988f0c4d1fda8dce2b23100e7167dd.html">bro</a></li><li class="navelem"><a class="el" href="dir_1ae927ab70ca550cfc88d2a3fb3c22b4.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">RuleMatcher.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="RuleMatcher_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef sigs_h</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define sigs_h</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;limits.h&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;set&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IPAddr_8h.html">IPAddr.h</a>&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BroString_8h.html">BroString.h</a>&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="List_8h.html">List.h</a>&quot;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="RE_8h.html">RE.h</a>&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Net_8h.html">Net.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Sessions_8h.html">Sessions.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntSet_8h.html">IntSet.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="util_8h.html">util.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Rule_8h.html">Rule.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="RuleAction_8h.html">RuleAction.h</a>&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="RuleCondition_8h.html">RuleCondition.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//#define MATCHER_PRINT_STATS</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// Parser interface:</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="RuleMatcher_8h.html#aba320856f004abe5d3912a21687c7c74">rules_error</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* msg);</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="RuleMatcher_8h.html#aba320856f004abe5d3912a21687c7c74">rules_error</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* msg, <span class="keyword">const</span> <span class="keywordtype">char</span>* addl);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="RuleMatcher_8h.html#aba320856f004abe5d3912a21687c7c74">rules_error</a>(<a class="code" href="classRule.html">Rule</a>* <span class="keywordtype">id</span>, <span class="keyword">const</span> <span class="keywordtype">char</span>* msg);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="RuleMatcher_8h.html#a778988c8d6119aa5fe4e3303b1495187">rules_lex</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="RuleMatcher_8h.html#a1ff8d980c82f11c1dfb3833c319800cf">rules_parse</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">int</span> <a class="code" href="RuleMatcher_8h.html#afe39929906311df2864bb6b2df71e727">rules_wrap</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">extern</span> FILE* <a class="code" href="RuleMatcher_8h.html#a92dbdfcf82f9407f1f0d0f4d46f16990">rules_in</a>;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="RuleMatcher_8h.html#a10fbb3490c5f357165687b523e16ae66">rules_line_number</a>;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="RuleMatcher_8h.html#adf386e7f4ee0238d62b60663b909f7fb">current_rule_file</a>;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">class </span><a class="code" href="classRuleMatcher.html">RuleMatcher</a>;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">extern</span> <a class="code" href="classRuleMatcher.html">RuleMatcher</a>* <a class="code" href="RuleMatcher_8h.html#ab439ed8d6aeda04ac031a22ba741b04e">rule_matcher</a>;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceanalyzer.html">analyzer</a> {</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keyword">namespace </span>pia { <span class="keyword">class </span>PIA; }</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keyword">class </span>Analyzer;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">// RuleHdrTest and associated things:</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">// Given a header expression like &quot;ip[offset:len] &amp; mask = val&quot;, we parse</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">// it into a Range and a MaskedValue.</span></div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="structRange.html">   49</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structRange.html">Range</a> {</div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="structRange.html#a2a8098044f074a947557c9d0c9a8fbff">   50</a></span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="structRange.html#a2a8098044f074a947557c9d0c9a8fbff">offset</a>;</div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="structRange.html#adf1a90d81c11e8de792f8b6dda0cc150">   51</a></span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="structRange.html#adf1a90d81c11e8de792f8b6dda0cc150">len</a>;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;};</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="structMaskedValue.html">   54</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structMaskedValue.html">MaskedValue</a> {</div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="structMaskedValue.html#a674b1d0c56a5fdf2e47ece316a1bc1a3">   55</a></span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="structMaskedValue.html#a674b1d0c56a5fdf2e47ece316a1bc1a3">val</a>;</div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="structMaskedValue.html#a13cddc322e5df867780c64f5f2538dfa">   56</a></span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="structMaskedValue.html#a13cddc322e5df867780c64f5f2538dfa">mask</a>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;};</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<a class="code" href="RuleMatcher_8h.html#a3124b33d34cf0b1ef275a2c7607c3618">declare</a>(<a class="code" href="RuleMatcher_8h.html#aa1bb2362d6e2f40cc8987b7b84e7b382">PList</a>, <a class="code" href="structMaskedValue.html">MaskedValue</a>);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="keyword">typedef</span> <a class="code" href="RuleMatcher_8h.html#aa1bb2362d6e2f40cc8987b7b84e7b382">PList</a>(<a class="code" href="structMaskedValue.html">MaskedValue</a>) maskedvalue_list;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;typedef <a class="code" href="RuleMatcher_8h.html#aa1bb2362d6e2f40cc8987b7b84e7b382">PList</a>(<span class="keywordtype">char</span>) <a class="code" href="RE_8h.html#aa8d7fd9597f5e3d28d18796a24e7a7f8">string_list</a>;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<a class="code" href="RuleMatcher_8h.html#a3124b33d34cf0b1ef275a2c7607c3618">declare</a>(<a class="code" href="RuleMatcher_8h.html#aa1bb2362d6e2f40cc8987b7b84e7b382">PList</a>, <a class="code" href="classBroString.html">BroString</a>);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;typedef PList(BroString) bstr_list;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">// Get values from Bro&#39;s script-level variables.</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;extern <span class="keywordtype">void</span> <a class="code" href="RuleMatcher_8h.html#ac01bbc7dd6191022829199dd984ec90f">id_to_maskedvallist</a>(const <span class="keywordtype">char</span>* <span class="keywordtype">id</span>, maskedvalue_list* append_to,</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                                vector&lt;<a class="code" href="classIPPrefix.html">IPPrefix</a>&gt;* prefix_vector = 0);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;extern <span class="keywordtype">char</span>* <a class="code" href="RuleMatcher_8h.html#acb58f6b3697f0840e6c309b468bb7c2c">id_to_str</a>(const <span class="keywordtype">char</span>* <span class="keywordtype">id</span>);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;extern <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="RuleMatcher_8h.html#a1f5f7e58e3e693f922a69034e045cbfb">id_to_uint</a>(const <span class="keywordtype">char</span>* <span class="keywordtype">id</span>);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="classRuleHdrTest.html">   73</a></span>&#160;class <a class="code" href="classRuleHdrTest.html">RuleHdrTest</a> {</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">// Note: Adapt RuleHdrTest::PrintDebug() when changing these enums.</span></div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="classRuleHdrTest.html#ad9b0e83b202d0e8d08e2a06f8f09234aa433771a0b9c7428016b3b8378c6da325">   76</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="classRuleHdrTest.html#ad9b0e83b202d0e8d08e2a06f8f09234a">Comp</a> { LE, GE, LT, GT, EQ, NE };</div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="classRuleHdrTest.html#adee0037d6ae409db790dfc003b996fdeac54d71699e449c56d83d9f8aa674bba6">   77</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="classRuleHdrTest.html#adee0037d6ae409db790dfc003b996fde">Prot</a> { NOPROT, IP, <a class="code" href="net__util_8h.html#a96479ca74ca88f0e2aafab1d9b23721eaee0722baf12a9db075fb08d0734710a6">IPv6</a>, ICMP, ICMPv6, TCP, <a class="code" href="classRuleHdrTest.html#adee0037d6ae409db790dfc003b996fdeac54d71699e449c56d83d9f8aa674bba6">UDP</a>, NEXT, IPSrc, IPDst };</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    RuleHdrTest(<a class="code" href="classRuleHdrTest.html#adee0037d6ae409db790dfc003b996fde">Prot</a> arg_prot, <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> arg_offset, <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> arg_size,</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <a class="code" href="classRuleHdrTest.html#ad9b0e83b202d0e8d08e2a06f8f09234a">Comp</a> arg_comp, maskedvalue_list* arg_vals);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    RuleHdrTest(<a class="code" href="classRuleHdrTest.html#adee0037d6ae409db790dfc003b996fde">Prot</a> arg_prot, <a class="code" href="classRuleHdrTest.html#ad9b0e83b202d0e8d08e2a06f8f09234a">Comp</a> arg_comp, vector&lt;IPPrefix&gt; arg_v);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    ~RuleHdrTest();</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordtype">void</span> PrintDebug();</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// The constructor does not copy those attributes which are set</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// by RuleMatcher::BuildRulesTree() (see below).</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    RuleHdrTest(RuleHdrTest&amp; h);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="comment">// should be const, but lists don&#39;t have const version</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// Likewise, the operator== checks only for same test semantics.</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="TunnelEncapsulation_8cc.html#a6204510415c806e49d259ee40b2a6979">operator==</a>(<span class="keyword">const</span> RuleHdrTest&amp; h);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="classRuleHdrTest.html#a775906677daac67f84e32a0df2ea9df7">   95</a></span>&#160;    <a class="code" href="classRuleHdrTest.html#adee0037d6ae409db790dfc003b996fde">Prot</a> <a class="code" href="classRuleHdrTest.html#a775906677daac67f84e32a0df2ea9df7">prot</a>;</div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="classRuleHdrTest.html#a28b15d5144360629eaf65b63a9721a2f">   96</a></span>&#160;    <a class="code" href="classRuleHdrTest.html#ad9b0e83b202d0e8d08e2a06f8f09234a">Comp</a> <a class="code" href="classRuleHdrTest.html#a28b15d5144360629eaf65b63a9721a2f">comp</a>;</div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="classRuleHdrTest.html#abfd9ce02de6679d7f40fbe5b25484280">   97</a></span>&#160;    maskedvalue_list* <a class="code" href="classRuleHdrTest.html#abfd9ce02de6679d7f40fbe5b25484280">vals</a>;</div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="classRuleHdrTest.html#a831f08cbc6af3f073292f3964178a9bd">   98</a></span>&#160;    vector&lt;IPPrefix&gt; <a class="code" href="classRuleHdrTest.html#a831f08cbc6af3f073292f3964178a9bd">prefix_vals</a>; <span class="comment">// for use with IPSrc/IPDst comparisons</span></div><div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="classRuleHdrTest.html#ab77783d2da4d41e1ccdf9c1cd4d935d7">   99</a></span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="classRuleHdrTest.html#ab77783d2da4d41e1ccdf9c1cd4d935d7">offset</a>;</div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="classRuleHdrTest.html#a8710fad3b56b7adcc9590cc7f97f1a3e">  100</a></span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="classRuleHdrTest.html#a8710fad3b56b7adcc9590cc7f97f1a3e">size</a>;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classRuleHdrTest.html#a6960fe7f85dd89b64c4979f915cae772">  102</a></span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="classRuleHdrTest.html#a6960fe7f85dd89b64c4979f915cae772">id</a>;  <span class="comment">// For debugging, each HdrTest gets an unique ID</span></div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="classRuleHdrTest.html#aaa9e3398a3b4b8dafe980a6e0b023fdc">  103</a></span>&#160;    <span class="keyword">static</span> <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="classRuleHdrTest.html#aaa9e3398a3b4b8dafe980a6e0b023fdc">idcounter</a>;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// The following are all set by RuleMatcher::BuildRulesTree().</span></div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="classRuleHdrTest.html#a298d7431fb2df94629592327be0b98e4">  106</a></span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classRuleMatcher.html">RuleMatcher</a>;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="structRuleHdrTest_1_1PatternSet.html">  108</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structRuleHdrTest_1_1PatternSet.html">PatternSet</a> {</div><div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="structRuleHdrTest_1_1PatternSet.html#a541fb392788a405bb08c3e8ba1cd2453">  109</a></span>&#160;        <a class="code" href="structRuleHdrTest_1_1PatternSet.html#a541fb392788a405bb08c3e8ba1cd2453">PatternSet</a>() : re() {}</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="comment">// If we&#39;re above the &#39;RE_level&#39; (see RuleMatcher), this</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="comment">// expr contains all patterns on this node. If we&#39;re on</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="comment">// &#39;RE_level&#39;, it additionally contains all patterns</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="comment">// of any of its children.</span></div><div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="structRuleHdrTest_1_1PatternSet.html#a24e10d24dd19b565bc025a8c576e230f">  115</a></span>&#160;        <a class="code" href="classSpecific__RE__Matcher.html">Specific_RE_Matcher</a>* <a class="code" href="structRuleHdrTest_1_1PatternSet.html#a24e10d24dd19b565bc025a8c576e230f">re</a>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="comment">// All the patterns and their rule indices.</span></div><div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="structRuleHdrTest_1_1PatternSet.html#abae87d60797230671cbafc4ae26c7919">  118</a></span>&#160;        string_list <a class="code" href="structRuleHdrTest_1_1PatternSet.html#abae87d60797230671cbafc4ae26c7919">patterns</a>;</div><div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="structRuleHdrTest_1_1PatternSet.html#a34d7edc8e79f4dfaff6baaf2911aeea5">  119</a></span>&#160;        int_list <a class="code" href="structRuleHdrTest_1_1PatternSet.html#a34d7edc8e79f4dfaff6baaf2911aeea5">ids</a>;   <span class="comment">// (only needed for debugging)</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    };</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="RuleMatcher_8h.html#a3124b33d34cf0b1ef275a2c7607c3618">declare</a>(PList, <a class="code" href="structRuleHdrTest_1_1PatternSet.html">PatternSet</a>);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keyword">typedef</span> <a class="code" href="RuleMatcher_8h.html#aa1bb2362d6e2f40cc8987b7b84e7b382">PList</a>(<a class="code" href="structRuleHdrTest_1_1PatternSet.html">PatternSet</a>) pattern_set_list;</div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="classRuleHdrTest.html#ac8c3163f67048ea7d9376d71c6432f0f">  124</a></span>&#160;    pattern_set_list psets[<a class="code" href="classRule.html">Rule</a>::TYPES];</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// List of rules belonging to this node.</span></div><div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="classRuleHdrTest.html#aecc71fd10dc396756565a73b9ec06858">  127</a></span>&#160;    <a class="code" href="classRule.html">Rule</a>* pattern_rules;    <span class="comment">// rules w/ at least one pattern of any type</span></div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="classRuleHdrTest.html#a90c91fa15eacec2c17910517f45e9c5d">  128</a></span>&#160;    <a class="code" href="classRule.html">Rule</a>* pure_rules;   <span class="comment">// rules containing no patterns at all</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="classRuleHdrTest.html#a723f64364612d009a3374c875483fa3c">  130</a></span>&#160;    <a class="code" href="classIntSet.html">IntSet</a>* ruleset;    <span class="comment">// set of all rules belonging to this node</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                <span class="comment">// (for fast membership test)</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="classRuleHdrTest.html#a5d809f65ba630c2a6e97307c24274c7b">  133</a></span>&#160;    RuleHdrTest* sibling;   <span class="comment">// linkage within HdrTest tree</span></div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="classRuleHdrTest.html#a0a539ad8d56102b77f87a63dfdf2decc">  134</a></span>&#160;    RuleHdrTest* child;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="classRuleHdrTest.html#aab112cd18a29839a225bf1d17e969466">  136</a></span>&#160;    <span class="keywordtype">int</span> level;  <span class="comment">// level within the tree</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;};</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<a class="code" href="RuleMatcher_8h.html#a3124b33d34cf0b1ef275a2c7607c3618">declare</a>(PList, RuleHdrTest);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;typedef PList(RuleHdrTest) rule_hdr_test_list;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">// RuleEndpointState keeps the per-stream matching state of one</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">// connection endpoint.</span></div><div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="classRuleEndpointState.html">  144</a></span>&#160;class <a class="code" href="classRuleEndpointState.html">RuleEndpointState</a> {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    ~RuleEndpointState();</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="classRuleEndpointState.html#a179243cbca696565235739505e52c94a">  148</a></span>&#160;    <a class="code" href="classanalyzer_1_1Analyzer.html">analyzer::Analyzer</a>* <a class="code" href="classRuleEndpointState.html#a179243cbca696565235739505e52c94a">GetAnalyzer</a>()<span class="keyword">   const   </span>{ <span class="keywordflow">return</span> <a class="code" href="namespaceanalyzer.html">analyzer</a>; }</div><div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="classRuleEndpointState.html#a9182e8c2d630b20be0f84f87663c47c0">  149</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classRuleEndpointState.html#a9182e8c2d630b20be0f84f87663c47c0">IsOrig</a>()       { <span class="keywordflow">return</span> is_orig; }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">// For flipping roles.</span></div><div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="classRuleEndpointState.html#a8dca8bfa8584aa012e7a600b9e9cd07d">  152</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classRuleEndpointState.html#a8dca8bfa8584aa012e7a600b9e9cd07d">FlipIsOrig</a>()   { is_orig = ! is_orig; }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// Returns the size of the first non-empty chunk of</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">//   data feed into the RULE_PAYLOAD matcher.</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// Returns 0 zero iff only empty chunks have been fed.</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// Returns -1 if no chunk has been fed yet at all.</span></div><div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="classRuleEndpointState.html#aa3380f496419b48084e145aa758b91a1">  158</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classRuleEndpointState.html#aa3380f496419b48084e145aa758b91a1">PayloadSize</a>()   { <span class="keywordflow">return</span> payload_size; }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="classRuleEndpointState.html#a83b23cb7d32ce038111480a0f8643281">  160</a></span>&#160;    <a class="code" href="classanalyzer_1_1pia_1_1PIA.html">analyzer::pia::PIA</a>* <a class="code" href="classRuleEndpointState.html#a83b23cb7d32ce038111480a0f8643281">PIA</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> pia; }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="classRuleEndpointState.html#a298d7431fb2df94629592327be0b98e4">  163</a></span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classRuleMatcher.html">RuleMatcher</a>;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// Constructor is private; use RuleMatcher::InitEndpoint()</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">// for creating an instance.</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    RuleEndpointState(<a class="code" href="classanalyzer_1_1Analyzer.html">analyzer::Analyzer</a>* arg_analyzer, <span class="keywordtype">bool</span> arg_is_orig,</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;              RuleEndpointState* arg_opposite, <a class="code" href="classanalyzer_1_1pia_1_1PIA.html">analyzer::pia::PIA</a>* arg_PIA);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="structRuleEndpointState_1_1Matcher.html">  170</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structRuleEndpointState_1_1Matcher.html">Matcher</a> {</div><div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="structRuleEndpointState_1_1Matcher.html#a748c847cadea93af94e21f64476c1e87">  171</a></span>&#160;        <a class="code" href="classRE__Match__State.html">RE_Match_State</a>* <a class="code" href="structRuleEndpointState_1_1Matcher.html#a748c847cadea93af94e21f64476c1e87">state</a>;</div><div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="structRuleEndpointState_1_1Matcher.html#a6941699610347f0a5f59389db3d628db">  172</a></span>&#160;        <a class="code" href="classRule.html#af6be8dfd23098aad37f3cd0188a0953b">Rule::PatternType</a> <a class="code" href="structRuleEndpointState_1_1Matcher.html#a6941699610347f0a5f59389db3d628db">type</a>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    };</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="RuleMatcher_8h.html#a3124b33d34cf0b1ef275a2c7607c3618">declare</a>(PList, <a class="code" href="structRuleEndpointState_1_1Matcher.html">Matcher</a>);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keyword">typedef</span> <a class="code" href="RuleMatcher_8h.html#aa1bb2362d6e2f40cc8987b7b84e7b382">PList</a>(<a class="code" href="structRuleEndpointState_1_1Matcher.html">Matcher</a>) matcher_list;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="classRuleEndpointState.html#a819dfc52889e7885c6ad5e4832170475">  178</a></span>&#160;    <span class="keywordtype">bool</span> is_orig;</div><div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="classRuleEndpointState.html#a1562b5120069950cf29b6df08ad05852">  179</a></span>&#160;    <a class="code" href="namespaceanalyzer.html">analyzer</a>::Analyzer* <a class="code" href="namespaceanalyzer.html">analyzer</a>;</div><div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="classRuleEndpointState.html#af8d06029dc5e90c4a71d899a1b7e4695">  180</a></span>&#160;    RuleEndpointState* opposite;</div><div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="classRuleEndpointState.html#ad2320ccb251314a9eaa84c68f400835c">  181</a></span>&#160;    analyzer::pia::PIA* pia;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="classRuleEndpointState.html#a9efd229a2911a92714be448f05f55832">  183</a></span>&#160;    matcher_list matchers;</div><div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="classRuleEndpointState.html#a10f36aef7199919de97cec47f7f2cbb2">  184</a></span>&#160;    rule_hdr_test_list hdr_tests;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// The follow tracks which rules for which all patterns have matched,</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">// and in a parallel list the (first instance of the) corresponding</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">// matched text.</span></div><div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="classRuleEndpointState.html#ac45a90b8c6b5c4ac8f1efc6521487e62">  189</a></span>&#160;    rule_list matched_by_patterns;</div><div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="classRuleEndpointState.html#adb54b3784ec0fd9008b651bccf42da82">  190</a></span>&#160;    bstr_list matched_text;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="classRuleEndpointState.html#a1febde49d239ebfa7de29881c731f995">  192</a></span>&#160;    <span class="keywordtype">int</span> payload_size;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="classRuleEndpointState.html#af603473ed992f315e19a8f8cec5e287f">  194</a></span>&#160;    int_list matched_rules;     <span class="comment">// Rules for which all conditions have matched</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;};</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="classRuleFileMagicState.html">  200</a></span>&#160;class <a class="code" href="classRuleFileMagicState.html">RuleFileMagicState</a> {</div><div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="classRuleFileMagicState.html#a298d7431fb2df94629592327be0b98e4">  201</a></span>&#160;<span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classRuleMatcher.html">RuleMatcher</a>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    ~RuleFileMagicState();</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// Ctor is private; use RuleMatcher::InitFileMagic() for</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// instantiation.</span></div><div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="classRuleFileMagicState.html#aabea49b6feab4c3046b64c7ae4fa4645">  208</a></span>&#160;    <a class="code" href="classRuleFileMagicState.html#aabea49b6feab4c3046b64c7ae4fa4645">RuleFileMagicState</a>()</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        { }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="structRuleFileMagicState_1_1Matcher.html">  211</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structRuleFileMagicState_1_1Matcher.html">Matcher</a> {</div><div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="structRuleFileMagicState_1_1Matcher.html#ac2e6601d826da69a594e02c90435383a">  212</a></span>&#160;        <a class="code" href="classRE__Match__State.html">RE_Match_State</a>* <a class="code" href="structRuleFileMagicState_1_1Matcher.html#ac2e6601d826da69a594e02c90435383a">state</a>;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    };</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="RuleMatcher_8h.html#a3124b33d34cf0b1ef275a2c7607c3618">declare</a>(PList, <a class="code" href="structRuleFileMagicState_1_1Matcher.html">Matcher</a>);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keyword">typedef</span> <a class="code" href="RuleMatcher_8h.html#aa1bb2362d6e2f40cc8987b7b84e7b382">PList</a>(<a class="code" href="structRuleFileMagicState_1_1Matcher.html">Matcher</a>) matcher_list;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="classRuleFileMagicState.html#a3cdc0d79d82154c411183092f9c8d77d">  218</a></span>&#160;    matcher_list matchers;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;};</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">// RuleMatcher is the main class which builds up the data structures</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">// and performs the actual matching.</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="classRuleMatcher.html">  225</a></span>&#160;class <a class="code" href="classRuleMatcher.html">RuleMatcher</a> {</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">// Argument is tree level on which we build combined regexps</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">// (Level 0 is root).</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    RuleMatcher(<span class="keywordtype">int</span> RE_level = 4);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    ~RuleMatcher();</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// Parse the given files and built up data structures.</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordtype">bool</span> ReadFiles(<span class="keyword">const</span> name_list&amp; files);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    RuleFileMagicState* InitFileMagic() <span class="keyword">const</span>;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="classRuleMatcher.html#ac5e25e5dd0cf45aa324cc5e01b98f7eb">  247</a></span>&#160;    <span class="keyword">typedef</span> map&lt;int, set&lt;string&gt;, std::greater&lt;int&gt; &gt; <a class="code" href="classRuleMatcher.html#ac5e25e5dd0cf45aa324cc5e01b98f7eb">MIME_Matches</a>;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    MIME_Matches* Match(RuleFileMagicState* state, <span class="keyword">const</span> u_char* data,</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                       <a class="code" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> len, MIME_Matches* matches = 0) <span class="keyword">const</span>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordtype">void</span> ClearFileMagicState(RuleFileMagicState* state) <span class="keyword">const</span>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// Initialize the matching state for a endpoind of a connection based on</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">// the given packet (which should be the first packet encountered for</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">// this endpoint). If the matching is triggered by an PIA, a pointer to</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">// it needs to be given.</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    RuleEndpointState* InitEndpoint(<a class="code" href="classanalyzer_1_1Analyzer.html">analyzer::Analyzer</a>* analyzer, <span class="keyword">const</span> <a class="code" href="classIP__Hdr.html">IP_Hdr</a>* ip,</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                    <span class="keywordtype">int</span> caplen, RuleEndpointState* opposite, <span class="keywordtype">bool</span> is_orig, <a class="code" href="classanalyzer_1_1pia_1_1PIA.html">analyzer::pia::PIA</a>* pia);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// Finish matching for this stream.</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordtype">void</span> FinishEndpoint(RuleEndpointState* state);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">// Perform the actual pattern matching on the given data.</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">// bol/eol should be set to false for type Rule::PAYLOAD; they&#39;re</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">// deduced automatically.</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordtype">void</span> Match(RuleEndpointState* state, <a class="code" href="classRule.html#af6be8dfd23098aad37f3cd0188a0953b">Rule::PatternType</a> type,</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="keyword">const</span> u_char* data, <span class="keywordtype">int</span> data_len,</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="keywordtype">bool</span> bol, <span class="keywordtype">bool</span> eol, <span class="keywordtype">bool</span> clear);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">// Reset the state of the pattern matcher for this endpoint.</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordtype">void</span> ClearEndpointState(RuleEndpointState* state);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordtype">void</span> PrintDebug();</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// Interface to parser</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordtype">void</span> AddRule(<a class="code" href="classRule.html">Rule</a>* rule);</div><div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="classRuleMatcher.html#a071e3f32f8230199f320df4f1e662268">  295</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classRuleMatcher.html#a071e3f32f8230199f320df4f1e662268">SetParseError</a>()        { parse_error = <span class="keyword">true</span>; }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">// Interface to for getting some statistics</span></div><div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="structRuleMatcher_1_1Stats.html">  298</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structRuleMatcher_1_1Stats.html">Stats</a> {</div><div class="line"><a name="l00299"></a><span class="lineno"><a class="line" href="structRuleMatcher_1_1Stats.html#a4566926991c4328ad4da173a3eee3515">  299</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structRuleMatcher_1_1Stats.html#a4566926991c4328ad4da173a3eee3515">matchers</a>;  <span class="comment">// # distinct RE matchers</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="comment">// NFA states across all matchers.</span></div><div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="structRuleMatcher_1_1Stats.html#a1a85846a39c1c52029d64d40f1b0f6f0">  302</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structRuleMatcher_1_1Stats.html#a1a85846a39c1c52029d64d40f1b0f6f0">nfa_states</a>;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="comment">// # DFA states across all matchers</span></div><div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="structRuleMatcher_1_1Stats.html#aa717d5f846282f510ee40009d8d2d05f">  305</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structRuleMatcher_1_1Stats.html#aa717d5f846282f510ee40009d8d2d05f">dfa_states</a>;</div><div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="structRuleMatcher_1_1Stats.html#a71fb09fa2760caa98ee9c79ea5277b65">  306</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structRuleMatcher_1_1Stats.html#a71fb09fa2760caa98ee9c79ea5277b65">computed</a>;  <span class="comment">// # computed DFA state transitions</span></div><div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="structRuleMatcher_1_1Stats.html#a41fe20f3c1c0004fd8dad48d3e27b1bb">  307</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structRuleMatcher_1_1Stats.html#a41fe20f3c1c0004fd8dad48d3e27b1bb">mem</a>;   <span class="comment">// #  bytes used by DFA states</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="comment">// # cache hits (sampled, multiply by MOVE_TO_FRONT_SAMPLE_SIZE)</span></div><div class="line"><a name="l00310"></a><span class="lineno"><a class="line" href="structRuleMatcher_1_1Stats.html#a88a831686da948b4af6b862d0579fbb5">  310</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structRuleMatcher_1_1Stats.html#a88a831686da948b4af6b862d0579fbb5">hits</a>;</div><div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="structRuleMatcher_1_1Stats.html#a6d6022726fccedb36f6a5cdbf5570536">  311</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structRuleMatcher_1_1Stats.html#a6d6022726fccedb36f6a5cdbf5570536">misses</a>;    <span class="comment">// # cache misses</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    };</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="classVal.html">Val</a>* BuildRuleStateValue(<span class="keyword">const</span> <a class="code" href="classRule.html">Rule</a>* rule,</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                    <span class="keyword">const</span> RuleEndpointState* state) <span class="keyword">const</span>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordtype">void</span> GetStats(<a class="code" href="structRuleMatcher_1_1Stats.html">Stats</a>* stats, RuleHdrTest* hdr_test = 0);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordtype">void</span> DumpStats(<a class="code" href="classBroFile.html">BroFile</a>* f);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">// Delete node and all children.</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="patricia_8c.html#a9651906e5d00d01c6e5406c7a74c8e97">Delete</a>(RuleHdrTest* node);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">// Build tree containing all added rules.</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordtype">void</span> BuildRulesTree();</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// Insert one rule into the current tree.</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordtype">void</span> InsertRuleIntoTree(<a class="code" href="classRule.html">Rule</a>* r, <span class="keywordtype">int</span> testnr, RuleHdrTest* dest,</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                <span class="keywordtype">int</span> level);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">// Traverse tree building the combined regular expressions.</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordtype">void</span> BuildRegEx(RuleHdrTest* hdr_test, string_list* exprs, int_list* ids);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="comment">// Build groups of regular epxressions.</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordtype">void</span> BuildPatternSets(RuleHdrTest::pattern_set_list* dst,</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                <span class="keyword">const</span> string_list&amp; exprs, <span class="keyword">const</span> int_list&amp; ids);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">// Check an arbitrary rule if it&#39;s satisfied right now.</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">// eos signals end of stream</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordtype">void</span> ExecRule(<a class="code" href="classRule.html">Rule</a>* rule, RuleEndpointState* state, <span class="keywordtype">bool</span> eos);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">// Evaluate all rules which do not depend on any matched patterns.</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordtype">void</span> ExecPureRules(RuleEndpointState* state, <span class="keywordtype">bool</span> eos);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// Eval a rule under the assumption that all its patterns</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// have already matched.  s holds the text the rule matched,</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">// or nil if N/A.</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordtype">bool</span> ExecRulePurely(<a class="code" href="classRule.html">Rule</a>* r, BroString* s,</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        RuleEndpointState* state, <span class="keywordtype">bool</span> eos);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">// Execute the actions associated with a rule.</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordtype">void</span> ExecRuleActions(<a class="code" href="classRule.html">Rule</a>* r, RuleEndpointState* state,</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                <span class="keyword">const</span> u_char* data, <span class="keywordtype">int</span> len, <span class="keywordtype">bool</span> eos);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// Evaluate all rule conditions except patterns and &quot;header&quot;.</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordtype">bool</span> EvalRuleConditions(<a class="code" href="classRule.html">Rule</a>* r, RuleEndpointState* state,</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                <span class="keyword">const</span> u_char* data, <span class="keywordtype">int</span> len, <span class="keywordtype">bool</span> eos);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordtype">void</span> PrintTreeDebug(RuleHdrTest* node);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordtype">void</span> DumpStateStats(<a class="code" href="classBroFile.html">BroFile</a>* f, RuleHdrTest* hdr_test);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> AllRulePatternsMatched(<span class="keyword">const</span> <a class="code" href="classRule.html">Rule</a>* r, <a class="code" href="RE_8h.html#a6a89be77ff62090e59b6a7563f624fae">MatchPos</a> matchpos,</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="RE_8h.html#aaf361125d207c1db082cc5e3eaa2d704">AcceptingMatchSet</a>&amp; ams);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="classRuleMatcher.html#a8a076adde07f525e1a8d88d6e896a872">  366</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classRuleMatcher.html#a8a076adde07f525e1a8d88d6e896a872">RE_level</a>;</div><div class="line"><a name="l00367"></a><span class="lineno"><a class="line" href="classRuleMatcher.html#abfe6c9de50e2fece5a7dab0a6557f526">  367</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classRuleMatcher.html#abfe6c9de50e2fece5a7dab0a6557f526">parse_error</a>;</div><div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="classRuleMatcher.html#a9923ff5652e5bd73c1162b91023d7e1b">  368</a></span>&#160;    RuleHdrTest* <a class="code" href="classRuleMatcher.html#a9923ff5652e5bd73c1162b91023d7e1b">root</a>;</div><div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="classRuleMatcher.html#a0ffc71bff29350fb8c31ca9ca4c9ca72">  369</a></span>&#160;    rule_list <a class="code" href="classRuleMatcher.html#a0ffc71bff29350fb8c31ca9ca4c9ca72">rules</a>;</div><div class="line"><a name="l00370"></a><span class="lineno"><a class="line" href="classRuleMatcher.html#ab323fb6a6dbc55fbb4c291555256d16a">  370</a></span>&#160;    rule_dict <a class="code" href="classRuleMatcher.html#ab323fb6a6dbc55fbb4c291555256d16a">rules_by_id</a>;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;};</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">// Keeps bi-directional matching-state.</span></div><div class="line"><a name="l00374"></a><span class="lineno"><a class="line" href="classRuleMatcherState.html">  374</a></span>&#160;<span class="keyword">class </span><a class="code" href="classRuleMatcherState.html">RuleMatcherState</a> {</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="classRuleMatcherState.html#aed5c9ddd1a7c62836659474b331b069a">  376</a></span>&#160;    <a class="code" href="classRuleMatcherState.html#aed5c9ddd1a7c62836659474b331b069a">RuleMatcherState</a>()  { orig_match_state = resp_match_state = 0; }</div><div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="classRuleMatcherState.html#a679805b847ed4cf3c1c5b80969673e28">  377</a></span>&#160;    <a class="code" href="classRuleMatcherState.html#a679805b847ed4cf3c1c5b80969673e28">~RuleMatcherState</a>()</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        { <span class="keyword">delete</span> orig_match_state; <span class="keyword">delete</span> resp_match_state; }</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">// ip may be nil.</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordtype">void</span> InitEndpointMatcher(<a class="code" href="classanalyzer_1_1Analyzer.html">analyzer::Analyzer</a>* analyzer, <span class="keyword">const</span> <a class="code" href="classIP__Hdr.html">IP_Hdr</a>* ip,</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                 <span class="keywordtype">int</span> caplen, <span class="keywordtype">bool</span> from_orig, <a class="code" href="classanalyzer_1_1pia_1_1PIA.html">analyzer::pia::PIA</a>* pia = 0);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">// bol/eol should be set to false for type Rule::PAYLOAD; they&#39;re</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">// deduced automatically.</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordtype">void</span> Match(<a class="code" href="classRule.html#af6be8dfd23098aad37f3cd0188a0953b">Rule::PatternType</a> type, <span class="keyword">const</span> u_char* data, <span class="keywordtype">int</span> data_len,</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            <span class="keywordtype">bool</span> from_orig, <span class="keywordtype">bool</span> bol, <span class="keywordtype">bool</span> eol, <span class="keywordtype">bool</span> clear_state);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordtype">void</span> FinishEndpointMatcher();</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordtype">void</span> ClearMatchState(<span class="keywordtype">bool</span> orig);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno"><a class="line" href="classRuleMatcherState.html#a60ab63d142ee441993d60bebbf9f8f78">  392</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classRuleMatcherState.html#a60ab63d142ee441993d60bebbf9f8f78">MatcherInitialized</a>(<span class="keywordtype">bool</span> orig)</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        { <span class="keywordflow">return</span> orig ? orig_match_state : resp_match_state; }</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="classRuleMatcherState.html#a3de9c985d3e56de2d6ecb7dd6ff5ce5b">  396</a></span>&#160;    RuleEndpointState* <a class="code" href="classRuleMatcherState.html#a3de9c985d3e56de2d6ecb7dd6ff5ce5b">orig_match_state</a>;</div><div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="classRuleMatcherState.html#a1137d108455ff096208ca755d321117e">  397</a></span>&#160;    RuleEndpointState* <a class="code" href="classRuleMatcherState.html#a1137d108455ff096208ca755d321117e">resp_match_state</a>;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;};</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="RuleMatcher_8h_html_a778988c8d6119aa5fe4e3303b1495187"><div class="ttname"><a href="RuleMatcher_8h.html#a778988c8d6119aa5fe4e3303b1495187">rules_lex</a></div><div class="ttdeci">int rules_lex(void)</div></div>
<div class="ttc" id="RuleMatcher_8h_html_a1ff8d980c82f11c1dfb3833c319800cf"><div class="ttname"><a href="RuleMatcher_8h.html#a1ff8d980c82f11c1dfb3833c319800cf">rules_parse</a></div><div class="ttdeci">int rules_parse(void)</div></div>
<div class="ttc" id="classRuleMatcherState_html_a60ab63d142ee441993d60bebbf9f8f78"><div class="ttname"><a href="classRuleMatcherState.html#a60ab63d142ee441993d60bebbf9f8f78">RuleMatcherState::MatcherInitialized</a></div><div class="ttdeci">bool MatcherInitialized(bool orig)</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00392">RuleMatcher.h:392</a></div></div>
<div class="ttc" id="Sessions_8h_html"><div class="ttname"><a href="Sessions_8h.html">Sessions.h</a></div></div>
<div class="ttc" id="classRuleHdrTest_html_a28b15d5144360629eaf65b63a9721a2f"><div class="ttname"><a href="classRuleHdrTest.html#a28b15d5144360629eaf65b63a9721a2f">RuleHdrTest::comp</a></div><div class="ttdeci">Comp comp</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00096">RuleMatcher.h:96</a></div></div>
<div class="ttc" id="classRuleMatcher_html_a0ffc71bff29350fb8c31ca9ca4c9ca72"><div class="ttname"><a href="classRuleMatcher.html#a0ffc71bff29350fb8c31ca9ca4c9ca72">RuleMatcher::rules</a></div><div class="ttdeci">rule_list rules</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00369">RuleMatcher.h:369</a></div></div>
<div class="ttc" id="structRuleHdrTest_1_1PatternSet_html"><div class="ttname"><a href="structRuleHdrTest_1_1PatternSet.html">RuleHdrTest::PatternSet</a></div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00108">RuleMatcher.h:108</a></div></div>
<div class="ttc" id="RuleMatcher_8h_html_acb58f6b3697f0840e6c309b468bb7c2c"><div class="ttname"><a href="RuleMatcher_8h.html#acb58f6b3697f0840e6c309b468bb7c2c">id_to_str</a></div><div class="ttdeci">char * id_to_str(const char *id)</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8cc_source.html#l01362">RuleMatcher.cc:1362</a></div></div>
<div class="ttc" id="classVal_html"><div class="ttname"><a href="classVal.html">Val</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00078">Val.h:78</a></div></div>
<div class="ttc" id="structRuleFileMagicState_1_1Matcher_html"><div class="ttname"><a href="structRuleFileMagicState_1_1Matcher.html">RuleFileMagicState::Matcher</a></div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00211">RuleMatcher.h:211</a></div></div>
<div class="ttc" id="structRuleMatcher_1_1Stats_html_a4566926991c4328ad4da173a3eee3515"><div class="ttname"><a href="structRuleMatcher_1_1Stats.html#a4566926991c4328ad4da173a3eee3515">RuleMatcher::Stats::matchers</a></div><div class="ttdeci">unsigned int matchers</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00299">RuleMatcher.h:299</a></div></div>
<div class="ttc" id="classRuleMatcher_html_a9923ff5652e5bd73c1162b91023d7e1b"><div class="ttname"><a href="classRuleMatcher.html#a9923ff5652e5bd73c1162b91023d7e1b">RuleMatcher::root</a></div><div class="ttdeci">RuleHdrTest * root</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00368">RuleMatcher.h:368</a></div></div>
<div class="ttc" id="classRuleMatcher_html_abfe6c9de50e2fece5a7dab0a6557f526"><div class="ttname"><a href="classRuleMatcher.html#abfe6c9de50e2fece5a7dab0a6557f526">RuleMatcher::parse_error</a></div><div class="ttdeci">bool parse_error</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00367">RuleMatcher.h:367</a></div></div>
<div class="ttc" id="structRange_html_adf1a90d81c11e8de792f8b6dda0cc150"><div class="ttname"><a href="structRange.html#adf1a90d81c11e8de792f8b6dda0cc150">Range::len</a></div><div class="ttdeci">uint32 len</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00051">RuleMatcher.h:51</a></div></div>
<div class="ttc" id="structRuleMatcher_1_1Stats_html_a88a831686da948b4af6b862d0579fbb5"><div class="ttname"><a href="structRuleMatcher_1_1Stats.html#a88a831686da948b4af6b862d0579fbb5">RuleMatcher::Stats::hits</a></div><div class="ttdeci">unsigned int hits</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00310">RuleMatcher.h:310</a></div></div>
<div class="ttc" id="patricia_8c_html_a9651906e5d00d01c6e5406c7a74c8e97"><div class="ttname"><a href="patricia_8c.html#a9651906e5d00d01c6e5406c7a74c8e97">Delete</a></div><div class="ttdeci">#define Delete</div><div class="ttdef"><b>Definition:</b> <a href="patricia_8c_source.html#l00074">patricia.c:74</a></div></div>
<div class="ttc" id="classRuleMatcher_html_a8a076adde07f525e1a8d88d6e896a872"><div class="ttname"><a href="classRuleMatcher.html#a8a076adde07f525e1a8d88d6e896a872">RuleMatcher::RE_level</a></div><div class="ttdeci">int RE_level</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00366">RuleMatcher.h:366</a></div></div>
<div class="ttc" id="classRuleMatcher_html_a071e3f32f8230199f320df4f1e662268"><div class="ttname"><a href="classRuleMatcher.html#a071e3f32f8230199f320df4f1e662268">RuleMatcher::SetParseError</a></div><div class="ttdeci">void SetParseError()</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00295">RuleMatcher.h:295</a></div></div>
<div class="ttc" id="structRuleMatcher_1_1Stats_html_aa717d5f846282f510ee40009d8d2d05f"><div class="ttname"><a href="structRuleMatcher_1_1Stats.html#aa717d5f846282f510ee40009d8d2d05f">RuleMatcher::Stats::dfa_states</a></div><div class="ttdeci">unsigned int dfa_states</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00305">RuleMatcher.h:305</a></div></div>
<div class="ttc" id="classRuleHdrTest_html_a831f08cbc6af3f073292f3964178a9bd"><div class="ttname"><a href="classRuleHdrTest.html#a831f08cbc6af3f073292f3964178a9bd">RuleHdrTest::prefix_vals</a></div><div class="ttdeci">vector&lt; IPPrefix &gt; prefix_vals</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00098">RuleMatcher.h:98</a></div></div>
<div class="ttc" id="structRuleMatcher_1_1Stats_html_a71fb09fa2760caa98ee9c79ea5277b65"><div class="ttname"><a href="structRuleMatcher_1_1Stats.html#a71fb09fa2760caa98ee9c79ea5277b65">RuleMatcher::Stats::computed</a></div><div class="ttdeci">unsigned int computed</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00306">RuleMatcher.h:306</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html">analyzer::Analyzer</a></div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8h_source.html#l00076">Analyzer.h:76</a></div></div>
<div class="ttc" id="classBroString_html"><div class="ttname"><a href="classBroString.html">BroString</a></div><div class="ttdef"><b>Definition:</b> <a href="BroString_8h_source.html#l00022">BroString.h:22</a></div></div>
<div class="ttc" id="RuleMatcher_8h_html_a10fbb3490c5f357165687b523e16ae66"><div class="ttname"><a href="RuleMatcher_8h.html#a10fbb3490c5f357165687b523e16ae66">rules_line_number</a></div><div class="ttdeci">int rules_line_number</div></div>
<div class="ttc" id="structRuleMatcher_1_1Stats_html"><div class="ttname"><a href="structRuleMatcher_1_1Stats.html">RuleMatcher::Stats</a></div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00298">RuleMatcher.h:298</a></div></div>
<div class="ttc" id="classRuleEndpointState_html_a8dca8bfa8584aa012e7a600b9e9cd07d"><div class="ttname"><a href="classRuleEndpointState.html#a8dca8bfa8584aa012e7a600b9e9cd07d">RuleEndpointState::FlipIsOrig</a></div><div class="ttdeci">void FlipIsOrig()</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00152">RuleMatcher.h:152</a></div></div>
<div class="ttc" id="classIPPrefix_html"><div class="ttname"><a href="classIPPrefix.html">IPPrefix</a></div><div class="ttdef"><b>Definition:</b> <a href="IPAddr_8h_source.html#l00458">IPAddr.h:458</a></div></div>
<div class="ttc" id="classRuleEndpointState_html_a179243cbca696565235739505e52c94a"><div class="ttname"><a href="classRuleEndpointState.html#a179243cbca696565235739505e52c94a">RuleEndpointState::GetAnalyzer</a></div><div class="ttdeci">analyzer::Analyzer * GetAnalyzer() const </div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00148">RuleMatcher.h:148</a></div></div>
<div class="ttc" id="classRuleMatcherState_html_a3de9c985d3e56de2d6ecb7dd6ff5ce5b"><div class="ttname"><a href="classRuleMatcherState.html#a3de9c985d3e56de2d6ecb7dd6ff5ce5b">RuleMatcherState::orig_match_state</a></div><div class="ttdeci">RuleEndpointState * orig_match_state</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00396">RuleMatcher.h:396</a></div></div>
<div class="ttc" id="classRuleEndpointState_html_a9182e8c2d630b20be0f84f87663c47c0"><div class="ttname"><a href="classRuleEndpointState.html#a9182e8c2d630b20be0f84f87663c47c0">RuleEndpointState::IsOrig</a></div><div class="ttdeci">bool IsOrig()</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00149">RuleMatcher.h:149</a></div></div>
<div class="ttc" id="RuleCondition_8h_html"><div class="ttname"><a href="RuleCondition_8h.html">RuleCondition.h</a></div></div>
<div class="ttc" id="Rule_8h_html"><div class="ttname"><a href="Rule_8h.html">Rule.h</a></div></div>
<div class="ttc" id="structMaskedValue_html"><div class="ttname"><a href="structMaskedValue.html">MaskedValue</a></div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00054">RuleMatcher.h:54</a></div></div>
<div class="ttc" id="classRuleHdrTest_html"><div class="ttname"><a href="classRuleHdrTest.html">RuleHdrTest</a></div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00073">RuleMatcher.h:73</a></div></div>
<div class="ttc" id="classRuleEndpointState_html"><div class="ttname"><a href="classRuleEndpointState.html">RuleEndpointState</a></div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00144">RuleMatcher.h:144</a></div></div>
<div class="ttc" id="structRuleHdrTest_1_1PatternSet_html_a34d7edc8e79f4dfaff6baaf2911aeea5"><div class="ttname"><a href="structRuleHdrTest_1_1PatternSet.html#a34d7edc8e79f4dfaff6baaf2911aeea5">RuleHdrTest::PatternSet::ids</a></div><div class="ttdeci">int_list ids</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00119">RuleMatcher.h:119</a></div></div>
<div class="ttc" id="structRuleMatcher_1_1Stats_html_a41fe20f3c1c0004fd8dad48d3e27b1bb"><div class="ttname"><a href="structRuleMatcher_1_1Stats.html#a41fe20f3c1c0004fd8dad48d3e27b1bb">RuleMatcher::Stats::mem</a></div><div class="ttdeci">unsigned int mem</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00307">RuleMatcher.h:307</a></div></div>
<div class="ttc" id="classRuleFileMagicState_html"><div class="ttname"><a href="classRuleFileMagicState.html">RuleFileMagicState</a></div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00200">RuleMatcher.h:200</a></div></div>
<div class="ttc" id="classIntSet_html"><div class="ttname"><a href="classIntSet.html">IntSet</a></div><div class="ttdef"><b>Definition:</b> <a href="IntSet_8h_source.html#l00012">IntSet.h:12</a></div></div>
<div class="ttc" id="BroString_8h_html"><div class="ttname"><a href="BroString_8h.html">BroString.h</a></div></div>
<div class="ttc" id="structRuleEndpointState_1_1Matcher_html_a748c847cadea93af94e21f64476c1e87"><div class="ttname"><a href="structRuleEndpointState_1_1Matcher.html#a748c847cadea93af94e21f64476c1e87">RuleEndpointState::Matcher::state</a></div><div class="ttdeci">RE_Match_State * state</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00171">RuleMatcher.h:171</a></div></div>
<div class="ttc" id="classRuleMatcher_html"><div class="ttname"><a href="classRuleMatcher.html">RuleMatcher</a></div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00225">RuleMatcher.h:225</a></div></div>
<div class="ttc" id="TunnelEncapsulation_8cc_html_a6204510415c806e49d259ee40b2a6979"><div class="ttname"><a href="TunnelEncapsulation_8cc.html#a6204510415c806e49d259ee40b2a6979">operator==</a></div><div class="ttdeci">bool operator==(const EncapsulationStack &amp;e1, const EncapsulationStack &amp;e2)</div><div class="ttdef"><b>Definition:</b> <a href="TunnelEncapsulation_8cc_source.html#l00036">TunnelEncapsulation.cc:36</a></div></div>
<div class="ttc" id="classRuleMatcherState_html"><div class="ttname"><a href="classRuleMatcherState.html">RuleMatcherState</a></div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00374">RuleMatcher.h:374</a></div></div>
<div class="ttc" id="classRuleHdrTest_html_adee0037d6ae409db790dfc003b996fdeac54d71699e449c56d83d9f8aa674bba6"><div class="ttname"><a href="classRuleHdrTest.html#adee0037d6ae409db790dfc003b996fdeac54d71699e449c56d83d9f8aa674bba6">RuleHdrTest::UDP</a></div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00077">RuleMatcher.h:77</a></div></div>
<div class="ttc" id="RE_8h_html_aa8d7fd9597f5e3d28d18796a24e7a7f8"><div class="ttname"><a href="RE_8h.html#aa8d7fd9597f5e3d28d18796a24e7a7f8">string_list</a></div><div class="ttdeci">name_list string_list</div><div class="ttdef"><b>Definition:</b> <a href="RE_8h_source.html#l00043">RE.h:43</a></div></div>
<div class="ttc" id="IPAddr_8h_html"><div class="ttname"><a href="IPAddr_8h.html">IPAddr.h</a></div></div>
<div class="ttc" id="RE_8h_html"><div class="ttname"><a href="RE_8h.html">RE.h</a></div></div>
<div class="ttc" id="classRE__Match__State_html"><div class="ttname"><a href="classRE__Match__State.html">RE_Match_State</a></div><div class="ttdef"><b>Definition:</b> <a href="RE_8h_source.html#l00136">RE.h:136</a></div></div>
<div class="ttc" id="classRuleHdrTest_html_ab77783d2da4d41e1ccdf9c1cd4d935d7"><div class="ttname"><a href="classRuleHdrTest.html#ab77783d2da4d41e1ccdf9c1cd4d935d7">RuleHdrTest::offset</a></div><div class="ttdeci">uint32 offset</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00099">RuleMatcher.h:99</a></div></div>
<div class="ttc" id="classIP__Hdr_html"><div class="ttname"><a href="classIP__Hdr.html">IP_Hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00339">IP.h:339</a></div></div>
<div class="ttc" id="structRuleMatcher_1_1Stats_html_a1a85846a39c1c52029d64d40f1b0f6f0"><div class="ttname"><a href="structRuleMatcher_1_1Stats.html#a1a85846a39c1c52029d64d40f1b0f6f0">RuleMatcher::Stats::nfa_states</a></div><div class="ttdeci">unsigned int nfa_states</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00302">RuleMatcher.h:302</a></div></div>
<div class="ttc" id="RE_8h_html_aaf361125d207c1db082cc5e3eaa2d704"><div class="ttname"><a href="RE_8h.html#aaf361125d207c1db082cc5e3eaa2d704">AcceptingMatchSet</a></div><div class="ttdeci">std::map&lt; AcceptIdx, MatchPos &gt; AcceptingMatchSet</div><div class="ttdef"><b>Definition:</b> <a href="RE_8h_source.html#l00042">RE.h:42</a></div></div>
<div class="ttc" id="structRuleMatcher_1_1Stats_html_a6d6022726fccedb36f6a5cdbf5570536"><div class="ttname"><a href="structRuleMatcher_1_1Stats.html#a6d6022726fccedb36f6a5cdbf5570536">RuleMatcher::Stats::misses</a></div><div class="ttdeci">unsigned int misses</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00311">RuleMatcher.h:311</a></div></div>
<div class="ttc" id="classRuleMatcherState_html_a1137d108455ff096208ca755d321117e"><div class="ttname"><a href="classRuleMatcherState.html#a1137d108455ff096208ca755d321117e">RuleMatcherState::resp_match_state</a></div><div class="ttdeci">RuleEndpointState * resp_match_state</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00397">RuleMatcher.h:397</a></div></div>
<div class="ttc" id="classRuleMatcher_html_ab323fb6a6dbc55fbb4c291555256d16a"><div class="ttname"><a href="classRuleMatcher.html#ab323fb6a6dbc55fbb4c291555256d16a">RuleMatcher::rules_by_id</a></div><div class="ttdeci">rule_dict rules_by_id</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00370">RuleMatcher.h:370</a></div></div>
<div class="ttc" id="structMaskedValue_html_a674b1d0c56a5fdf2e47ece316a1bc1a3"><div class="ttname"><a href="structMaskedValue.html#a674b1d0c56a5fdf2e47ece316a1bc1a3">MaskedValue::val</a></div><div class="ttdeci">uint32 val</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00055">RuleMatcher.h:55</a></div></div>
<div class="ttc" id="classRuleEndpointState_html_aa3380f496419b48084e145aa758b91a1"><div class="ttname"><a href="classRuleEndpointState.html#aa3380f496419b48084e145aa758b91a1">RuleEndpointState::PayloadSize</a></div><div class="ttdeci">int PayloadSize()</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00158">RuleMatcher.h:158</a></div></div>
<div class="ttc" id="classRule_html_af6be8dfd23098aad37f3cd0188a0953b"><div class="ttname"><a href="classRule.html#af6be8dfd23098aad37f3cd0188a0953b">Rule::PatternType</a></div><div class="ttdeci">PatternType</div><div class="ttdef"><b>Definition:</b> <a href="Rule_8h_source.html#l00039">Rule.h:39</a></div></div>
<div class="ttc" id="classRuleHdrTest_html_adee0037d6ae409db790dfc003b996fde"><div class="ttname"><a href="classRuleHdrTest.html#adee0037d6ae409db790dfc003b996fde">RuleHdrTest::Prot</a></div><div class="ttdeci">Prot</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00077">RuleMatcher.h:77</a></div></div>
<div class="ttc" id="RE_8h_html_a6a89be77ff62090e59b6a7563f624fae"><div class="ttname"><a href="RE_8h.html#a6a89be77ff62090e59b6a7563f624fae">MatchPos</a></div><div class="ttdeci">uint64 MatchPos</div><div class="ttdef"><b>Definition:</b> <a href="RE_8h_source.html#l00041">RE.h:41</a></div></div>
<div class="ttc" id="Net_8h_html"><div class="ttname"><a href="Net_8h.html">Net.h</a></div></div>
<div class="ttc" id="util_8h_html"><div class="ttname"><a href="util_8h.html">util.h</a></div></div>
<div class="ttc" id="RuleMatcher_8h_html_aba320856f004abe5d3912a21687c7c74"><div class="ttname"><a href="RuleMatcher_8h.html#aba320856f004abe5d3912a21687c7c74">rules_error</a></div><div class="ttdeci">void rules_error(const char *msg)</div></div>
<div class="ttc" id="structRuleFileMagicState_1_1Matcher_html_ac2e6601d826da69a594e02c90435383a"><div class="ttname"><a href="structRuleFileMagicState_1_1Matcher.html#ac2e6601d826da69a594e02c90435383a">RuleFileMagicState::Matcher::state</a></div><div class="ttdeci">RE_Match_State * state</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00212">RuleMatcher.h:212</a></div></div>
<div class="ttc" id="classRule_html"><div class="ttname"><a href="classRule.html">Rule</a></div><div class="ttdef"><b>Definition:</b> <a href="Rule_8h_source.html#l00023">Rule.h:23</a></div></div>
<div class="ttc" id="RuleMatcher_8h_html_afe39929906311df2864bb6b2df71e727"><div class="ttname"><a href="RuleMatcher_8h.html#afe39929906311df2864bb6b2df71e727">rules_wrap</a></div><div class="ttdeci">int rules_wrap(void)</div></div>
<div class="ttc" id="List_8h_html"><div class="ttname"><a href="List_8h.html">List.h</a></div></div>
<div class="ttc" id="structRuleHdrTest_1_1PatternSet_html_a24e10d24dd19b565bc025a8c576e230f"><div class="ttname"><a href="structRuleHdrTest_1_1PatternSet.html#a24e10d24dd19b565bc025a8c576e230f">RuleHdrTest::PatternSet::re</a></div><div class="ttdeci">Specific_RE_Matcher * re</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00115">RuleMatcher.h:115</a></div></div>
<div class="ttc" id="net__util_8h_html_a96479ca74ca88f0e2aafab1d9b23721eaee0722baf12a9db075fb08d0734710a6"><div class="ttname"><a href="net__util_8h.html#a96479ca74ca88f0e2aafab1d9b23721eaee0722baf12a9db075fb08d0734710a6">IPv6</a></div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00013">net_util.h:13</a></div></div>
<div class="ttc" id="structRange_html_a2a8098044f074a947557c9d0c9a8fbff"><div class="ttname"><a href="structRange.html#a2a8098044f074a947557c9d0c9a8fbff">Range::offset</a></div><div class="ttdeci">uint32 offset</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00050">RuleMatcher.h:50</a></div></div>
<div class="ttc" id="RuleMatcher_8h_html_adf386e7f4ee0238d62b60663b909f7fb"><div class="ttname"><a href="RuleMatcher_8h.html#adf386e7f4ee0238d62b60663b909f7fb">current_rule_file</a></div><div class="ttdeci">const char * current_rule_file</div></div>
<div class="ttc" id="classRuleHdrTest_html_a8710fad3b56b7adcc9590cc7f97f1a3e"><div class="ttname"><a href="classRuleHdrTest.html#a8710fad3b56b7adcc9590cc7f97f1a3e">RuleHdrTest::size</a></div><div class="ttdeci">uint32 size</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00100">RuleMatcher.h:100</a></div></div>
<div class="ttc" id="structRuleEndpointState_1_1Matcher_html"><div class="ttname"><a href="structRuleEndpointState_1_1Matcher.html">RuleEndpointState::Matcher</a></div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00170">RuleMatcher.h:170</a></div></div>
<div class="ttc" id="classanalyzer_1_1pia_1_1PIA_html"><div class="ttname"><a href="classanalyzer_1_1pia_1_1PIA.html">analyzer::pia::PIA</a></div><div class="ttdef"><b>Definition:</b> <a href="PIA_8h_source.html#l00020">PIA.h:20</a></div></div>
<div class="ttc" id="structRange_html"><div class="ttname"><a href="structRange.html">Range</a></div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00049">RuleMatcher.h:49</a></div></div>
<div class="ttc" id="structRuleEndpointState_1_1Matcher_html_a6941699610347f0a5f59389db3d628db"><div class="ttname"><a href="structRuleEndpointState_1_1Matcher.html#a6941699610347f0a5f59389db3d628db">RuleEndpointState::Matcher::type</a></div><div class="ttdeci">Rule::PatternType type</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00172">RuleMatcher.h:172</a></div></div>
<div class="ttc" id="classRuleHdrTest_html_a6960fe7f85dd89b64c4979f915cae772"><div class="ttname"><a href="classRuleHdrTest.html#a6960fe7f85dd89b64c4979f915cae772">RuleHdrTest::id</a></div><div class="ttdeci">uint32 id</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00102">RuleMatcher.h:102</a></div></div>
<div class="ttc" id="util_8h_html_acbd4acd0d29e2d6c43104827f77d9cd2"><div class="ttname"><a href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00064">util.h:64</a></div></div>
<div class="ttc" id="classRuleMatcherState_html_a679805b847ed4cf3c1c5b80969673e28"><div class="ttname"><a href="classRuleMatcherState.html#a679805b847ed4cf3c1c5b80969673e28">RuleMatcherState::~RuleMatcherState</a></div><div class="ttdeci">~RuleMatcherState()</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00377">RuleMatcher.h:377</a></div></div>
<div class="ttc" id="classRuleMatcherState_html_aed5c9ddd1a7c62836659474b331b069a"><div class="ttname"><a href="classRuleMatcherState.html#aed5c9ddd1a7c62836659474b331b069a">RuleMatcherState::RuleMatcherState</a></div><div class="ttdeci">RuleMatcherState()</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00376">RuleMatcher.h:376</a></div></div>
<div class="ttc" id="structMaskedValue_html_a13cddc322e5df867780c64f5f2538dfa"><div class="ttname"><a href="structMaskedValue.html#a13cddc322e5df867780c64f5f2538dfa">MaskedValue::mask</a></div><div class="ttdeci">uint32 mask</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00056">RuleMatcher.h:56</a></div></div>
<div class="ttc" id="RuleMatcher_8h_html_a92dbdfcf82f9407f1f0d0f4d46f16990"><div class="ttname"><a href="RuleMatcher_8h.html#a92dbdfcf82f9407f1f0d0f4d46f16990">rules_in</a></div><div class="ttdeci">FILE * rules_in</div></div>
<div class="ttc" id="classRuleEndpointState_html_a83b23cb7d32ce038111480a0f8643281"><div class="ttname"><a href="classRuleEndpointState.html#a83b23cb7d32ce038111480a0f8643281">RuleEndpointState::PIA</a></div><div class="ttdeci">analyzer::pia::PIA * PIA() const </div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00160">RuleMatcher.h:160</a></div></div>
<div class="ttc" id="util_8h_html_abc0f5bc07737e498f287334775dff2b6"><div class="ttname"><a href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a></div><div class="ttdeci">uint64_t uint64</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00063">util.h:63</a></div></div>
<div class="ttc" id="structRuleHdrTest_1_1PatternSet_html_a541fb392788a405bb08c3e8ba1cd2453"><div class="ttname"><a href="structRuleHdrTest_1_1PatternSet.html#a541fb392788a405bb08c3e8ba1cd2453">RuleHdrTest::PatternSet::PatternSet</a></div><div class="ttdeci">PatternSet()</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00109">RuleMatcher.h:109</a></div></div>
<div class="ttc" id="RuleAction_8h_html"><div class="ttname"><a href="RuleAction_8h.html">RuleAction.h</a></div></div>
<div class="ttc" id="RuleMatcher_8h_html_aa1bb2362d6e2f40cc8987b7b84e7b382"><div class="ttname"><a href="RuleMatcher_8h.html#aa1bb2362d6e2f40cc8987b7b84e7b382">PList</a></div><div class="ttdeci">typedef PList(MaskedValue) maskedvalue_list</div></div>
<div class="ttc" id="RuleMatcher_8h_html_ab439ed8d6aeda04ac031a22ba741b04e"><div class="ttname"><a href="RuleMatcher_8h.html#ab439ed8d6aeda04ac031a22ba741b04e">rule_matcher</a></div><div class="ttdeci">RuleMatcher * rule_matcher</div><div class="ttdef"><b>Definition:</b> <a href="main_8cc_source.html#l00102">main.cc:102</a></div></div>
<div class="ttc" id="classRuleMatcher_html_ac5e25e5dd0cf45aa324cc5e01b98f7eb"><div class="ttname"><a href="classRuleMatcher.html#ac5e25e5dd0cf45aa324cc5e01b98f7eb">RuleMatcher::MIME_Matches</a></div><div class="ttdeci">map&lt; int, set&lt; string &gt;, std::greater&lt; int &gt; &gt; MIME_Matches</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00247">RuleMatcher.h:247</a></div></div>
<div class="ttc" id="classSpecific__RE__Matcher_html"><div class="ttname"><a href="classSpecific__RE__Matcher.html">Specific_RE_Matcher</a></div><div class="ttdef"><b>Definition:</b> <a href="RE_8h_source.html#l00050">RE.h:50</a></div></div>
<div class="ttc" id="classRuleHdrTest_html_aaa9e3398a3b4b8dafe980a6e0b023fdc"><div class="ttname"><a href="classRuleHdrTest.html#aaa9e3398a3b4b8dafe980a6e0b023fdc">RuleHdrTest::idcounter</a></div><div class="ttdeci">static uint32 idcounter</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00103">RuleMatcher.h:103</a></div></div>
<div class="ttc" id="RuleMatcher_8h_html_a3124b33d34cf0b1ef275a2c7607c3618"><div class="ttname"><a href="RuleMatcher_8h.html#a3124b33d34cf0b1ef275a2c7607c3618">declare</a></div><div class="ttdeci">declare(PList, MaskedValue)</div></div>
<div class="ttc" id="classBroFile_html"><div class="ttname"><a href="classBroFile.html">BroFile</a></div><div class="ttdef"><b>Definition:</b> <a href="File_8h_source.html#l00023">File.h:23</a></div></div>
<div class="ttc" id="classRuleFileMagicState_html_aabea49b6feab4c3046b64c7ae4fa4645"><div class="ttname"><a href="classRuleFileMagicState.html#aabea49b6feab4c3046b64c7ae4fa4645">RuleFileMagicState::RuleFileMagicState</a></div><div class="ttdeci">RuleFileMagicState()</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00208">RuleMatcher.h:208</a></div></div>
<div class="ttc" id="structRuleHdrTest_1_1PatternSet_html_abae87d60797230671cbafc4ae26c7919"><div class="ttname"><a href="structRuleHdrTest_1_1PatternSet.html#abae87d60797230671cbafc4ae26c7919">RuleHdrTest::PatternSet::patterns</a></div><div class="ttdeci">string_list patterns</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00118">RuleMatcher.h:118</a></div></div>
<div class="ttc" id="classRuleHdrTest_html_ad9b0e83b202d0e8d08e2a06f8f09234a"><div class="ttname"><a href="classRuleHdrTest.html#ad9b0e83b202d0e8d08e2a06f8f09234a">RuleHdrTest::Comp</a></div><div class="ttdeci">Comp</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00076">RuleMatcher.h:76</a></div></div>
<div class="ttc" id="namespaceanalyzer_html"><div class="ttname"><a href="namespaceanalyzer.html">analyzer</a></div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00012">Analyzer.cc:12</a></div></div>
<div class="ttc" id="RuleMatcher_8h_html_a1f5f7e58e3e693f922a69034e045cbfb"><div class="ttname"><a href="RuleMatcher_8h.html#a1f5f7e58e3e693f922a69034e045cbfb">id_to_uint</a></div><div class="ttdeci">uint32 id_to_uint(const char *id)</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8cc_source.html#l01388">RuleMatcher.cc:1388</a></div></div>
<div class="ttc" id="classRuleHdrTest_html_a775906677daac67f84e32a0df2ea9df7"><div class="ttname"><a href="classRuleHdrTest.html#a775906677daac67f84e32a0df2ea9df7">RuleHdrTest::prot</a></div><div class="ttdeci">Prot prot</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00095">RuleMatcher.h:95</a></div></div>
<div class="ttc" id="IntSet_8h_html"><div class="ttname"><a href="IntSet_8h.html">IntSet.h</a></div></div>
<div class="ttc" id="classRuleHdrTest_html_abfd9ce02de6679d7f40fbe5b25484280"><div class="ttname"><a href="classRuleHdrTest.html#abfd9ce02de6679d7f40fbe5b25484280">RuleHdrTest::vals</a></div><div class="ttdeci">maskedvalue_list * vals</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00097">RuleMatcher.h:97</a></div></div>
<div class="ttc" id="RuleMatcher_8h_html_ac01bbc7dd6191022829199dd984ec90f"><div class="ttname"><a href="RuleMatcher_8h.html#ac01bbc7dd6191022829199dd984ec90f">id_to_maskedvallist</a></div><div class="ttdeci">void id_to_maskedvallist(const char *id, maskedvalue_list *append_to, vector&lt; IPPrefix &gt; *prefix_vector=0)</div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8cc_source.html#l01337">RuleMatcher.cc:1337</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
