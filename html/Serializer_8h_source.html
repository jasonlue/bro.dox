<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>bro: /home/jasonlu/bro/src/Serializer.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">bro
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5b988f0c4d1fda8dce2b23100e7167dd.html">bro</a></li><li class="navelem"><a class="el" href="dir_1ae927ab70ca550cfc88d2a3fb3c22b4.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Serializer.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="Serializer_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef SERIALIZER_H</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define SERIALIZER_H</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;list&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;pcap.h&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ID_8h.html">ID.h</a>&quot;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="List_8h.html">List.h</a>&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Expr_8h.html">Expr.h</a>&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ChunkedIO_8h.html">ChunkedIO.h</a>&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SerializationFormat_8h.html">SerializationFormat.h</a>&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="StateAccess_8h.html">StateAccess.h</a>&quot;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PriorityQueue_8h.html">PriorityQueue.h</a>&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SerialInfo_8h.html">SerialInfo.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IP_8h.html">IP.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Timer_8h.html">Timer.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IOSource_8h.html">iosource/IOSource.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Reporter_8h.html">Reporter.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">class </span><a class="code" href="classSerializationCache.html">SerializationCache</a>;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">class </span><a class="code" href="classSerialInfo.html">SerialInfo</a>;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">class </span><a class="code" href="classConnection.html">Connection</a>;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">class </span><a class="code" href="classTimer.html">Timer</a>;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">class </span><a class="code" href="classPacket.html">Packet</a>;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="classSerializer.html">   28</a></span>&#160;<span class="keyword">class </span><a class="code" href="classSerializer.html">Serializer</a> {</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">// Currently ID serialization is the only method which may suspend.</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#a73d02b8e8ae0a9a51f1b4e538acea136">Serialize</a>(<a class="code" href="classSerialInfo.html">SerialInfo</a>* info, <span class="keyword">const</span> <a class="code" href="classID.html">ID</a>&amp; <span class="keywordtype">id</span>);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#a73d02b8e8ae0a9a51f1b4e538acea136">Serialize</a>(<a class="code" href="classSerialInfo.html">SerialInfo</a>* info, <span class="keyword">const</span> <span class="keywordtype">char</span>* func, val_list* args);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#a73d02b8e8ae0a9a51f1b4e538acea136">Serialize</a>(<a class="code" href="classSerialInfo.html">SerialInfo</a>* info, <span class="keyword">const</span> <a class="code" href="classStateAccess.html">StateAccess</a>&amp; s);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#a73d02b8e8ae0a9a51f1b4e538acea136">Serialize</a>(<a class="code" href="classSerialInfo.html">SerialInfo</a>* info, <span class="keyword">const</span> <a class="code" href="classConnection.html">Connection</a>&amp; c);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#a73d02b8e8ae0a9a51f1b4e538acea136">Serialize</a>(<a class="code" href="classSerialInfo.html">SerialInfo</a>* info, <span class="keyword">const</span> <a class="code" href="classTimer.html">Timer</a>&amp; t);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#a73d02b8e8ae0a9a51f1b4e538acea136">Serialize</a>(<a class="code" href="classSerialInfo.html">SerialInfo</a>* info, <span class="keyword">const</span> <a class="code" href="classPacket.html">Packet</a>&amp; p);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">// Access to the current cache.</span></div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="classSerializer.html#af45a3e5590622abacd3c8352a3928e10">   39</a></span>&#160;    <a class="code" href="classSerializationCache.html">SerializationCache</a>* <a class="code" href="classSerializer.html#af45a3e5590622abacd3c8352a3928e10">Cache</a>() { <span class="keywordflow">return</span> <a class="code" href="classSerializer.html#a2338c655ac88c6f240c1172117430a8d">current_cache</a>; }</div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="classSerializer.html#a9f02b4bc92751aab0ac5b490de9c8cc6">   40</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#a9f02b4bc92751aab0ac5b490de9c8cc6">SetCache</a>(<a class="code" href="classSerializationCache.html">SerializationCache</a>* cache)</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        { <a class="code" href="classSerializer.html#a2338c655ac88c6f240c1172117430a8d">current_cache</a> = cache; }</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// Input/output methods.</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="Serializer_8h.html#ac37b1978ee99d84138e1dde20cbf08f7">   45</a></span>&#160;<span class="preprocessor">#define DECLARE_READ(type) \</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">    bool Read(type* v, const char* tag) { return format-&gt;Read(v, tag); }</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="Serializer_8h.html#ae6285c6cf3ea096d93785ed0e2b165d8">   48</a></span>&#160;<span class="preprocessor">#define DECLARE_WRITE(type) \</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">    bool Write(type v, const char* tag) \</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">        { return format-&gt;Write(v, tag); }</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="Serializer_8h.html#af24cd2e9bbf8d1ee6a2a9c191328be2d">   52</a></span>&#160;<span class="preprocessor">#define DECLARE_IO(type)    \</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">    DECLARE_READ(type)  \</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">    DECLARE_WRITE(type)</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="Serializer_8h.html#af24cd2e9bbf8d1ee6a2a9c191328be2d">DECLARE_IO</a>(<span class="keywordtype">int</span>)</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="Serializer_8h.html#af24cd2e9bbf8d1ee6a2a9c191328be2d">DECLARE_IO</a>(<a class="code" href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a>)</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="Serializer_8h.html#af24cd2e9bbf8d1ee6a2a9c191328be2d">DECLARE_IO</a>(<a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>)</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="Serializer_8h.html#af24cd2e9bbf8d1ee6a2a9c191328be2d">DECLARE_IO</a>(<a class="code" href="util_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a>)</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="Serializer_8h.html#af24cd2e9bbf8d1ee6a2a9c191328be2d">DECLARE_IO</a>(<a class="code" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a>)</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="Serializer_8h.html#af24cd2e9bbf8d1ee6a2a9c191328be2d">DECLARE_IO</a>(<span class="keywordtype">char</span>)</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="Serializer_8h.html#af24cd2e9bbf8d1ee6a2a9c191328be2d">DECLARE_IO</a>(<span class="keywordtype">bool</span>)</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="Serializer_8h.html#af24cd2e9bbf8d1ee6a2a9c191328be2d">DECLARE_IO</a>(<span class="keywordtype">double</span>)</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="classSerializer.html#a26c3e430fa36b5ee921e619e349111e6">   65</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#a26c3e430fa36b5ee921e619e349111e6">Read</a>(<span class="keywordtype">char</span>** str, <span class="keywordtype">int</span>* len, const <span class="keywordtype">char</span>* tag)</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        { <span class="keywordflow">return</span> <a class="code" href="classSerializer.html#a14d43ffbf27d3b4fc1a797ddc73ed989">format</a>-&gt;<a class="code" href="classSerializationFormat.html#a4497cf41ed1a6521207c63e2f3a126c7">Read</a>(str, len, tag); }</div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="classSerializer.html#a74cdbbb980f93270dce39b65fe1e2983">   67</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#a74cdbbb980f93270dce39b65fe1e2983">Read</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>** str, <span class="keywordtype">int</span>* len, <span class="keyword">const</span> <span class="keywordtype">char</span>* tag)</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="comment">// This cast is ok.</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        { <span class="keywordflow">return</span> <a class="code" href="classSerializer.html#a14d43ffbf27d3b4fc1a797ddc73ed989">format</a>-&gt;<a class="code" href="classSerializationFormat.html#a4497cf41ed1a6521207c63e2f3a126c7">Read</a>(const_cast&lt;char**&gt;(str), len, tag); }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#a26c3e430fa36b5ee921e619e349111e6">Read</a>(<span class="keywordtype">string</span>* s, <span class="keyword">const</span> <span class="keywordtype">char</span>* tag);</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="classSerializer.html#a1c53bf6b442e4d7c357b40d5d3aa2269">   72</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#a1c53bf6b442e4d7c357b40d5d3aa2269">Read</a>(<a class="code" href="classIPAddr.html">IPAddr</a>* a, <span class="keyword">const</span> <span class="keywordtype">char</span>* tag)   { <span class="keywordflow">return</span> <a class="code" href="classSerializer.html#a14d43ffbf27d3b4fc1a797ddc73ed989">format</a>-&gt;<a class="code" href="classSerializationFormat.html#a4497cf41ed1a6521207c63e2f3a126c7">Read</a>(a, tag); }</div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="classSerializer.html#ab3c01c59a97a98d832c58a1373ae2da0">   73</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#ab3c01c59a97a98d832c58a1373ae2da0">Read</a>(<a class="code" href="classIPPrefix.html">IPPrefix</a>* p, <span class="keyword">const</span> <span class="keywordtype">char</span>* tag) { <span class="keywordflow">return</span> <a class="code" href="classSerializer.html#a14d43ffbf27d3b4fc1a797ddc73ed989">format</a>-&gt;<a class="code" href="classSerializationFormat.html#a4497cf41ed1a6521207c63e2f3a126c7">Read</a>(p, tag); }</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="classSerializer.html#ad4632c86c14641a7c1e95218a766857f">   75</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#ad4632c86c14641a7c1e95218a766857f">Write</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* s, <span class="keyword">const</span> <span class="keywordtype">char</span>* tag)</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        { <span class="keywordflow">return</span> <a class="code" href="classSerializer.html#a14d43ffbf27d3b4fc1a797ddc73ed989">format</a>-&gt;<a class="code" href="classSerializationFormat.html#a9d123970506445e8df1ca473ff76c5c9">Write</a>(s, tag); }</div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="classSerializer.html#af85cacacb31d93c2c20d411e524fc812">   77</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#af85cacacb31d93c2c20d411e524fc812">Write</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* buf, <span class="keywordtype">int</span> len, <span class="keyword">const</span> <span class="keywordtype">char</span>* tag)</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        { <span class="keywordflow">return</span> <a class="code" href="classSerializer.html#a14d43ffbf27d3b4fc1a797ddc73ed989">format</a>-&gt;<a class="code" href="classSerializationFormat.html#a9d123970506445e8df1ca473ff76c5c9">Write</a>(buf, len, tag); }</div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="classSerializer.html#afe54eb18bd33a0f01405356bedf43fb8">   79</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#afe54eb18bd33a0f01405356bedf43fb8">Write</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; s, <span class="keyword">const</span> <span class="keywordtype">char</span>* tag)</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        { <span class="keywordflow">return</span> <a class="code" href="classSerializer.html#a14d43ffbf27d3b4fc1a797ddc73ed989">format</a>-&gt;<a class="code" href="classSerializationFormat.html#a9d123970506445e8df1ca473ff76c5c9">Write</a>(s.data(), s.size(), tag); }</div><div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="classSerializer.html#ab88f3d44125bc2c650e846b69bbded23">   81</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#ab88f3d44125bc2c650e846b69bbded23">Write</a>(<span class="keyword">const</span> <a class="code" href="classIPAddr.html">IPAddr</a>&amp; a, <span class="keyword">const</span> <span class="keywordtype">char</span>* tag)    { <span class="keywordflow">return</span> <a class="code" href="classSerializer.html#a14d43ffbf27d3b4fc1a797ddc73ed989">format</a>-&gt;<a class="code" href="classSerializationFormat.html#a9d123970506445e8df1ca473ff76c5c9">Write</a>(a, tag); }</div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="classSerializer.html#afa129a62ce54e608bacd2ebb430d760a">   82</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#afa129a62ce54e608bacd2ebb430d760a">Write</a>(<span class="keyword">const</span> <a class="code" href="classIPPrefix.html">IPPrefix</a>&amp; p, <span class="keyword">const</span> <span class="keywordtype">char</span>* tag)  { <span class="keywordflow">return</span> <a class="code" href="classSerializer.html#a14d43ffbf27d3b4fc1a797ddc73ed989">format</a>-&gt;<a class="code" href="classSerializationFormat.html#a9d123970506445e8df1ca473ff76c5c9">Write</a>(p, tag); }</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="classSerializer.html#a81ef0512e3a7a40ea163ff583c03f576">   84</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#a81ef0512e3a7a40ea163ff583c03f576">WriteOpenTag</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* tag)</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        { <span class="keywordflow">return</span> <a class="code" href="classSerializer.html#a14d43ffbf27d3b4fc1a797ddc73ed989">format</a>-&gt;<a class="code" href="classSerializationFormat.html#a8b50e6cb4a85bbd09f4c595c158905cc">WriteOpenTag</a>(tag); }</div><div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="classSerializer.html#af72408415174bb4d39e049dd3b5df465">   86</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#af72408415174bb4d39e049dd3b5df465">WriteCloseTag</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* tag)</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        { <span class="keywordflow">return</span> <a class="code" href="classSerializer.html#a14d43ffbf27d3b4fc1a797ddc73ed989">format</a>-&gt;<a class="code" href="classSerializationFormat.html#a9553d399947ab43fe1426e5b15e7a86e">WriteCloseTag</a>(tag); }</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="classSerializer.html#a778d5eb6aed86de99c535fba9e79ccc3">   89</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#a778d5eb6aed86de99c535fba9e79ccc3">WriteSeparator</a>()   { <span class="keywordflow">return</span> <a class="code" href="classSerializer.html#a14d43ffbf27d3b4fc1a797ddc73ed989">format</a>-&gt;<a class="code" href="classSerializationFormat.html#ab19ba3d144fad73396968e23a5baad8d">WriteSeparator</a>(); }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#a4954811d7edf09572879504384db7b98">Error</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* msg);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#a48ffc55a9a71081b226ce2e5fa369012">Warning</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* msg);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="classSerializer.html#a3643829e134588c8e88b74cb6f870ae2">   94</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#a3643829e134588c8e88b74cb6f870ae2">SetErrorDescr</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* descr)</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        { <span class="keyword">delete</span> [] <a class="code" href="classSerializer.html#a6d91fed6d9e22b3f38fe8acb650d1132">error_descr</a>; <a class="code" href="classSerializer.html#a6d91fed6d9e22b3f38fe8acb650d1132">error_descr</a> = <a class="code" href="util_8cc.html#af3956694b3af6026e660199a29b794da">copy_string</a>(descr); }</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// Format defaults to binary serialization.</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keyword">explicit</span> <a class="code" href="classSerializer.html#aa37260fe5cca986611bed193ad2bcc61">Serializer</a>(<a class="code" href="classSerializationFormat.html">SerializationFormat</a>* <a class="code" href="classSerializer.html#a14d43ffbf27d3b4fc1a797ddc73ed989">format</a> = 0);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keyword">virtual</span> <a class="code" href="classSerializer.html#a42a7d2d8e622ad1ef5f869813b498aa9">~Serializer</a>();</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">// Reads next object.</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">// If &#39;block&#39; is true, wait until an object can be read.</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// Returns 0 if no more object available, -1 on error.</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classSerializer.html#a177b4062931e4dd756a2615e4c5e5f91">Unserialize</a>(<a class="code" href="classUnserialInfo.html">UnserialInfo</a>* info, <span class="keywordtype">bool</span> block = <span class="keyword">false</span>);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// Callback for error messages.</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#a36c8799f2342ab53c5357de5f210a8a8">ReportError</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* msg) = 0;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// Callbacks for unserialized objects.</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// id points to ID in global scope, val is unserialized value.</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#a6edcc06a039cec985d9fdef668946132">GotID</a>(<a class="code" href="classID.html">ID</a>* <span class="keywordtype">id</span>, <a class="code" href="classVal.html">Val</a>* val) = 0;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#a50e7aa303cf11db5c327af101683a720">GotEvent</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keywordtype">double</span> time,</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                <a class="code" href="classEventHandlerPtr.html">EventHandlerPtr</a> event, val_list* args) = 0;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#a777b3f6d646a2812d5f6ea6d47580e6d">GotFunctionCall</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keywordtype">double</span> time,</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                <a class="code" href="classFunc.html">Func</a>* func, val_list* args) = 0;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#ab2f042a8509377281969d191ac0ba882">GotStateAccess</a>(<a class="code" href="classStateAccess.html">StateAccess</a>* s) = 0;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#a8835d808e9af88d73cc317caf9c3318f">GotTimer</a>(<a class="code" href="classTimer.html">Timer</a>* t) = 0;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#aa8810a58f51bf06d1a1c915e93bd2ea9">GotConnection</a>(<a class="code" href="classConnection.html">Connection</a>* c) = 0;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#aac6f58ac38683e0f962a2e33301483cd">GotPacket</a>(<a class="code" href="classPacket.html">Packet</a>* packet) = 0;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">// Magic to recognize state files.</span></div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="classSerializer.html#a314a0fad70bc1d5cb01b130d76ae0717">  124</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="classSerializer.html#a314a0fad70bc1d5cb01b130d76ae0717">MAGIC</a> = 0x42525354;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// This will be increased whenever there is an incompatible change</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// in the data format.</span></div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="classSerializer.html#a3001c37e01b7b54dcc9c28d008d1e546">  128</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="classSerializer.html#a3001c37e01b7b54dcc9c28d008d1e546">DATA_FORMAT_VERSION</a> = 26;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="classSerializer.html#af26421ef2572f109f71c53a0f718205c">  130</a></span>&#160;    <a class="code" href="classChunkedIO.html">ChunkedIO</a>* <a class="code" href="classSerializer.html#af26421ef2572f109f71c53a0f718205c">io</a>;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#a9caeaff12c48fd899e2007692f23040d">StartSerialization</a>(<a class="code" href="classSerialInfo.html">SerialInfo</a>* info, <span class="keyword">const</span> <span class="keywordtype">char</span>* descr, <span class="keywordtype">char</span> tag);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#ada3000980f780365946168e4e9e08738">EndSerialization</a>(<a class="code" href="classSerialInfo.html">SerialInfo</a>* info);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#abd83a9f6d10c049cd26149cec6e3c33d">UnserializeID</a>(<a class="code" href="classUnserialInfo.html">UnserialInfo</a>* info);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#a05e8f4df571f66e5518028983edfd82b">UnserializeCall</a>(<a class="code" href="classUnserialInfo.html">UnserialInfo</a>* info);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#a276852e29c56f2f25b8b1f38d6782742">UnserializeStateAccess</a>(<a class="code" href="classUnserialInfo.html">UnserialInfo</a>* info);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#a68e2026fac3d55a37bf2660136541adf">UnserializeTimer</a>(<a class="code" href="classUnserialInfo.html">UnserialInfo</a>* info);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#ae438ebcb5df72454ef6e7d084899c0f6">UnserializeConnection</a>(<a class="code" href="classUnserialInfo.html">UnserialInfo</a>* info);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#a3b7c705a7d981e7193c25b154bbb9198">UnserializePacket</a>(<a class="code" href="classUnserialInfo.html">UnserialInfo</a>* info);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="classSerializer.html#a14d43ffbf27d3b4fc1a797ddc73ed989">  143</a></span>&#160;    <a class="code" href="classSerializationFormat.html">SerializationFormat</a>* <a class="code" href="classSerializer.html#a14d43ffbf27d3b4fc1a797ddc73ed989">format</a>;</div><div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="classSerializer.html#a2338c655ac88c6f240c1172117430a8d">  144</a></span>&#160;    <a class="code" href="classSerializationCache.html">SerializationCache</a>* <a class="code" href="classSerializer.html#a2338c655ac88c6f240c1172117430a8d">current_cache</a>;</div><div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="classSerializer.html#a6d91fed6d9e22b3f38fe8acb650d1132">  145</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="classSerializer.html#a6d91fed6d9e22b3f38fe8acb650d1132">error_descr</a>;    <span class="comment">// used in error messages</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;};</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">// We maintain an LRU-cache for some of the objects which have already been</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">// serialized. For the cache, we need two types of IDs: TransientIDs (defined</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">// in SerialObj.cc) uniquely reference an object during the lifetime of a</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">// process.  PermanentIDs uniquely reference an object within a serialization.</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="classSerializationCache.html">  155</a></span>&#160;<span class="keyword">class </span><a class="code" href="classSerializationCache.html">SerializationCache</a> {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="classSerializationCache.html#a591cc59b4140f019a1e5c62921c0b182">  157</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> <a class="code" href="classSerializationCache.html#a591cc59b4140f019a1e5c62921c0b182">PermanentID</a>;</div><div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="classSerializationCache.html#ae1979cb3e844b2f325c99bee0e7d105f">  158</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> PermanentID NONE = 0;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// If max_cache_size is greater than zero, we&#39;ll remove old entries</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// automatically if limit is reached (LRU expiration).</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keyword">explicit</span> <a class="code" href="classSerializationCache.html">SerializationCache</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_cache_size = 0);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    ~<a class="code" href="classSerializationCache.html">SerializationCache</a>();</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    PermanentID Register(<span class="keyword">const</span> <a class="code" href="classSerialObj.html">SerialObj</a>* obj, PermanentID pid,</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                <span class="keywordtype">bool</span> new_cache_strategy);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="classSerializationCache.html#ae2a660fd7aa8f3939a00d7d099a18f8b">  168</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="classSerialObj.html">SerialObj</a>* <a class="code" href="classSerializationCache.html#ae2a660fd7aa8f3939a00d7d099a18f8b">Lookup</a>(PermanentID pid)</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        PIDMap::const_iterator i = pid_map.find(pid);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">if</span> ( i == pid_map.end() )</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        assert(i-&gt;second);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        MoveEntryToTail(i-&gt;second);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">return</span> i-&gt;second-&gt;obj.serial;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        }</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="classSerializationCache.html#aa17e2df73a1389d527e01fadea39e73a">  179</a></span>&#160;    PermanentID <a class="code" href="classSerializationCache.html#aa17e2df73a1389d527e01fadea39e73a">Lookup</a>(<span class="keyword">const</span> <a class="code" href="classTransientID.html">TransientID</a>&amp; tid)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        TIDMap::const_iterator i = tid_map.find(tid.<a class="code" href="classTransientID.html#a3f93ead786a442f0d8ca3028c62ef561">Value</a>());</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">if</span> ( i == tid_map.end() )</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <a class="code" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> modified = i-&gt;second-&gt;obj.serial-&gt;LastModified();</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">if</span> ( modified == <a class="code" href="classSerialObj.html#a97edec325159775e4b89b86702daf009">SerialObj::ALWAYS</a> || modified &gt; i-&gt;second-&gt;time )</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        assert(i-&gt;second);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        MoveEntryToTail(i-&gt;second);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordflow">return</span> i-&gt;second-&gt;pid;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        }</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="classSerializationCache.html#a65eb093b68ea8fb29a1294cffaa83efa">  194</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classSerializationCache.html#a65eb093b68ea8fb29a1294cffaa83efa">GetMaxCacheSize</a>()<span class="keyword"> const    </span>{ <span class="keywordflow">return</span> max_cache_size; }</div><div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="classSerializationCache.html#aaac21d276b5287cc14c08d669457c4f6">  195</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classSerializationCache.html#aaac21d276b5287cc14c08d669457c4f6">SetMaxCacheSize</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size) { max_cache_size = size; }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// These methods have to be called at the start/end of the</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// serialization of an entity. The cache guarentees that objects</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// registered after Begin() remain valid until End() is called.</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// After End(), objects which are not derived from BroObj are</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// discarded; others *may* remain valid.</span></div><div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="classSerializationCache.html#abd7f86616566399bf20077e3fda588f3">  202</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classSerializationCache.html#abd7f86616566399bf20077e3fda588f3">Begin</a>(<span class="keywordtype">bool</span> can_keep_in_cache)  { End(can_keep_in_cache); }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordtype">void</span> End(<span class="keywordtype">bool</span> can_keep_in_cache);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordtype">void</span> Clear();</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keyword">struct </span><a class="code" href="structSerializationCache_1_1CacheList.html">CacheList</a>;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="structSerializationCache_1_1CacheEntry.html">  211</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structSerializationCache_1_1CacheEntry.html">CacheEntry</a> {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keyword">union </span>{</div><div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="structSerializationCache_1_1CacheEntry.html#abaa57447936d85e0cb570657b61e4abb">  213</a></span>&#160;            <span class="keyword">const</span> <a class="code" href="classSerialObj.html">SerialObj</a>* <a class="code" href="structSerializationCache_1_1CacheEntry.html#abaa57447936d85e0cb570657b61e4abb">serial</a>;</div><div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="structSerializationCache_1_1CacheEntry.html#a834c249945bb8aba5b5d3cdadc1f5545">  214</a></span>&#160;            <span class="keyword">const</span> <a class="code" href="classBroObj.html">BroObj</a>* <a class="code" href="structSerializationCache_1_1CacheEntry.html#a834c249945bb8aba5b5d3cdadc1f5545">bro</a>;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        } obj;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="structSerializationCache_1_1CacheEntry.html#ad7b38cb8a4c0c66a88a977f487d4a004">  217</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="structSerializationCache_1_1CacheEntry.html#ad7b38cb8a4c0c66a88a977f487d4a004">is_bro_obj</a>;</div><div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="structSerializationCache_1_1CacheEntry.html#a7fdb3d12205eab1eded0d5da2cad5690">  218</a></span>&#160;        PermanentID <a class="code" href="structSerializationCache_1_1CacheEntry.html#a7fdb3d12205eab1eded0d5da2cad5690">pid</a>;</div><div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="structSerializationCache_1_1CacheEntry.html#a24779e81f126147e9c7a8bc2d8cade1c">  219</a></span>&#160;        <a class="code" href="classTransientID.html#a3f2abce52a75170607daffe9f165013c">TransientID::ID</a> <a class="code" href="structSerializationCache_1_1CacheEntry.html#a24779e81f126147e9c7a8bc2d8cade1c">tid</a>;</div><div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="structSerializationCache_1_1CacheEntry.html#a6168a4549314a1fd82ed8e7ce3f86b73">  220</a></span>&#160;        <a class="code" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> <a class="code" href="structSerializationCache_1_1CacheEntry.html#a6168a4549314a1fd82ed8e7ce3f86b73">time</a>;</div><div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="structSerializationCache_1_1CacheEntry.html#a0bd6afcd5f070e5ba6a4b98b55ded235">  221</a></span>&#160;        <span class="keyword">struct </span><a class="code" href="structSerializationCache_1_1CacheList.html">CacheList</a>* <a class="code" href="structSerializationCache_1_1CacheEntry.html#a0bd6afcd5f070e5ba6a4b98b55ded235">cache</a>;</div><div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="structSerializationCache_1_1CacheEntry.html#a9d310cd7ed74f303daa83a5ad963f244">  222</a></span>&#160;        <a class="code" href="structSerializationCache_1_1CacheEntry.html">CacheEntry</a>* <a class="code" href="structSerializationCache_1_1CacheEntry.html#a9d310cd7ed74f303daa83a5ad963f244">prev</a>;</div><div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="structSerializationCache_1_1CacheEntry.html#a94b9d55fb7a287d80fa92f49173e6b6d">  223</a></span>&#160;        <a class="code" href="structSerializationCache_1_1CacheEntry.html">CacheEntry</a>* <a class="code" href="structSerializationCache_1_1CacheEntry.html#a94b9d55fb7a287d80fa92f49173e6b6d">next</a>;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="structSerializationCache_1_1CacheEntry.html#a22df71642d7616cbe8a66acf5773bf75">  225</a></span>&#160;        <a class="code" href="SerialTypes_8h.html#add49e82f76bb3390a108e21f6246025e">SerialType</a> <a class="code" href="structSerializationCache_1_1CacheEntry.html#a22df71642d7616cbe8a66acf5773bf75">stype</a>;   <span class="comment">// primarily for debugging</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    };</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">// We maintain two LRU-sorted lists, one for often-changing objects and</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">// one for only rarely changing objects;</span></div><div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="structSerializationCache_1_1CacheList.html">  230</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structSerializationCache_1_1CacheList.html">CacheList</a> {</div><div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="structSerializationCache_1_1CacheList.html#ab37ad2cf56e5763d88fb50fa5dde7092">  231</a></span>&#160;        <a class="code" href="structSerializationCache_1_1CacheEntry.html">CacheEntry</a>* <a class="code" href="structSerializationCache_1_1CacheList.html#ab37ad2cf56e5763d88fb50fa5dde7092">head</a>;</div><div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="structSerializationCache_1_1CacheList.html#a62432a0633b3b55a21c42b83ab8a7599">  232</a></span>&#160;        <a class="code" href="structSerializationCache_1_1CacheEntry.html">CacheEntry</a>* <a class="code" href="structSerializationCache_1_1CacheList.html#a62432a0633b3b55a21c42b83ab8a7599">tail</a>;</div><div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="structSerializationCache_1_1CacheList.html#a4e9b1539a6a34a3a85286b8558e44257">  233</a></span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structSerializationCache_1_1CacheList.html#a4e9b1539a6a34a3a85286b8558e44257">size</a>;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    };</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">void</span> RemoveEntry(<a class="code" href="structSerializationCache_1_1CacheEntry.html">CacheEntry</a>* e);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">void</span> UnlinkEntry(<a class="code" href="structSerializationCache_1_1CacheEntry.html">CacheEntry</a>* e);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordtype">void</span> MoveEntryToTail(<a class="code" href="structSerializationCache_1_1CacheEntry.html">CacheEntry</a>* e);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="classSerializationCache.html#a69e19ea4316ee670b89583b20b7877d3">  240</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classSerializationCache.html#a69e19ea4316ee670b89583b20b7877d3">max_cache_size</a>;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="classSerializationCache.html#a6d0b56ffb94a823733feaa5ef6ef7ff3">  242</a></span>&#160;    <span class="keyword">typedef</span> map&lt;PermanentID, CacheEntry*&gt; <a class="code" href="classSerializationCache.html#a6d0b56ffb94a823733feaa5ef6ef7ff3">PIDMap</a>;</div><div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="classSerializationCache.html#a9bded21d4d0292d66c710da3b056cac4">  243</a></span>&#160;    <span class="keyword">typedef</span> map&lt;TransientID::ID, CacheEntry*&gt; <a class="code" href="classSerializationCache.html#a9bded21d4d0292d66c710da3b056cac4">TIDMap</a>;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="classSerializationCache.html#adfff535c892f498071febfdb5253a707">  245</a></span>&#160;    TIDMap <a class="code" href="classSerializationCache.html#adfff535c892f498071febfdb5253a707">tid_map</a>;</div><div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="classSerializationCache.html#a2ae9e37ed0b70ab99748a6f671a34a77">  246</a></span>&#160;    PIDMap <a class="code" href="classSerializationCache.html#a2ae9e37ed0b70ab99748a6f671a34a77">pid_map</a>;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="classSerializationCache.html#ac05b9630f5b805e96a4213de5491fc78">  248</a></span>&#160;    <a class="code" href="structSerializationCache_1_1CacheList.html">CacheList</a> <a class="code" href="classSerializationCache.html#ac05b9630f5b805e96a4213de5491fc78">cache_stable</a>;</div><div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="classSerializationCache.html#a01f6d17ed10fdc1fa2a8f91d84381518">  249</a></span>&#160;    <a class="code" href="structSerializationCache_1_1CacheList.html">CacheList</a> <a class="code" href="classSerializationCache.html#a01f6d17ed10fdc1fa2a8f91d84381518">cache_unstable</a>;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">// Objects in the cache which aren&#39;t derived from BroObj. These are</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// always stored in the unstable cache.</span></div><div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="classSerializationCache.html#a5a8f67916929f72ef79734b45abfc445">  253</a></span>&#160;    <span class="keyword">typedef</span> list&lt;CacheEntry*&gt; <a class="code" href="classSerializationCache.html#a5a8f67916929f72ef79734b45abfc445">VolatileList</a>;</div><div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="classSerializationCache.html#a1b36f8eec2e1e05118169a550ff97f81">  254</a></span>&#160;    VolatileList <a class="code" href="classSerializationCache.html#a1b36f8eec2e1e05118169a550ff97f81">volatiles</a>;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="classSerializationCache.html#a210d9252f8b4520827029eb2bb51d2e6">  256</a></span>&#160;    PermanentID <a class="code" href="classSerializationCache.html#a210d9252f8b4520827029eb2bb51d2e6">next_id</a>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;};</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">// A serializer for cloning objects.  Objects can be serialized into</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">// the serializer and unserialized into new objects.  An absolutely</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">// minimal implementation of Serializer!</span></div><div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="classCloneSerializer.html">  262</a></span>&#160;<span class="keyword">class </span><a class="code" href="classCloneSerializer.html">CloneSerializer</a> : <span class="keyword">public</span> <a class="code" href="classSerializer.html">Serializer</a> {</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="classCloneSerializer.html#abc9ddd9b6cd41a23005ef9f4b20088b6">  264</a></span>&#160;    <span class="keyword">explicit</span> <a class="code" href="classCloneSerializer.html#abc9ddd9b6cd41a23005ef9f4b20088b6">CloneSerializer</a>(<a class="code" href="classSerializationFormat.html">SerializationFormat</a>* <a class="code" href="classSerializer.html#a14d43ffbf27d3b4fc1a797ddc73ed989">format</a> = 0) : <a class="code" href="classSerializer.html">Serializer</a>(<a class="code" href="classSerializer.html#a14d43ffbf27d3b4fc1a797ddc73ed989">format</a>) { }</div><div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="classCloneSerializer.html#ab0912c03bce847b2b4d7a1e8cb0cfa93">  265</a></span>&#160;    <a class="code" href="classCloneSerializer.html#ab0912c03bce847b2b4d7a1e8cb0cfa93">~CloneSerializer</a>()<span class="keyword"> override</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="keyword">        </span>{ }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="classCloneSerializer.html#a3db0baa7fda61d334b4d4a384b38eaac">  269</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classCloneSerializer.html#a3db0baa7fda61d334b4d4a384b38eaac">ReportError</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* msg)<span class="keyword"> override </span>{ <a class="code" href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a>-&gt;<a class="code" href="classReporter.html#ac67df7fad58e8835b7b4df857ee82363">Error</a>(<span class="stringliteral">&quot;%s&quot;</span>, msg); }</div><div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="classCloneSerializer.html#a58b892d51bd21e43ed58c8c8a726fdf1">  270</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classCloneSerializer.html#a58b892d51bd21e43ed58c8c8a726fdf1">GotID</a>(<a class="code" href="classID.html">ID</a>* <span class="keywordtype">id</span>, <a class="code" href="classVal.html">Val</a>* val)<span class="keyword"> override </span>{ }</div><div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="classCloneSerializer.html#a807762419ab6baadebb8b13e76c06834">  271</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classCloneSerializer.html#a807762419ab6baadebb8b13e76c06834">GotEvent</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keywordtype">double</span> time, <a class="code" href="classEventHandlerPtr.html">EventHandlerPtr</a> event, val_list* args)<span class="keyword"> override </span>{ }</div><div class="line"><a name="l00272"></a><span class="lineno"><a class="line" href="classCloneSerializer.html#ada936f71cf5fa96646117c4222d15bac">  272</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classCloneSerializer.html#ada936f71cf5fa96646117c4222d15bac">GotFunctionCall</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keywordtype">double</span> time,</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                <a class="code" href="classFunc.html">Func</a>* func, val_list* args)<span class="keyword"> override </span>{ }</div><div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="classCloneSerializer.html#add8f3bce26420698f2ae4ecb39c16b9f">  274</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classCloneSerializer.html#add8f3bce26420698f2ae4ecb39c16b9f">GotStateAccess</a>(<a class="code" href="classStateAccess.html">StateAccess</a>* s)<span class="keyword"> override </span>{ <span class="keyword">delete</span> s; }</div><div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="classCloneSerializer.html#a525f236efea84fba72379be9f302bf42">  275</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classCloneSerializer.html#a525f236efea84fba72379be9f302bf42">GotTimer</a>(<a class="code" href="classTimer.html">Timer</a>* t)<span class="keyword"> override </span>{ }</div><div class="line"><a name="l00276"></a><span class="lineno"><a class="line" href="classCloneSerializer.html#ab0a42860296d3c85bb4c41109d96e10c">  276</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classCloneSerializer.html#ab0a42860296d3c85bb4c41109d96e10c">GotConnection</a>(<a class="code" href="classConnection.html">Connection</a>* c)<span class="keyword"> override </span>{ }</div><div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="classCloneSerializer.html#a9570c6e267b7e68c6c9c13d625a2605e">  277</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classCloneSerializer.html#a9570c6e267b7e68c6c9c13d625a2605e">GotPacket</a>(<a class="code" href="classPacket.html">Packet</a>* packet)<span class="keyword"> override </span>{ }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;};</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">// Write values/events to file or fd.</span></div><div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="classFileSerializer.html">  281</a></span>&#160;<span class="keyword">class </span><a class="code" href="classFileSerializer.html">FileSerializer</a> : <span class="keyword">public</span> <a class="code" href="classSerializer.html">Serializer</a> {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keyword">explicit</span> <a class="code" href="classFileSerializer.html">FileSerializer</a>(<a class="code" href="classSerializationFormat.html">SerializationFormat</a>* <a class="code" href="classSerializer.html#a14d43ffbf27d3b4fc1a797ddc73ed989">format</a> = 0);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    ~<a class="code" href="classFileSerializer.html">FileSerializer</a>() <span class="keyword">override</span>;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// Opens the file for serialization.</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">bool</span> Open(<span class="keyword">const</span> <span class="keywordtype">char</span>* file, <span class="keywordtype">bool</span> pure = <span class="keyword">false</span>);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordtype">bool</span> Close();</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// Reads the file.</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classSerializer.html#a26c3e430fa36b5ee921e619e349111e6">Read</a>(<a class="code" href="classUnserialInfo.html">UnserialInfo</a>* info, <span class="keyword">const</span> <span class="keywordtype">char</span>* file, <span class="keywordtype">bool</span> header = <span class="keyword">true</span>);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#a36c8799f2342ab53c5357de5f210a8a8">ReportError</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* msg) <span class="keyword">override</span>;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#a6edcc06a039cec985d9fdef668946132">GotID</a>(<a class="code" href="classID.html">ID</a>* <span class="keywordtype">id</span>, <a class="code" href="classVal.html">Val</a>* val) <span class="keyword">override</span>;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#a50e7aa303cf11db5c327af101683a720">GotEvent</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keywordtype">double</span> time,</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                <a class="code" href="classEventHandlerPtr.html">EventHandlerPtr</a> event, val_list* args) <span class="keyword">override</span>;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#a777b3f6d646a2812d5f6ea6d47580e6d">GotFunctionCall</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keywordtype">double</span> time,</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                <a class="code" href="classFunc.html">Func</a>* func, val_list* args) <span class="keyword">override</span>;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#ab2f042a8509377281969d191ac0ba882">GotStateAccess</a>(<a class="code" href="classStateAccess.html">StateAccess</a>* s) <span class="keyword">override</span>;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#a8835d808e9af88d73cc317caf9c3318f">GotTimer</a>(<a class="code" href="classTimer.html">Timer</a>* t) <span class="keyword">override</span>;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#aa8810a58f51bf06d1a1c915e93bd2ea9">GotConnection</a>(<a class="code" href="classConnection.html">Connection</a>* c) <span class="keyword">override</span>;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#aac6f58ac38683e0f962a2e33301483cd">GotPacket</a>(<a class="code" href="classPacket.html">Packet</a>* packet) <span class="keyword">override</span>;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordtype">bool</span> OpenFile(<span class="keyword">const</span> <span class="keywordtype">char</span>* file, <span class="keywordtype">bool</span> readonly, <span class="keywordtype">bool</span> should_exist = <span class="keyword">false</span>);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordtype">void</span> CloseFile();</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordtype">bool</span> ReadFile(<span class="keyword">const</span> <span class="keywordtype">char</span>* file);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordtype">bool</span> PrepareForWriting();</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordtype">bool</span> ReadHeader(<a class="code" href="classUnserialInfo.html">UnserialInfo</a>* info = 0);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="classFileSerializer.html#aa772566a15104ca3f80c23d848da18e4">  311</a></span>&#160;    <a class="code" href="classSerializationCache.html">SerializationCache</a> <a class="code" href="classFileSerializer.html#aa772566a15104ca3f80c23d848da18e4">cache</a>;</div><div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="classFileSerializer.html#a2a5241903c970d80972db651d349daf5">  312</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="classFileSerializer.html#a2a5241903c970d80972db651d349daf5">file</a>;</div><div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="classFileSerializer.html#a6896fbb3fa8a9f492b87fa018a60e68f">  313</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classFileSerializer.html#a6896fbb3fa8a9f492b87fa018a60e68f">fd</a>;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;};</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">// Abstract interface class for external sources providing a stream of events.</span></div><div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="classEventSource.html">  317</a></span>&#160;<span class="keyword">class </span><a class="code" href="classEventSource.html">EventSource</a> {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="classEventSource.html#a667da0cd3be10febb0eaf9e7946d1b8f">  319</a></span>&#160;    <span class="keyword">virtual</span> <a class="code" href="classEventSource.html#a667da0cd3be10febb0eaf9e7946d1b8f">~EventSource</a>() { }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">// Returns time of the oldest event (0 if none available).</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">double</span> NextTimestamp(<span class="keywordtype">double</span>* local_network_time) = 0;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">// Dispatches the oldest event and removes it.</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> DispatchNextEvent() = 0;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// Returns true if there are more events to expect from this source.</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> IsActive() = 0;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;};</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">// Plays a file of events back.</span></div><div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="classEventPlayer.html">  332</a></span>&#160;<span class="keyword">class </span><a class="code" href="classEventPlayer.html">EventPlayer</a> : <span class="keyword">public</span> <a class="code" href="classFileSerializer.html">FileSerializer</a>, <span class="keyword">public</span> <a class="code" href="classiosource_1_1IOSource.html">iosource::IOSource</a> {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keyword">explicit</span> <a class="code" href="classEventPlayer.html">EventPlayer</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* file);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    ~<a class="code" href="classEventPlayer.html">EventPlayer</a>() <span class="keyword">override</span>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordtype">void</span> GetFds(<a class="code" href="classiosource_1_1FD__Set.html">iosource::FD_Set</a>* read, <a class="code" href="classiosource_1_1FD__Set.html">iosource::FD_Set</a>* write,</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                        <a class="code" href="classiosource_1_1FD__Set.html">iosource::FD_Set</a>* except) <span class="keyword">override</span>;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordtype">double</span> NextTimestamp(<span class="keywordtype">double</span>* local_network_time) <span class="keyword">override</span>;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordtype">void</span> Process() <span class="keyword">override</span>;</div><div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="classEventPlayer.html#a8737254385f2934b59de39b02ac3e322">  341</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="classEventPlayer.html#a8737254385f2934b59de39b02ac3e322">Tag</a>()<span class="keyword"> override </span>{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;EventPlayer&quot;</span>; }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="classEventPlayer.html#a3fd636f6372df2e8b6ebb802f2346c37">  344</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classEventPlayer.html#a3fd636f6372df2e8b6ebb802f2346c37">GotID</a>(<a class="code" href="classID.html">ID</a>* <span class="keywordtype">id</span>, <a class="code" href="classVal.html">Val</a>* val)<span class="keyword"> override </span>{}</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#a50e7aa303cf11db5c327af101683a720">GotEvent</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keywordtype">double</span> time,</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                <a class="code" href="classEventHandlerPtr.html">EventHandlerPtr</a> event, val_list* args) <span class="keyword">override</span>;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classSerializer.html#a777b3f6d646a2812d5f6ea6d47580e6d">GotFunctionCall</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keywordtype">double</span> time,</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                <a class="code" href="classFunc.html">Func</a>* func, val_list* args) <span class="keyword">override</span>;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="classEventPlayer.html#a6f827c1df42cad818f981c35bef9b1cc">  350</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classEventPlayer.html#a6f827c1df42cad818f981c35bef9b1cc">stream_time</a>; <span class="comment">// time of first captured event</span></div><div class="line"><a name="l00351"></a><span class="lineno"><a class="line" href="classEventPlayer.html#a07ddb048ce74c5ac5653771607dd5a50">  351</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classEventPlayer.html#a07ddb048ce74c5ac5653771607dd5a50">replay_time</a>; <span class="comment">// network time of replay start</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">// Next event waiting to be dispatched.</span></div><div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="classEventPlayer.html#a021b3d2372d16d197939e2be20118edb">  354</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classEventPlayer.html#a021b3d2372d16d197939e2be20118edb">ne_time</a>;</div><div class="line"><a name="l00355"></a><span class="lineno"><a class="line" href="classEventPlayer.html#ae4a9ff0eba42c6fdc3bd832e55dd08b0">  355</a></span>&#160;    <a class="code" href="classEventHandlerPtr.html">EventHandlerPtr</a> <a class="code" href="classEventPlayer.html#ae4a9ff0eba42c6fdc3bd832e55dd08b0">ne_handler</a>;</div><div class="line"><a name="l00356"></a><span class="lineno"><a class="line" href="classEventPlayer.html#abfa8204c66fc74ca50d169309cd28de8">  356</a></span>&#160;    val_list* <a class="code" href="classEventPlayer.html#abfa8204c66fc74ca50d169309cd28de8">ne_args</a>;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;};</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="keyword">extern</span> <a class="code" href="classFileSerializer.html">FileSerializer</a>* <a class="code" href="Serializer_8h.html#a5d66cb16d0171245396508fa5c0437be">event_serializer</a>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keyword">extern</span> <a class="code" href="classFileSerializer.html">FileSerializer</a>* <a class="code" href="Serializer_8h.html#ad45281de269b5dbd557452da44b10f0f">state_serializer</a>;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="structSerializationCache_1_1CacheEntry_html_a6168a4549314a1fd82ed8e7ce3f86b73"><div class="ttname"><a href="structSerializationCache_1_1CacheEntry.html#a6168a4549314a1fd82ed8e7ce3f86b73">SerializationCache::CacheEntry::time</a></div><div class="ttdeci">uint64 time</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00220">Serializer.h:220</a></div></div>
<div class="ttc" id="classSerialObj_html"><div class="ttname"><a href="classSerialObj.html">SerialObj</a></div><div class="ttdef"><b>Definition:</b> <a href="SerialObj_8h_source.html#l00065">SerialObj.h:65</a></div></div>
<div class="ttc" id="classUnserialInfo_html"><div class="ttname"><a href="classUnserialInfo.html">UnserialInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="SerialInfo_8h_source.html#l00066">SerialInfo.h:66</a></div></div>
<div class="ttc" id="classSerializer_html_a2338c655ac88c6f240c1172117430a8d"><div class="ttname"><a href="classSerializer.html#a2338c655ac88c6f240c1172117430a8d">Serializer::current_cache</a></div><div class="ttdeci">SerializationCache * current_cache</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00144">Serializer.h:144</a></div></div>
<div class="ttc" id="classCloneSerializer_html"><div class="ttname"><a href="classCloneSerializer.html">CloneSerializer</a></div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00262">Serializer.h:262</a></div></div>
<div class="ttc" id="classSerializationFormat_html"><div class="ttname"><a href="classSerializationFormat.html">SerializationFormat</a></div><div class="ttdef"><b>Definition:</b> <a href="SerializationFormat_8h_source.html#l00016">SerializationFormat.h:16</a></div></div>
<div class="ttc" id="classSerializationCache_html_a1b36f8eec2e1e05118169a550ff97f81"><div class="ttname"><a href="classSerializationCache.html#a1b36f8eec2e1e05118169a550ff97f81">SerializationCache::volatiles</a></div><div class="ttdeci">VolatileList volatiles</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00254">Serializer.h:254</a></div></div>
<div class="ttc" id="ID_8h_html"><div class="ttname"><a href="ID_8h.html">ID.h</a></div></div>
<div class="ttc" id="SerialInfo_8h_html"><div class="ttname"><a href="SerialInfo_8h.html">SerialInfo.h</a></div></div>
<div class="ttc" id="classVal_html"><div class="ttname"><a href="classVal.html">Val</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00078">Val.h:78</a></div></div>
<div class="ttc" id="classSerializer_html_a1c53bf6b442e4d7c357b40d5d3aa2269"><div class="ttname"><a href="classSerializer.html#a1c53bf6b442e4d7c357b40d5d3aa2269">Serializer::Read</a></div><div class="ttdeci">bool Read(IPAddr *a, const char *tag)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00072">Serializer.h:72</a></div></div>
<div class="ttc" id="classSerializer_html_aa8810a58f51bf06d1a1c915e93bd2ea9"><div class="ttname"><a href="classSerializer.html#aa8810a58f51bf06d1a1c915e93bd2ea9">Serializer::GotConnection</a></div><div class="ttdeci">virtual void GotConnection(Connection *c)=0</div></div>
<div class="ttc" id="SerializationFormat_8h_html"><div class="ttname"><a href="SerializationFormat_8h.html">SerializationFormat.h</a></div></div>
<div class="ttc" id="classSerializer_html_a26c3e430fa36b5ee921e619e349111e6"><div class="ttname"><a href="classSerializer.html#a26c3e430fa36b5ee921e619e349111e6">Serializer::Read</a></div><div class="ttdeci">bool Read(char **str, int *len, const char *tag)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00065">Serializer.h:65</a></div></div>
<div class="ttc" id="structSerializationCache_1_1CacheEntry_html_a22df71642d7616cbe8a66acf5773bf75"><div class="ttname"><a href="structSerializationCache_1_1CacheEntry.html#a22df71642d7616cbe8a66acf5773bf75">SerializationCache::CacheEntry::stype</a></div><div class="ttdeci">SerialType stype</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00225">Serializer.h:225</a></div></div>
<div class="ttc" id="classSerializationFormat_html_a9553d399947ab43fe1426e5b15e7a86e"><div class="ttname"><a href="classSerializationFormat.html#a9553d399947ab43fe1426e5b15e7a86e">SerializationFormat::WriteCloseTag</a></div><div class="ttdeci">virtual bool WriteCloseTag(const char *tag)=0</div></div>
<div class="ttc" id="classSerializer_html_a777b3f6d646a2812d5f6ea6d47580e6d"><div class="ttname"><a href="classSerializer.html#a777b3f6d646a2812d5f6ea6d47580e6d">Serializer::GotFunctionCall</a></div><div class="ttdeci">virtual void GotFunctionCall(const char *name, double time, Func *func, val_list *args)=0</div></div>
<div class="ttc" id="classSerialInfo_html"><div class="ttname"><a href="classSerialInfo.html">SerialInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="SerialInfo_8h_source.html#l00006">SerialInfo.h:6</a></div></div>
<div class="ttc" id="classSerializer_html_af26421ef2572f109f71c53a0f718205c"><div class="ttname"><a href="classSerializer.html#af26421ef2572f109f71c53a0f718205c">Serializer::io</a></div><div class="ttdeci">ChunkedIO * io</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00130">Serializer.h:130</a></div></div>
<div class="ttc" id="classIPPrefix_html"><div class="ttname"><a href="classIPPrefix.html">IPPrefix</a></div><div class="ttdef"><b>Definition:</b> <a href="IPAddr_8h_source.html#l00458">IPAddr.h:458</a></div></div>
<div class="ttc" id="structSerializationCache_1_1CacheEntry_html_abaa57447936d85e0cb570657b61e4abb"><div class="ttname"><a href="structSerializationCache_1_1CacheEntry.html#abaa57447936d85e0cb570657b61e4abb">SerializationCache::CacheEntry::serial</a></div><div class="ttdeci">const SerialObj * serial</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00213">Serializer.h:213</a></div></div>
<div class="ttc" id="classSerializer_html_afe54eb18bd33a0f01405356bedf43fb8"><div class="ttname"><a href="classSerializer.html#afe54eb18bd33a0f01405356bedf43fb8">Serializer::Write</a></div><div class="ttdeci">bool Write(const string &amp;s, const char *tag)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00079">Serializer.h:79</a></div></div>
<div class="ttc" id="classSerializer_html_a778d5eb6aed86de99c535fba9e79ccc3"><div class="ttname"><a href="classSerializer.html#a778d5eb6aed86de99c535fba9e79ccc3">Serializer::WriteSeparator</a></div><div class="ttdeci">bool WriteSeparator()</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00089">Serializer.h:89</a></div></div>
<div class="ttc" id="classSerializationFormat_html_a8b50e6cb4a85bbd09f4c595c158905cc"><div class="ttname"><a href="classSerializationFormat.html#a8b50e6cb4a85bbd09f4c595c158905cc">SerializationFormat::WriteOpenTag</a></div><div class="ttdeci">virtual bool WriteOpenTag(const char *tag)=0</div></div>
<div class="ttc" id="classCloneSerializer_html_a58b892d51bd21e43ed58c8c8a726fdf1"><div class="ttname"><a href="classCloneSerializer.html#a58b892d51bd21e43ed58c8c8a726fdf1">CloneSerializer::GotID</a></div><div class="ttdeci">void GotID(ID *id, Val *val) override</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00270">Serializer.h:270</a></div></div>
<div class="ttc" id="classCloneSerializer_html_ada936f71cf5fa96646117c4222d15bac"><div class="ttname"><a href="classCloneSerializer.html#ada936f71cf5fa96646117c4222d15bac">CloneSerializer::GotFunctionCall</a></div><div class="ttdeci">void GotFunctionCall(const char *name, double time, Func *func, val_list *args) override</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00272">Serializer.h:272</a></div></div>
<div class="ttc" id="classSerializationFormat_html_a9d123970506445e8df1ca473ff76c5c9"><div class="ttname"><a href="classSerializationFormat.html#a9d123970506445e8df1ca473ff76c5c9">SerializationFormat::Write</a></div><div class="ttdeci">virtual bool Write(int v, const char *tag)=0</div></div>
<div class="ttc" id="classSerializer_html_a8835d808e9af88d73cc317caf9c3318f"><div class="ttname"><a href="classSerializer.html#a8835d808e9af88d73cc317caf9c3318f">Serializer::GotTimer</a></div><div class="ttdeci">virtual void GotTimer(Timer *t)=0</div></div>
<div class="ttc" id="Reporter_8cc_html_a25adbcf7f40a03cf61ce36b1e10bbf91"><div class="ttname"><a href="Reporter_8cc.html#a25adbcf7f40a03cf61ce36b1e10bbf91">reporter</a></div><div class="ttdeci">Reporter * reporter</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00025">Reporter.cc:25</a></div></div>
<div class="ttc" id="classCloneSerializer_html_a3db0baa7fda61d334b4d4a384b38eaac"><div class="ttname"><a href="classCloneSerializer.html#a3db0baa7fda61d334b4d4a384b38eaac">CloneSerializer::ReportError</a></div><div class="ttdeci">void ReportError(const char *msg) override</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00269">Serializer.h:269</a></div></div>
<div class="ttc" id="classEventPlayer_html_ae4a9ff0eba42c6fdc3bd832e55dd08b0"><div class="ttname"><a href="classEventPlayer.html#ae4a9ff0eba42c6fdc3bd832e55dd08b0">EventPlayer::ne_handler</a></div><div class="ttdeci">EventHandlerPtr ne_handler</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00355">Serializer.h:355</a></div></div>
<div class="ttc" id="classIPAddr_html"><div class="ttname"><a href="classIPAddr.html">IPAddr</a></div><div class="ttdef"><b>Definition:</b> <a href="IPAddr_8h_source.html#l00024">IPAddr.h:24</a></div></div>
<div class="ttc" id="classSerializer_html_a73d02b8e8ae0a9a51f1b4e538acea136"><div class="ttname"><a href="classSerializer.html#a73d02b8e8ae0a9a51f1b4e538acea136">Serializer::Serialize</a></div><div class="ttdeci">bool Serialize(SerialInfo *info, const ID &amp;id)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8cc_source.html#l00097">Serializer.cc:97</a></div></div>
<div class="ttc" id="classSerializer_html_a4954811d7edf09572879504384db7b98"><div class="ttname"><a href="classSerializer.html#a4954811d7edf09572879504384db7b98">Serializer::Error</a></div><div class="ttdeci">void Error(const char *msg)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8cc_source.html#l00558">Serializer.cc:558</a></div></div>
<div class="ttc" id="classSerializationCache_html_a6d0b56ffb94a823733feaa5ef6ef7ff3"><div class="ttname"><a href="classSerializationCache.html#a6d0b56ffb94a823733feaa5ef6ef7ff3">SerializationCache::PIDMap</a></div><div class="ttdeci">map&lt; PermanentID, CacheEntry * &gt; PIDMap</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00242">Serializer.h:242</a></div></div>
<div class="ttc" id="classEventPlayer_html"><div class="ttname"><a href="classEventPlayer.html">EventPlayer</a></div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00332">Serializer.h:332</a></div></div>
<div class="ttc" id="classSerializer_html_af45a3e5590622abacd3c8352a3928e10"><div class="ttname"><a href="classSerializer.html#af45a3e5590622abacd3c8352a3928e10">Serializer::Cache</a></div><div class="ttdeci">SerializationCache * Cache()</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00039">Serializer.h:39</a></div></div>
<div class="ttc" id="Timer_8h_html"><div class="ttname"><a href="Timer_8h.html">Timer.h</a></div></div>
<div class="ttc" id="classSerializationCache_html_a5a8f67916929f72ef79734b45abfc445"><div class="ttname"><a href="classSerializationCache.html#a5a8f67916929f72ef79734b45abfc445">SerializationCache::VolatileList</a></div><div class="ttdeci">list&lt; CacheEntry * &gt; VolatileList</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00253">Serializer.h:253</a></div></div>
<div class="ttc" id="IOSource_8h_html"><div class="ttname"><a href="IOSource_8h.html">IOSource.h</a></div></div>
<div class="ttc" id="util_8h_html_a7cde0074dfd288f2d70c0e035dacb28a"><div class="ttname"><a href="util_8h.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a></div><div class="ttdeci">int64_t int64</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00068">util.h:68</a></div></div>
<div class="ttc" id="classiosource_1_1IOSource_html"><div class="ttname"><a href="classiosource_1_1IOSource.html">iosource::IOSource</a></div><div class="ttdef"><b>Definition:</b> <a href="IOSource_8h_source.html#l00020">IOSource.h:20</a></div></div>
<div class="ttc" id="classTransientID_html"><div class="ttname"><a href="classTransientID.html">TransientID</a></div><div class="ttdef"><b>Definition:</b> <a href="SerialObj_8h_source.html#l00052">SerialObj.h:52</a></div></div>
<div class="ttc" id="structSerializationCache_1_1CacheEntry_html"><div class="ttname"><a href="structSerializationCache_1_1CacheEntry.html">SerializationCache::CacheEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00211">Serializer.h:211</a></div></div>
<div class="ttc" id="structSerializationCache_1_1CacheEntry_html_a834c249945bb8aba5b5d3cdadc1f5545"><div class="ttname"><a href="structSerializationCache_1_1CacheEntry.html#a834c249945bb8aba5b5d3cdadc1f5545">SerializationCache::CacheEntry::bro</a></div><div class="ttdeci">const BroObj * bro</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00214">Serializer.h:214</a></div></div>
<div class="ttc" id="classSerializer_html_a276852e29c56f2f25b8b1f38d6782742"><div class="ttname"><a href="classSerializer.html#a276852e29c56f2f25b8b1f38d6782742">Serializer::UnserializeStateAccess</a></div><div class="ttdeci">bool UnserializeStateAccess(UnserialInfo *info)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8cc_source.html#l00438">Serializer.cc:438</a></div></div>
<div class="ttc" id="classSerializer_html_a81ef0512e3a7a40ea163ff583c03f576"><div class="ttname"><a href="classSerializer.html#a81ef0512e3a7a40ea163ff583c03f576">Serializer::WriteOpenTag</a></div><div class="ttdeci">bool WriteOpenTag(const char *tag)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00084">Serializer.h:84</a></div></div>
<div class="ttc" id="classEventPlayer_html_a8737254385f2934b59de39b02ac3e322"><div class="ttname"><a href="classEventPlayer.html#a8737254385f2934b59de39b02ac3e322">EventPlayer::Tag</a></div><div class="ttdeci">const char * Tag() override</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00341">Serializer.h:341</a></div></div>
<div class="ttc" id="classSerializer_html_a05e8f4df571f66e5518028983edfd82b"><div class="ttname"><a href="classSerializer.html#a05e8f4df571f66e5518028983edfd82b">Serializer::UnserializeCall</a></div><div class="ttdeci">bool UnserializeCall(UnserialInfo *info)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8cc_source.html#l00322">Serializer.cc:322</a></div></div>
<div class="ttc" id="classEventHandlerPtr_html"><div class="ttname"><a href="classEventHandlerPtr.html">EventHandlerPtr</a></div><div class="ttdef"><b>Definition:</b> <a href="EventHandler_8h_source.html#l00086">EventHandler.h:86</a></div></div>
<div class="ttc" id="Serializer_8h_html_af24cd2e9bbf8d1ee6a2a9c191328be2d"><div class="ttname"><a href="Serializer_8h.html#af24cd2e9bbf8d1ee6a2a9c191328be2d">DECLARE_IO</a></div><div class="ttdeci">#define DECLARE_IO(type)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00052">Serializer.h:52</a></div></div>
<div class="ttc" id="classCloneSerializer_html_a9570c6e267b7e68c6c9c13d625a2605e"><div class="ttname"><a href="classCloneSerializer.html#a9570c6e267b7e68c6c9c13d625a2605e">CloneSerializer::GotPacket</a></div><div class="ttdeci">void GotPacket(Packet *packet) override</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00277">Serializer.h:277</a></div></div>
<div class="ttc" id="Reporter_8h_html"><div class="ttname"><a href="Reporter_8h.html">Reporter.h</a></div></div>
<div class="ttc" id="classSerializationCache_html_a65eb093b68ea8fb29a1294cffaa83efa"><div class="ttname"><a href="classSerializationCache.html#a65eb093b68ea8fb29a1294cffaa83efa">SerializationCache::GetMaxCacheSize</a></div><div class="ttdeci">unsigned int GetMaxCacheSize() const </div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00194">Serializer.h:194</a></div></div>
<div class="ttc" id="classEventPlayer_html_a021b3d2372d16d197939e2be20118edb"><div class="ttname"><a href="classEventPlayer.html#a021b3d2372d16d197939e2be20118edb">EventPlayer::ne_time</a></div><div class="ttdeci">double ne_time</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00354">Serializer.h:354</a></div></div>
<div class="ttc" id="classStateAccess_html"><div class="ttname"><a href="classStateAccess.html">StateAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="StateAccess_8h_source.html#l00033">StateAccess.h:33</a></div></div>
<div class="ttc" id="classSerializer_html_a48ffc55a9a71081b226ce2e5fa369012"><div class="ttname"><a href="classSerializer.html#a48ffc55a9a71081b226ce2e5fa369012">Serializer::Warning</a></div><div class="ttdeci">void Warning(const char *msg)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8cc_source.html#l00566">Serializer.cc:566</a></div></div>
<div class="ttc" id="util_8h_html_ac2a9e79eb120216f855626495b7bd18a"><div class="ttname"><a href="util_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a></div><div class="ttdeci">uint16_t uint16</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00065">util.h:65</a></div></div>
<div class="ttc" id="classSerializer_html_a6edcc06a039cec985d9fdef668946132"><div class="ttname"><a href="classSerializer.html#a6edcc06a039cec985d9fdef668946132">Serializer::GotID</a></div><div class="ttdeci">virtual void GotID(ID *id, Val *val)=0</div></div>
<div class="ttc" id="classiosource_1_1FD__Set_html"><div class="ttname"><a href="classiosource_1_1FD__Set.html">iosource::FD_Set</a></div><div class="ttdef"><b>Definition:</b> <a href="FD__Set_8h_source.html#l00012">FD_Set.h:12</a></div></div>
<div class="ttc" id="classSerializer_html_aac6f58ac38683e0f962a2e33301483cd"><div class="ttname"><a href="classSerializer.html#aac6f58ac38683e0f962a2e33301483cd">Serializer::GotPacket</a></div><div class="ttdeci">virtual void GotPacket(Packet *packet)=0</div></div>
<div class="ttc" id="classSerializationCache_html_ae2a660fd7aa8f3939a00d7d099a18f8b"><div class="ttname"><a href="classSerializationCache.html#ae2a660fd7aa8f3939a00d7d099a18f8b">SerializationCache::Lookup</a></div><div class="ttdeci">const SerialObj * Lookup(PermanentID pid)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00168">Serializer.h:168</a></div></div>
<div class="ttc" id="classCloneSerializer_html_ab0912c03bce847b2b4d7a1e8cb0cfa93"><div class="ttname"><a href="classCloneSerializer.html#ab0912c03bce847b2b4d7a1e8cb0cfa93">CloneSerializer::~CloneSerializer</a></div><div class="ttdeci">~CloneSerializer() override</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00265">Serializer.h:265</a></div></div>
<div class="ttc" id="classFileSerializer_html_a6896fbb3fa8a9f492b87fa018a60e68f"><div class="ttname"><a href="classFileSerializer.html#a6896fbb3fa8a9f492b87fa018a60e68f">FileSerializer::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00313">Serializer.h:313</a></div></div>
<div class="ttc" id="structSerializationCache_1_1CacheEntry_html_a94b9d55fb7a287d80fa92f49173e6b6d"><div class="ttname"><a href="structSerializationCache_1_1CacheEntry.html#a94b9d55fb7a287d80fa92f49173e6b6d">SerializationCache::CacheEntry::next</a></div><div class="ttdeci">CacheEntry * next</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00223">Serializer.h:223</a></div></div>
<div class="ttc" id="classSerializationCache_html_abd7f86616566399bf20077e3fda588f3"><div class="ttname"><a href="classSerializationCache.html#abd7f86616566399bf20077e3fda588f3">SerializationCache::Begin</a></div><div class="ttdeci">void Begin(bool can_keep_in_cache)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00202">Serializer.h:202</a></div></div>
<div class="ttc" id="classSerialObj_html_a97edec325159775e4b89b86702daf009"><div class="ttname"><a href="classSerialObj.html#a97edec325159775e4b89b86702daf009">SerialObj::ALWAYS</a></div><div class="ttdeci">static const uint64 ALWAYS</div><div class="ttdef"><b>Definition:</b> <a href="SerialObj_8h_source.html#l00077">SerialObj.h:77</a></div></div>
<div class="ttc" id="classEventPlayer_html_abfa8204c66fc74ca50d169309cd28de8"><div class="ttname"><a href="classEventPlayer.html#abfa8204c66fc74ca50d169309cd28de8">EventPlayer::ne_args</a></div><div class="ttdeci">val_list * ne_args</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00356">Serializer.h:356</a></div></div>
<div class="ttc" id="classSerializer_html_a74cdbbb980f93270dce39b65fe1e2983"><div class="ttname"><a href="classSerializer.html#a74cdbbb980f93270dce39b65fe1e2983">Serializer::Read</a></div><div class="ttdeci">bool Read(const char **str, int *len, const char *tag)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00067">Serializer.h:67</a></div></div>
<div class="ttc" id="classSerializationCache_html_a69e19ea4316ee670b89583b20b7877d3"><div class="ttname"><a href="classSerializationCache.html#a69e19ea4316ee670b89583b20b7877d3">SerializationCache::max_cache_size</a></div><div class="ttdeci">unsigned int max_cache_size</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00240">Serializer.h:240</a></div></div>
<div class="ttc" id="classSerializationCache_html_ac05b9630f5b805e96a4213de5491fc78"><div class="ttname"><a href="classSerializationCache.html#ac05b9630f5b805e96a4213de5491fc78">SerializationCache::cache_stable</a></div><div class="ttdeci">CacheList cache_stable</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00248">Serializer.h:248</a></div></div>
<div class="ttc" id="List_8h_html"><div class="ttname"><a href="List_8h.html">List.h</a></div></div>
<div class="ttc" id="classCloneSerializer_html_ab0a42860296d3c85bb4c41109d96e10c"><div class="ttname"><a href="classCloneSerializer.html#ab0a42860296d3c85bb4c41109d96e10c">CloneSerializer::GotConnection</a></div><div class="ttdeci">void GotConnection(Connection *c) override</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00276">Serializer.h:276</a></div></div>
<div class="ttc" id="classPacket_html"><div class="ttname"><a href="classPacket.html">Packet</a></div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00034">Packet.h:34</a></div></div>
<div class="ttc" id="classSerializationCache_html"><div class="ttname"><a href="classSerializationCache.html">SerializationCache</a></div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00155">Serializer.h:155</a></div></div>
<div class="ttc" id="classSerializer_html_abd83a9f6d10c049cd26149cec6e3c33d"><div class="ttname"><a href="classSerializer.html#abd83a9f6d10c049cd26149cec6e3c33d">Serializer::UnserializeID</a></div><div class="ttdeci">bool UnserializeID(UnserialInfo *info)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8cc_source.html#l00295">Serializer.cc:295</a></div></div>
<div class="ttc" id="classSerializer_html"><div class="ttname"><a href="classSerializer.html">Serializer</a></div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00028">Serializer.h:28</a></div></div>
<div class="ttc" id="classSerializer_html_aa37260fe5cca986611bed193ad2bcc61"><div class="ttname"><a href="classSerializer.html#aa37260fe5cca986611bed193ad2bcc61">Serializer::Serializer</a></div><div class="ttdeci">Serializer(SerializationFormat *format=0)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8cc_source.html#l00024">Serializer.cc:24</a></div></div>
<div class="ttc" id="classSerializationCache_html_a9bded21d4d0292d66c710da3b056cac4"><div class="ttname"><a href="classSerializationCache.html#a9bded21d4d0292d66c710da3b056cac4">SerializationCache::TIDMap</a></div><div class="ttdeci">map&lt; TransientID::ID, CacheEntry * &gt; TIDMap</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00243">Serializer.h:243</a></div></div>
<div class="ttc" id="classFunc_html"><div class="ttname"><a href="classFunc.html">Func</a></div><div class="ttdef"><b>Definition:</b> <a href="Func_8h_source.html#l00020">Func.h:20</a></div></div>
<div class="ttc" id="classSerializer_html_a3b7c705a7d981e7193c25b154bbb9198"><div class="ttname"><a href="classSerializer.html#a3b7c705a7d981e7193c25b154bbb9198">Serializer::UnserializePacket</a></div><div class="ttdeci">bool UnserializePacket(UnserialInfo *info)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8cc_source.html#l00531">Serializer.cc:531</a></div></div>
<div class="ttc" id="classSerializer_html_af85cacacb31d93c2c20d411e524fc812"><div class="ttname"><a href="classSerializer.html#af85cacacb31d93c2c20d411e524fc812">Serializer::Write</a></div><div class="ttdeci">bool Write(const char *buf, int len, const char *tag)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00077">Serializer.h:77</a></div></div>
<div class="ttc" id="util_8cc_html_af3956694b3af6026e660199a29b794da"><div class="ttname"><a href="util_8cc.html#af3956694b3af6026e660199a29b794da">copy_string</a></div><div class="ttdeci">char * copy_string(const char *s)</div><div class="ttdef"><b>Definition:</b> <a href="util_8cc_source.html#l00172">util.cc:172</a></div></div>
<div class="ttc" id="classSerializer_html_ada3000980f780365946168e4e9e08738"><div class="ttname"><a href="classSerializer.html#ada3000980f780365946168e4e9e08738">Serializer::EndSerialization</a></div><div class="ttdeci">bool EndSerialization(SerialInfo *info)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8cc_source.html#l00072">Serializer.cc:72</a></div></div>
<div class="ttc" id="classSerializer_html_a42a7d2d8e622ad1ef5f869813b498aa9"><div class="ttname"><a href="classSerializer.html#a42a7d2d8e622ad1ef5f869813b498aa9">Serializer::~Serializer</a></div><div class="ttdeci">virtual ~Serializer()</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8cc_source.html#l00036">Serializer.cc:36</a></div></div>
<div class="ttc" id="classSerializer_html_a3001c37e01b7b54dcc9c28d008d1e546"><div class="ttname"><a href="classSerializer.html#a3001c37e01b7b54dcc9c28d008d1e546">Serializer::DATA_FORMAT_VERSION</a></div><div class="ttdeci">static const uint32 DATA_FORMAT_VERSION</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00128">Serializer.h:128</a></div></div>
<div class="ttc" id="classSerializationCache_html_a210d9252f8b4520827029eb2bb51d2e6"><div class="ttname"><a href="classSerializationCache.html#a210d9252f8b4520827029eb2bb51d2e6">SerializationCache::next_id</a></div><div class="ttdeci">PermanentID next_id</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00256">Serializer.h:256</a></div></div>
<div class="ttc" id="structSerializationCache_1_1CacheEntry_html_a9d310cd7ed74f303daa83a5ad963f244"><div class="ttname"><a href="structSerializationCache_1_1CacheEntry.html#a9d310cd7ed74f303daa83a5ad963f244">SerializationCache::CacheEntry::prev</a></div><div class="ttdeci">CacheEntry * prev</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00222">Serializer.h:222</a></div></div>
<div class="ttc" id="structSerializationCache_1_1CacheEntry_html_a0bd6afcd5f070e5ba6a4b98b55ded235"><div class="ttname"><a href="structSerializationCache_1_1CacheEntry.html#a0bd6afcd5f070e5ba6a4b98b55ded235">SerializationCache::CacheEntry::cache</a></div><div class="ttdeci">struct CacheList * cache</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00221">Serializer.h:221</a></div></div>
<div class="ttc" id="classEventPlayer_html_a07ddb048ce74c5ac5653771607dd5a50"><div class="ttname"><a href="classEventPlayer.html#a07ddb048ce74c5ac5653771607dd5a50">EventPlayer::replay_time</a></div><div class="ttdeci">double replay_time</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00351">Serializer.h:351</a></div></div>
<div class="ttc" id="classSerializer_html_a9caeaff12c48fd899e2007692f23040d"><div class="ttname"><a href="classSerializer.html#a9caeaff12c48fd899e2007692f23040d">Serializer::StartSerialization</a></div><div class="ttdeci">bool StartSerialization(SerialInfo *info, const char *descr, char tag)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8cc_source.html#l00056">Serializer.cc:56</a></div></div>
<div class="ttc" id="classSerializer_html_a3643829e134588c8e88b74cb6f870ae2"><div class="ttname"><a href="classSerializer.html#a3643829e134588c8e88b74cb6f870ae2">Serializer::SetErrorDescr</a></div><div class="ttdeci">void SetErrorDescr(const char *descr)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00094">Serializer.h:94</a></div></div>
<div class="ttc" id="classSerializer_html_afa129a62ce54e608bacd2ebb430d760a"><div class="ttname"><a href="classSerializer.html#afa129a62ce54e608bacd2ebb430d760a">Serializer::Write</a></div><div class="ttdeci">bool Write(const IPPrefix &amp;p, const char *tag)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00082">Serializer.h:82</a></div></div>
<div class="ttc" id="classFileSerializer_html"><div class="ttname"><a href="classFileSerializer.html">FileSerializer</a></div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00281">Serializer.h:281</a></div></div>
<div class="ttc" id="classSerializer_html_a14d43ffbf27d3b4fc1a797ddc73ed989"><div class="ttname"><a href="classSerializer.html#a14d43ffbf27d3b4fc1a797ddc73ed989">Serializer::format</a></div><div class="ttdeci">SerializationFormat * format</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00143">Serializer.h:143</a></div></div>
<div class="ttc" id="util_8h_html_acbd4acd0d29e2d6c43104827f77d9cd2"><div class="ttname"><a href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00064">util.h:64</a></div></div>
<div class="ttc" id="classEventPlayer_html_a6f827c1df42cad818f981c35bef9b1cc"><div class="ttname"><a href="classEventPlayer.html#a6f827c1df42cad818f981c35bef9b1cc">EventPlayer::stream_time</a></div><div class="ttdeci">double stream_time</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00350">Serializer.h:350</a></div></div>
<div class="ttc" id="classSerializationFormat_html_ab19ba3d144fad73396968e23a5baad8d"><div class="ttname"><a href="classSerializationFormat.html#ab19ba3d144fad73396968e23a5baad8d">SerializationFormat::WriteSeparator</a></div><div class="ttdeci">virtual bool WriteSeparator()=0</div></div>
<div class="ttc" id="classSerializer_html_a50e7aa303cf11db5c327af101683a720"><div class="ttname"><a href="classSerializer.html#a50e7aa303cf11db5c327af101683a720">Serializer::GotEvent</a></div><div class="ttdeci">virtual void GotEvent(const char *name, double time, EventHandlerPtr event, val_list *args)=0</div></div>
<div class="ttc" id="classSerializer_html_a68e2026fac3d55a37bf2660136541adf"><div class="ttname"><a href="classSerializer.html#a68e2026fac3d55a37bf2660136541adf">Serializer::UnserializeTimer</a></div><div class="ttdeci">bool UnserializeTimer(UnserialInfo *info)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8cc_source.html#l00465">Serializer.cc:465</a></div></div>
<div class="ttc" id="classTransientID_html_a3f93ead786a442f0d8ca3028c62ef561"><div class="ttname"><a href="classTransientID.html#a3f93ead786a442f0d8ca3028c62ef561">TransientID::Value</a></div><div class="ttdeci">ID Value() const </div><div class="ttdef"><b>Definition:</b> <a href="SerialObj_8h_source.html#l00057">SerialObj.h:57</a></div></div>
<div class="ttc" id="classCloneSerializer_html_abc9ddd9b6cd41a23005ef9f4b20088b6"><div class="ttname"><a href="classCloneSerializer.html#abc9ddd9b6cd41a23005ef9f4b20088b6">CloneSerializer::CloneSerializer</a></div><div class="ttdeci">CloneSerializer(SerializationFormat *format=0)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00264">Serializer.h:264</a></div></div>
<div class="ttc" id="classEventPlayer_html_a3fd636f6372df2e8b6ebb802f2346c37"><div class="ttname"><a href="classEventPlayer.html#a3fd636f6372df2e8b6ebb802f2346c37">EventPlayer::GotID</a></div><div class="ttdeci">void GotID(ID *id, Val *val) override</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00344">Serializer.h:344</a></div></div>
<div class="ttc" id="util_8h_html_abc0f5bc07737e498f287334775dff2b6"><div class="ttname"><a href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a></div><div class="ttdeci">uint64_t uint64</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00063">util.h:63</a></div></div>
<div class="ttc" id="classSerializer_html_af72408415174bb4d39e049dd3b5df465"><div class="ttname"><a href="classSerializer.html#af72408415174bb4d39e049dd3b5df465">Serializer::WriteCloseTag</a></div><div class="ttdeci">bool WriteCloseTag(const char *tag)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00086">Serializer.h:86</a></div></div>
<div class="ttc" id="structSerializationCache_1_1CacheList_html_a4e9b1539a6a34a3a85286b8558e44257"><div class="ttname"><a href="structSerializationCache_1_1CacheList.html#a4e9b1539a6a34a3a85286b8558e44257">SerializationCache::CacheList::size</a></div><div class="ttdeci">unsigned int size</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00233">Serializer.h:233</a></div></div>
<div class="ttc" id="classEventSource_html"><div class="ttname"><a href="classEventSource.html">EventSource</a></div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00317">Serializer.h:317</a></div></div>
<div class="ttc" id="structSerializationCache_1_1CacheEntry_html_a7fdb3d12205eab1eded0d5da2cad5690"><div class="ttname"><a href="structSerializationCache_1_1CacheEntry.html#a7fdb3d12205eab1eded0d5da2cad5690">SerializationCache::CacheEntry::pid</a></div><div class="ttdeci">PermanentID pid</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00218">Serializer.h:218</a></div></div>
<div class="ttc" id="classSerializationCache_html_aaac21d276b5287cc14c08d669457c4f6"><div class="ttname"><a href="classSerializationCache.html#aaac21d276b5287cc14c08d669457c4f6">SerializationCache::SetMaxCacheSize</a></div><div class="ttdeci">void SetMaxCacheSize(unsigned int size)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00195">Serializer.h:195</a></div></div>
<div class="ttc" id="structSerializationCache_1_1CacheList_html_a62432a0633b3b55a21c42b83ab8a7599"><div class="ttname"><a href="structSerializationCache_1_1CacheList.html#a62432a0633b3b55a21c42b83ab8a7599">SerializationCache::CacheList::tail</a></div><div class="ttdeci">CacheEntry * tail</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00232">Serializer.h:232</a></div></div>
<div class="ttc" id="ChunkedIO_8h_html"><div class="ttname"><a href="ChunkedIO_8h.html">ChunkedIO.h</a></div></div>
<div class="ttc" id="classSerializer_html_a314a0fad70bc1d5cb01b130d76ae0717"><div class="ttname"><a href="classSerializer.html#a314a0fad70bc1d5cb01b130d76ae0717">Serializer::MAGIC</a></div><div class="ttdeci">static const uint32 MAGIC</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00124">Serializer.h:124</a></div></div>
<div class="ttc" id="classBroObj_html"><div class="ttname"><a href="classBroObj.html">BroObj</a></div><div class="ttdef"><b>Definition:</b> <a href="Obj_8h_source.html#l00089">Obj.h:89</a></div></div>
<div class="ttc" id="StateAccess_8h_html"><div class="ttname"><a href="StateAccess_8h.html">StateAccess.h</a></div></div>
<div class="ttc" id="classCloneSerializer_html_a525f236efea84fba72379be9f302bf42"><div class="ttname"><a href="classCloneSerializer.html#a525f236efea84fba72379be9f302bf42">CloneSerializer::GotTimer</a></div><div class="ttdeci">void GotTimer(Timer *t) override</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00275">Serializer.h:275</a></div></div>
<div class="ttc" id="classSerializer_html_a36c8799f2342ab53c5357de5f210a8a8"><div class="ttname"><a href="classSerializer.html#a36c8799f2342ab53c5357de5f210a8a8">Serializer::ReportError</a></div><div class="ttdeci">virtual void ReportError(const char *msg)=0</div></div>
<div class="ttc" id="classSerializationCache_html_a591cc59b4140f019a1e5c62921c0b182"><div class="ttname"><a href="classSerializationCache.html#a591cc59b4140f019a1e5c62921c0b182">SerializationCache::PermanentID</a></div><div class="ttdeci">uint64 PermanentID</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00157">Serializer.h:157</a></div></div>
<div class="ttc" id="classTransientID_html_a3f2abce52a75170607daffe9f165013c"><div class="ttname"><a href="classTransientID.html#a3f2abce52a75170607daffe9f165013c">TransientID::ID</a></div><div class="ttdeci">unsigned long long ID</div><div class="ttdef"><b>Definition:</b> <a href="SerialObj_8h_source.html#l00056">SerialObj.h:56</a></div></div>
<div class="ttc" id="SerialTypes_8h_html_add49e82f76bb3390a108e21f6246025e"><div class="ttname"><a href="SerialTypes_8h.html#add49e82f76bb3390a108e21f6246025e">SerialType</a></div><div class="ttdeci">uint16 SerialType</div><div class="ttdef"><b>Definition:</b> <a href="SerialTypes_8h_source.html#l00013">SerialTypes.h:13</a></div></div>
<div class="ttc" id="classSerializer_html_ab88f3d44125bc2c650e846b69bbded23"><div class="ttname"><a href="classSerializer.html#ab88f3d44125bc2c650e846b69bbded23">Serializer::Write</a></div><div class="ttdeci">bool Write(const IPAddr &amp;a, const char *tag)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00081">Serializer.h:81</a></div></div>
<div class="ttc" id="structSerializationCache_1_1CacheEntry_html_ad7b38cb8a4c0c66a88a977f487d4a004"><div class="ttname"><a href="structSerializationCache_1_1CacheEntry.html#ad7b38cb8a4c0c66a88a977f487d4a004">SerializationCache::CacheEntry::is_bro_obj</a></div><div class="ttdeci">bool is_bro_obj</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00217">Serializer.h:217</a></div></div>
<div class="ttc" id="classSerializationCache_html_adfff535c892f498071febfdb5253a707"><div class="ttname"><a href="classSerializationCache.html#adfff535c892f498071febfdb5253a707">SerializationCache::tid_map</a></div><div class="ttdeci">TIDMap tid_map</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00245">Serializer.h:245</a></div></div>
<div class="ttc" id="classSerializer_html_ab3c01c59a97a98d832c58a1373ae2da0"><div class="ttname"><a href="classSerializer.html#ab3c01c59a97a98d832c58a1373ae2da0">Serializer::Read</a></div><div class="ttdeci">bool Read(IPPrefix *p, const char *tag)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00073">Serializer.h:73</a></div></div>
<div class="ttc" id="classReporter_html_ac67df7fad58e8835b7b4df857ee82363"><div class="ttname"><a href="classReporter.html#ac67df7fad58e8835b7b4df857ee82363">Reporter::Error</a></div><div class="ttdeci">void Error(const char *fmt,...) FMT_ATTR</div><div class="ttdef"><b>Definition:</b> <a href="Reporter_8cc_source.html#l00096">Reporter.cc:96</a></div></div>
<div class="ttc" id="PriorityQueue_8h_html"><div class="ttname"><a href="PriorityQueue_8h.html">PriorityQueue.h</a></div></div>
<div class="ttc" id="classTimer_html"><div class="ttname"><a href="classTimer.html">Timer</a></div><div class="ttdef"><b>Definition:</b> <a href="Timer_8h_source.html#l00057">Timer.h:57</a></div></div>
<div class="ttc" id="classSerializationFormat_html_a4497cf41ed1a6521207c63e2f3a126c7"><div class="ttname"><a href="classSerializationFormat.html#a4497cf41ed1a6521207c63e2f3a126c7">SerializationFormat::Read</a></div><div class="ttdeci">virtual bool Read(int *v, const char *tag)=0</div></div>
<div class="ttc" id="classSerializationCache_html_a2ae9e37ed0b70ab99748a6f671a34a77"><div class="ttname"><a href="classSerializationCache.html#a2ae9e37ed0b70ab99748a6f671a34a77">SerializationCache::pid_map</a></div><div class="ttdeci">PIDMap pid_map</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00246">Serializer.h:246</a></div></div>
<div class="ttc" id="classSerializer_html_ad4632c86c14641a7c1e95218a766857f"><div class="ttname"><a href="classSerializer.html#ad4632c86c14641a7c1e95218a766857f">Serializer::Write</a></div><div class="ttdeci">bool Write(const char *s, const char *tag)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00075">Serializer.h:75</a></div></div>
<div class="ttc" id="Expr_8h_html"><div class="ttname"><a href="Expr_8h.html">Expr.h</a></div></div>
<div class="ttc" id="classConnection_html"><div class="ttname"><a href="classConnection.html">Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00059">Conn.h:59</a></div></div>
<div class="ttc" id="classID_html"><div class="ttname"><a href="classID.html">ID</a></div><div class="ttdef"><b>Definition:</b> <a href="ID_8h_source.html#l00019">ID.h:19</a></div></div>
<div class="ttc" id="classSerializationCache_html_a01f6d17ed10fdc1fa2a8f91d84381518"><div class="ttname"><a href="classSerializationCache.html#a01f6d17ed10fdc1fa2a8f91d84381518">SerializationCache::cache_unstable</a></div><div class="ttdeci">CacheList cache_unstable</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00249">Serializer.h:249</a></div></div>
<div class="ttc" id="classChunkedIO_html"><div class="ttname"><a href="classChunkedIO.html">ChunkedIO</a></div><div class="ttdef"><b>Definition:</b> <a href="ChunkedIO_8h_source.html#l00022">ChunkedIO.h:22</a></div></div>
<div class="ttc" id="classSerializer_html_ab2f042a8509377281969d191ac0ba882"><div class="ttname"><a href="classSerializer.html#ab2f042a8509377281969d191ac0ba882">Serializer::GotStateAccess</a></div><div class="ttdeci">virtual void GotStateAccess(StateAccess *s)=0</div></div>
<div class="ttc" id="classSerializer_html_ae438ebcb5df72454ef6e7d084899c0f6"><div class="ttname"><a href="classSerializer.html#ae438ebcb5df72454ef6e7d084899c0f6">Serializer::UnserializeConnection</a></div><div class="ttdeci">bool UnserializeConnection(UnserialInfo *info)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8cc_source.html#l00490">Serializer.cc:490</a></div></div>
<div class="ttc" id="classCloneSerializer_html_a807762419ab6baadebb8b13e76c06834"><div class="ttname"><a href="classCloneSerializer.html#a807762419ab6baadebb8b13e76c06834">CloneSerializer::GotEvent</a></div><div class="ttdeci">void GotEvent(const char *name, double time, EventHandlerPtr event, val_list *args) override</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00271">Serializer.h:271</a></div></div>
<div class="ttc" id="classSerializationCache_html_aa17e2df73a1389d527e01fadea39e73a"><div class="ttname"><a href="classSerializationCache.html#aa17e2df73a1389d527e01fadea39e73a">SerializationCache::Lookup</a></div><div class="ttdeci">PermanentID Lookup(const TransientID &amp;tid)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00179">Serializer.h:179</a></div></div>
<div class="ttc" id="Serializer_8h_html_ad45281de269b5dbd557452da44b10f0f"><div class="ttname"><a href="Serializer_8h.html#ad45281de269b5dbd557452da44b10f0f">state_serializer</a></div><div class="ttdeci">FileSerializer * state_serializer</div><div class="ttdef"><b>Definition:</b> <a href="main_8cc_source.html#l00105">main.cc:105</a></div></div>
<div class="ttc" id="IP_8h_html"><div class="ttname"><a href="IP_8h.html">IP.h</a></div></div>
<div class="ttc" id="classEventSource_html_a667da0cd3be10febb0eaf9e7946d1b8f"><div class="ttname"><a href="classEventSource.html#a667da0cd3be10febb0eaf9e7946d1b8f">EventSource::~EventSource</a></div><div class="ttdeci">virtual ~EventSource()</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00319">Serializer.h:319</a></div></div>
<div class="ttc" id="Serializer_8h_html_a5d66cb16d0171245396508fa5c0437be"><div class="ttname"><a href="Serializer_8h.html#a5d66cb16d0171245396508fa5c0437be">event_serializer</a></div><div class="ttdeci">FileSerializer * event_serializer</div><div class="ttdef"><b>Definition:</b> <a href="main_8cc_source.html#l00104">main.cc:104</a></div></div>
<div class="ttc" id="structSerializationCache_1_1CacheList_html"><div class="ttname"><a href="structSerializationCache_1_1CacheList.html">SerializationCache::CacheList</a></div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00230">Serializer.h:230</a></div></div>
<div class="ttc" id="classSerializer_html_a6d91fed6d9e22b3f38fe8acb650d1132"><div class="ttname"><a href="classSerializer.html#a6d91fed6d9e22b3f38fe8acb650d1132">Serializer::error_descr</a></div><div class="ttdeci">const char * error_descr</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00145">Serializer.h:145</a></div></div>
<div class="ttc" id="classSerializer_html_a9f02b4bc92751aab0ac5b490de9c8cc6"><div class="ttname"><a href="classSerializer.html#a9f02b4bc92751aab0ac5b490de9c8cc6">Serializer::SetCache</a></div><div class="ttdeci">void SetCache(SerializationCache *cache)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00040">Serializer.h:40</a></div></div>
<div class="ttc" id="structSerializationCache_1_1CacheList_html_ab37ad2cf56e5763d88fb50fa5dde7092"><div class="ttname"><a href="structSerializationCache_1_1CacheList.html#ab37ad2cf56e5763d88fb50fa5dde7092">SerializationCache::CacheList::head</a></div><div class="ttdeci">CacheEntry * head</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00231">Serializer.h:231</a></div></div>
<div class="ttc" id="structSerializationCache_1_1CacheEntry_html_a24779e81f126147e9c7a8bc2d8cade1c"><div class="ttname"><a href="structSerializationCache_1_1CacheEntry.html#a24779e81f126147e9c7a8bc2d8cade1c">SerializationCache::CacheEntry::tid</a></div><div class="ttdeci">TransientID::ID tid</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00219">Serializer.h:219</a></div></div>
<div class="ttc" id="classSerializer_html_a177b4062931e4dd756a2615e4c5e5f91"><div class="ttname"><a href="classSerializer.html#a177b4062931e4dd756a2615e4c5e5f91">Serializer::Unserialize</a></div><div class="ttdeci">int Unserialize(UnserialInfo *info, bool block=false)</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8cc_source.html#l00220">Serializer.cc:220</a></div></div>
<div class="ttc" id="classFileSerializer_html_aa772566a15104ca3f80c23d848da18e4"><div class="ttname"><a href="classFileSerializer.html#aa772566a15104ca3f80c23d848da18e4">FileSerializer::cache</a></div><div class="ttdeci">SerializationCache cache</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00311">Serializer.h:311</a></div></div>
<div class="ttc" id="classCloneSerializer_html_add8f3bce26420698f2ae4ecb39c16b9f"><div class="ttname"><a href="classCloneSerializer.html#add8f3bce26420698f2ae4ecb39c16b9f">CloneSerializer::GotStateAccess</a></div><div class="ttdeci">void GotStateAccess(StateAccess *s) override</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00274">Serializer.h:274</a></div></div>
<div class="ttc" id="classFileSerializer_html_a2a5241903c970d80972db651d349daf5"><div class="ttname"><a href="classFileSerializer.html#a2a5241903c970d80972db651d349daf5">FileSerializer::file</a></div><div class="ttdeci">const char * file</div><div class="ttdef"><b>Definition:</b> <a href="Serializer_8h_source.html#l00312">Serializer.h:312</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
