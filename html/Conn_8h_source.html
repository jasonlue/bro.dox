<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>bro: /home/jasonlu/bro/src/Conn.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">bro
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5b988f0c4d1fda8dce2b23100e7167dd.html">bro</a></li><li class="navelem"><a class="el" href="dir_1ae927ab70ca550cfc88d2a3fb3c22b4.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Conn.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="Conn_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// See the file &quot;COPYING&quot; in the main distribution directory for copyright.</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#ifndef conn_h</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#define conn_h</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;sys/types.h&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;unordered_map&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Dict_8h.html">Dict.h</a>&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Val_8h.html">Val.h</a>&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Timer_8h.html">Timer.h</a>&quot;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Serializer_8h.html">Serializer.h</a>&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PersistenceSerializer_8h.html">PersistenceSerializer.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="RuleMatcher_8h.html">RuleMatcher.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IPAddr_8h.html">IPAddr.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TunnelEncapsulation_8h.html">TunnelEncapsulation.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="UID_8h.html">UID.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="analyzer_2Tag_8h.html">analyzer/Tag.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="analyzer_2Analyzer_8h.html">analyzer/Analyzer.h</a>&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">class </span><a class="code" href="classConnection.html">Connection</a>;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">class </span><a class="code" href="classConnectionTimer.html">ConnectionTimer</a>;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">class </span><a class="code" href="classNetSessions.html">NetSessions</a>;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">class </span>LoginConn;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">class </span><a class="code" href="classRuleHdrTest.html">RuleHdrTest</a>;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">class </span><a class="code" href="classSpecific__RE__Matcher.html">Specific_RE_Matcher</a>;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">class </span><a class="code" href="classRuleEndpointState.html">RuleEndpointState</a>;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceanalyzer.html">analyzer</a> { <span class="keyword">class </span>TransportLayerAnalyzer; }</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="Conn_8h.html#a80f6c169681367b70eddc3b90d23eaf8">   34</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">enum</span> {</div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="Conn_8h.html#a80f6c169681367b70eddc3b90d23eaf8a33c652ed465d53417405a0656e698264">   35</a></span>&#160;    <a class="code" href="Conn_8h.html#a80f6c169681367b70eddc3b90d23eaf8a33c652ed465d53417405a0656e698264">NUL_IN_LINE</a>,</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="Conn_8h.html#a80f6c169681367b70eddc3b90d23eaf8a5f46044b1163aaac2333619ffb899f7d">   36</a></span>&#160;    <a class="code" href="Conn_8h.html#a80f6c169681367b70eddc3b90d23eaf8a5f46044b1163aaac2333619ffb899f7d">SINGULAR_CR</a>,</div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="Conn_8h.html#a80f6c169681367b70eddc3b90d23eaf8a0b644a086437e7e33b2481be8b22f3fc">   37</a></span>&#160;    <a class="code" href="Conn_8h.html#a80f6c169681367b70eddc3b90d23eaf8a0b644a086437e7e33b2481be8b22f3fc">SINGULAR_LF</a>,</div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="Conn_8h.html#a80f6c169681367b70eddc3b90d23eaf8aae94a0f40bcdb6009498a3ba0ed894d2">   38</a></span>&#160;    <a class="code" href="Conn_8h.html#a80f6c169681367b70eddc3b90d23eaf8aae94a0f40bcdb6009498a3ba0ed894d2">NUM_EVENTS_TO_FLAG</a>,</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;} <a class="code" href="Conn_8h.html#a80f6c169681367b70eddc3b90d23eaf8">ConnEventToFlag</a>;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="Conn_8h.html#ada976197ef4fddba1b5d3c2d7a8f62c8">   41</a></span>&#160;<span class="keyword">typedef</span> void (<a class="code" href="classConnection.html">Connection</a>::*<a class="code" href="Conn_8h.html#ada976197ef4fddba1b5d3c2d7a8f62c8">timer_func</a>)(<span class="keywordtype">double</span> t);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="structConnID.html">   43</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structConnID.html">ConnID</a> {</div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="structConnID.html#ab31d61d52f47a05528fc220c295d6f29">   44</a></span>&#160;    <a class="code" href="classIPAddr.html">IPAddr</a> <a class="code" href="structConnID.html#ab31d61d52f47a05528fc220c295d6f29">src_addr</a>;</div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="structConnID.html#ad08208ae83226b86815b6b6f787531e5">   45</a></span>&#160;    <a class="code" href="classIPAddr.html">IPAddr</a> <a class="code" href="structConnID.html#ad08208ae83226b86815b6b6f787531e5">dst_addr</a>;</div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="structConnID.html#ae9ad37d2e62210daa8955938351b61a2">   46</a></span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="structConnID.html#ae9ad37d2e62210daa8955938351b61a2">src_port</a>;</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="structConnID.html#a76f9ae769858dca80ed4d4c254194300">   47</a></span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="structConnID.html#a76f9ae769858dca80ed4d4c254194300">dst_port</a>;</div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="structConnID.html#aafcde0285d132c9f24f162df69ad08ce">   48</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structConnID.html#aafcde0285d132c9f24f162df69ad08ce">is_one_way</a>;    <span class="comment">// if true, don&#39;t canonicalize order</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;};</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="Conn_8h.html#aa104caa44a88fae508bbc8e9de30cb28">   51</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="Conn_8h.html#aa104caa44a88fae508bbc8e9de30cb28">addr_port_canon_lt</a>(<span class="keyword">const</span> <a class="code" href="classIPAddr.html">IPAddr</a>&amp; addr1, <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> p1,</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classIPAddr.html">IPAddr</a>&amp; addr2, <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> p2)</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">return</span> addr1 &lt; addr2 || (addr1 == addr2 &amp;&amp; p1 &lt; p2);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    }</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceanalyzer.html">analyzer</a> { <span class="keyword">class </span>Analyzer; }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="classConnection.html">   59</a></span>&#160;<span class="keyword">class </span><a class="code" href="classConnection.html">Connection</a> : <span class="keyword">public</span> <a class="code" href="classBroObj.html">BroObj</a> {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="classConnection.html">Connection</a>(<a class="code" href="classNetSessions.html">NetSessions</a>* s, <a class="code" href="classHashKey.html">HashKey</a>* k, <span class="keywordtype">double</span> t, <span class="keyword">const</span> <a class="code" href="structConnID.html">ConnID</a>* <span class="keywordtype">id</span>,</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;               <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> flow, <span class="keyword">const</span> <a class="code" href="classPacket.html">Packet</a>* pkt, <span class="keyword">const</span> <a class="code" href="classEncapsulationStack.html">EncapsulationStack</a>* arg_encap);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    ~<a class="code" href="classConnection.html">Connection</a>() <span class="keyword">override</span>;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="comment">// Invoked when an encapsulation is discovered. It records the</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// encapsulation with the connection and raises a &quot;tunnel_changed&quot;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">// event if it&#39;s different from the previous encapsulation (or the</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">// first encountered). encap can be null to indicate no</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// encapsulation.</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordtype">void</span> CheckEncapsulation(<span class="keyword">const</span> <a class="code" href="classEncapsulationStack.html">EncapsulationStack</a>* encap);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// Invoked when connection is about to be removed.  Use Ref(this)</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">// inside Done to keep the connection object around (though it&#39;ll</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// no longer be accessible from the dictionary of active</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">// connections).</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordtype">void</span> Done();</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// Process the connection&#39;s next packet.  &quot;data&quot; points just</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// beyond the IP header.  It&#39;s updated to point just beyond</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// the transport header (or whatever should be saved, if we</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// decide not to save the full packet contents).</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// If record_packet is true, the packet should be recorded.</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// If record_content is true, then its entire contents should</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// be recorded, otherwise just up through the transport header.</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// Both are assumed set to true when called.</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordtype">void</span> NextPacket(<span class="keywordtype">double</span> t, <span class="keywordtype">int</span> is_orig,</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <span class="keyword">const</span> <a class="code" href="classIP__Hdr.html">IP_Hdr</a>* ip, <span class="keywordtype">int</span> len, <span class="keywordtype">int</span> caplen,</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="keyword">const</span> u_char*&amp; data,</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keywordtype">int</span>&amp; record_packet, <span class="keywordtype">int</span>&amp; record_content,</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <span class="comment">// arguments for reproducing packets</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <span class="keyword">const</span> <a class="code" href="classPacket.html">Packet</a> *pkt);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="classConnection.html#a36e522312fdae78fef83d54c84f0e0b5">   94</a></span>&#160;    <a class="code" href="classHashKey.html">HashKey</a>* <a class="code" href="classConnection.html#a36e522312fdae78fef83d54c84f0e0b5">Key</a>()<span class="keyword"> const            </span>{ <span class="keywordflow">return</span> key; }</div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="classConnection.html#a76de4f28f08057de1c37910113989f7b">   95</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classConnection.html#a76de4f28f08057de1c37910113989f7b">ClearKey</a>()             { key = 0; }</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="classConnection.html#a4cb06f742acc06248ca7a23e377e0849">   97</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classConnection.html#a4cb06f742acc06248ca7a23e377e0849">StartTime</a>()<span class="keyword"> const        </span>{ <span class="keywordflow">return</span> start_time; }</div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="classConnection.html#aef7a8ab568adcda054cf6568a66c9822">   98</a></span>&#160;    <span class="keywordtype">void</span>  <a class="code" href="classConnection.html#aef7a8ab568adcda054cf6568a66c9822">SetStartTime</a>(<span class="keywordtype">double</span> t)        { start_time = t; }</div><div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="classConnection.html#a9513634e7dcf73a72fc5e566dc4f5159">   99</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classConnection.html#a9513634e7dcf73a72fc5e566dc4f5159">LastTime</a>()<span class="keyword"> const         </span>{ <span class="keywordflow">return</span> last_time; }</div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="classConnection.html#af4df7e68c03f2c898845ab2132a93180">  100</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classConnection.html#af4df7e68c03f2c898845ab2132a93180">SetLastTime</a>(<span class="keywordtype">double</span> t)      { last_time = t; }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classConnection.html#a2807492e6d4a7e525082873aa3a06ba1">  102</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="classIPAddr.html">IPAddr</a>&amp; <a class="code" href="classConnection.html#a2807492e6d4a7e525082873aa3a06ba1">OrigAddr</a>()<span class="keyword"> const      </span>{ <span class="keywordflow">return</span> orig_addr; }</div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="classConnection.html#a3f48a25b42b41c0de6515fd55f8df6ea">  103</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="classIPAddr.html">IPAddr</a>&amp; <a class="code" href="classConnection.html#a3f48a25b42b41c0de6515fd55f8df6ea">RespAddr</a>()<span class="keyword"> const      </span>{ <span class="keywordflow">return</span> resp_addr; }</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="classConnection.html#a9df9d1798854bd69944e838de68ed136">  105</a></span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="classConnection.html#a9df9d1798854bd69944e838de68ed136">OrigPort</a>()<span class="keyword"> const         </span>{ <span class="keywordflow">return</span> orig_port; }</div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="classConnection.html#a38f9bcd5cd5a658c9f3b58257bddb99b">  106</a></span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="classConnection.html#a38f9bcd5cd5a658c9f3b58257bddb99b">RespPort</a>()<span class="keyword"> const         </span>{ <span class="keywordflow">return</span> resp_port; }</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordtype">void</span> FlipRoles();</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="classanalyzer_1_1Analyzer.html">analyzer::Analyzer</a>* FindAnalyzer(<a class="code" href="namespaceanalyzer.html#a0f3859fceea28de62b71f4997f5f6c4f">analyzer::ID</a> <span class="keywordtype">id</span>);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="classanalyzer_1_1Analyzer.html">analyzer::Analyzer</a>* FindAnalyzer(<a class="code" href="classanalyzer_1_1Tag.html">analyzer::Tag</a> tag);    <span class="comment">// find first in tree.</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="classanalyzer_1_1Analyzer.html">analyzer::Analyzer</a>* FindAnalyzer(<span class="keyword">const</span> <span class="keywordtype">char</span>* name); <span class="comment">// find first in tree.</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="classConnection.html#a643bd6206b2b153fb082773e2c5f7a5e">  114</a></span>&#160;    <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7b">TransportProto</a> <a class="code" href="classConnection.html#a643bd6206b2b153fb082773e2c5f7a5e">ConnTransport</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> proto; }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// True if we should record subsequent packets (either headers or</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// in their entirety, depending on record_contents).  We still</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// record subsequent SYN/FIN/RST, regardless of how this is set.</span></div><div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="classConnection.html#ac5ae73f3e9b72f433bc889c5f4f0a56f">  119</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classConnection.html#ac5ae73f3e9b72f433bc889c5f4f0a56f">RecordPackets</a>()<span class="keyword"> const       </span>{ <span class="keywordflow">return</span> record_packets; }</div><div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="classConnection.html#a1bc60c50f1631342091cd4f12be055fe">  120</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classConnection.html#a1bc60c50f1631342091cd4f12be055fe">SetRecordPackets</a>(<span class="keywordtype">int</span> do_record)    { record_packets = do_record; }</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">// True if we should record full packets for this connection,</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">// false if we should just record headers.</span></div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="classConnection.html#a54c9530b9add10440e005d70b34e46b9">  124</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classConnection.html#a54c9530b9add10440e005d70b34e46b9">RecordContents</a>()<span class="keyword"> const      </span>{ <span class="keywordflow">return</span> record_contents; }</div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="classConnection.html#aba6b2cec35b0eff7c592a53db8e10768">  125</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classConnection.html#aba6b2cec35b0eff7c592a53db8e10768">SetRecordContents</a>(<span class="keywordtype">int</span> do_record)   { record_contents = do_record; }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// Set whether to record *current* packet header/full.</span></div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="classConnection.html#af7cac1c17f83cf4470976c0923f62a86">  128</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classConnection.html#af7cac1c17f83cf4470976c0923f62a86">SetRecordCurrentPacket</a>(<span class="keywordtype">int</span> do_record)</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        { record_current_packet = do_record; }</div><div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="classConnection.html#ad58d5b6b28efa1fed98390a50adaee23">  130</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classConnection.html#ad58d5b6b28efa1fed98390a50adaee23">SetRecordCurrentContent</a>(<span class="keywordtype">int</span> do_record)</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        { record_current_content = do_record; }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// FIXME: Now this is in Analyzer and should eventually be removed here.</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// If true, skip processing of remainder of connection.  Note</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// that this does not in itself imply that record_packets is false;</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// we might want instead to process the connection off-line.</span></div><div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="classConnection.html#adc1d038f98c86b00720eaf221790743d">  138</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classConnection.html#adc1d038f98c86b00720eaf221790743d">SetSkip</a>(<span class="keywordtype">int</span> do_skip)       { skip = do_skip; }</div><div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="classConnection.html#aa34eea9ee84acf315a13828d7cb955ed">  139</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classConnection.html#aa34eea9ee84acf315a13828d7cb955ed">Skipping</a>()<span class="keyword"> const            </span>{ <span class="keywordflow">return</span> skip; }</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">// Arrange for the connection to expire after the given amount of time.</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordtype">void</span> SetLifetime(<span class="keywordtype">double</span> lifetime);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">// Returns true if the packet reflects a reuse of this</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">// connection (i.e., not a continuation but the beginning of</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// a new connection).</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="namespaceanalyzer_1_1dns.html#a4eda0cc0d27726971bfe1253e4243445">IsReuse</a>(<span class="keywordtype">double</span> t, <span class="keyword">const</span> u_char* pkt);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// Get/set the inactivity timeout for this connection.</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordtype">void</span> SetInactivityTimeout(<span class="keywordtype">double</span> timeout);</div><div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="classConnection.html#ac9eede429301d9d08d354bf04d683a12">  151</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classConnection.html#ac9eede429301d9d08d354bf04d683a12">InactivityTimeout</a>()<span class="keyword"> const    </span>{ <span class="keywordflow">return</span> inactivity_timeout; }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">// Activate connection_status_update timer.</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordtype">void</span> EnableStatusUpdateTimer();</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="classRecordVal.html">RecordVal</a>* BuildConnVal();</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">void</span> AppendAddl(<span class="keyword">const</span> <span class="keywordtype">char</span>* str);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="classConnection.html#a3cbc75959216daf671e7d68c645313fc">  159</a></span>&#160;    LoginConn* <a class="code" href="classConnection.html#a3cbc75959216daf671e7d68c645313fc">AsLoginConn</a>()        { <span class="keywordflow">return</span> login_conn; }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordtype">void</span> Match(<a class="code" href="classRule.html#af6be8dfd23098aad37f3cd0188a0953b">Rule::PatternType</a> type, <span class="keyword">const</span> u_char* data, <span class="keywordtype">int</span> len,</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="keywordtype">bool</span> is_orig, <span class="keywordtype">bool</span> bol, <span class="keywordtype">bool</span> eol, <span class="keywordtype">bool</span> clear_state);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// Tries really hard to extract a program name and a version.</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="classVal.html">Val</a>* BuildVersionVal(<span class="keyword">const</span> <span class="keywordtype">char</span>* s, <span class="keywordtype">int</span> len);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// Raises a software_version_found event based on the</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// given string (returns false if it&#39;s not parseable).</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordtype">int</span> VersionFoundEvent(<span class="keyword">const</span> <a class="code" href="classIPAddr.html">IPAddr</a>&amp; addr, <span class="keyword">const</span> <span class="keywordtype">char</span>* s, <span class="keywordtype">int</span> len,</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                <a class="code" href="classanalyzer_1_1Analyzer.html">analyzer::Analyzer</a>* <a class="code" href="namespaceanalyzer.html">analyzer</a> = 0);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// Raises a software_unparsed_version_found event.</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordtype">int</span> UnparsedVersionFoundEvent(<span class="keyword">const</span> <a class="code" href="classIPAddr.html">IPAddr</a>&amp; addr,</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span>* full_descr, <span class="keywordtype">int</span> len, <a class="code" href="classanalyzer_1_1Analyzer.html">analyzer::Analyzer</a>* <a class="code" href="namespaceanalyzer.html">analyzer</a>);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classEvent.html">Event</a>(<a class="code" href="classEventHandlerPtr.html">EventHandlerPtr</a> f, <a class="code" href="classanalyzer_1_1Analyzer.html">analyzer::Analyzer</a>* analyzer, <span class="keyword">const</span> <span class="keywordtype">char</span>* name = 0);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordtype">void</span> Event(<a class="code" href="classEventHandlerPtr.html">EventHandlerPtr</a> f, <a class="code" href="classanalyzer_1_1Analyzer.html">analyzer::Analyzer</a>* analyzer, <a class="code" href="classVal.html">Val</a>* v1, <a class="code" href="classVal.html">Val</a>* v2 = 0);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordtype">void</span> ConnectionEvent(<a class="code" href="classEventHandlerPtr.html">EventHandlerPtr</a> f, <a class="code" href="classanalyzer_1_1Analyzer.html">analyzer::Analyzer</a>* analyzer,</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                val_list* vl);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordtype">void</span> Weird(<span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keyword">const</span> <span class="keywordtype">char</span>* addl = <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="classConnection.html#a28f61fd8e0e956aa94df456e5c3e61b0">  182</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classConnection.html#a28f61fd8e0e956aa94df456e5c3e61b0">DidWeird</a>()<span class="keyword"> const   </span>{ <span class="keywordflow">return</span> weird != 0; }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// Cancel all associated timers.</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordtype">void</span> CancelTimers();</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="classConnection.html#a1552f77a2e3c5f381c33d979ddd19067">  187</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classConnection.html#a1552f77a2e3c5f381c33d979ddd19067">FlagEvent</a>(<a class="code" href="Conn_8h.html#a80f6c169681367b70eddc3b90d23eaf8">ConnEventToFlag</a> e)</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordflow">if</span> ( e &gt;= 0 &amp;&amp; e &lt; <a class="code" href="Conn_8h.html#a80f6c169681367b70eddc3b90d23eaf8aae94a0f40bcdb6009498a3ba0ed894d2">NUM_EVENTS_TO_FLAG</a> )</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="keywordflow">if</span> ( suppress_event &amp; (1 &lt;&lt; e) )</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            suppress_event |= 1 &lt;&lt; e;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="classConnection.html#a9bd4b788939fb695973f9a72406baea6">  199</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classConnection.html#a9bd4b788939fb695973f9a72406baea6">MakePersistent</a>()</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        persistent = 1;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <a class="code" href="main_8cc.html#a1aff8a1f8e9083728732277f4726ad8d">persistence_serializer</a>-&gt;<a class="code" href="classPersistenceSerializer.html#a14f52c42537c7b1e04cccc0f211c5beb">Register</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        }</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="classConnection.html#ac30060d5450264467706a0036ef9044b">  205</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classConnection.html#ac30060d5450264467706a0036ef9044b">IsPersistent</a>() { <span class="keywordflow">return</span> persistent; }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordtype">void</span> Describe(<a class="code" href="classODesc.html">ODesc</a>* d) <span class="keyword">const override</span>;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordtype">void</span> IDString(<a class="code" href="classODesc.html">ODesc</a>* d) <span class="keyword">const</span>;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="classTimerMgr.html">TimerMgr</a>* GetTimerMgr() <span class="keyword">const</span>;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// Returns true if connection has been received externally.</span></div><div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="classConnection.html#adfcaaf6597ba088d49c347a88a1bc5a9">  213</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classConnection.html#adfcaaf6597ba088d49c347a88a1bc5a9">IsExternal</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> conn_timer_mgr != 0; }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordtype">bool</span> Serialize(<a class="code" href="classSerialInfo.html">SerialInfo</a>* info) <span class="keyword">const</span>;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keyword">static</span> <a class="code" href="classConnection.html">Connection</a>* Unserialize(<a class="code" href="classUnserialInfo.html">UnserialInfo</a>* info);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="SerialObj_8h.html#a1874dff178d4789461171fbbd3b57220">DECLARE_SERIAL</a>(<a class="code" href="classConnection.html">Connection</a>);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">// Statistics.</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">// Just a lower bound.</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> MemoryAllocation() <span class="keyword">const</span>;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> MemoryAllocationConnVal() <span class="keyword">const</span>;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="classConnection.html#aeb76920698c5ee0ab81c1de56b36e912">  226</a></span>&#160;    <span class="keyword">static</span> <a class="code" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> <a class="code" href="classConnection.html#aeb76920698c5ee0ab81c1de56b36e912">TotalConnections</a>()</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        { <span class="keywordflow">return</span> total_connections; }</div><div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="classConnection.html#a68d718e69d8619faf7957b2f64c3f79d">  228</a></span>&#160;    <span class="keyword">static</span> <a class="code" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> <a class="code" href="classConnection.html#a68d718e69d8619faf7957b2f64c3f79d">CurrentConnections</a>()</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        { <span class="keywordflow">return</span> current_connections; }</div><div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="classConnection.html#a81284e05d2cccb0f323b3c15a5dd817f">  230</a></span>&#160;    <span class="keyword">static</span> <a class="code" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> <a class="code" href="classConnection.html#a81284e05d2cccb0f323b3c15a5dd817f">CurrentExternalConnections</a>()</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        { <span class="keywordflow">return</span> external_connections; }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// Returns true if the history was already seen, false otherwise.</span></div><div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="classConnection.html#ad30c35fc864cc3318492651a6f5486b5">  234</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classConnection.html#ad30c35fc864cc3318492651a6f5486b5">CheckHistory</a>(<a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> mask, <span class="keywordtype">char</span> code)</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">if</span> ( (hist_seen &amp; mask) == 0 )</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            hist_seen |= mask;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            AddHistory(code);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">// Increments the passed counter and adds it as a history</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">// code if it has crossed the next scaling threshold.  Scaling</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">// is done in terms of powers of the third argument.</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">// Returns true if the threshold was crossed, false otherwise.</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordtype">bool</span> ScaledHistoryEntry(<span class="keywordtype">char</span> code, <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&amp; counter,</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                            <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>&amp; scaling_threshold,</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                            <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> scaling_base = 10);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordtype">void</span> HistoryThresholdEvent(<a class="code" href="classEventHandlerPtr.html">EventHandlerPtr</a> e, <span class="keywordtype">bool</span> is_orig,</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                               <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> threshold);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="classConnection.html#a835ce5799a3fc311ce6947c2d68c8e2b">  257</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classConnection.html#a835ce5799a3fc311ce6947c2d68c8e2b">AddHistory</a>(<span class="keywordtype">char</span> code)  { history += code; }</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordtype">void</span> DeleteTimer(<span class="keywordtype">double</span> t);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">// Sets the root of the analyzer tree as well as the primary PIA.</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordtype">void</span> SetRootAnalyzer(<a class="code" href="classanalyzer_1_1TransportLayerAnalyzer.html">analyzer::TransportLayerAnalyzer</a>* analyzer, <a class="code" href="classanalyzer_1_1pia_1_1PIA.html">analyzer::pia::PIA</a>* pia);</div><div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="classConnection.html#a52274612e2dbc076a2c5620c8215c50c">  263</a></span>&#160;    <a class="code" href="classanalyzer_1_1TransportLayerAnalyzer.html">analyzer::TransportLayerAnalyzer</a>* <a class="code" href="classConnection.html#a52274612e2dbc076a2c5620c8215c50c">GetRootAnalyzer</a>() { <span class="keywordflow">return</span> root_analyzer; }</div><div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="classConnection.html#aa1d0b76cfffa292436fe4acccb2053d1">  264</a></span>&#160;    <a class="code" href="classanalyzer_1_1pia_1_1PIA.html">analyzer::pia::PIA</a>* <a class="code" href="classConnection.html#aa1d0b76cfffa292436fe4acccb2053d1">GetPrimaryPIA</a>() { <span class="keywordflow">return</span> primary_PIA; }</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// Sets the transport protocol in use.</span></div><div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="classConnection.html#a13d3b4489fdba64ebe5ff817764c9863">  267</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classConnection.html#a13d3b4489fdba64ebe5ff817764c9863">SetTransport</a>(<a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7b">TransportProto</a> arg_proto) { proto = arg_proto; }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="classConnection.html#ac157de5e849f9cd5c64f3c4967bbe7c8">  269</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classConnection.html#ac157de5e849f9cd5c64f3c4967bbe7c8">SetUID</a>(<span class="keyword">const</span> <a class="code" href="classBro_1_1UID.html">Bro::UID</a> &amp;arg_uid)     { uid = arg_uid; }</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="classConnection.html#a173f279005065a009126c277f4216cdb">  271</a></span>&#160;    <a class="code" href="classBro_1_1UID.html">Bro::UID</a> <a class="code" href="classConnection.html#a173f279005065a009126c277f4216cdb">GetUID</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> uid; }</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="classConnection.html#a0655fd4d383eaf6dfc689700707c030f">  273</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="classEncapsulationStack.html">EncapsulationStack</a>* <a class="code" href="classConnection.html#a0655fd4d383eaf6dfc689700707c030f">GetEncapsulation</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="keyword">        </span>{ <span class="keywordflow">return</span> encapsulation; }</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordtype">void</span> CheckFlowLabel(<span class="keywordtype">bool</span> is_orig, <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> flow_label);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="classConnection.html#a5af1186178d0f110a8655b45876bb107">  278</a></span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="classConnection.html#a5af1186178d0f110a8655b45876bb107">GetOrigFlowLabel</a>() { <span class="keywordflow">return</span> orig_flow_label; }</div><div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="classConnection.html#ae8e8c3606daedac13b39c11688e0caf4">  279</a></span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="classConnection.html#ae8e8c3606daedac13b39c11688e0caf4">GetRespFlowLabel</a>() { <span class="keywordflow">return</span> resp_flow_label; }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordtype">bool</span> PermitWeird(<span class="keyword">const</span> <span class="keywordtype">char</span>* name, <a class="code" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> threshold, <a class="code" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> rate,</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                     <span class="keywordtype">double</span> duration);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="classConnection.html#a9de94289ca6259f94ef6aeba3b134a77">  286</a></span>&#160;    <a class="code" href="classConnection.html#a9de94289ca6259f94ef6aeba3b134a77">Connection</a>()    { persistent = 0; }</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">// Add the given timer to expire at time t.  If do_expire</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// is true, then the timer is also evaluated when Bro terminates,</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// otherwise not.</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordtype">void</span> AddTimer(<a class="code" href="Conn_8h.html#ada976197ef4fddba1b5d3c2d7a8f62c8">timer_func</a> timer, <span class="keywordtype">double</span> t, <span class="keywordtype">int</span> do_expire,</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <a class="code" href="Timer_8h.html#ad3a7c38fbde9814e427a75171fe8939d">TimerType</a> type);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordtype">void</span> RemoveTimer(<a class="code" href="classTimer.html">Timer</a>* t);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">// Allow other classes to access pointers to these:</span></div><div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="classConnection.html#a81d505f3f3907cce04022aa454b06ebb">  297</a></span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classConnectionTimer.html">ConnectionTimer</a>;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordtype">void</span> InactivityTimer(<span class="keywordtype">double</span> t);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordtype">void</span> StatusUpdateTimer(<span class="keywordtype">double</span> t);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordtype">void</span> RemoveConnectionTimer(<span class="keywordtype">double</span> t);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="classConnection.html#a241219f9280b07cb082272e9102ebbc6">  303</a></span>&#160;    <a class="code" href="classNetSessions.html">NetSessions</a>* <a class="code" href="classConnection.html#a241219f9280b07cb082272e9102ebbc6">sessions</a>;</div><div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="classConnection.html#a689d9c2b25d898b9f49128e3379af1f9">  304</a></span>&#160;    <a class="code" href="classHashKey.html">HashKey</a>* <a class="code" href="classConnection.html#a689d9c2b25d898b9f49128e3379af1f9">key</a>;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">// Timer manager to use for this conn (or nil).</span></div><div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="classConnection.html#a24c5af05bdb1cf4579ab5aba659667a4">  307</a></span>&#160;    <a class="code" href="classTimerMgr.html#a8d797fd4f0dc6dcf1e81026f0265c5f6">TimerMgr::Tag</a>* <a class="code" href="classConnection.html#a24c5af05bdb1cf4579ab5aba659667a4">conn_timer_mgr</a>;</div><div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="classConnection.html#a3f42f91d63f3f9f3578224113e599990">  308</a></span>&#160;    timer_list <a class="code" href="classConnection.html#a3f42f91d63f3f9f3578224113e599990">timers</a>;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno"><a class="line" href="classConnection.html#a2a2bc0fc8df4197e53dfecbe0fe5e94c">  310</a></span>&#160;    <a class="code" href="classIPAddr.html">IPAddr</a> <a class="code" href="classConnection.html#a2a2bc0fc8df4197e53dfecbe0fe5e94c">orig_addr</a>;</div><div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="classConnection.html#ac9e2b575a6675785353152545b844a40">  311</a></span>&#160;    <a class="code" href="classIPAddr.html">IPAddr</a> <a class="code" href="classConnection.html#ac9e2b575a6675785353152545b844a40">resp_addr</a>;</div><div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="classConnection.html#aa55d370298d340d7b3b1b0a7d6e3c057">  312</a></span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> orig_port, <a class="code" href="classConnection.html#aa55d370298d340d7b3b1b0a7d6e3c057">resp_port</a>;    <span class="comment">// in network order</span></div><div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="classConnection.html#ab9d5e8fc28da3273d38180c6c41f8782">  313</a></span>&#160;    <a class="code" href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7b">TransportProto</a> <a class="code" href="classConnection.html#ab9d5e8fc28da3273d38180c6c41f8782">proto</a>;</div><div class="line"><a name="l00314"></a><span class="lineno"><a class="line" href="classConnection.html#ac11fc5dc84f7e813f22fd6ffec97f230">  314</a></span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> orig_flow_label, <a class="code" href="classConnection.html#ac11fc5dc84f7e813f22fd6ffec97f230">resp_flow_label</a>;    <span class="comment">// most recent IPv6 flow labels</span></div><div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="classConnection.html#a66317dc7fc2621757f58071a0b53f76b">  315</a></span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="classConnection.html#a66317dc7fc2621757f58071a0b53f76b">vlan</a>, inner_vlan;    <span class="comment">// VLAN this connection traverses, if available</span></div><div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="classConnection.html#aaa5ddea8956754ab13219395e08c6dfe">  316</a></span>&#160;    u_char orig_l2_addr[<a class="code" href="classPacket.html#a5d2647e8a6f14e3661091c8871444d6a">Packet::l2_addr_len</a>];   <span class="comment">// Link-layer originator address, if available</span></div><div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="classConnection.html#a0d473af5db9ff55dec96ec522ffad1c4">  317</a></span>&#160;    u_char resp_l2_addr[<a class="code" href="classPacket.html#a5d2647e8a6f14e3661091c8871444d6a">Packet::l2_addr_len</a>];   <span class="comment">// Link-layer responder address, if available</span></div><div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="classConnection.html#a4ad4209e4c6d9eb7c69cd2a00b54a946">  318</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classConnection.html#a4ad4209e4c6d9eb7c69cd2a00b54a946">start_time</a>, last_time;</div><div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="classConnection.html#a76172ba71db44af7d5437689f042f608">  319</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classConnection.html#a76172ba71db44af7d5437689f042f608">inactivity_timeout</a>;</div><div class="line"><a name="l00320"></a><span class="lineno"><a class="line" href="classConnection.html#a5dc9b666250ddc0249e777b24b22c777">  320</a></span>&#160;    <a class="code" href="classRecordVal.html">RecordVal</a>* <a class="code" href="classConnection.html#a5dc9b666250ddc0249e777b24b22c777">conn_val</a>;</div><div class="line"><a name="l00321"></a><span class="lineno"><a class="line" href="classConnection.html#a4f81e26edbe826cf18d474409aee65db">  321</a></span>&#160;    LoginConn* <a class="code" href="classConnection.html#a4f81e26edbe826cf18d474409aee65db">login_conn</a>;  <span class="comment">// either nil, or this</span></div><div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="classConnection.html#a68b113b382bb9ccdef34161d85a992e3">  322</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="classEncapsulationStack.html">EncapsulationStack</a>* <a class="code" href="classConnection.html#a68b113b382bb9ccdef34161d85a992e3">encapsulation</a>; <span class="comment">// tunnels</span></div><div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="classConnection.html#a7ec1da1fd0d319d687a915c991836c8f">  323</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classConnection.html#a7ec1da1fd0d319d687a915c991836c8f">suppress_event</a>; <span class="comment">// suppress certain events to once per conn.</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno"><a class="line" href="classConnection.html#ae0bef1cd5971e54d1f9102e0856f2d34">  325</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> installed_status_timer:1;</div><div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="classConnection.html#a8369ee672e9deb7693c6b49448cd45ec">  326</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timers_canceled:1;</div><div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="classConnection.html#a4030e25b568288a8fef8c77aaf061880">  327</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> is_active:1;</div><div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="classConnection.html#a547a93627589ba6fa07f70aaca362cb7">  328</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> skip:1;</div><div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="classConnection.html#a40ba4ddf1f812be02ac3906ba16ab802">  329</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> weird:1;</div><div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="classConnection.html#a230f14b405561891189d8b4f386aa68d">  330</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> finished:1;</div><div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="classConnection.html#a5136d81452599ebefd99940a7f1259ca">  331</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> record_packets:1, record_contents:1;</div><div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="classConnection.html#a98f8cf03ccb8d7c8379597ddc4f76f6d">  332</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> persistent:1;</div><div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="classConnection.html#a41f4e1a64db831dce209e8190c530fae">  333</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> record_current_packet:1, record_current_content:1;</div><div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="classConnection.html#a3c448693c9b70953ce37392a035a5352">  334</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> saw_first_orig_packet:1, saw_first_resp_packet:1;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">// Count number of connections.</span></div><div class="line"><a name="l00337"></a><span class="lineno"><a class="line" href="classConnection.html#a07322b47ccaedd73badb6d46d187f59c">  337</a></span>&#160;    <span class="keyword">static</span> <a class="code" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> <a class="code" href="classConnection.html#a07322b47ccaedd73badb6d46d187f59c">total_connections</a>;</div><div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="classConnection.html#a7a2a302b2c377c98906ec83debef92e2">  338</a></span>&#160;    <span class="keyword">static</span> <a class="code" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> <a class="code" href="classConnection.html#a7a2a302b2c377c98906ec83debef92e2">current_connections</a>;</div><div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="classConnection.html#ad7692e4291533e88cbb673ff8c9a3aca">  339</a></span>&#160;    <span class="keyword">static</span> <a class="code" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> <a class="code" href="classConnection.html#ad7692e4291533e88cbb673ff8c9a3aca">external_connections</a>;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="classConnection.html#a069bbbcee053e9b5442cd94f3a2c0dd8">  341</a></span>&#160;    <span class="keywordtype">string</span> <a class="code" href="classConnection.html#a069bbbcee053e9b5442cd94f3a2c0dd8">history</a>;</div><div class="line"><a name="l00342"></a><span class="lineno"><a class="line" href="classConnection.html#a2a9c82a8373dbfd2ffcda2cc40a8a657">  342</a></span>&#160;    <a class="code" href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="classConnection.html#a2a9c82a8373dbfd2ffcda2cc40a8a657">hist_seen</a>;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="classConnection.html#ac3ef7b7ffedc2ecfa70dd1a12378ce92">  344</a></span>&#160;    <a class="code" href="classanalyzer_1_1TransportLayerAnalyzer.html">analyzer::TransportLayerAnalyzer</a>* <a class="code" href="classConnection.html#ac3ef7b7ffedc2ecfa70dd1a12378ce92">root_analyzer</a>;</div><div class="line"><a name="l00345"></a><span class="lineno"><a class="line" href="classConnection.html#a7f1100eb4f114327b83c6edfd2b9f610">  345</a></span>&#160;    <a class="code" href="classanalyzer_1_1pia_1_1PIA.html">analyzer::pia::PIA</a>* <a class="code" href="classConnection.html#a7f1100eb4f114327b83c6edfd2b9f610">primary_PIA</a>;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno"><a class="line" href="classConnection.html#ac00eec2cd9c82226c4ab851953e5e6d2">  347</a></span>&#160;    <a class="code" href="classBro_1_1UID.html">Bro::UID</a> <a class="code" href="classConnection.html#ac00eec2cd9c82226c4ab851953e5e6d2">uid</a>;   <span class="comment">// Globally unique connection ID.</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="structConnection_1_1WeirdState.html">  349</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structConnection_1_1WeirdState.html">WeirdState</a> {</div><div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="structConnection_1_1WeirdState.html#aef188829738851895e99d461d82aedeb">  350</a></span>&#160;        <a class="code" href="structConnection_1_1WeirdState.html#aef188829738851895e99d461d82aedeb">WeirdState</a>() { count = 0; sampling_start_time = 0; }</div><div class="line"><a name="l00351"></a><span class="lineno"><a class="line" href="structConnection_1_1WeirdState.html#a4ce6a4f6491bcfdb79e7c108f7319b22">  351</a></span>&#160;        <a class="code" href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a> count = 0;</div><div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="structConnection_1_1WeirdState.html#ab439337b2ae62699b473064f6c7c9b10">  352</a></span>&#160;        <span class="keywordtype">double</span> sampling_start_time = 0;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    };</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno"><a class="line" href="classConnection.html#af8d6f006e7862ec9fda704ec11f004e2">  355</a></span>&#160;    std::unordered_map&lt;std::string, WeirdState&gt; <a class="code" href="classConnection.html#af8d6f006e7862ec9fda704ec11f004e2">weird_state</a>;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;};</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno"><a class="line" href="classConnectionTimer.html">  358</a></span>&#160;<span class="keyword">class </span><a class="code" href="classConnectionTimer.html">ConnectionTimer</a> : <span class="keyword">public</span> <a class="code" href="classTimer.html">Timer</a> {</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00360"></a><span class="lineno"><a class="line" href="classConnectionTimer.html#a3a21550b3c252e1315e34a4b4b6db2db">  360</a></span>&#160;    <a class="code" href="classConnectionTimer.html#a3a21550b3c252e1315e34a4b4b6db2db">ConnectionTimer</a>(<a class="code" href="classConnection.html">Connection</a>* arg_conn, <a class="code" href="Conn_8h.html#ada976197ef4fddba1b5d3c2d7a8f62c8">timer_func</a> arg_timer,</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <span class="keywordtype">double</span> arg_t, <span class="keywordtype">int</span> arg_do_expire, <a class="code" href="Timer_8h.html#ad3a7c38fbde9814e427a75171fe8939d">TimerType</a> arg_type)</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        : <a class="code" href="classTimer.html">Timer</a>(arg_t, arg_type)</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        { Init(arg_conn, arg_timer, arg_do_expire); }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    ~<a class="code" href="classConnectionTimer.html">ConnectionTimer</a>() <span class="keyword">override</span>;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordtype">void</span> Dispatch(<span class="keywordtype">double</span> t, <span class="keywordtype">int</span> is_expire) <span class="keyword">override</span>;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="classConnectionTimer.html#aaa4ef77d948eabbc3d43f20b884074bc">  369</a></span>&#160;    <a class="code" href="classConnectionTimer.html#aaa4ef77d948eabbc3d43f20b884074bc">ConnectionTimer</a>()   {}</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordtype">void</span> Init(<a class="code" href="classConnection.html">Connection</a>* conn, <a class="code" href="Conn_8h.html#ada976197ef4fddba1b5d3c2d7a8f62c8">timer_func</a> timer, <span class="keywordtype">int</span> do_expire);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="SerialObj_8h.html#a1874dff178d4789461171fbbd3b57220">DECLARE_SERIAL</a>(<a class="code" href="classConnectionTimer.html">ConnectionTimer</a>);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="classConnectionTimer.html#a626fc8ce9f7b29b074b85b164dd56b1f">  375</a></span>&#160;    <a class="code" href="classConnection.html">Connection</a>* <a class="code" href="classConnectionTimer.html#a626fc8ce9f7b29b074b85b164dd56b1f">conn</a>;</div><div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="classConnectionTimer.html#a9f32186494e1b1deecc033a81ee4c1be">  376</a></span>&#160;    <a class="code" href="Conn_8h.html#ada976197ef4fddba1b5d3c2d7a8f62c8">timer_func</a> <a class="code" href="classConnectionTimer.html#a9f32186494e1b1deecc033a81ee4c1be">timer</a>;</div><div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="classConnectionTimer.html#a273f9a01c6286daf0fc1b7d0ce96fd85">  377</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classConnectionTimer.html#a273f9a01c6286daf0fc1b7d0ce96fd85">do_expire</a>;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;};</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno"><a class="line" href="Conn_8h.html#ac2b5290523d6b7dd5e7863e7b26f0a4c">  380</a></span>&#160;<span class="preprocessor">#define ADD_TIMER(timer, t, do_expire, type) \</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="preprocessor">    AddTimer(timer_func(timer), (t), (do_expire), (type))</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="classConnection_html_a069bbbcee053e9b5442cd94f3a2c0dd8"><div class="ttname"><a href="classConnection.html#a069bbbcee053e9b5442cd94f3a2c0dd8">Connection::history</a></div><div class="ttdeci">string history</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00341">Conn.h:341</a></div></div>
<div class="ttc" id="classUnserialInfo_html"><div class="ttname"><a href="classUnserialInfo.html">UnserialInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="SerialInfo_8h_source.html#l00066">SerialInfo.h:66</a></div></div>
<div class="ttc" id="classTimerMgr_html_a8d797fd4f0dc6dcf1e81026f0265c5f6"><div class="ttname"><a href="classTimerMgr.html#a8d797fd4f0dc6dcf1e81026f0265c5f6">TimerMgr::Tag</a></div><div class="ttdeci">std::string Tag</div><div class="ttdef"><b>Definition:</b> <a href="Timer_8h_source.html#l00109">Timer.h:109</a></div></div>
<div class="ttc" id="classConnectionTimer_html_a273f9a01c6286daf0fc1b7d0ce96fd85"><div class="ttname"><a href="classConnectionTimer.html#a273f9a01c6286daf0fc1b7d0ce96fd85">ConnectionTimer::do_expire</a></div><div class="ttdeci">int do_expire</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00377">Conn.h:377</a></div></div>
<div class="ttc" id="structConnID_html"><div class="ttname"><a href="structConnID.html">ConnID</a></div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00043">Conn.h:43</a></div></div>
<div class="ttc" id="classConnection_html_a9513634e7dcf73a72fc5e566dc4f5159"><div class="ttname"><a href="classConnection.html#a9513634e7dcf73a72fc5e566dc4f5159">Connection::LastTime</a></div><div class="ttdeci">double LastTime() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00099">Conn.h:99</a></div></div>
<div class="ttc" id="Conn_8h_html_aa104caa44a88fae508bbc8e9de30cb28"><div class="ttname"><a href="Conn_8h.html#aa104caa44a88fae508bbc8e9de30cb28">addr_port_canon_lt</a></div><div class="ttdeci">static int addr_port_canon_lt(const IPAddr &amp;addr1, uint32 p1, const IPAddr &amp;addr2, uint32 p2)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00051">Conn.h:51</a></div></div>
<div class="ttc" id="classConnection_html_a54c9530b9add10440e005d70b34e46b9"><div class="ttname"><a href="classConnection.html#a54c9530b9add10440e005d70b34e46b9">Connection::RecordContents</a></div><div class="ttdeci">int RecordContents() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00124">Conn.h:124</a></div></div>
<div class="ttc" id="classConnection_html_a173f279005065a009126c277f4216cdb"><div class="ttname"><a href="classConnection.html#a173f279005065a009126c277f4216cdb">Connection::GetUID</a></div><div class="ttdeci">Bro::UID GetUID() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00271">Conn.h:271</a></div></div>
<div class="ttc" id="net__util_8h_html_ab9d477e464e3fa232ca6b9675d4d1d7b"><div class="ttname"><a href="net__util_8h.html#ab9d477e464e3fa232ca6b9675d4d1d7b">TransportProto</a></div><div class="ttdeci">TransportProto</div><div class="ttdef"><b>Definition:</b> <a href="net__util_8h_source.html#l00009">net_util.h:9</a></div></div>
<div class="ttc" id="classConnection_html_af8d6f006e7862ec9fda704ec11f004e2"><div class="ttname"><a href="classConnection.html#af8d6f006e7862ec9fda704ec11f004e2">Connection::weird_state</a></div><div class="ttdeci">std::unordered_map&lt; std::string, WeirdState &gt; weird_state</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00355">Conn.h:355</a></div></div>
<div class="ttc" id="classConnection_html_a76de4f28f08057de1c37910113989f7b"><div class="ttname"><a href="classConnection.html#a76de4f28f08057de1c37910113989f7b">Connection::ClearKey</a></div><div class="ttdeci">void ClearKey()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00095">Conn.h:95</a></div></div>
<div class="ttc" id="classConnection_html_aeb76920698c5ee0ab81c1de56b36e912"><div class="ttname"><a href="classConnection.html#aeb76920698c5ee0ab81c1de56b36e912">Connection::TotalConnections</a></div><div class="ttdeci">static uint64 TotalConnections()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00226">Conn.h:226</a></div></div>
<div class="ttc" id="classConnection_html_aa1d0b76cfffa292436fe4acccb2053d1"><div class="ttname"><a href="classConnection.html#aa1d0b76cfffa292436fe4acccb2053d1">Connection::GetPrimaryPIA</a></div><div class="ttdeci">analyzer::pia::PIA * GetPrimaryPIA()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00264">Conn.h:264</a></div></div>
<div class="ttc" id="classConnection_html_a835ce5799a3fc311ce6947c2d68c8e2b"><div class="ttname"><a href="classConnection.html#a835ce5799a3fc311ce6947c2d68c8e2b">Connection::AddHistory</a></div><div class="ttdeci">void AddHistory(char code)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00257">Conn.h:257</a></div></div>
<div class="ttc" id="classVal_html"><div class="ttname"><a href="classVal.html">Val</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00078">Val.h:78</a></div></div>
<div class="ttc" id="namespaceanalyzer_html_a0f3859fceea28de62b71f4997f5f6c4f"><div class="ttname"><a href="namespaceanalyzer.html#a0f3859fceea28de62b71f4997f5f6c4f">analyzer::ID</a></div><div class="ttdeci">uint32 ID</div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8h_source.html#l00029">Analyzer.h:29</a></div></div>
<div class="ttc" id="classConnection_html_ad7692e4291533e88cbb673ff8c9a3aca"><div class="ttname"><a href="classConnection.html#ad7692e4291533e88cbb673ff8c9a3aca">Connection::external_connections</a></div><div class="ttdeci">static uint64 external_connections</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00339">Conn.h:339</a></div></div>
<div class="ttc" id="classConnection_html_adfcaaf6597ba088d49c347a88a1bc5a9"><div class="ttname"><a href="classConnection.html#adfcaaf6597ba088d49c347a88a1bc5a9">Connection::IsExternal</a></div><div class="ttdeci">bool IsExternal() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00213">Conn.h:213</a></div></div>
<div class="ttc" id="classConnection_html_a28f61fd8e0e956aa94df456e5c3e61b0"><div class="ttname"><a href="classConnection.html#a28f61fd8e0e956aa94df456e5c3e61b0">Connection::DidWeird</a></div><div class="ttdeci">bool DidWeird() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00182">Conn.h:182</a></div></div>
<div class="ttc" id="classConnection_html_ac9e2b575a6675785353152545b844a40"><div class="ttname"><a href="classConnection.html#ac9e2b575a6675785353152545b844a40">Connection::resp_addr</a></div><div class="ttdeci">IPAddr resp_addr</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00311">Conn.h:311</a></div></div>
<div class="ttc" id="classPersistenceSerializer_html_a14f52c42537c7b1e04cccc0f211c5beb"><div class="ttname"><a href="classPersistenceSerializer.html#a14f52c42537c7b1e04cccc0f211c5beb">PersistenceSerializer::Register</a></div><div class="ttdeci">void Register(ID *id)</div><div class="ttdef"><b>Definition:</b> <a href="PersistenceSerializer_8cc_source.html#l00052">PersistenceSerializer.cc:52</a></div></div>
<div class="ttc" id="Serializer_8h_html"><div class="ttname"><a href="Serializer_8h.html">Serializer.h</a></div></div>
<div class="ttc" id="classConnection_html_a4ad4209e4c6d9eb7c69cd2a00b54a946"><div class="ttname"><a href="classConnection.html#a4ad4209e4c6d9eb7c69cd2a00b54a946">Connection::start_time</a></div><div class="ttdeci">double start_time</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00318">Conn.h:318</a></div></div>
<div class="ttc" id="classConnection_html_ac30060d5450264467706a0036ef9044b"><div class="ttname"><a href="classConnection.html#ac30060d5450264467706a0036ef9044b">Connection::IsPersistent</a></div><div class="ttdeci">bool IsPersistent()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00205">Conn.h:205</a></div></div>
<div class="ttc" id="structConnID_html_ae9ad37d2e62210daa8955938351b61a2"><div class="ttname"><a href="structConnID.html#ae9ad37d2e62210daa8955938351b61a2">ConnID::src_port</a></div><div class="ttdeci">uint32 src_port</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00046">Conn.h:46</a></div></div>
<div class="ttc" id="UID_8h_html"><div class="ttname"><a href="UID_8h.html">UID.h</a></div></div>
<div class="ttc" id="classConnection_html_af4df7e68c03f2c898845ab2132a93180"><div class="ttname"><a href="classConnection.html#af4df7e68c03f2c898845ab2132a93180">Connection::SetLastTime</a></div><div class="ttdeci">void SetLastTime(double t)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00100">Conn.h:100</a></div></div>
<div class="ttc" id="classConnection_html_a2a2bc0fc8df4197e53dfecbe0fe5e94c"><div class="ttname"><a href="classConnection.html#a2a2bc0fc8df4197e53dfecbe0fe5e94c">Connection::orig_addr</a></div><div class="ttdeci">IPAddr orig_addr</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00310">Conn.h:310</a></div></div>
<div class="ttc" id="classConnection_html_ae8e8c3606daedac13b39c11688e0caf4"><div class="ttname"><a href="classConnection.html#ae8e8c3606daedac13b39c11688e0caf4">Connection::GetRespFlowLabel</a></div><div class="ttdeci">uint32 GetRespFlowLabel()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00279">Conn.h:279</a></div></div>
<div class="ttc" id="classConnection_html_a0655fd4d383eaf6dfc689700707c030f"><div class="ttname"><a href="classConnection.html#a0655fd4d383eaf6dfc689700707c030f">Connection::GetEncapsulation</a></div><div class="ttdeci">const EncapsulationStack * GetEncapsulation() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00273">Conn.h:273</a></div></div>
<div class="ttc" id="classConnection_html_a07322b47ccaedd73badb6d46d187f59c"><div class="ttname"><a href="classConnection.html#a07322b47ccaedd73badb6d46d187f59c">Connection::total_connections</a></div><div class="ttdeci">static uint64 total_connections</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00337">Conn.h:337</a></div></div>
<div class="ttc" id="classanalyzer_1_1Analyzer_html"><div class="ttname"><a href="classanalyzer_1_1Analyzer.html">analyzer::Analyzer</a></div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8h_source.html#l00076">Analyzer.h:76</a></div></div>
<div class="ttc" id="classSerialInfo_html"><div class="ttname"><a href="classSerialInfo.html">SerialInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="SerialInfo_8h_source.html#l00006">SerialInfo.h:6</a></div></div>
<div class="ttc" id="classConnection_html_a3cbc75959216daf671e7d68c645313fc"><div class="ttname"><a href="classConnection.html#a3cbc75959216daf671e7d68c645313fc">Connection::AsLoginConn</a></div><div class="ttdeci">LoginConn * AsLoginConn()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00159">Conn.h:159</a></div></div>
<div class="ttc" id="classConnection_html_a5dc9b666250ddc0249e777b24b22c777"><div class="ttname"><a href="classConnection.html#a5dc9b666250ddc0249e777b24b22c777">Connection::conn_val</a></div><div class="ttdeci">RecordVal * conn_val</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00320">Conn.h:320</a></div></div>
<div class="ttc" id="classBro_1_1UID_html"><div class="ttname"><a href="classBro_1_1UID.html">Bro::UID</a></div><div class="ttdef"><b>Definition:</b> <a href="UID_8h_source.html#l00019">UID.h:19</a></div></div>
<div class="ttc" id="classConnection_html_a1bc60c50f1631342091cd4f12be055fe"><div class="ttname"><a href="classConnection.html#a1bc60c50f1631342091cd4f12be055fe">Connection::SetRecordPackets</a></div><div class="ttdeci">void SetRecordPackets(int do_record)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00120">Conn.h:120</a></div></div>
<div class="ttc" id="RuleMatcher_8h_html"><div class="ttname"><a href="RuleMatcher_8h.html">RuleMatcher.h</a></div></div>
<div class="ttc" id="classConnection_html_a643bd6206b2b153fb082773e2c5f7a5e"><div class="ttname"><a href="classConnection.html#a643bd6206b2b153fb082773e2c5f7a5e">Connection::ConnTransport</a></div><div class="ttdeci">TransportProto ConnTransport() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00114">Conn.h:114</a></div></div>
<div class="ttc" id="classPacket_html_a5d2647e8a6f14e3661091c8871444d6a"><div class="ttname"><a href="classPacket.html#a5d2647e8a6f14e3661091c8871444d6a">Packet::l2_addr_len</a></div><div class="ttdeci">static const int l2_addr_len</div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00160">Packet.h:160</a></div></div>
<div class="ttc" id="structConnID_html_aafcde0285d132c9f24f162df69ad08ce"><div class="ttname"><a href="structConnID.html#aafcde0285d132c9f24f162df69ad08ce">ConnID::is_one_way</a></div><div class="ttdeci">bool is_one_way</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00048">Conn.h:48</a></div></div>
<div class="ttc" id="Conn_8h_html_a80f6c169681367b70eddc3b90d23eaf8a0b644a086437e7e33b2481be8b22f3fc"><div class="ttname"><a href="Conn_8h.html#a80f6c169681367b70eddc3b90d23eaf8a0b644a086437e7e33b2481be8b22f3fc">SINGULAR_LF</a></div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00037">Conn.h:37</a></div></div>
<div class="ttc" id="classRuleHdrTest_html"><div class="ttname"><a href="classRuleHdrTest.html">RuleHdrTest</a></div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00073">RuleMatcher.h:73</a></div></div>
<div class="ttc" id="classConnection_html_a241219f9280b07cb082272e9102ebbc6"><div class="ttname"><a href="classConnection.html#a241219f9280b07cb082272e9102ebbc6">Connection::sessions</a></div><div class="ttdeci">NetSessions * sessions</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00303">Conn.h:303</a></div></div>
<div class="ttc" id="structConnection_1_1WeirdState_html_aef188829738851895e99d461d82aedeb"><div class="ttname"><a href="structConnection_1_1WeirdState.html#aef188829738851895e99d461d82aedeb">Connection::WeirdState::WeirdState</a></div><div class="ttdeci">WeirdState()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00350">Conn.h:350</a></div></div>
<div class="ttc" id="classConnection_html_a3f48a25b42b41c0de6515fd55f8df6ea"><div class="ttname"><a href="classConnection.html#a3f48a25b42b41c0de6515fd55f8df6ea">Connection::RespAddr</a></div><div class="ttdeci">const IPAddr &amp; RespAddr() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00103">Conn.h:103</a></div></div>
<div class="ttc" id="classIPAddr_html"><div class="ttname"><a href="classIPAddr.html">IPAddr</a></div><div class="ttdef"><b>Definition:</b> <a href="IPAddr_8h_source.html#l00024">IPAddr.h:24</a></div></div>
<div class="ttc" id="classConnectionTimer_html_a626fc8ce9f7b29b074b85b164dd56b1f"><div class="ttname"><a href="classConnectionTimer.html#a626fc8ce9f7b29b074b85b164dd56b1f">ConnectionTimer::conn</a></div><div class="ttdeci">Connection * conn</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00375">Conn.h:375</a></div></div>
<div class="ttc" id="classConnection_html_ad30c35fc864cc3318492651a6f5486b5"><div class="ttname"><a href="classConnection.html#ad30c35fc864cc3318492651a6f5486b5">Connection::CheckHistory</a></div><div class="ttdeci">int CheckHistory(uint32 mask, char code)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00234">Conn.h:234</a></div></div>
<div class="ttc" id="classRuleEndpointState_html"><div class="ttname"><a href="classRuleEndpointState.html">RuleEndpointState</a></div><div class="ttdef"><b>Definition:</b> <a href="RuleMatcher_8h_source.html#l00144">RuleMatcher.h:144</a></div></div>
<div class="ttc" id="structConnection_1_1WeirdState_html"><div class="ttname"><a href="structConnection_1_1WeirdState.html">Connection::WeirdState</a></div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00349">Conn.h:349</a></div></div>
<div class="ttc" id="classConnection_html_a9bd4b788939fb695973f9a72406baea6"><div class="ttname"><a href="classConnection.html#a9bd4b788939fb695973f9a72406baea6">Connection::MakePersistent</a></div><div class="ttdeci">void MakePersistent()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00199">Conn.h:199</a></div></div>
<div class="ttc" id="Dict_8h_html"><div class="ttname"><a href="Dict_8h.html">Dict.h</a></div></div>
<div class="ttc" id="structConnID_html_a76f9ae769858dca80ed4d4c254194300"><div class="ttname"><a href="structConnID.html#a76f9ae769858dca80ed4d4c254194300">ConnID::dst_port</a></div><div class="ttdeci">uint32 dst_port</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00047">Conn.h:47</a></div></div>
<div class="ttc" id="Timer_8h_html"><div class="ttname"><a href="Timer_8h.html">Timer.h</a></div></div>
<div class="ttc" id="classConnection_html_a5af1186178d0f110a8655b45876bb107"><div class="ttname"><a href="classConnection.html#a5af1186178d0f110a8655b45876bb107">Connection::GetOrigFlowLabel</a></div><div class="ttdeci">uint32 GetOrigFlowLabel()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00278">Conn.h:278</a></div></div>
<div class="ttc" id="classConnection_html_aef7a8ab568adcda054cf6568a66c9822"><div class="ttname"><a href="classConnection.html#aef7a8ab568adcda054cf6568a66c9822">Connection::SetStartTime</a></div><div class="ttdeci">void SetStartTime(double t)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00098">Conn.h:98</a></div></div>
<div class="ttc" id="Timer_8h_html_ad3a7c38fbde9814e427a75171fe8939d"><div class="ttname"><a href="Timer_8h.html#ad3a7c38fbde9814e427a75171fe8939d">TimerType</a></div><div class="ttdeci">TimerType</div><div class="ttdef"><b>Definition:</b> <a href="Timer_8h_source.html#l00017">Timer.h:17</a></div></div>
<div class="ttc" id="Conn_8h_html_a80f6c169681367b70eddc3b90d23eaf8a5f46044b1163aaac2333619ffb899f7d"><div class="ttname"><a href="Conn_8h.html#a80f6c169681367b70eddc3b90d23eaf8a5f46044b1163aaac2333619ffb899f7d">SINGULAR_CR</a></div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00036">Conn.h:36</a></div></div>
<div class="ttc" id="IPAddr_8h_html"><div class="ttname"><a href="IPAddr_8h.html">IPAddr.h</a></div></div>
<div class="ttc" id="classConnection_html_a7f1100eb4f114327b83c6edfd2b9f610"><div class="ttname"><a href="classConnection.html#a7f1100eb4f114327b83c6edfd2b9f610">Connection::primary_PIA</a></div><div class="ttdeci">analyzer::pia::PIA * primary_PIA</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00345">Conn.h:345</a></div></div>
<div class="ttc" id="classConnection_html_a2807492e6d4a7e525082873aa3a06ba1"><div class="ttname"><a href="classConnection.html#a2807492e6d4a7e525082873aa3a06ba1">Connection::OrigAddr</a></div><div class="ttdeci">const IPAddr &amp; OrigAddr() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00102">Conn.h:102</a></div></div>
<div class="ttc" id="classHashKey_html"><div class="ttname"><a href="classHashKey.html">HashKey</a></div><div class="ttdef"><b>Definition:</b> <a href="Hash_8h_source.html#l00021">Hash.h:21</a></div></div>
<div class="ttc" id="classIP__Hdr_html"><div class="ttname"><a href="classIP__Hdr.html">IP_Hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="IP_8h_source.html#l00339">IP.h:339</a></div></div>
<div class="ttc" id="Conn_8h_html_a80f6c169681367b70eddc3b90d23eaf8"><div class="ttname"><a href="Conn_8h.html#a80f6c169681367b70eddc3b90d23eaf8">ConnEventToFlag</a></div><div class="ttdeci">ConnEventToFlag</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00034">Conn.h:34</a></div></div>
<div class="ttc" id="classODesc_html"><div class="ttname"><a href="classODesc.html">ODesc</a></div><div class="ttdef"><b>Definition:</b> <a href="Desc_8h_source.html#l00028">Desc.h:28</a></div></div>
<div class="ttc" id="classConnection_html_ac3ef7b7ffedc2ecfa70dd1a12378ce92"><div class="ttname"><a href="classConnection.html#ac3ef7b7ffedc2ecfa70dd1a12378ce92">Connection::root_analyzer</a></div><div class="ttdeci">analyzer::TransportLayerAnalyzer * root_analyzer</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00344">Conn.h:344</a></div></div>
<div class="ttc" id="classConnectionTimer_html_a3a21550b3c252e1315e34a4b4b6db2db"><div class="ttname"><a href="classConnectionTimer.html#a3a21550b3c252e1315e34a4b4b6db2db">ConnectionTimer::ConnectionTimer</a></div><div class="ttdeci">ConnectionTimer(Connection *arg_conn, timer_func arg_timer, double arg_t, int arg_do_expire, TimerType arg_type)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00360">Conn.h:360</a></div></div>
<div class="ttc" id="classEventHandlerPtr_html"><div class="ttname"><a href="classEventHandlerPtr.html">EventHandlerPtr</a></div><div class="ttdef"><b>Definition:</b> <a href="EventHandler_8h_source.html#l00086">EventHandler.h:86</a></div></div>
<div class="ttc" id="classConnection_html_aa55d370298d340d7b3b1b0a7d6e3c057"><div class="ttname"><a href="classConnection.html#aa55d370298d340d7b3b1b0a7d6e3c057">Connection::resp_port</a></div><div class="ttdeci">uint32 resp_port</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00312">Conn.h:312</a></div></div>
<div class="ttc" id="classNetSessions_html"><div class="ttname"><a href="classNetSessions.html">NetSessions</a></div><div class="ttdef"><b>Definition:</b> <a href="Sessions_8h_source.html#l00065">Sessions.h:65</a></div></div>
<div class="ttc" id="analyzer_2Tag_8h_html"><div class="ttname"><a href="analyzer_2Tag_8h.html">Tag.h</a></div></div>
<div class="ttc" id="classConnection_html_a76172ba71db44af7d5437689f042f608"><div class="ttname"><a href="classConnection.html#a76172ba71db44af7d5437689f042f608">Connection::inactivity_timeout</a></div><div class="ttdeci">double inactivity_timeout</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00319">Conn.h:319</a></div></div>
<div class="ttc" id="classRecordVal_html"><div class="ttname"><a href="classRecordVal.html">RecordVal</a></div><div class="ttdef"><b>Definition:</b> <a href="Val_8h_source.html#l00937">Val.h:937</a></div></div>
<div class="ttc" id="classanalyzer_1_1Tag_html"><div class="ttname"><a href="classanalyzer_1_1Tag.html">analyzer::Tag</a></div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Tag_8h_source.html#l00024">Tag.h:24</a></div></div>
<div class="ttc" id="classRule_html_af6be8dfd23098aad37f3cd0188a0953b"><div class="ttname"><a href="classRule.html#af6be8dfd23098aad37f3cd0188a0953b">Rule::PatternType</a></div><div class="ttdeci">PatternType</div><div class="ttdef"><b>Definition:</b> <a href="Rule_8h_source.html#l00039">Rule.h:39</a></div></div>
<div class="ttc" id="classConnection_html_ac5ae73f3e9b72f433bc889c5f4f0a56f"><div class="ttname"><a href="classConnection.html#ac5ae73f3e9b72f433bc889c5f4f0a56f">Connection::RecordPackets</a></div><div class="ttdeci">int RecordPackets() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00119">Conn.h:119</a></div></div>
<div class="ttc" id="classConnection_html_a7ec1da1fd0d319d687a915c991836c8f"><div class="ttname"><a href="classConnection.html#a7ec1da1fd0d319d687a915c991836c8f">Connection::suppress_event</a></div><div class="ttdeci">int suppress_event</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00323">Conn.h:323</a></div></div>
<div class="ttc" id="classConnection_html_aa34eea9ee84acf315a13828d7cb955ed"><div class="ttname"><a href="classConnection.html#aa34eea9ee84acf315a13828d7cb955ed">Connection::Skipping</a></div><div class="ttdeci">int Skipping() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00139">Conn.h:139</a></div></div>
<div class="ttc" id="namespaceanalyzer_1_1dns_html_a4eda0cc0d27726971bfe1253e4243445"><div class="ttname"><a href="namespaceanalyzer_1_1dns.html#a4eda0cc0d27726971bfe1253e4243445">analyzer::dns::IsReuse</a></div><div class="ttdeci">int IsReuse(double t, const u_char *pkt)</div></div>
<div class="ttc" id="classConnection_html_a68b113b382bb9ccdef34161d85a992e3"><div class="ttname"><a href="classConnection.html#a68b113b382bb9ccdef34161d85a992e3">Connection::encapsulation</a></div><div class="ttdeci">const EncapsulationStack * encapsulation</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00322">Conn.h:322</a></div></div>
<div class="ttc" id="classConnection_html_aba6b2cec35b0eff7c592a53db8e10768"><div class="ttname"><a href="classConnection.html#aba6b2cec35b0eff7c592a53db8e10768">Connection::SetRecordContents</a></div><div class="ttdeci">void SetRecordContents(int do_record)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00125">Conn.h:125</a></div></div>
<div class="ttc" id="classConnection_html_a81284e05d2cccb0f323b3c15a5dd817f"><div class="ttname"><a href="classConnection.html#a81284e05d2cccb0f323b3c15a5dd817f">Connection::CurrentExternalConnections</a></div><div class="ttdeci">static uint64 CurrentExternalConnections()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00230">Conn.h:230</a></div></div>
<div class="ttc" id="classConnection_html_a52274612e2dbc076a2c5620c8215c50c"><div class="ttname"><a href="classConnection.html#a52274612e2dbc076a2c5620c8215c50c">Connection::GetRootAnalyzer</a></div><div class="ttdeci">analyzer::TransportLayerAnalyzer * GetRootAnalyzer()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00263">Conn.h:263</a></div></div>
<div class="ttc" id="classTimerMgr_html"><div class="ttname"><a href="classTimerMgr.html">TimerMgr</a></div><div class="ttdef"><b>Definition:</b> <a href="Timer_8h_source.html#l00083">Timer.h:83</a></div></div>
<div class="ttc" id="analyzer_2Analyzer_8h_html"><div class="ttname"><a href="analyzer_2Analyzer_8h.html">Analyzer.h</a></div></div>
<div class="ttc" id="classConnection_html_af7cac1c17f83cf4470976c0923f62a86"><div class="ttname"><a href="classConnection.html#af7cac1c17f83cf4470976c0923f62a86">Connection::SetRecordCurrentPacket</a></div><div class="ttdeci">void SetRecordCurrentPacket(int do_record)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00128">Conn.h:128</a></div></div>
<div class="ttc" id="classPacket_html"><div class="ttname"><a href="classPacket.html">Packet</a></div><div class="ttdef"><b>Definition:</b> <a href="Packet_8h_source.html#l00034">Packet.h:34</a></div></div>
<div class="ttc" id="classConnection_html_a24c5af05bdb1cf4579ab5aba659667a4"><div class="ttname"><a href="classConnection.html#a24c5af05bdb1cf4579ab5aba659667a4">Connection::conn_timer_mgr</a></div><div class="ttdeci">TimerMgr::Tag * conn_timer_mgr</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00307">Conn.h:307</a></div></div>
<div class="ttc" id="classConnection_html_ac00eec2cd9c82226c4ab851953e5e6d2"><div class="ttname"><a href="classConnection.html#ac00eec2cd9c82226c4ab851953e5e6d2">Connection::uid</a></div><div class="ttdeci">Bro::UID uid</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00347">Conn.h:347</a></div></div>
<div class="ttc" id="classConnection_html_a689d9c2b25d898b9f49128e3379af1f9"><div class="ttname"><a href="classConnection.html#a689d9c2b25d898b9f49128e3379af1f9">Connection::key</a></div><div class="ttdeci">HashKey * key</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00304">Conn.h:304</a></div></div>
<div class="ttc" id="TunnelEncapsulation_8h_html"><div class="ttname"><a href="TunnelEncapsulation_8h.html">TunnelEncapsulation.h</a></div></div>
<div class="ttc" id="classConnection_html_a9df9d1798854bd69944e838de68ed136"><div class="ttname"><a href="classConnection.html#a9df9d1798854bd69944e838de68ed136">Connection::OrigPort</a></div><div class="ttdeci">uint32 OrigPort() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00105">Conn.h:105</a></div></div>
<div class="ttc" id="main_8cc_html_a1aff8a1f8e9083728732277f4726ad8d"><div class="ttname"><a href="main_8cc.html#a1aff8a1f8e9083728732277f4726ad8d">persistence_serializer</a></div><div class="ttdeci">PersistenceSerializer * persistence_serializer</div><div class="ttdef"><b>Definition:</b> <a href="main_8cc_source.html#l00103">main.cc:103</a></div></div>
<div class="ttc" id="classanalyzer_1_1pia_1_1PIA_html"><div class="ttname"><a href="classanalyzer_1_1pia_1_1PIA.html">analyzer::pia::PIA</a></div><div class="ttdef"><b>Definition:</b> <a href="PIA_8h_source.html#l00020">PIA.h:20</a></div></div>
<div class="ttc" id="classConnection_html_adc1d038f98c86b00720eaf221790743d"><div class="ttname"><a href="classConnection.html#adc1d038f98c86b00720eaf221790743d">Connection::SetSkip</a></div><div class="ttdeci">void SetSkip(int do_skip)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00138">Conn.h:138</a></div></div>
<div class="ttc" id="classConnection_html_a1552f77a2e3c5f381c33d979ddd19067"><div class="ttname"><a href="classConnection.html#a1552f77a2e3c5f381c33d979ddd19067">Connection::FlagEvent</a></div><div class="ttdeci">int FlagEvent(ConnEventToFlag e)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00187">Conn.h:187</a></div></div>
<div class="ttc" id="structConnID_html_ad08208ae83226b86815b6b6f787531e5"><div class="ttname"><a href="structConnID.html#ad08208ae83226b86815b6b6f787531e5">ConnID::dst_addr</a></div><div class="ttdeci">IPAddr dst_addr</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00045">Conn.h:45</a></div></div>
<div class="ttc" id="classEncapsulationStack_html"><div class="ttname"><a href="classEncapsulationStack.html">EncapsulationStack</a></div><div class="ttdef"><b>Definition:</b> <a href="TunnelEncapsulation_8h_source.html#l00121">TunnelEncapsulation.h:121</a></div></div>
<div class="ttc" id="classConnection_html_ab9d5e8fc28da3273d38180c6c41f8782"><div class="ttname"><a href="classConnection.html#ab9d5e8fc28da3273d38180c6c41f8782">Connection::proto</a></div><div class="ttdeci">TransportProto proto</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00313">Conn.h:313</a></div></div>
<div class="ttc" id="Conn_8h_html_a80f6c169681367b70eddc3b90d23eaf8aae94a0f40bcdb6009498a3ba0ed894d2"><div class="ttname"><a href="Conn_8h.html#a80f6c169681367b70eddc3b90d23eaf8aae94a0f40bcdb6009498a3ba0ed894d2">NUM_EVENTS_TO_FLAG</a></div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00038">Conn.h:38</a></div></div>
<div class="ttc" id="Conn_8h_html_ada976197ef4fddba1b5d3c2d7a8f62c8"><div class="ttname"><a href="Conn_8h.html#ada976197ef4fddba1b5d3c2d7a8f62c8">timer_func</a></div><div class="ttdeci">void(Connection::* timer_func)(double t)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00041">Conn.h:41</a></div></div>
<div class="ttc" id="classConnection_html_a9de94289ca6259f94ef6aeba3b134a77"><div class="ttname"><a href="classConnection.html#a9de94289ca6259f94ef6aeba3b134a77">Connection::Connection</a></div><div class="ttdeci">Connection()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00286">Conn.h:286</a></div></div>
<div class="ttc" id="classConnection_html_a4f81e26edbe826cf18d474409aee65db"><div class="ttname"><a href="classConnection.html#a4f81e26edbe826cf18d474409aee65db">Connection::login_conn</a></div><div class="ttdeci">LoginConn * login_conn</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00321">Conn.h:321</a></div></div>
<div class="ttc" id="classConnection_html_a3f42f91d63f3f9f3578224113e599990"><div class="ttname"><a href="classConnection.html#a3f42f91d63f3f9f3578224113e599990">Connection::timers</a></div><div class="ttdeci">timer_list timers</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00308">Conn.h:308</a></div></div>
<div class="ttc" id="classConnection_html_ad58d5b6b28efa1fed98390a50adaee23"><div class="ttname"><a href="classConnection.html#ad58d5b6b28efa1fed98390a50adaee23">Connection::SetRecordCurrentContent</a></div><div class="ttdeci">void SetRecordCurrentContent(int do_record)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00130">Conn.h:130</a></div></div>
<div class="ttc" id="classConnectionTimer_html_a9f32186494e1b1deecc033a81ee4c1be"><div class="ttname"><a href="classConnectionTimer.html#a9f32186494e1b1deecc033a81ee4c1be">ConnectionTimer::timer</a></div><div class="ttdeci">timer_func timer</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00376">Conn.h:376</a></div></div>
<div class="ttc" id="util_8h_html_acbd4acd0d29e2d6c43104827f77d9cd2"><div class="ttname"><a href="util_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00064">util.h:64</a></div></div>
<div class="ttc" id="SerialObj_8h_html_a1874dff178d4789461171fbbd3b57220"><div class="ttname"><a href="SerialObj_8h.html#a1874dff178d4789461171fbbd3b57220">DECLARE_SERIAL</a></div><div class="ttdeci">#define DECLARE_SERIAL(classname)</div><div class="ttdef"><b>Definition:</b> <a href="SerialObj_8h_source.html#l00169">SerialObj.h:169</a></div></div>
<div class="ttc" id="classEvent_html"><div class="ttname"><a href="classEvent.html">Event</a></div><div class="ttdef"><b>Definition:</b> <a href="Event_8h_source.html#l00014">Event.h:14</a></div></div>
<div class="ttc" id="classConnection_html_a38f9bcd5cd5a658c9f3b58257bddb99b"><div class="ttname"><a href="classConnection.html#a38f9bcd5cd5a658c9f3b58257bddb99b">Connection::RespPort</a></div><div class="ttdeci">uint32 RespPort() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00106">Conn.h:106</a></div></div>
<div class="ttc" id="util_8h_html_abc0f5bc07737e498f287334775dff2b6"><div class="ttname"><a href="util_8h.html#abc0f5bc07737e498f287334775dff2b6">uint64</a></div><div class="ttdeci">uint64_t uint64</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00063">util.h:63</a></div></div>
<div class="ttc" id="Val_8h_html"><div class="ttname"><a href="Val_8h.html">Val.h</a></div></div>
<div class="ttc" id="classConnection_html_a66317dc7fc2621757f58071a0b53f76b"><div class="ttname"><a href="classConnection.html#a66317dc7fc2621757f58071a0b53f76b">Connection::vlan</a></div><div class="ttdeci">uint32 vlan</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00315">Conn.h:315</a></div></div>
<div class="ttc" id="classConnectionTimer_html"><div class="ttname"><a href="classConnectionTimer.html">ConnectionTimer</a></div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00358">Conn.h:358</a></div></div>
<div class="ttc" id="PersistenceSerializer_8h_html"><div class="ttname"><a href="PersistenceSerializer_8h.html">PersistenceSerializer.h</a></div></div>
<div class="ttc" id="classConnection_html_ac11fc5dc84f7e813f22fd6ffec97f230"><div class="ttname"><a href="classConnection.html#ac11fc5dc84f7e813f22fd6ffec97f230">Connection::resp_flow_label</a></div><div class="ttdeci">uint32 resp_flow_label</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00314">Conn.h:314</a></div></div>
<div class="ttc" id="classConnection_html_ac9eede429301d9d08d354bf04d683a12"><div class="ttname"><a href="classConnection.html#ac9eede429301d9d08d354bf04d683a12">Connection::InactivityTimeout</a></div><div class="ttdeci">double InactivityTimeout() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00151">Conn.h:151</a></div></div>
<div class="ttc" id="classBroObj_html"><div class="ttname"><a href="classBroObj.html">BroObj</a></div><div class="ttdef"><b>Definition:</b> <a href="Obj_8h_source.html#l00089">Obj.h:89</a></div></div>
<div class="ttc" id="classConnectionTimer_html_aaa4ef77d948eabbc3d43f20b884074bc"><div class="ttname"><a href="classConnectionTimer.html#aaa4ef77d948eabbc3d43f20b884074bc">ConnectionTimer::ConnectionTimer</a></div><div class="ttdeci">ConnectionTimer()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00369">Conn.h:369</a></div></div>
<div class="ttc" id="classConnection_html_a7a2a302b2c377c98906ec83debef92e2"><div class="ttname"><a href="classConnection.html#a7a2a302b2c377c98906ec83debef92e2">Connection::current_connections</a></div><div class="ttdeci">static uint64 current_connections</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00338">Conn.h:338</a></div></div>
<div class="ttc" id="classSpecific__RE__Matcher_html"><div class="ttname"><a href="classSpecific__RE__Matcher.html">Specific_RE_Matcher</a></div><div class="ttdef"><b>Definition:</b> <a href="RE_8h_source.html#l00050">RE.h:50</a></div></div>
<div class="ttc" id="classConnection_html_a13d3b4489fdba64ebe5ff817764c9863"><div class="ttname"><a href="classConnection.html#a13d3b4489fdba64ebe5ff817764c9863">Connection::SetTransport</a></div><div class="ttdeci">void SetTransport(TransportProto arg_proto)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00267">Conn.h:267</a></div></div>
<div class="ttc" id="classTimer_html"><div class="ttname"><a href="classTimer.html">Timer</a></div><div class="ttdef"><b>Definition:</b> <a href="Timer_8h_source.html#l00057">Timer.h:57</a></div></div>
<div class="ttc" id="structConnID_html_ab31d61d52f47a05528fc220c295d6f29"><div class="ttname"><a href="structConnID.html#ab31d61d52f47a05528fc220c295d6f29">ConnID::src_addr</a></div><div class="ttdeci">IPAddr src_addr</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00044">Conn.h:44</a></div></div>
<div class="ttc" id="classConnection_html"><div class="ttname"><a href="classConnection.html">Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00059">Conn.h:59</a></div></div>
<div class="ttc" id="namespaceanalyzer_html"><div class="ttname"><a href="namespaceanalyzer.html">analyzer</a></div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8cc_source.html#l00012">Analyzer.cc:12</a></div></div>
<div class="ttc" id="Conn_8h_html_a80f6c169681367b70eddc3b90d23eaf8a33c652ed465d53417405a0656e698264"><div class="ttname"><a href="Conn_8h.html#a80f6c169681367b70eddc3b90d23eaf8a33c652ed465d53417405a0656e698264">NUL_IN_LINE</a></div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00035">Conn.h:35</a></div></div>
<div class="ttc" id="classConnection_html_a2a9c82a8373dbfd2ffcda2cc40a8a657"><div class="ttname"><a href="classConnection.html#a2a9c82a8373dbfd2ffcda2cc40a8a657">Connection::hist_seen</a></div><div class="ttdeci">uint32 hist_seen</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00342">Conn.h:342</a></div></div>
<div class="ttc" id="classConnection_html_a68d718e69d8619faf7957b2f64c3f79d"><div class="ttname"><a href="classConnection.html#a68d718e69d8619faf7957b2f64c3f79d">Connection::CurrentConnections</a></div><div class="ttdeci">static uint64 CurrentConnections()</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00228">Conn.h:228</a></div></div>
<div class="ttc" id="classConnection_html_a4cb06f742acc06248ca7a23e377e0849"><div class="ttname"><a href="classConnection.html#a4cb06f742acc06248ca7a23e377e0849">Connection::StartTime</a></div><div class="ttdeci">double StartTime() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00097">Conn.h:97</a></div></div>
<div class="ttc" id="classConnection_html_a36e522312fdae78fef83d54c84f0e0b5"><div class="ttname"><a href="classConnection.html#a36e522312fdae78fef83d54c84f0e0b5">Connection::Key</a></div><div class="ttdeci">HashKey * Key() const </div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00094">Conn.h:94</a></div></div>
<div class="ttc" id="classanalyzer_1_1TransportLayerAnalyzer_html"><div class="ttname"><a href="classanalyzer_1_1TransportLayerAnalyzer.html">analyzer::TransportLayerAnalyzer</a></div><div class="ttdef"><b>Definition:</b> <a href="analyzer_2Analyzer_8h_source.html#l00801">Analyzer.h:801</a></div></div>
<div class="ttc" id="classConnection_html_ac157de5e849f9cd5c64f3c4967bbe7c8"><div class="ttname"><a href="classConnection.html#ac157de5e849f9cd5c64f3c4967bbe7c8">Connection::SetUID</a></div><div class="ttdeci">void SetUID(const Bro::UID &amp;arg_uid)</div><div class="ttdef"><b>Definition:</b> <a href="Conn_8h_source.html#l00269">Conn.h:269</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
